M.define("/js/Dropdown",function(c,b,d){function a(e){this.$nav=typeof e.nav==="string"?$(e.nav):e.nav;this.$panel=typeof e.panel==="string"?$(e.panel):e.panel;this.showCallback=e.showCallback;this.hideCallback=e.hideCallback;this.delay=e.delay||0;this.event=e.event||"mouseenterleave";this._isShow=false;this.init()}a.prototype={init:function(){if(this.event==="mouseenterleave"){this.$nav.on("mouseenter.dropdown",M.bind(function(e){this.show()},this)).on("mouseleave.dropdown",M.bind(function(e){if($(e.relatedTarget).closest(this.$panel).length===0){this.hide(true)}},this));this.$panel.on("mouseenter.dropdown",M.bind(function(e){this.show()},this)).on("mouseleave.dropdown",M.bind(function(e){if($(e.relatedTarget).closest(this.$nav).length===0){this.hide(false)}},this))}if(this.event==="click"){this.$nav.on("click.dropdown",M.bind(function(e){this.show()},this));$(document).on("click.dropdown",M.bind(function(e){if($(e.target).closest(this.$nav).length===0&&$(e.target).closest(this.$panel).length===0){this.hide(false)}},this))}},show:function(){this.$panel.show();this._isShow=true;if(M.isFunction(this.showCallback)){this.showCallback.call(this,this.$nav,this.$panel)}},hide:function(e){this._isShow=false;if(e&&this.delay>0){setTimeout(M.bind(function(){if(!this._isShow){this.$panel.hide();if(M.isFunction(this.hideCallback)){this.hideCallback.call(this,this.$nav,this.$panel)}}},this),this.delay)}else{this.$panel.hide();if(M.isFunction(this.hideCallback)){this.hideCallback.call(this,this.$nav,this.$panel)}}},destory:function(){if(this.event==="mouseenterleave"){this.$nav.off("mouseenter.dropdown").off("mouseleave.dropdown");this.$panel.off("mouseenter.dropdown").off("mouseleave.dropdown")}if(this.event==="click"){this.$nav.off("click.dropdown")}this.$panel.hide()}};d.exports=a});M.define("/js/pageletcommon/pageHeadUserInfoWWWNormal",function(c){var a=c("/js/Dropdown"),b=window.Env||{};return{events:{},init:function(){var k=$("#head-btn-daka");$(function(){$(".new_daka_tips").addClass("on")});$(".ndt_close").on("click",function(){$(this).parent().hide()});M.Event.on("afterDaka",l);function l(q){if(q&&q.dakaFlag){k.closest(".head-daka").addClass("daka-complete")}}var e=i("dakaday");if(e!==null){$(".head-btn-daka").attr("data-day",e)}function i(q){var s=new RegExp("(^|&)"+q+"=([^&]*)(&|$)");var t=window.location.search.substr(1).match(s);if(t!==null){return unescape(t[2])}return null}var g=new a({nav:"#_j_head_user",panel:"#_j_user_panel",showCallback:function(q,r){q.find(".drop-trigger").addClass("drop-trigger-active")},hideCallback:function(q,r){q.find(".drop-trigger").removeClass("drop-trigger-active")},delay:500});var d=0,p=$("#_j_head_msg"),o=$("#_j_msg_panel"),n=p.find(".head-msg-new"),j=$("#_j_msg_float_panel");var f=new a({nav:p.selector,panel:o.selector,showCallback:function(q,r){q.find(".drop-trigger").addClass("drop-trigger-active")},hideCallback:function(q,r){q.find(".drop-trigger").removeClass("drop-trigger-active")},delay:200});M.Event.on("get new msg",function(q){if(q.msg||d>0){o.find("ul").html(q.menu_index);h()}});o.on("click","a",function(q){M.Event.fire("update msg")});j.on("click","ul a",function(q){M.Event.fire("update msg")});j.on("click",".close-newmsg",function(q){m()});function m(){n.hide();j.hide();$.ajax({url:"http://"+b.WWW_HOST+"/ajax/ajax_msg.php",dataType:"jsonp",data:{a:"ignore",from:"1"},success:function(q){M.Event.fire("update msg")}})}window.close_msg_tips=m;function h(){var q="";d=0;o.find(".num").each(function(r,t){var s=$(t);d+=Number(s.html());q+="<li>"+s.closest("li").html()+"</li>"});if(d>0){n.html((d>99?"99+":d)).show();j.find("ul").html(q).end().show()}else{n.hide();j.hide()}}h()}}});
/*!
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright 2011, Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(i,f){var t=i.fn.domManip,h="_tmplitem",u=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,p={},e={},z,x={key:0,data:{}},w=0,q=0,g=[];function k(C,B,E,F){var D={data:F||(F===0||F===false)?F:(B?B.data:{}),_wrap:B?B._wrap:null,tmpl:null,parent:B||null,nodes:[],calls:c,nest:b,wrap:n,html:r,update:A};if(C){i.extend(D,C,{nodes:[],parent:B})}if(E){D.tmpl=E;D._ctnt=D._ctnt||D.tmpl(i,D);D.key=++w;(g.length?e:p)[w]=D}return D}i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(B,C){i.fn[B]=function(D){var G=[],J=i(D),F,H,E,K,I=this.length===1&&this[0].parentNode;z=p||{};if(I&&I.nodeType===11&&I.childNodes.length===1&&J.length===1){J[C](this[0]);G=this}else{for(H=0,E=J.length;H<E;H++){q=H;F=(H>0?this.clone(true):this).get();i(J[H])[C](F);G=G.concat(F)}q=0;G=this.pushStack(G,B,J.selector)}K=z;z=null;i.tmpl.complete(K);return G}});i.fn.extend({tmpl:function(D,C,B){return i.tmpl(this[0],D,C,B)},tmplItem:function(){return i.tmplItem(this[0])},template:function(B){return i.template(B,this[0])},domManip:function(F,I,H,J){if(F[0]&&i.isArray(F[0])){var C=i.makeArray(arguments),B=F[0],G=B.length,D=0,E;while(D<G&&!(E=i.data(B[D++],"tmplItem"))){}if(E&&q){C[2]=function(K){i.tmpl.afterManip(this,K,H)}}t.apply(this,C)}else{t.apply(this,arguments)}q=0;if(!z){i.tmpl.complete(p)}return this}});i.extend({tmpl:function(D,G,F,C){var E,B=!C;if(B){C=x;D=i.template[D]||i.template(null,D);e={}}else{if(!D){D=C.tmpl;p[C.key]=C;C.nodes=[];if(C.wrapped){s(C,C.wrapped)}return i(m(C,null,C.tmpl(i,C)))}}if(!D){return[]}if(typeof G==="function"){G=G.call(C||{})}if(F&&F.wrapped){s(F,F.wrapped)}E=i.isArray(G)?i.map(G,function(H){return H?k(F,C,D,H):null}):[k(F,C,D,G)];return B?i(m(C,null,E)):E},tmplItem:function(C){var B;if(C instanceof i){C=C[0]}while(C&&C.nodeType===1&&!(B=i.data(C,"tmplItem"))&&(C=C.parentNode)){}return B||x},template:function(C,B){if(B){if(typeof B==="string"){B=l(B)}else{if(B instanceof i){B=B[0]||{}}}if(B.nodeType){B=i.data(B,"tmpl")||i.data(B,"tmpl",l(B.innerHTML))}return typeof C==="string"?(i.template[C]=B):B}return C?(typeof C!=="string"?i.template(null,C):(i.template[C]||i.template(null,u.test(C)?C:i(C)))):null},encode:function(B){return(""+B).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});i.extend(i.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(B){p={}},afterManip:function v(D,B,E){var C=B.nodeType===11?i.makeArray(B.childNodes):B.nodeType===1?[B]:[];E.call(D,B);o(C);q++}});function m(B,F,D){var E,C=D?i.map(D,function(G){return(typeof G==="string")?(B.key?G.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+h+'="'+B.key+'" $2'):G):m(G,B,G._ctnt)}):B;if(F){return C}C=C.join("");C.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(H,I,G,J){E=i(G).get();o(E);if(I){E=a(I).concat(E)}if(J){E=E.concat(a(J))}});return E?E:a(C)}function a(C){var B=document.createElement("div");B.innerHTML=C;return i.makeArray(B.childNodes)}function l(B){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+i.trim(B).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(J,D,H,E,F,K,G){var O=i.tmpl.tag[H],C,I,N;if(!O){throw"Unknown template tag: "+H}C=O._default||[];if(K&&!/\w$/.test(F)){F+=K;K=""}if(F){F=j(F);G=G?(","+j(G)+")"):(K?")":"");I=K?(F.indexOf(".")>-1?F+j(K):("("+F+").call($item"+G)):F;N=K?I:"(typeof("+F+")==='function'?("+F+").call($item):("+F+"))"}else{N=I=C.$1||"null"}E=j(E);return"');"+O[D?"close":"open"].split("$notnull_1").join(F?"typeof("+F+")!=='undefined' && ("+F+")!=null":"true").split("$1a").join(N).split("$1").join(I).split("$2").join(E||C.$2||"")+"__.push('"})+"');}return __;")}function s(C,B){C._wrap=m(C,true,i.isArray(B)?B:[u.test(B)?B:i(B).html()]).join("")}function j(B){return B?B.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function d(B){var C=document.createElement("div");C.appendChild(B.cloneNode(true));return C.innerHTML}function o(H){var J="_"+q,C,B,F={},G,E,D;for(G=0,E=H.length;G<E;G++){if((C=H[G]).nodeType!==1){continue}B=C.getElementsByTagName("*");for(D=B.length-1;D>=0;D--){I(B[D])}I(C)}function I(S){var O,Q=S,P,K,N;if((N=S.getAttribute(h))){while(Q.parentNode&&(Q=Q.parentNode).nodeType===1&&!(O=Q.getAttribute(h))){}if(O!==N){Q=Q.parentNode?(Q.nodeType===11?0:(Q.getAttribute(h)||0)):0;if(!(K=p[N])){K=e[N];K=k(K,p[Q]||e[Q]);K.key=++w;p[w]=K}if(q){T(N)}}S.removeAttribute(h)}else{if(q&&(K=i.data(S,"tmplItem"))){T(K.key);p[K.key]=K;Q=i.data(S.parentNode,"tmplItem");Q=Q?Q.key:0}}if(K){P=K;while(P&&P.key!=Q){P.nodes.push(S);P=P.parent}delete K._ctnt;delete K._wrap;i.data(S,"tmplItem",K)}function T(U){U=U+J;K=F[U]=(F[U]||k(K,p[K.parent.key+J]||K.parent))}}}function c(D,B,E,C){if(!D){return g.pop()}g.push({_:D,tmpl:B,item:this,data:E,options:C})}function b(B,D,C){return i.tmpl(i.template(B),D,C,this)}function n(D,B){var C=D.options||{};C.wrapped=B;return i.tmpl(i.template(D.tmpl),D.data,C,D.item)}function r(C,D){var B=this._wrap;return i.map(i(i.isArray(B)?B.join(""):B).filter(C||"*"),function(E){return D?E.innerText||E.textContent:E.outerHTML||d(E)})}function A(){var B=this.nodes;i.tmpl(null,null,null,this).insertBefore(B[0]);i(B).remove()}if(window.M&&typeof M.define=="function"){M.define("jq-tmpl",function(){return i})}})(jQuery);M.define("InputListener",function(c,b,d){var a={listen:function(f,e){f=$(f);f.each($.proxy(function(g,h){h=$(h);if(!h.is("input")&&!h.is("textarea")){throw new Error("input listener only apply to input or textarea")}this.initListen(h,e)},this))},unlisten:function(e){e=$(e);e.each($.proxy(function(h,k){k=$(k);if(!k.is("input")&&!k.is("textarea")){throw new Error("input listener only apply to input or textarea")}if(arguments.length==1){k.unbind("focus",this.getStartListenFunc());k.unbind("blur",this.getStopListenFunc());k.removeData("__input_listener_handlers")}else{if(typeof arguments[1]=="function"){var j=arguments[1],g=k.data("__input_listener_listeninterval");for(var h=0,f=g.length;h<f;h++){if(g[h]==j){g.splice(h,1);h--}}}}},this))},initListen:function(f,e){f.data("__input_listener_currentval",f.val());if(!f.data("__input_listener_handlers")){this.bindListenEvent(f)}this.addListenHandler(f,e);if(f.is(":focus")){f.blur();f.focus()}},bindListenEvent:function(e){e.data("__input_listener_handlers",[]);e.focus(this.getStartListenFunc());e.blur(this.getStopListenFunc())},getStartListenFunc:function(){if(!this.bindStartListenFunc){this.bindStartListenFunc=$.proxy(this.startListen,this)}return this.bindStartListenFunc},getStopListenFunc:function(){if(!this.bindStopListenFunc){this.bindStopListenFunc=$.proxy(this.stopListen,this)}return this.bindStopListenFunc},startListen:function(e){var f=$(e.target);f.data("__input_listener_currentval",f.val());f.data("__input_listener_listeninterval",setInterval($.proxy(function(){var h=f.data("__input_listener_currentval"),g=f.val();if(h!=g){f.data("__input_listener_currentval",g);this.triggerListenHandler(f)}},this),100))},stopListen:function(e){var f=$(e.target);clearInterval(f.data("__input_listener_listeninterval"))},addListenHandler:function(f,e){if(typeof e=="function"){f.data("__input_listener_handlers").push(e)}},triggerListenHandler:function(h){var f=h.data("__input_listener_handlers");for(var g=0,e=f.length;g<e;g++){f[g].call(null,{target:h.get(0)})}}};return a});M.define("SuggestionXHR",function(b,a,c){function d(e){this.URL=null;this.delay=200;this.dataType="text";$.extend(this,e);this.delayTimer=null;this.xhr=null;this.cache={};this.init()}d.prototype={init:function(){if(!this.URL){throw new Error("no url for suggestion")}},getSuggestion:function(g,h){var f=this.getQuery(g),e=this.cache[f];h=typeof h==="function"?h:$.noop;this.stop();if(e){h(e)}else{this.getXHRData(f,h)}},stop:function(){clearTimeout(this.delayTimer);if(this.xhr&&this.xhr.readyState!==4){this.xhr.abort()}},getQuery:function(h){var g="";if(typeof h=="string"){g=encodeURIComponent(h)}else{if(h&&typeof h=="object"){var e=[];for(var f in h){if(h.hasOwnProperty(f)){e.push(f+"="+encodeURIComponent(h[f]))}}g=e.join("&")}}return g},getXHRData:function(e,h){var f=this.xhr,g={url:this.URL,data:e,dataType:this.dataType,success:M.bind(function(i){h(i);this.cache[e]=i},this)};this.delayTimer=setTimeout(M.bind(function(){this.xhr=$.ajax(g)},this),this.delay)}};return d});M.define("DropList",function(c,b,d){var a=M.Event;function e(f){this.trigger=null;this.container=null;this.itemSelector="._j_listitem";this.itemHoverClass="on";this.firstItemHover=false;$.extend(this,f);this.trigger=$(this.trigger);this.container=$(this.container);this.mouseon=false;this.visible=false;this.init()}M.mix(e.prototype,{createContainer:$.noop,updateList:$.noop,init:function(){if(!this.trigger.length){M.error("no trigger for drop list")}if(!this.container.length){this.container=this.createContainer()}if(!this.container.length){M.error("no container for drop list")}this.bindEvents()},bindEvents:function(){this.trigger.on("keydown",$.proxy(function(g){var h=g.keyCode;if(this.visible&&h==13){var f=this.getFocusItem();if(f.length){this.selectItem(f);g.preventDefault()}}else{if(this.visible&&h==38){this.moveFocus(-1)}else{if(this.visible&&h==40){this.moveFocus(1)}}}},this));this.container.on("mouseenter",this.itemSelector,$.proxy(this.moveFocus,this)).on("click",this.itemSelector,$.proxy(this.clickItem,this)).on("mouseenter",$.proxy(this.mouseOverCnt,this)).on("mouseleave",$.proxy(this.mouseOutCnt,this))},show:function(g){this.updateList(g);this.container.show();if(this.firstItemHover){var f=this.container.find(this.itemSelector);if(f.length){this.moveFocus(1)}}this.visible=true},hide:function(){this.container.hide();this.visible=false},clickItem:function(g){var f=this.getFocusItem();this.selectItem(f);g.preventDefault()},selectItem:function(f){a(this).fire("itemselected",{item:f})},moveFocus:function(i){var h=this.container.find(this.itemSelector),j=this.getFocusItem(),g=j,f;if(i===-1){if(j.length){f=h.index(j)-1}if(!j.length||f==-1){g=h.last()}else{g=h.eq(f)}}else{if(i===1){if(j.length){f=h.index(j)+1}if(!j.length||f==h.length){g=h.first()}else{g=h.eq(f)}}else{if(i.currentTarget){g=$(i.currentTarget)}}}j.removeClass(this.itemHoverClass);g.addClass(this.itemHoverClass);a(this).fire("itemfocused",{prevItem:j,focusItem:g})},getFocusItem:function(){var f=this.container.find(this.itemSelector);return f.filter("."+this.itemHoverClass)},mouseOverCnt:function(){this.mouseon=true},mouseOutCnt:function(){this.mouseon=false}});return e});M.define("Suggestion",function(c){c("jq-tmpl");var a=c("InputListener");var b='{{each(i, item) list}}<li class="${listItemClass}" data-value="${item.value}">${item.text}</li>{{/each}}';function d(e){e.suggestionURL=e.url||$(e.input).data("suggestionurl");this.dropListClass="droplist";this.listItemSelector="._j_listitem";this.listItemHoverClass="on";this.listFirstItemHover=false;this.keyParamName="key";this.dataType="json";this.suggestionParams={};this.listContainer=null;M.mix(this,e);this.input=$(this.input);this.listTmpl=this.listTmpl||b;this.actOnList=false;this.init()}M.mix(d.prototype,{init:function(){a.listen(this.input,$.proxy(this.inputChange,this));this.input.blur($.proxy(function(f){var e=$(f.currentTarget);if(e.data("droplist")){setTimeout($.proxy(function(){if(!this.actOnList&&e.data("droplist")){e.data("droplist").hide()}this.actOnList=false},this),200)}},this));this.input.keyup($.proxy(function(f){var e=$(f.currentTarget);if(f.keyCode==40&&(!e.data("droplist")||!e.data("droplist").visible)){this.inputChange(f)}},this))},inputChange:function(i){var f=$(i.target),k=$.trim(f.val()),j=c("SuggestionXHR"),h=c("DropList");var g=f.data("droplist");if(!g){f.data("droplist",g=new h({trigger:f,itemSelector:this.listItemSelector,itemHoverClass:this.listItemHoverClass,firstItemHover:this.listFirstItemHover,container:this.listContainer,createContainer:$.proxy(function(){var l=this.createListContainer(f);this.listContainer=l;return l},this),updateList:$.proxy(this.updateList,this)}));M.Event(g).on("itemselected",$.proxy(function(l){this.dropItemSelected(f,l.item)},this));M.Event(g).on("itemfocused",$.proxy(function(l){M.Event(this).fire("itemfocused",l)},this))}g.hide=function(){setTimeout($.proxy(function(){if(M.windowFocused){this.container.hide();this.visible=false}},this),1)};var e=f.data("suggestion");if(!e){f.data("suggestion",e=new j({URL:this.suggestionURL,dataType:this.dataType}))}if(!k.length){e.stop();g.hide();M.Event(this).fire("after hide list")}else{this.suggestionParams[this.keyParamName]=k;M.Event(this).fire("before suggestion xhr");e.getSuggestion(this.suggestionParams,$.proxy(function(m){M.Event(this).fire("before show list");var l=this.handleSuggest(m);if(l){f.data("droplist").show(l)}},this))}},handleSuggest:function(f){var e="";if(this.dataType=="json"){e=$.tmpl(this.listTmpl,f)}return e},createListContainer:function(f){var g=$("<ul />"),e=f.position();g.css({display:"none",position:"absolute",left:e.left,top:e.top+f.outerHeight()}).addClass(this.dropListClass);g.insertAfter(f);return g},updateList:function(e){this.listContainer.html(e)},hideDropList:function(){this.input.data("droplist")&&this.input.data("droplist").hide()},dropItemSelected:function(e,f){a.unlisten(e);M.Event(this).fire("itemselected",{item:f,input:e});a.listen(e,$.proxy(this.inputChange,this))}});return d});M.define("MesSearchEvent",function(b,a,c){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(f,j){var l=e,h=[],g;j=j||l.length;if(f){for(g=0;g<f;g++){h[g]=l[0|Math.random()*j]}}else{var k;h[8]=h[13]=h[18]=h[23]="-";h[14]="4";for(g=0;g<36;g++){if(!h[g]){k=0|Math.random()*16;h[g]=l[(g==19)?(k&3)|8:k]}}}return h.join("")};Math.uuidFast=function(){var k=e,h=new Array(36),g=0,j;for(var f=0;f<36;f++){if(f==8||f==13||f==18||f==23){h[f]="-"}else{if(f==14){h[f]="4"}else{if(g<=2){g=33554432+(Math.random()*16777216)|0}j=g&15;g=g>>4;h[f]=k[(f==19)?(j&3)|8:j]}}}return h.join("")};Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){var g=Math.random()*16|0,f=h=="x"?g:(g&3|8);return f.toString(16)})};var d={uuid:function(){return Math.uuid()},search:function(f){var g=Math.uuid();f.id=g;!!mfwPageEvent&&mfwPageEvent("se","v2_search",f);return g},searchCache:function(f){var g=Math.uuid();f.id=g;!!mfwPageEvent&&mfwPageEvent("se","v2_search_cache",f);return g},resultClick:function(f){!!mfwPageEvent&&mfwPageEvent("se","v2_result_click",f);return f.id}};c.exports=d});M.define("/js/SiteSearch",function(e){var d="1.0.0",h=e("Suggestion"),f=e("MesSearchEvent"),g=M.cssSupport("transition"),b=M.cssSupport("transform"),c=window.Env||{};var a=function(D){var F=$("#"+D.input+""),W=!!D.submit?$("#"+D.submit+""):null,t=D.additionalClass?D.additionalClass:"",N=!!D.isRelevant,s=D.maxCount||0,A=D.hideOnScroll||false,n=false,K=false,i="",z="",l="",p="";if(D.input==="_j_index_search_input_all"){var I=[];if(F.val()===""&&I&&I.length){var V=Math.floor(Math.random()*I.length),J=I[V];F.val(J.name).data("url",J.url)}F.on("focus",function(Y){if(F.data("url")){F.val("").data("url","")}})}if(c.is_async_site_search){n=true}var S=new h({url:(c.WWW_HOST?window.location.protocol+"//"+c.WWW_HOST:"")+"/search/ss.php",suggestionParams:{isHeader:Number(N)},input:F,listItemHoverClass:"active",listFirstItemHover:false,dataType:"jsonp",createListContainer:function(){var Y=$('<div class="m-search-suggest '+t+' hide"><ul class="mss-list"></ul></div>').appendTo("body");Y.on("mouseenter",".mss-place .mss-title, .mss-place .mss-nav a",function(aa){var Z=$(aa.currentTarget),ab=Z.closest(".mss-place");ab.find(".mss-title").removeClass("active").removeClass("frozen").end().find(".mss-nav a").removeClass("active").end();Z.addClass("active")}).on("mouseleave",".mss-place .mss-title, .mss-place .mss-nav a",function(aa){var Z=$(aa.currentTarget);Z.removeClass("active")});return Y},handleSuggest:function(aE){i=aE.keyword;K=!!aE.is_hit;l="http://"+aE.www_host;var az=aE.keyword_cut,aB=aE.show_types,Z=aE.hide_types;var au=$("<ul>");var ad=aE.first_poi;if(!!ad){var ao=ad,am=$('<li class="mss-item _j_listitem" data-type="poi">').appendTo(au),ar=$('<div class="mss-title">').appendTo(am);am.attr("data-url",ao.url);ar.append('<span class="mss-fr">'+(!!ao.mddname?ao.mddname:"")+ao.typename+"</span>");ar.append('<span class="mss-cn">'+ao.dis_name+"</span>")}var aj=aE.article_info;if(aj&&aj.result){for(var av=0;av<aj.result.length;av++){var ai=aj.result[av],am=$('<li class="mss-item _j_listitem" data-type="article_promoted">').appendTo(au),ar=$('<div class="mss-title">').appendTo(am);am.attr("data-url",ai.link);ar.html(ai.name_display)}}var an=aE.mdd_info;if(an&&an.result){for(var av=0;av<an.result.length;av++){var ac=an.result[av],am=$('<li class="mss-item _j_listitem" data-type="mdd">').appendTo(au),ar=$('<div class="mss-title">').appendTo(am);am.attr("data-url",ac.url);if(!!ac.parent){ar.append('<span class="mss-fr">'+ac.parent+"</span>")}ar.append('<span class="mss-cn">'+ac.dis_name+"</span>");ar.append('<span class="mss-gl"> '+ac.infoname+"</span>")}}var aq=aE.hotel_info;if(aq&&aq.result&&!N){for(var av=0;av<aq.result.length;av++){var aC=aq.result[av],am=$('<li class="mss-item _j_listitem" data-type="hotel_promoted">').appendTo(au),ar=$('<div class="mss-title">').appendTo(am);am.attr("data-url",aC.url);ar.append('<span class="mss-fr">'+aC.typename+"</span>");ar.append('<span class="mss-cn">'+aC.title+"</span>");ar.append('<span class="mss-gl"> '+aC.infoname+"</span>")}}var ag=aE.gl_info;if(ag&&ag.result){for(var av=0;av<ag.result.length;av++){var at=ag.result[av],am=$('<li class="mss-item _j_listitem" data-type="sales_gonglve">').appendTo(au),ar=$('<div class="mss-title">').appendTo(am);am.attr("data-url",at.url);ar.append('<span class="mss-fr">'+at.typename+"</span>");ar.append('<span class="mss-cn">'+at.title+"</span>")}}var ab=aE.sales_info;if(ab&&ab.result&&!N){for(var av=0;av<ab.result.length;av++){var Y=ab.result[av],am=$('<li class="mss-item _j_listitem" data-type="sales_promoted">').appendTo(au),ar=$('<div class="mss-title">').appendTo(am);am.attr("data-url",Y.url);ar.append('<span class="mss-fr">'+Y.typename+"</span>");ar.append('<span class="mss-cn">'+Y.title+"</span>");ar.append('<span class="mss-gl"> '+Y.infoname+"</span>")}}var ah=aE.route_info;if(ah&&ah.result&&!N){for(var av=0;av<ah.result.length;av++){var aA=ah.result[av],am=$('<li class="mss-item _j_listitem" data-type="route_promoted">').appendTo(au),ar=$('<div class="mss-title">').appendTo(am);am.attr("data-url",aA.url);ar.append('<span class="mss-fr">'+aA.typename+"</span>");ar.append('<span class="mss-cn">'+aA.title+"</span>");ar.append('<span class="mss-gl"> '+aA.infoname+"</span>")}}var aw=aE.qa_info;if(aw&&aw.result){for(var av=0;av<aw.result.length;av++){var ak=aw.result[av],am=$('<li class="mss-item _j_listitem" data-type="wenda">').appendTo(au),ar=$('<div class="mss-title">').appendTo(am);am.attr("data-url",ak.url);ar.append('<span class="mss-fr">'+ak.typename+"</span>");ar.append('<span class="mss-cn">'+ak.title+"</span>")}}var af=aE.poi_info,ay=!N;if(M.isArray(aB)&&M.indexOf(aB,"poi")!==-1){ay=true}if(af&&af.result&&ay){for(var av=0;av<af.result.length;av++){var ao=af.result[av],aa="hotel"===ao.stype?"hotel":"poi",am=$('<li class="mss-item _j_listitem" data-type="'+aa+'">').appendTo(au),ar=$('<div class="mss-title">').appendTo(am);am.attr("data-url",ao.url);ar.append('<span class="mss-fr">'+(!!ao.mddname?ao.mddname:"")+ao.typename+"</span>");ar.append('<span class="mss-cn" style="color:#999;">'+ao.dis_name+"</span>")}}var al=aE.sekey_info,ax=N;if(M.isArray(Z)&&M.indexOf(Z,"sekey")!==-1){ax=false}if(al&&al.result&&ax){for(var av=0;av<al.result.length;av++){if(av>4){break}var aD=al.result[av],am=$('<li class="mss-item _j_listitem" data-type="sekey">').appendTo(au);am.attr("data-url",aD.url);am.append('<div class="mss-title">'+aD.name+"</div>")}}var ae=aE.ginfo_num;if(!!ae){var am=$('<li class="mss-item _j_listitem" data-type="info">').appendTo(au);am.append('<div class="mss-title">搜“<span class="mss-key">'+az+'</span>”相关游记<span class="mss-num">'+ae+"篇</span></div>")}var ap=aE.user_num;if(!!ae){var am=$('<li class="mss-item _j_listitem" data-type="user">').appendTo(au);am.append('<div class="mss-title">搜“<span class="mss-key">'+az+"</span>”相关用户</div>")}if(s>0){au.find("._j_listitem").each(function(aF,aG){if(aF>s){$(aG).remove()}})}return au.html()},updateList:function(Y){this.listContainer.find(".mss-list").html(Y);if(N){this.listContainer.find(".mss-list").addClass("shrink-list")}if(K){S.input.data("droplist").moveFocus(1)}}});if(n){var B=e("InputListener"),w=e("SuggestionXHR"),E=new w({URL:(c.WWW_HOST?"http://"+c.WWW_HOST:"")+"/search/s.php",dataType:"json"}),v=$("#_j_mfw_search_main"),X=F.closest(".search-wrapper"),O=$('<div class="search-keyword-tip"></div>').appendTo(X),C=D.input==="_j_index_search_input_all",H=false,u,q,P,k,r;B.listen(F,function(Z){var Y=$(Z.target),aa=$.trim(Y.val());if(!H&&aa){H=true}O.hide()});M.Event(S).on("before suggestion xhr",function(){var Y=S.suggestionParams[S.keyParamName];if(Y&&Y!==z){E.getSuggestion({q:Y,gall:1},$.proxy(function(aa){var ae=$.trim(F.val());if(!ae){return false}if(!aa||!aa.keyword||(!aa.result&&!aa.unmatch)){return false}if(aa.unmatch===1){O.hide()}else{z=Y;if(X[0]){var ab=aa.keyword.length,Z=aa.keyword.replace(/[A-Za-z0-9\s]/g,"").length,ad=ab-Z;setTimeout(function(){O.html(aa.keyword).css("left",32+Z*14+ad*7).show()},1)}v.html($(aa.result).css("minHeight",0).html());if(g&&b){v.find("> .wid").addClass("anim-climb");setTimeout(function(){v.find("> .wid").removeClass("anim-climb")},1)}var ac=c.search_type||"all";c.search_seid=T(Y,ac);c.search_keyword=Y;c.is_search_cache=true;c.is_search_updated=true}},S))}})}M.Event(S).on("before suggestion xhr",function(){U(F,S.listContainer)});M.Event(S).on("before show list",function(){S.listContainer.find(".mss-list").show()});M.Event(S).on("itemfocused",function(Z){var Y=Z.prevItem,aa=Z.focusItem,ab=S.listContainer;if(1<ab.find(".mss-place").length){if(aa.hasClass("mss-place")){ab.find(".mss-place").removeClass("frozen")}if(!aa.hasClass("mss-place")&&!!Y&&Y.hasClass("mss-place")){ab.find(".mss-place").removeClass("frozen");Y.addClass("frozen")}}if(aa.hasClass("mss-place")){aa.find(".mss-title").addClass("frozen")}});M.Event(S).on("itemselected",function(aa){var ac=aa.item;if(ac.length){var ab=ac.data("type"),Z=ac.data("url"),ae=F.attr("id")==="_j_head_search_input"?"header":"default";if(ab==="flight_hotel"||ab==="flight"||ab==="local"){ab="sales"}p=m(i,"all",ae,"suggest");if("info"===ab||"user"===ab){var ad=m(i,ab,ae,"suggest");location.href=l+"/search/s.php?q="+encodeURIComponent(i)+"&t="+ab+"&seid="+ad}else{var Z=ac.data("url"),Y=S.listContainer.find(".mss-item").index(ac.closest(".mss-item"))+1;Q(Z,Y,ab);location.href=ac.data("url")}}else{if(i!==""){location.href=l+"/search/s.php?q="+encodeURIComponent(i)}}});var x=F.closest(".head-search-wrapper");if(x[0]){F.on("focus",function(Y){setTimeout(function(){x.addClass("head-search-focus")},1)}).on("blur",function(Y){setTimeout(function(){if(M.windowFocused){x.removeClass("head-search-focus")}},1)})}if(W&&W[0]){W.on("click",function(aa){var Z=$.trim(F.val());if(F.data("url")){if(F.data("url").indexOf("http")!==-1){location.href=F.data("url")}else{location.href=(c.WWW_HOST?"http://"+c.WWW_HOST:"")+F.data("url")}return true}if(Z!==""){if(S.listContainer){S.listContainer.hide()}var ac=F.attr("id")==="_j_head_search_input"?"header":"default",ad=c.search_type||"all",ab=m(Z,ad,ac,"form"),Y=l+"/search/s.php?q="+encodeURIComponent(Z);if(c.search_type&&location.pathname==="/search/s.php"){Y+="&t="+c.search_type}Y+="&seid="+ab;location.href=Y}})}if(F&&F[0]){F.on("keydown",function(aa){if(aa.keyCode==13){var ad=S.input.data("droplist");if(ad&&ad.getFocusItem().length){return true}var Z=$.trim(F.val());if(Z!==""){if(S.listContainer){S.listContainer.hide()}var ac=F.attr("id")==="_j_head_search_input"?"header":"default",ae=c.search_type||"all",ab=m(Z,ae,ac,"form"),Y=l+"/search/s.php?q="+encodeURIComponent(Z);if(c.search_type&&location.pathname==="/search/s.php"){Y+="&t="+c.search_type}Y+="&seid="+ab;location.href=Y}}})}$(window).resize(function(){if(S.listContainer&&S.listContainer.length&&S.listContainer.is(":visible")){U(F,S.listContainer)}});$(window).on("scroll",function(Y){if(A){S.hideDropList()}});function U(Y,aa){var Z=Y.offset();aa.css({left:Z.left+(D.input==="_j_index_search_input_all"?0:1),top:Z.top+F.outerHeight()-2})}function m(Y,ac,ab,aa){var Z={keyword:Y,content_category:ac,searchbox_category:"main_search",searchbox_position:ab,search_type:aa,version:d};return f.search(Z)}function T(Y,aa){var Z={keyword:Y,content_category:aa,version:d};return f.searchCache(Z)}function Q(ab,Z,aa){var Y={id:p,keyword:i,click_url:ab,index:Z,content_category:aa,search_type:"suggest",version:d};return f.resultClick(Y)}function G(Z,ad){var aa=[],af=Z.split("|");ad=j(ad);for(var ac=0;ac<af.length;ac++){var ab=$.trim(af[ac]);if(ab=="search://"){var Y=aa.length;aa[Y]=af[ac++];aa[Y+1]=af[ac++];aa[Y+2]=af[ac++];aa[Y+3]=af[ac++];aa[Y+4]=af[ac++];aa[Y+5]=af[ac];continue}if(ab){try{ab=ab.replace(new RegExp(ad,"ig"),function(ag){return'<span class="highlight">'+ag+"</span>"})}catch(ae){ab=ab.replace(ad,function(ag){return'<span class="highlight">'+ag+"</span>"})}aa[aa.length]=ab}}return aa}var o=$("<div/>");function j(Y){return o.text(Y).html()}};return a});M.closure(function(c){var r=$("#header");if(!r.length){return false}var o=c("/js/Dropdown");var n=c("/js/SiteSearch");new n({input:"_j_head_search_input",submit:"_j_head_search_link",isRelevant:true});$("#_j_nav_sales").find("[data-sales-nav]").on("click",function(){var t=$(this).data("salesNav");mfwPageEvent("sales","index_sales_nav",{name:t})});if(!window.showBarFlag){$("._j_sales_nav_show").off("hover")}else{var b=0,p=0;$("._j_sales_nav_show").hover(function(){clearTimeout(b);p=setTimeout(function(){$("._j_sales_nav_show").addClass("head-nav-hover");$("._j_sales_top").fadeIn(300)},200)},function(){clearTimeout(p);b=setTimeout(function(){$("._j_sales_nav_show").removeClass("head-nav-hover");$("._j_sales_top").fadeOut(300)},200)})}var m=0,f=0;$("._j_shequ_nav_show").hover(function(){clearTimeout(m);f=setTimeout(function(){$("._j_shequ_nav_show").addClass("head-nav-hover");$("._j_shequ_top").fadeIn(300)},200)},function(){clearTimeout(f);m=setTimeout(function(){$("._j_shequ_nav_show").removeClass("head-nav-hover");$("._j_shequ_top").fadeOut(300)},200)});var q=$("#_j_community_panel"),i=q.find(".panel-image").length,j=Math.floor(Math.random()*i);if(j===i){j--}q.find(".panel-image").eq(j).show();$("#_j_showlogin").click(function(t){if(window.location.host===Env.WWW_HOST){t.preventDefault()}M.Event.fire("login:required")});var g=window.location.hostname,k=window.location.pathname+window.location.search,a=$("#_j_head_nav");if(g.indexOf("www")===0){if(k===""||k==="/"){a.children("li:eq(0)").addClass("head-nav-active")}var h=new RegExp("^/(mdd|photo/mdd|poi|photo/poi|travel-scenic-spot|jd|cy|gw|yl|yj|xc|baike)/|sFrom=mdd.*|sFrom=smdd.*","i");if(h.test(k)){a.children("li:eq(1)").addClass("head-nav-active")}var e=new RegExp("^/gonglve/.*","i");if(e.test(k)){a.children("li:eq(2)").addClass("head-nav-active")}var d=window.Env&&window.Env.sales_title_tag;if(d){if(d==="flight_hotel"){a.children("li:eq(3)").find("ul>li:eq(0)>a").addClass("on")}else{if(d==="visa"){a.children("li:eq(3)").find("ul>li:eq(2)>a").addClass("on")}else{if(d==="localdeals"){a.children("li:eq(3)").find("ul>li:eq(1)>a").addClass("on")}else{if(d==="insurance"){a.children("li:eq(3)").find("ul>li:eq(4)>a").addClass("on")}}}}a.find("li:eq(3)").addClass("head-nav-active")}if(/^\/insurance\//i.test(k)){a.find("li:eq(3)").addClass("head-nav-active")}var s=new RegExp("^/hotel/(?!.*sFrom=mdd).*","ig");if(s.test(k)){a.children("li:eq(4)").addClass("head-nav-active");a.children("li:eq(4)").find(".head-act616").remove()}var l=new RegExp("^/(wenda|qa|mall|together|group|i|traveller|rudder|paimai|club|postal|school|photo_pk|focus)/(?!.*sFrom=mdd|s.php*).*","i");if(l.test(k)){a.children("li:eq(5)").addClass("head-nav-active")}}});M.define("/js/mdd/ControllerHotelTag",function(a){var b;return{events:{"click,.change":"showMoreTag"},init:function(){var c=this;b=c.container},showMoreTag:function(d){var c=$(d.currentTarget),f=b.find("ul li:last").data("id");this.setSyncParams({iMddid:c.data("mddid"),iStart:f,},true)},syncHtml:function(c){b.html(c)}}});(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-util",function(d,c,e){e.exports=a(b)})}else{b.mfwmap={};b.mfwmap.util=a(b)}}(window,function(b){function c(l,m){if(m<72.004||m>137.8347||l<0.8293||l>55.8271){return{lat:0,lng:0}}var j=6378245,d=0.006693421622965943,k=m-105,g=l-35;var f=-100+2*k+3*g+0.2*g*g+0.1*k*g+0.2*Math.sqrt(Math.abs(k));f+=(20*Math.sin(6*k*Math.PI)+20*Math.sin(2*k*Math.PI))*2/3;f+=(20*Math.sin(g*Math.PI)+40*Math.sin(g/3*Math.PI))*2/3;f+=(160*Math.sin(g/12*Math.PI)+320*Math.sin(g*Math.PI/30))*2/3;var h=300+k+2*g+0.1*k*k+0.1*k*g+0.1*Math.sqrt(Math.abs(k));h+=(20*Math.sin(6*k*Math.PI)+20*Math.sin(2*k*Math.PI))*2/3;h+=(20*Math.sin(k*Math.PI)+40*Math.sin(k/3*Math.PI))*2/3;h+=(150*Math.sin(k/12*Math.PI)+300*Math.sin(k/30*Math.PI))*2/3;var e=l/180*Math.PI,i=Math.sin(e);i=1-d*i*i;f=(f*180)/((j*(1-d))/(i*Math.sqrt(i))*Math.PI);h=(h*180)/(j/Math.sqrt(i)*Math.cos(e)*Math.PI);return{lat:f,lng:h}}var a={decodePath:function(f){var h=f?f.length:f,l=Array(Math.floor(f.length/2)),g=0,i=0,k=0;for(var j=0;g<h;++j){var m=1,d=0,e;do{e=f.charCodeAt(g++)-63-1;m+=e<<d;d+=5}while(31<=e);i+=m&1?~(m>>1):m>>1;m=1;d=0;do{e=f.charCodeAt(g++)-63-1;m+=e<<d;d+=5}while(31<=e);k+=m&1?~(m>>1):m>>1;l[j]={lat:0.00001*i,lng:0.00001*k}}l.length=j;return l},extend:function(f,d){var e=function(){};e.prototype=d.prototype;f.prototype=new e();f.prototype.constructor=f;f.__super__=d.prototype},clone:function(g){if(null==g||"object"!=typeof g){return g}if(g instanceof Date){var h=new Date();h.setTime(g.getTime());return h}if(g instanceof Array){var h=[];for(var f=0,e=g.length;f<e;f++){h[f]=a.clone(g[f])}return h}if(g instanceof Object){var h={};for(var d in g){h[d]=a.clone(g[d])}return h}throw new Error("Unable to copy obj! Its type isn't supported.")},bind:function(e,d){if(!!Function.prototype.bind){return Function.prototype.bind.apply(e,[d].concat(Array.prototype.slice.call(arguments,2)))}else{if(typeof e!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var i=Array.prototype.slice.call(arguments,2),h=e,f=function(){},g=function(){return h.apply(e instanceof f&&d?e:d||b,i.concat(Array.prototype.slice.call(arguments)))};f.prototype=e.prototype;g.prototype=new f();return g}},includes:function(j,g){if(!!Array.prototype.includes){return Array.prototype.includes.call(j,g)}else{var h=Object(j);var d=parseInt(h.length)||0;if(d===0){return false}var i=parseInt(arguments[2])||0;var e;if(i>=0){e=i}else{e=d+i;if(e<0){e=0}}var f;while(e<d){f=h[e];if(g===f||(g!==g&&f!==f)){return true}e++}return false}},pick:function(g,f){var h={};for(var e=0;e<f.length;e++){var d=f[e];if(d in g){h[d]=g[d]}}return h},mapping:function(f,e){if(typeof f==="string"){if(!!e[f]){return e[f]}else{return f}}if(typeof f==="object"&&f!==null){var g={};for(var d in f){if(!!e[d]){g[e[d]]=f[d]}else{g[d]=f[d]}}return g}},uuid:function(d,g){var j="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");var f=[],e;g=g||j.length;if(d){for(e=0;e<d;e++){f[e]=j[0|Math.random()*g]}}else{var h;f[8]=f[13]=f[18]=f[23]="-";f[14]="4";for(e=0;e<36;e++){if(!f[e]){h=0|Math.random()*16;f[e]=j[(e==19)?(h&3)|8:h]}}}return f.join("")},debounce:function(f,h,e){var k,j,d,i,l;var g=function(){var m=(new Date().getTime())-i;if(m<h){k=setTimeout(g,h-m)}else{k=null;if(!e){l=f.apply(d,j);d=j=null}}};return function(){d=this;j=arguments;i=(new Date().getTime());var m=e&&!k;if(!k){k=setTimeout(g,h)}if(m){l=f.apply(d,j);d=j=null}return l}},wgs2gcj:function(f,d){var e=c(f,d);return{lat:f+e.lat,lng:d+e.lng}},gcj2wgs:function(f,d){var e=c(f,d);return{lat:f-e.lat,lng:d-e.lng}}};return a}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-event",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util");f.exports=a(b,c)})}else{b.mfwmap.event=a(b,b.mfwmap.util)}}(window,function(d,a){var c={};var e=c.EventListener=function(g,f){this.event=g;this._eventListener=f};var b=["click","dblclick","mouseover","mouseout"];c.eventFunc={addListener:function(h,g,f){if(!a.includes(h,g)){throw new ReferenceError("unsupport event: "+g)}if(a.includes(b,g)){return this._addMouseListener(g,f)}return this._addListener(g,f)},addListenerOnce:function(h,g,f){if(!a.includes(h,g)){throw new ReferenceError("unsupport event: "+g)}if(a.includes(b,g)){return this._addMouseListenerOnce(g,f)}return this._addListenerOnce(g,f)},removeListener:function(f){if(!f instanceof e){throw new TypeError(f+" is not an instance of mfwmap.EventListener")}this._removeListener(f)},trigger:function(g,f,h){if(!a.includes(g,f)){throw new ReferenceError("unsupport event: "+f)}return this._trigger(f,h)}};return c}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-runtime-google",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util"),g=e("/js/hotel/mfwmap/mfwmap-event");f.exports=a(b,c,g)})}else{b.mfwmap.googleRuntime=a(b,b.mfwmap.util,b.mfwmap.event)}}(window,function(p,a,s){var w={util:a,event:s};var e=false,u=$.Deferred(),c=10000;p.initGoogleMap=function(){u.resolve()};function t(D){var C=document.getElementsByTagName("head")[0],B=C.insertBefore,z=C.appendChild;C.insertBefore=function(F,E){if(F.href&&F.href.indexOf(location.protocol+"//fonts.googleapis.com/css?family=Roboto")===0){return}B.call(C,F,E)};C.appendChild=function(E){if(E.href&&E.href.indexOf(location.protocol+"//fonts.googleapis.com/css?family=Roboto")===0){return}z.call(C,E)};var A=document.createElement("script");A.type="text/javascript";A.src=location.protocol+"//maps.google.cn/maps/api/js?language=zh-CN&libraries=geometry&callback=initGoogleMap&key="+((window.Env&&window.Env.GOOGLE_MAP_KEY)||"AIzaSyD-Su0x_rPy1xehlMBcMyTqWkU49Bk53nQ");if("onerror" in A){A.onerror=function(E){u.reject()}}document.body.appendChild(A);setTimeout(function(){try{if(u.state()==="pending"){u.reject()}}catch(E){u.reject()}},D)}var h={hasInited:e,init:function(A){if(!e){e=true;var z=Number(A)>0?Number(A):c;t(z)}},getInitPromise:function(){return u.promise()}};var g=h.implement={};var i={_addListener:function(B,A){var z=google.maps.event.addListener(this._inst,B,A);return new w.event.EventListener(B,z)},_addListenerOnce:function(B,A){var z=google.maps.event.addListenerOnce(this._inst,B,A);return new w.event.EventListener(B,z)},_addMouseListener:function(C,B){var A=this._inst;var z=google.maps.event.addListener(this._inst,C,function(D){B.call(A,D,{lat:D.latLng.lat(),lng:D.latLng.lng()})});return new w.event.EventListener(C,z)},_addMouseListenerOnce:function(C,B){var A=this._inst;var z=google.maps.event.addListenerOnce(this._inst,C,function(D){B.call(A,D,{lat:D.latLng.lat(),lng:D.latLng.lng()})});return new w.event.EventListener(C,z)},_removeListener:function(z){google.maps.event.removeListener(z._eventListener);return this},_trigger:function(z,A){google.maps.event.trigger(this._inst,z,A);return this}};function o(){var z=[{featureType:"water",stylers:[{saturation:44},{lightness:10},{hue:"#0099ff"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",stylers:[{weight:0.4}]},{featureType:"transit.line",stylers:[{weight:0.3}]},{featureType:"landscape",stylers:[{saturation:-80},{lightness:40}]},{featureType:"poi.park",elementType:"geometry",stylers:[{saturation:-26},{lightness:20}]}];return z}var l=navigator.userAgent.toLowerCase().match(/msie [\d.]+/),d=l?parseFloat(l[0].substr(5)):false,j=d&&d<=9;function r(z){if(j){google.maps.event.addListenerOnce(z,"idle",function(){setTimeout(function(){var A=$(".gm-style > .gmnoprint:first",$(z.getDiv()));if(A[0]){A[0].style.width=null}},200)})}}function m(z){google.maps.event.addListenerOnce(z,"idle",function(){$("body").children().each(function(B,D){var E=$(D),C=parseFloat(E.css("fontSize")),A=E.css("fontFamily");if(C>64&&A&&A.toLowerCase().indexOf("roboto")!==-1){E.hide()}})})}g.map={initialize:function(A){A=$.extend(true,{},{control:{mapType:{visible:true,position:google.maps.ControlPosition.RIGHT_BOTTOM},zoom:{visible:true,position:google.maps.ControlPosition.LEFT_TOP}}},A);var z={mapTypeId:google.maps.MapTypeId.ROADMAP,center:new google.maps.LatLng(A.lat,A.lng),zoom:A.zoom,styles:o(),panControl:false,streetViewControl:false,scaleControl:true,mapTypeControl:A.control.mapType.visible,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE],position:A.control.mapType.position},zoomControl:A.control.zoom.visible,zoomControlOptions:{position:A.control.zoom.position},draggable:A.draggable,scrollwheel:A.scrollwheel,disableDoubleClickZoom:A.disableDoubleClickZoom};this._inst=new google.maps.Map(A.element,z);r(this._inst);m(this._inst)},setCenter:function(A,z){this._inst.setCenter(new google.maps.LatLng(A,z));return this},getCenter:function(){var z=this._inst.getCenter();return{lat:z.lat(),lng:z.lng()}},setZoom:function(z){this._inst.setZoom(z);return this},getZoom:function(){return this._inst.getZoom()},panTo:function(A,z){this._inst.panTo(new google.maps.LatLng(A,z));return this},panBy:function(z,A){this._inst.panBy(z,A);return this},fitBounds:function(z){this._inst.fitBounds(z._inst);return this},computeDistanceBetween:function(C,B){var A=new google.maps.LatLng(C.lat,C.lng),z=new google.maps.LatLng(B.lat,B.lng);return google.maps.geometry.spherical.computeDistanceBetween(A,z)}};g.map=$.extend({},i,g.map);g.latLngBounds={initialize:function(A){if(!!A.latLngBounds){this._inst=A.latLngBounds}else{var z,B;if(!!A.northEast){z=new google.maps.LatLng(A.northEast.lat,A.northEast.lng)}if(!!A.southWest){B=new google.maps.LatLng(A.southWest.lat,A.southWest.lng)}this._inst=new google.maps.LatLngBounds(z,B)}},getCenter:function(){var z=this._inst.getCenter();return{lat:z.lat(),lng:z.lng()}},getNorthEast:function(){var z=this._inst.getNorthEast();return{lat:z.lat(),lng:z.lng()}},getSouthWest:function(){var z=this._inst.getSouthWest();return{lat:z.lat(),lng:z.lng()}},extend:function(A,z){this._inst.extend(new google.maps.LatLng(A,z));return this},contains:function(A,z){return this._inst.contains(new google.maps.LatLng(A,z))}};var q=["title","zIndex","opacity","clickable","draggable","icon"];g.marker={initialize:function(A){var z=$.extend({},a.pick(A,q),{map:this.map._inst,position:new google.maps.LatLng(A.lat,A.lng)});var B=z.icon;if(!!B){this.icon=B;if(typeof B==="object"){z.icon={url:B.url,size:new google.maps.Size(B.size[0],B.size[1]),origin:!!B.origin?new google.maps.Point(B.origin[0],B.origin[1]):undefined,anchor:!!B.anchor?new google.maps.Point(B.anchor[0],B.anchor[1]):undefined}}}this._inst=new google.maps.Marker(z)},getMap:function(){return this.map},setPosition:function(A,z){this._inst.setPosition(new google.maps.LatLng({lat:A,lng:z}));return this},getPosition:function(){var z=this._inst.getPosition();return{lat:z.lat(),lng:z.lng()}},setIcon:function(A){if(typeof A==="string"){this.icon=A;this._inst.setIcon(A)}if(typeof A==="object"){if(typeof this.icon!=="object"){this.icon=A}else{$.extend(this.icon,A)}var z={};z.url=this.icon.url;if(!!this.icon.size){z.size=new google.maps.Size(this.icon.size[0],this.icon.size[1])}if(!!this.icon.origin){z.origin=new google.maps.Point(this.icon.origin[0],this.icon.origin[1])}if(!!this.icon.anchor){z.anchor=new google.maps.Point(this.icon.anchor[0],this.icon.anchor[1])}this._inst.setIcon(z)}return this},getIcon:function(){return this.icon},setZIndex:function(z){this._inst.setZIndex(z);return this},getZIndex:function(){return this._inst.getZIndex()},show:function(){this._inst.setVisible(true);return this},hide:function(){this._inst.setVisible(false);return this},remove:function(){this._inst.setMap(null)}};g.marker=$.extend({},i,g.marker);var n=["content","maxWidth","pixelOffset","disableAutoPan","zIndex"];g.infoWindow={initialize:function(A){var z=A.pixelOffset;if(!!z){A.pixelOffset=new google.maps.Size(z[0],z[1])}var B=$.extend({},a.pick(A,n),{map:this.map._inst,position:new google.maps.LatLng(A.lat,A.lng)})},remove:function(){this._inst.setMap(null)}};g.infoWindow=$.extend({},i,g.infoWindow);var f=["strokeColor","strokeOpacity","strokeWeight","clickable"];g.polyline={initialize:function(B){var E=B.paths,D=[];for(var C=0;C<E.length;C++){var z=E[C];D.push(new google.maps.LatLng(z.lat,z.lng))}var A=$.extend({},a.pick(B,f),{map:this.map._inst,path:D});this._inst=new google.maps.Polyline(A)},getMap:function(){return this.map},getPath:function(){var A=this._inst.getPath().getArray(),B=[];for(var z=0;z<A.length;z++){B.push({lat:A[z].lat(),lng:A[z].lng()})}return B},setOptions:function(A){var z=a.pick(A,f);this._inst.setOptions(z);return this},show:function(){this._inst.setVisible(true);return this},hide:function(){this._inst.setVisible(false);return this},remove:function(){this._inst.setMap(null)}};g.polyline=$.extend({},i,g.polyline);var x=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","clickable"];g.circle={initialize:function(z){var A=$.extend({},a.pick(z,x),{map:this.map._inst,center:new google.maps.LatLng(z.lat,z.lng),radius:z.radius});this._inst=new google.maps.Circle(A)},getMap:function(){return this.map},getCenter:function(){var z=this._inst.getCenter();return{lat:z.lat(),lng:z.lng()}},setRadius:function(z){this._inst.setRadius(z);return this},getRadius:function(){return this._inst.getRadius()},setOptions:function(z){var A=a.pick(z,x);this._inst.setOptions(A);return this},show:function(){this._inst.setVisible(true);return this},hide:function(){this._inst.setVisible(false);return this},remove:function(){this._inst.setMap(null)}};g.circle=$.extend({},i,g.circle);var k=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","clickable","zIndex"];g.polygon={initialize:function(B){var E=B.paths,D=[];for(var C=0;C<E.length;C++){var z=E[C];D.push(new google.maps.LatLng(z.lat,z.lng))}var A=$.extend({},a.pick(B,k),{map:this.map._inst,paths:D});this._inst=new google.maps.Polygon(A)},getMap:function(){return this.map},getPath:function(){var A=this._inst.getPath().getArray(),B=[];for(var z=0;z<A.length;z++){B.push({lat:A[z].lat(),lng:A[z].lng()})}return B},setOptions:function(A){var z=a.pick(A,k);this._inst.setOptions(z);return this},show:function(){this._inst.setVisible(true);return this},hide:function(){this._inst.setVisible(false);return this},remove:function(){this._inst.setMap(null)}};g.polygon=$.extend({},i,g.polygon);var v={};u.then(function(){var z=function(A){this.map=A.map._inst;this.lat=A.lat;this.lng=A.lng;this.type="marker";this.$node=null;this.position=null;this.initialize(A);this.createNode();this.setMap(this.map)};a.extend(z,google.maps.OverlayView);z.prototype.onAdd=function(){this.$node.css("position","absolute");var A;switch(this.type){case"marker":A=this.getPanes().overlayMouseTarget;break;case"infoWindow":A=this.getPanes().floatPane;break;default:}A.appendChild(this.$node[0])};z.prototype.draw=function(){var A=new google.maps.LatLng(this.lat,this.lng),B=this.getProjection().fromLatLngToDivPixel(A);this.renderNode(B);this.$node.css({left:this.position.x,top:this.position.y})};z.prototype.onRemove=function(){this.destoryNode()};z.prototype.getPosition=function(){return{lat:this.lat,lng:this.lng}};v._base=z});var b=h.addOverlayView=function(B,A){var z=function(C){z.__super__.constructor.call(this,C)};a.extend(z,v._base);$.extend(z.prototype,A);v[B]=z};g.overlayView={initialize:function(z){this._inst=new v[this._cid](z)},getMap:function(){return this.map},getPosition:function(){return this._inst.getPosition()},reset:function(){if(this._inst.$node.is(":visible")){this._inst.draw()}return this},remove:function(){this._inst.setMap(null)}};g.overlayView=$.extend({},i,g.overlayView);g.geocoder={initialize:function(z){this._inst=new google.maps.Geocoder()},geocode:function(z,A){this._inst.geocode({address:z.address},function(G,C){var B=[],D={results:G,status:C};if(C==google.maps.GeocoderStatus.OK){if(M.isArray(G)){for(var F=0;F<G.length;F++){var H=G[F],E={formattedAddress:H.formatted_address};if(H.geometry&&H.geometry.location&&M.isFunction(H.geometry.location.lat)&&M.isFunction(H.geometry.location.lng)){E.location={lat:H.geometry.location.lat(),lng:H.geometry.location.lng()}}B.push(E)}}}else{}A.call(null,B,D)})}};return h}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-runtime-amap",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util"),g=e("/js/hotel/mfwmap/mfwmap-event");f.exports=a(b,c,g)})}else{b.mfwmap.amapRuntime=a(b,b.mfwmap.util,b.mfwmap.event)}}(window,function(o,a,r){var u={util:a,event:r};var d=false,t=$.Deferred(),b=4000;o.initAMap=function(){t.resolve()};function s(x){var w=document.createElement("script");w.type="text/javascript";w.src=location.protocol+"//webapi.amap.com/maps?v=1.3&key=b2cf7b957c24323add8c497ed3512e15&callback=initAMap";if("onerror" in w){w.onerror=function(z){t.reject()}}document.body.appendChild(w);setTimeout(function(){try{if(t.state()==="pending"){t.reject()}}catch(z){t.reject()}},x)}var c={hasInited:d,init:function(x){if(!d){d=true;var w=Number(x)>0?Number(x):b;s(w)}},getInitPromise:function(){return t.promise()},controlPosition:{TOP_LEFT:1,TOP_RIGHT:3,BOTTOM_LEFT:10,BOTTOM_RIGHT:12}};var h=c.implement={};var j={zoom_changed:"zoomchange"};var i={_addListener:function(A,z){var x=a.mapping(A,j);var w=AMap.event.addListener(this._inst,x,z);return new u.event.EventListener(A,w)},_addListenerOnce:function(A,z){var x=a.mapping(A,j);var w=AMap.event.addListenerOnce(this._inst,x,z);return new u.event.EventListener(A,w)},_addMouseListener:function(B,A){var x=a.mapping(B,j);var z=this._inst;var w=AMap.event.addListener(z,x,function(C){A.call(z,C)});return new u.event.EventListener(B,w)},_addMouseListenerOnce:function(B,A){var x=a.mapping(B,j);var z=this._inst;var w=AMap.event.addListenerOnce(z,x,function(C){A.call(z,C)});return new u.event.EventListener(B,w)},_removeListener:function(w){AMap.event.removeListener(w._eventListener);return this},_trigger:function(x,z){var w=a.mapping(x,j);AMap.event.trigger(this._inst,w,z);return this}};h.map={initialize:function(x){x=$.extend(true,{},{control:{mapType:{visible:true},zoom:{visible:true,amapRuler:true,amapOffset:[10,10],amapLiteStyle:false}}},x);var w={view:new AMap.View2D({center:new AMap.LngLat(x.lng,x.lat),zoom:x.zoom}),mapStyle:"normal",dragEnable:x.draggable,scrollWheel:x.scrollwheel,doubleClickZoom:!x.disableDoubleClickZoom};x.element.id=x.element.id||"_j_map_container_"+a.uuid(8,16);this._inst=new AMap.Map(x.element.id,w);var z=this._inst;z.plugin(["AMap.Scale","AMap.ToolBar"],function(){var D=new AMap.Scale();z.addControl(D);var C=x.control.zoom,A;switch(C.position){case c.controlPosition.TOP_LEFT:A="LT";break;case c.controlPosition.TOP_RIGHT:A="RT";break;case c.controlPosition.BOTTOM_LEFT:A="BL";break;case c.controlPosition.BOTTOM_RIGHT:A="BR";break;default:A="LT"}var B=new AMap.ToolBar({position:A,offset:new AMap.Pixel(C.amapOffset[0],C.amapOffset[1]),ruler:C.amapRuler,direction:false,autoPosition:false,liteStyle:C.amapLiteStyle});if(C.visible){z.addControl(B)}})},setCenter:function(x,w){this._inst.setCenter(new AMap.LngLat(w,x));return this},getCenter:function(){var w=this._inst.getCenter();return{lat:w.getLat(),lng:w.getLng()}},setZoom:function(w){this._inst.setZoom(w);return this},getZoom:function(){return this._inst.getZoom()},panTo:function(x,w){this._inst.panTo(new AMap.LngLat(w,x));return this},panBy:function(w,z){this._inst.panBy(-w,-z);return this},fitBounds:function(w){this._inst.setBounds(w._inst);return this}};h.map=$.extend({},i,h.map);h.latLngBounds={initialize:function(x){if(!!x.northEast&&!!x.southWest){var z=new AMap.LngLat(x.southWest.lng,x.southWest.lat),w=new AMap.LngLat(x.northEast.lng,x.northEast.lat);this._inst=new AMap.Bounds(z,w)}},getCenter:function(){if(!!this._inst){var w=this._inst.getCenter();return{lat:w.getLat(),lng:w.getLng()}}return false},getNorthEast:function(){if(!!this._inst){var w=this._inst.getNorthEast();return{lat:w.getLat(),lng:w.getLng()}}return null},getSouthWest:function(){if(!!this._inst){var w=this._inst.getSouthWest();return{lat:w.getLat(),lng:w.getLng()}}return null},extend:function(C,F){var B,A,D,G;if(!!this._inst){var x=this._inst.getSouthWest().getLng(),I=this._inst.getNorthEast().getLng(),E=this._inst.getNorthEast().getLat(),H=this._inst.getSouthWest().getLat();B=x<=F?x:F;A=I>=F?I:F;D=E>=C?E:C;G=H<=C?H:C}else{B=A=F;D=G=C}var w=new AMap.LngLat(B,G),z=new AMap.LngLat(A,D);this._inst=new AMap.Bounds(w,z);return this},contains:function(x,w){if(!!this._inst){return this._inst.contains(new AMap.LngLat(w,x))}return false}};var p=["title","zIndex","clickable","draggable","icon","offset","content"],m={};h.marker={initialize:function(x){var z=x.icon,A=x.content,B;if(!!z){this.icon=z;if(typeof z==="object"){x.icon=new AMap.Icon({image:z.url,size:new AMap.Size(z.size[0],z.size[1]),imageOffset:!!z.origin?new AMap.Pixel(-z.origin[0],-z.origin[1]):undefined})}}if(!!A){this.content=A}if(!!x.offset){B=new AMap.Pixel(-x.offset[0],-x.offset[1])}var w=$.extend({},a.mapping(a.pick(x,p),m),{map:this.map._inst,position:new AMap.LngLat(x.lng,x.lat),offset:B});this._inst=new AMap.Marker(w)},getMap:function(){return this.map},setPosition:function(x,w){this._inst.setPosition(new AMap.LngLat(w,x));return this},getPosition:function(){var w=this._inst.getPosition();return{lat:w.getLat(),lng:w.getLng()}},setIcon:function(x){if(typeof x==="string"){this.icon=x;this._inst.setIcon(x)}if(typeof x==="object"){if(typeof this.icon!=="object"){this.icon=x}else{$.extend(this.icon,x)}var w={};w.image=this.icon.url;if(!!this.icon.size){w.size=new AMap.Size(this.icon.size[0],this.icon.size[1])}if(!!this.icon.origin){w.imageOffset=new AMap.Pixel(-this.icon.origin[0],-this.icon.origin[1])}this._inst.setIcon(new AMap.Icon(w))}return this},getIcon:function(){return this.icon},setOffset:function(w,z){this._inst.setOffset(new AMap.Pixel(-w,-z));return this},getOffset:function(){var w=this._inst.getOffset();return{x:-w.getX(),y:-w.getY()}},setZIndex:function(w){this._inst.setzIndex(w+100);return this},getZIndex:function(){return this._inst.getzIndex()-100},setContent:function(w){this.content=w;this._inst.setContent(w);return this},getContent:function(){return this.content},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.marker=$.extend({},i,h.marker);var n=["content","pixelOffset","disableAutoPan"],e={pixelOffset:"offset",disableAutoPan:"autoMove"};h.infoWindow={initialize:function(x){if("disableAutoPan" in x){x.disableAutoPan=!x.disableAutoPan}var w=x.pixelOffset;if(!!w){x.pixelOffset=new AMap.Pixel(w[0],w[1])}var z=$.extend({},a.mapping(a.pick(x,n),e),{map:this.map._inst,position:new AMap.LngLat(x.lng,x.lat),isCustom:true});this._inst=new AMap.InfoWindow(z);this._inst.open()},getMap:function(){return this.map},getPosition:function(){var w=this._inst.getPosition();return{lat:w.getLat(),lng:w.getLng()}},setContent:function(w){this._inst.setContent(w);return this},getContent:function(){return this._inst.getContent()},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.infoWindow=$.extend({},i,h.infoWindow);var g=["strokeColor","strokeOpacity","strokeWeight"],l={};h.polyline={initialize:function(z){var C=z.paths,B=[];for(var A=0;A<C.length;A++){var w=C[A];B.push(new AMap.LngLat(w.lng,w.lat))}var x=$.extend({},a.mapping(a.pick(z,g),l),{map:this.map._inst,path:B});this._inst=new AMap.Polyline(x)},getMap:function(){return this.map},getPath:function(){var x=this._inst.getPath(),z=[];for(var w=0;w<x.length;w++){z.push({lat:x[w].getLat(),lng:x[w].getLng()})}return z},setOptions:function(x){var w=a.mapping(a.pick(x,g),l);this._inst.setOptions(w);return this},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.polyline=$.extend({},i,h.polyline);var v=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity"],f={};h.circle={initialize:function(w){var x=$.extend({},a.mapping(a.pick(w,v),f),{map:this.map._inst,center:new AMap.LngLat(w.lng,w.lat),radius:w.radius});this._inst=new AMap.Circle(x)},getMap:function(){return this.map},getCenter:function(){var w=this._inst.getCenter();return{lat:w.getLat(),lng:w.getLng()}},setRadius:function(w){this._inst.setRadius(w);return this},getRadius:function(){return this._inst.getRadius()},setOptions:function(w){var x=a.mapping(a.pick(w,v),f);this._inst.setOptions(x);return this},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.circle=$.extend({},i,h.circle);var k=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","zIndex"],q={};h.polygon={initialize:function(z){var C=z.paths,B=[];for(var A=0;A<C.length;A++){var w=C[A];B.push(new AMap.LngLat(w.lng,w.lat))}var x=$.extend({},a.mapping(a.pick(z,k),q),{map:this.map._inst,path:B});this._inst=new AMap.Polygon(x)},getMap:function(){return this.map},getPath:function(){var x=this._inst.getPath(),z=[];for(var w=0;w<x.length;w++){z.push({lat:x[w].getLat(),lng:x[w].getLng()})}return z},setOptions:function(x){var w=a.mapping(a.pick(x,k),q);this._inst.setOptions(w);return this},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.polygon=$.extend({},i,h.polygon);h.overlayView={};h.geocoder={initialize:function(w){},geocode:function(w,x){AMap.service("AMap.Geocoder",function(){var z=new AMap.Geocoder();z.getLocation(w.address,function(C,A){var B=[],D={result:A,status:C};if(C==="complete"&&A.info==="OK"){if(M.isArray(A.geocodes)){for(var F=0;F<A.geocodes.length;F++){var G=A.geocodes[F],E={formattedAddress:G.formattedAddress};if(G.location){E.location={lat:G.location.lat,lng:G.location.lng}}B.push(E)}}}else{}x.call(null,B,D)})})}};return c}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-runtime-leaflet",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util"),g=e("/js/hotel/mfwmap/mfwmap-event");f.exports=a(b,c,g)})}else{b.mfwmap.leafletRuntime=a(b,b.mfwmap.util,b.mfwmap.event)}}(window,function(m,a,p){var u={util:a,event:p};var d=false,s=$.Deferred(),c=4000;function q(w){if(!!m.M){m.M.fetchCSSJS(["/css/plugins/leaflet/leaflet.css","/js/plugins/leaflet.js"],function(){L.Icon.Default.imagePath="http://images.mafengwo.net/images/plugins/leaflet/";s.resolve()})}else{if(!!window.L){s.resolve()}}setTimeout(function(){try{if(s.state()==="pending"){s.reject()}}catch(x){s.reject()}},w)}var r={hasInited:d,init:function(x){if(!d){d=true;var w=Number(x)>0?Number(x):c;q(w)}},getInitPromise:function(){return s.promise()},controlPosition:{TOP_LEFT:1,TOP_RIGHT:3,BOTTOM_LEFT:10,BOTTOM_RIGHT:12}};var g=r.implement={};var i={zoom_changed:"zoomend"};var h={_addListener:function(z,x){var w=a.mapping(z,i);this._inst.addEventListener(w,x);return new u.event.EventListener(z,{event:z,handler:x})},_addListenerOnce:function(z,x){var w=a.mapping(z,i);this._inst.addOneTimeEventListener(w,x);return new u.event.EventListener(z,{event:z,handler:x})},_addMouseListener:function(B,A){var x=a.mapping(B,i);var z=this._inst,w=function(C){A.call(z,C,{lat:C.latlng.lat,lng:C.latlng.lng})};this._inst.addEventListener(x,w);return new u.event.EventListener(B,{event:B,handler:w})},_addMouseListenerOnce:function(B,A){var x=a.mapping(B,i);var z=this._inst,w=function(C){A.call(z,C,{lat:C.latlng.lat,lng:C.latlng.lng})};this._inst.addOneTimeEventListener(x,w);return new u.event.EventListener(B,{event:B,handler:w})},_removeListener:function(w){this._inst.removeEventListener(w.event,w.handler);return this},_trigger:function(w,x){this._inst.fireEvent(w,x);return this}};var l=["draggable","scrollwheel","disableDoubleClickZoom"],n={draggable:"dragging",scrollwheel:"scrollWheelZoom",disableDoubleClickZoom:"doubleClickZoom"};g.map={initialize:function(A){this._view={center:null,zoom:null};this._setView=a.debounce(a.bind(function(){var D=this._view.center,E=this._view.zoom;if(!!D&&!!E){this._inst.setView(L.latLng(D.lat,D.lng),E)}else{if(!!D){this._inst.panTo(L.latLng(D.lat,D.lng))}if(!!E){this._inst.setZoom(E)}}D=null;E=null},this),1);A=$.extend(true,{},{control:{mapType:{visible:true},zoom:{visible:true,position:r.controlPosition.TOP_LEFT}}},A);var z=a.mapping(a.pick(A,l),n);z.doubleClickZoom=!z.doubleClickZoom;z.zoomControl=false;this._inst=L.map(A.element,z).setView([A.lat,A.lng],A.zoom);var C="https://maps.google.cn/maps/vt/pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m3!1e0!2sm!3i258145710!5m1!5f2!3m2!2szh-CN!3sCN",x="Map data &copy;Google";L.tileLayer(C,{maxZoom:18,attribution:x}).addTo(this._inst);var B=A.control.zoom,w;switch(B.position){case r.controlPosition.TOP_LEFT:w="topleft";break;case r.controlPosition.TOP_RIGHT:w="topright";break;case r.controlPosition.BOTTOM_LEFT:w="bottomleft";break;case r.controlPosition.BOTTOM_RIGHT:w="bottomright";break;default:w="topleft"}if(B.visible){L.control.zoom({position:w}).addTo(this._inst)}L.control.scale({imperial:false}).addTo(this._inst);this._inst.attributionControl.setPrefix(false)},setCenter:function(x,w){this._view.center={lat:x,lng:w};this._setView.call(this);return this},getCenter:function(){var w=this._inst.getCenter();return{lat:w.lat,lng:w.lng}},setZoom:function(w){this._inst.setZoom(w);return this},getZoom:function(){return this._inst.getZoom()},panTo:function(x,w){this._inst.panTo(L.latLng(x,w));return this},panBy:function(w,z){this._inst.panBy(L.point(w,z));return this},fitBounds:function(w){this._inst.fitBounds(w._inst);return this},computeDistanceBetween:function(A,z){var x=L.latLng(A.lat,A.lng),w=L.latLng(z.lat,z.lng);return x.distanceTo(w)}};g.map=$.extend({},h,g.map);g.latLngBounds={initialize:function(x){if(!!x.latLngBounds){this._inst=x.latLngBounds}else{if(!!x.northEast&&!!x.southWest){var z=L.latLng(x.southWest.lat,x.southWest.lng),w=L.latLng(x.northEast.lat,x.northEast.lng);this._inst=L.latLngBounds(z,w)}else{this._inst=L.latLngBounds([])}}},getCenter:function(){if(!!this._inst){var w=this._inst.getCenter();return{lat:w.lat,lng:w.lng}}return false},getNorthEast:function(){if(!!this._inst){var w=this._inst.getNorthEast();return{lat:w.lat,lng:w.lng}}return null},getSouthWest:function(){if(!!this._inst){var w=this._inst.getSouthWest();return{lat:w.lat,lng:w.lng}}return null},extend:function(x,w){this._inst.extend(L.latLng(x,w));return this},contains:function(x,w){return this._inst.contains(L.latLng(x,w))}};var f=["strokeColor","strokeOpacity","strokeWeight","clickable"],k={strokeColor:"color",strokeOpacity:"opacity",strokeWeight:"weight"};g.polyline={initialize:function(z){var C=z.paths,B=[];for(var A=0;A<C.length;A++){var w=C[A];B.push(L.latLng(w.lat,w.lng))}var x=a.mapping(a.pick(z,f),k);this._inst=L.polyline(B,x).addTo(this.map._inst)},getMap:function(){return this.map},getPath:function(){var x=this._inst.getLatLngs(),z=[];for(var w=0;w<x.length;w++){z.push({lat:x[w].lat,lng:x[w].lng})}return z},setOptions:function(x){var w=a.mapping(a.pick(x,f),k);this._inst.setStyle(w);return this},show:function(){this._inst.addTo(this.map._inst);return this},hide:function(){this.remove();return this},remove:function(){this.map._inst.removeLayer(this._inst)}};g.polyline=$.extend({},h,g.polyline);var v=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","clickable"],e={strokeColor:"color",strokeOpacity:"opacity",strokeWeight:"weight"};g.circle={initialize:function(w){var x=a.mapping(a.pick(w,v),e);this._inst=L.circle(L.latLng(w.lat,w.lng),w.radius,x).addTo(this.map._inst)},getMap:function(){return this.map},getCenter:function(){var w=this._inst.getCenter();return{lat:w.lat,lng:w.lng}},setRadius:function(w){this._inst.setRadius(w);return this},getRadius:function(){return this._inst.getRadius()},setOptions:function(w){var x=a.mapping(a.pick(w,v),e);this._inst.setStyle(x);return this},show:function(){this._inst.addTo(this.map._inst);return this},hide:function(){this.remove();return this},remove:function(){this.map._inst.removeLayer(this._inst)}};g.circle=$.extend({},h,g.circle);var j=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","clickable"],o={strokeColor:"color",strokeOpacity:"opacity",strokeWeight:"weight"};g.polygon={initialize:function(z){var C=z.paths,B=[];for(var A=0;A<C.length;A++){var w=C[A];B.push(L.latLng(w.lat,w.lng))}var x=a.mapping(a.pick(z,j),o);this._inst=L.polygon(B,x).addTo(this.map._inst)},getMap:function(){return this.map},getPath:function(){var x=this._inst.getLatLngs(),z=[];for(var w=0;w<x.length;w++){z.push({lat:x[w].lat,lng:x[w].lng})}return z},setOptions:function(x){var w=a.mapping(a.pick(x,j),o);this._inst.setStyle(w);return this},show:function(){this._inst.addTo(this.map._inst);return this},hide:function(){this.remove();return this},remove:function(){this.map._inst.removeLayer(this._inst)}};g.polygon=$.extend({},h,g.polygon);var t={};var b=r.addOverlayView=function(z,x){var w=L.Class.extend({initialize:function(A){this.map=A.map._inst;this.lat=A.lat;this.lng=A.lng;this.type="marker";this.$node=null;this.position=null;this._initialize(A);this.createNode()},onAdd:function(A){var B;switch(this.type){case"marker":B=A.getPanes().markerPane;break;case"infoWindow":B=A.getPanes().popupPane;this.$node.css("position","absolute");break;default:}B.appendChild(this.$node[0]);A.on("viewreset",this._reset,this);this._reset()},onRemove:function(A){var B;switch(this.type){case"marker":B=A.getPanes().markerPane;break;case"infoWindow":B=A.getPanes().popupPane;break;default:}B.removeChild(this.$node[0]);A.off("viewreset",this._reset,this)},_reset:function(){var A=this.map.latLngToLayerPoint(L.latLng(this.lat,this.lng));this.renderNode(A);L.DomUtil.setPosition(this.$node[0],this.position)}});x._initialize=x.initialize;delete x.initialize;$.extend(w.prototype,x);t[z]=w};g.overlayView={initialize:function(w){this._inst=new t[this._cid](w);this.map._inst.addLayer(this._inst)},getMap:function(){return this.map},getPosition:function(){return{lat:this._inst.lat,lng:this._inst.lng}},reset:function(){if(this._inst.$node.is(":visible")){this._inst._reset()}return this},remove:function(){this.map._inst.removeLayer(this._inst)}};g.overlayView=$.extend({},h,g.overlayView);g.geocoder={};return r}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util"),h=e("/js/hotel/mfwmap/mfwmap-event"),j=e("/js/hotel/mfwmap/mfwmap-runtime-google"),i=e("/js/hotel/mfwmap/mfwmap-runtime-amap"),g=e("/js/hotel/mfwmap/mfwmap-runtime-leaflet");f.exports=a(b,c,h,j,i,g)})}else{b.mfwmap=a(b,b.mfwmap.util,b.mfwmap.event,b.mfwmap.googleRuntime,b.mfwmap.amapRuntime,b.mfwmap.leafletRuntime)}}(window,function(s,c,t,m,h,v){var u={google:m,amap:h,leaflet:v};var x={createMap:function(E){var B=$.Deferred(),G=null,D=c.clone(E.runtimes),C=E.channelType||"unknown",A=E.pageType||"unknown",F=function(){var I=D.shift();if(I==="google"&&C!=="hotel"&&!(C==="poi"&&(A==="add"||A==="edit"))){F();return false}if(!!I){var H=u[I].getInitPromise();u[I].init();H.then(function(){E.mapType=I;G=new j(E);if("google"===I){google.maps.event.addListenerOnce(G._inst,"idle",function(){B.resolve(G)})}else{B.resolve(G)}var J=I==="leaflet"?"osm":I;!!window.mfwPageEvent&&window.mfwPageEvent("default","map",{map_type:J,channel_type:C,page_type:A});!!window.mfwPageEvent&&window.mfwPageEvent("hotel","mfwmap",{runtimes:E.runtimes,map_type:I,channel_type:C,page_type:A,is_success:1})},function(J){F()})}else{B.reject(new Error("create mfwmap failed!"));!!window.mfwPageEvent&&window.mfwPageEvent("hotel","mfwmap",{runtimes:E.runtimes,channel_type:C,page_type:A,is_success:0})}};F();return B.promise()},controlPosition:{TOP:2,TOP_CENTER:2,TOP_LEFT:1,TOP_RIGHT:3,LEFT:5,LEFT_BOTTOM:6,LEFT_CENTER:4,LEFT_TOP:5,RIGHT:7,RIGHT_BOTTOM:9,RIGHT_CENTER:8,RIGHT_TOP:7,BOTTOM:11,BOTTOM_CENTER:11,BOTTOM_LEFT:10,BOTTOM_RIGHT:12,CENTER:13},isWGS84:function(A){if(A==="leaflet"){return true}return false},isSupportOverlayView:function(A){if(c.includes(["google","leaflet"],A)){return true}return false},util:c};var j=function(A){A=$.extend({},j.DEFAULT,A);this.runtimes=A.runtimes;this.mapType=A.mapType;this.inject();this.initialize(A)};j.DEFAULT={draggable:true,scrollwheel:true,disableDoubleClickZoom:false};var e=["click","dblclick","mouseover","mouseout","drag","dragstart","dragend","zoom_changed","resize"];j.prototype.inject=function(){for(var A in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],A)){this[A]=c.bind(t.eventFunc[A],this,e)}else{this[A]=c.bind(t.eventFunc[A],this)}}var B=u[this.mapType].implement.map;for(var A in B){this[A]=c.bind(B[A],this)}};j.prototype.getBounds=function(){return new o({map:this,latLngBounds:this._inst.getBounds()})};var o=x.LatLngBounds=function(A){this.map=A.map;this.inject();this.initialize(A)};o.prototype.inject=function(){var B=u[this.map.mapType].implement.latLngBounds;for(var A in B){this[A]=c.bind(B[A],this)}};var k=x.Marker=function(A){A=$.extend({},k.DEFAULT,A);this.map=A.map;this.icon=null;this.content="";this.inject();this.initialize(A)};k.DEFAULT={title:"",opacity:1,clickable:true,draggable:false};var f=["click","dblclick","mouseover","mouseout","drag","dragstart","dragend"];k.prototype.inject=function(){for(var A in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],A)){this[A]=c.bind(t.eventFunc[A],this,f)}else{this[A]=c.bind(t.eventFunc[A],this)}}var B=u[this.map.mapType].implement.marker;for(var A in B){this[A]=c.bind(B[A],this)}};var l=x.InfoWindow=function(A){A=$.extend({},l.DEFAULT,A);this.map=A.map;this.icon=null;this.inject();this.initialize(A)};l.DEFAULT={};var a=["click","dblclick","mouseover","mouseout"];l.prototype.inject=function(){for(var A in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],A)){this[A]=c.bind(t.eventFunc[A],this,a)}else{this[A]=c.bind(t.eventFunc[A],this)}}var B=u[this.map.mapType].implement.infoWindow;for(var A in B){this[A]=c.bind(B[A],this)}};var q=x.Polyline=function(A){A=$.extend({},q.DEFAULT,A);this.map=A.map;this.inject();this.initialize(A)};q.DEFAULT={strokeColor:"#0a89e4",strokeOpacity:1,strokeWeight:2,clickable:true};var g=["click","dblclick","mouseover","mouseout"];q.prototype.inject=function(){for(var A in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],A)){this[A]=c.bind(t.eventFunc[A],this,g)}else{this[A]=c.bind(t.eventFunc[A],this)}}var B=u[this.map.mapType].implement.polyline;for(var A in B){this[A]=c.bind(B[A],this)}};var r=x.Circle=function(A){A=$.extend({},r.DEFAULT,A);this.map=A.map;this.inject();this.initialize(A)};r.DEFAULT={strokeColor:"#29b5EF",strokeOpacity:1,strokeWeight:1,fillColor:"#0a89e4",fillOpacity:0,clickable:true};var w=["click","dblclick","mouseover","mouseout"];r.prototype.inject=function(){for(var A in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],A)){this[A]=c.bind(t.eventFunc[A],this,w)}else{this[A]=c.bind(t.eventFunc[A],this)}}var B=u[this.map.mapType].implement.circle;for(var A in B){this[A]=c.bind(B[A],this)}};r.prototype.getBounds=function(){return new o({map:this.map,latLngBounds:this._inst.getBounds()})};var b=x.Polygon=function(A){A=$.extend({},b.DEFAULT,A);this.map=A.map;this.inject();this.initialize(A)};b.DEFAULT={strokeColor:"#0a89e4",strokeOpacity:1,strokeWeight:2,fillColor:"#0a89e4",fillOpacity:0,clickable:true};var p=["click","dblclick","mouseover","mouseout"];b.prototype.inject=function(){for(var A in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],A)){this[A]=c.bind(t.eventFunc[A],this,p)}else{this[A]=c.bind(t.eventFunc[A],this)}}var B=u[this.map.mapType].implement.polygon;for(var A in B){this[A]=c.bind(B[A],this)}};var z=x.OverlayView=function(A){this.map=A.map;this.inject();!!this.initialize&&this.initialize(A)};var i=["click","dblclick","mouseover","mouseout"];z.prototype.inject=function(){for(var A in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],A)){this[A]=c.bind(t.eventFunc[A],this,i)}else{this[A]=c.bind(t.eventFunc[A],this)}}var B=u[this.map.mapType].implement.overlayView;for(var A in B){this[A]=c.bind(B[A],this)}};var d=["initialize","createNode","renderNode","destoryNode"];z.implement=function(B){var A=this,D=c.uuid(),C=function(){this._cid=D;return A.apply(this,arguments)};u.google.getInitPromise().then(function(){u.google.addOverlayView(D,B)});u.leaflet.getInitPromise().then(function(){u.leaflet.addOverlayView(D,B)});c.extend(C,A);return C};var n=x.Geocoder=function(A){this.map=A.map;this.inject();this.initialize(A)};n.prototype.inject=function(){var B=u[this.map.mapType].implement.geocoder;for(var A in B){this[A]=c.bind(B[A],this)}};return x}));$(document).ready(function(){var C=$(".row-schedule"),w=C.find(".tabs"),B=$(".maps-img"),z=$(".maps-expand"),A=z.find(".mark"),c=z.find(".tip"),h=$(".row-sales"),s=$(".edithotmdd"),m=window.Env.MDDADM,e,G,r="",u=window.Env.MDDID;$("#_js_treasureTips .i_know").click(function(H){H.preventDefault();$("#_js_treasureTips").hide()});B.mouseenter(function(H){H.preventDefault();H.stopPropagation();if(H.target.tagName=="IMG"){z.removeClass("hide");setTimeout(function(){z.addClass("op");B.hide()},0)}});if(!m){z.mouseleave(function(H){H.preventDefault();H.stopPropagation();if(H.target.tagName=="IMG"){z.removeClass("op");setTimeout(function(){z.addClass("hide");B.show()},0)}})}z.find(".close").click(function(H){if(e){e.closeArea()}z.removeClass("op");z.addClass("hide");B.show()});$('<b style="cursor:pointer;right: 0; top: 0; position: absolute; font-size: 14px;">×</b>').appendTo(c);z.find("b").click(function(){c.addClass("hide")});if(m){z.click(function(H){var J=$(H.target);if(J[0].tagName=="I"||J.attr("class")=="mname"){J=J.parent()}var I=J.attr("data-act");if(I){j(I).call(this,J[0],H)}});function j(I){var H={};H.do_add_pos=function(J,K){var N=$('<a class="mark" style="left:50%;top:50%" data-act="open_tip"><b class="removepos" data-act="remove_point">×</b><i class="icon-b"></i><span class="mname"></span></a>');N.appendTo(z);x(N.get(0))};H.do_add_mdd=function(J,K){};H.do_submit_pos=function(K,O){var N=z.find("a.mark"),J=z.find(".selectArea"),P={aMarks:[],sLeft:0,sTop:0,sAct:"KMdd_StructWebAjax|SetAroundMap",iMddid:Env.MDDID,sImg:r};N.each(function(Q,S){var T={},U=$(S);T.mddname=U.find("span").html();if(T.mddname){T.left=U.css("left");T.top=U.css("top");T.iconcolor=U.find("i").attr("class");T.iconfont=U.hasClass("small");P.aMarks.push(T)}});if(N.length!=P.aMarks.length){alert("部分节点名为空");return}P.sLeft=J.css("left");P.sTop=J.css("top");if(!P.aMarks.length){alert("不能全部删除，请小心谨慎！");return}o("POST","/ajax/router.php",P,function(Q){if(Q.succ){alert("发布成功");D(0,P)}else{alert(Q.error.msg)}})};H.do_open_tip=function(J,K){K.preventDefault();if(c.hasClass("hide")){c.find("input[name=mddname]").val($(J).find("span").html());c.find("input[name=mddid]").val(J.getAttribute("data-mddid"));c.removeClass("hide");c.css("left",(parseFloat($(J).css("left"),10)+20)+"px");c.css("top",(parseFloat($(J).css("top"),10)+20)+"px");G=J}};H.do_switch_color=function(J,K){var N=$(G).find("i");if(N.hasClass("icon-a")){N.removeClass("icon-a");N.addClass("icon-b")}else{N.removeClass("icon-b");N.addClass("icon-a")}};H.do_switch_font=function(J,K){var N=$(G);if(N.hasClass("small")){N.removeClass("small")}else{N.addClass("small")}};H.do_load_area=function(){if(!e){e=new v();e.init($("#selectArea").get(0))}else{e.setVisible();e.cropPic()}};H.do_close_select=function(J,K){if(e){e.closeArea()}};H.do_remove_point=function(J,K){$(J).parent().remove()};H.do_copy_pos=function(J,K){var N={sAct:"KMdd_StructWebAjax|CopyMap",iFrom:Env.MDDID," iTo":$(J).parent().find("input").val()};o("GET","/ajax/router.php",N,function(O){if(O.succ){alert("发布成功")}else{alert(O.error.msg)}})};return H["do_"+I]}function x(I){var H=new R.ui.DragDrop();H.init({bridge:I,target:I,cursor:"pointer",mousedownObj:{fn:function(){H.setArea([0,z.width()-26,0,z.height()-26]);document.body.style.MozUserSelect="none";if(!z.find(".tip").hasClass("hide")){z.find(".tip").addClass("hide")}},scope:this},mouseupObj:{fn:function(){document.body.style.MozUserSelect="";setTimeout(function(){$(I).attr("data-act","open_tip")},100)},scope:this},mousemoveObj:{fn:function(){$(I).attr("data-act","")},scope:this}})}}z.find("input[name=mddname]").keyup(function(H){$(G).find("span").html(H.currentTarget.value)});z.find("input[name=mddid]").keyup(function(H){$(G).attr("data-mddid",H.currentTarget.value)});function v(){this._height="178px";this._width="260px";this._nodes=[];this._self=null;this._parent=null;this._mypic=null;this._mypic1=null;this._mypic2=null;this.fnselectMove={};var H=false;this.init=function(I){this._self=I;this._parent=z.get(0);this._self.style.border="1px dashed #959595";this._self.style.width=this._width;this._self.style.height=this._height;this._self.style.left="10px";this._self.style.top="10px";this._mypic=$("#mypic").get(0);this._mypic1=$("#mypic1").get(0);this._mypic2=$("#mypic2").get(0);this._mypic1.style.left="0px";this._mypic1.style.top="0px";this._mypic2.style.left="0px";this._mypic2.style.top="0px";var J=$("#squareIE").get(0);var N=parseInt(this._self.clientWidth);var K=parseInt(this._self.clientHeight);J.style.width=Math.abs(N-8);J.style.height=Math.abs(K-8);this.cropPic();this.setVisible();this.create()};this.setVisible=function(I){this._self.style.border=!I?"1px dashed #959595":"none";this._self.style.display=!I?"block":""};this.closeArea=function(){this.cropPic(1);this.setVisible(1)};this.create=function(){var I=this;if(!H){this.setLayout();this.hookEvent(this._self,"mousedown",function(J){I.addEvent(J,I._self,I.fnStop);var K=new F();K.create(J,I);I.fnselectMove=function(P){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();var O=parseInt(P.clientX-K.clickX);var N=parseInt(P.clientY-K.clickY);I.comPos(K,O,N,P)};I.hookEvent(document,"mousemove",I.fnselectMove)});this.hookEvent(document,"mouseup",I.fnStop=function(J){I.removeEvent(J,I._self,I.fnStop);I.unhookEvent(document,"mousemove",I.fnselectMove);if(I._self.style.border!="none"){I.cropPic()}})}if(H){this.hookEvent(this._self,"mousedown",function(S){I.addEvent(S,I._self,I.fnStop);var P=S.clientX;var N=S.clientY;var O=I._mypic1.offsetWidth-I._parent.offsetWidth;var K=I._mypic1.offsetHeight-I._parent.offsetHeight;var J=I._mypic1.offsetLeft;var Q=I._mypic1.offsetTop;I.fnselectMove=function(V){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();var U=parseInt(V.clientX-P);var T=parseInt(V.clientY-N);I.comPosBG(U,T,O,K,J,Q)};I.hookEvent(document,"mousemove",I.fnselectMove)});this.hookEvent(document,"mouseup",I.fnStop=function(J){I.removeEvent(J,I._self,I.fnStop);I.unhookEvent(document,"mousemove",I.fnselectMove)})}};this.addEvent=function(I,J,K){if(J.setCapture){this.hookEvent(J,"losecapture",K);J.setCapture();I.cancelBubble=true}else{if(window.captureEvents){I.stopPropagation();this.hookEvent(window,"blur",this.fnStop);I.preventDefault()}}};this.removeEvent=function(I,J,K){if(J.releaseCapture){this.unhookEvent(J,"losecapture",K);J.releaseCapture()}else{if(window.releaseEvents){this.unhookEvent(window,"blur",this.fnStop)}}};this.hookEvent=function(J,I,K){if(J.addEventListener){J.addEventListener(I,K,false)}else{if(J.attachEvent){J.attachEvent("on"+I,K)}}};this.unhookEvent=function(J,I,K){if(J.removeEventListener){J.removeEventListener(I,K,false)}else{if(J.detachEvent){J.detachEvent("on"+I,K)}}};this.cropPic=function(P){var I=$("#mypic1").get(0);if(!P){var O=parseInt(this._self.style.top)+Math.abs(parseInt(this._mypic1.style.top)),K=parseInt(this._self.style.left)+parseInt(this._self.offsetWidth)+Math.abs(parseInt(this._mypic1.style.left)),N=parseInt(this._self.style.top)+parseInt(this._self.offsetHeight)+Math.abs(parseInt(this._mypic1.style.top)),J=parseInt(this._self.style.left)+Math.abs(parseInt(this._mypic1.style.left));I.style.clip="rect("+O+"px,"+K+"px,"+N+"px,"+J+"px)"}else{I.style.clip=""}};this.comPos=function(N,J,I,K){if(N.DivLeft+N.DivWidth+J>=N.parentWidth-2){this._self.style.left=N.parentWidth-N.DivWidth-2+"px"}else{if(N.DivLeft+J<0){this._self.style.left="0px"}else{this._self.style.left=N.DivLeft+J+"px"}}if(N.DivTop+N.DivHeight+I>=N.parentHeight-2){this._self.style.top=N.parentHeight-N.DivHeight-2+"px"}else{if(N.DivTop+I<0){this._self.style.top="0px"}else{this._self.style.top=N.DivTop+I+"px"}}};this.comPosBG=function(O,K,N,J,I,P){this._mypic1.style.left=Math.max(-N,Math.min(0,O+I))+"px";this._mypic1.style.top=Math.max(-J,Math.min(0,K+P))+"px";this._mypic2.style.left=Math.max(-N,Math.min(0,O+I))+"px";this._mypic2.style.top=Math.max(-J,Math.min(0,K+P))+"px";this.cropPic()};this.setLayout=function(){this._mypic1.style.height="100%";this._mypic1.style.width="100%";this._mypic2.style.height="100%";this._mypic2.style.width="100%"}}function F(){this.clickX=0;this.clickY=0;this.DivWidth=0;this.DivHeight=0;this.DivLeft=0;this.DivTop=0;this.parentWidth=0;this.parentHeight=0;this.parentOffsetX=0;this.parentOffsetY=0;this.init=function(){};this.create=function(H,I){this.clickX=parseInt(H.clientX),this.clickY=parseInt(H.clientY);this.DivWidth=parseInt(I._self.clientWidth);this.DivHeight=parseInt(I._self.clientHeight);this.DivLeft=parseInt(I._self.style.left);this.DivTop=parseInt(I._self.style.top);this.parentWidth=parseInt(I._parent.clientWidth);this.parentHeight=parseInt(I._parent.clientHeight);this.absPos(I._parent)};this.absPos=function(I){var H=y=0;do{H+=I.offsetLeft;y+=I.offsetTop}while(I=I.offsetParent);this.parentLeft=H;this.parentTop=y}}function o(J,I,K,N){if(J=="POST"){$.ajax({type:J,url:I,dataType:"json",data:K,success:N})}else{I+="?";for(var H in K){I+=H+"="+K[H]+"&"}I=I.slice(0,I.length-1);$.ajax({type:J,url:I,dataType:"json",success:N})}}function i(J){var I={},K=-1;for(var H in J){K=H.search(/[A-Z]/g)}if(K==2){return"post"}else{if(K==1){return"get"}else{Alert.pop("参数属性错误~")}}}function D(I,S){var O=[],P=[],Q=S.aMarks,J=B.find("img"),H;for(var K=0,N=Q.length;K<N;K++){O[O.length]='<a href="/travel-scenic-spot/mafengwo/'+Q[K].mddid+'.html" data-cs-l="'+Q[K].mddname+'" class="mark '+(Q[K].iconfont=="true"?"small":"")+'" data-act="open_tip" data-mddid="'+Q[K].mddid+'" style="cursor: pointer;left: '+(parseFloat(Q[K].left,10)-parseFloat(S.sLeft,10))+"px;top:"+(parseFloat(Q[K].top,10)-parseFloat(S.sTop,10))+'px;"><i class="'+Q[K].iconcolor+'"></i><span class="mname">'+Q[K].mddname+"</span></a>";if(I){if(m){P[O.length]='<a href="javascript:void(0)" class="mark '+(Q[K].iconfont=="true"?"small":"")+'" data-act="open_tip" data-mddid="'+Q[K].mddid+'" style="cursor: pointer;left: '+Q[K].left+";top:"+Q[K].top+';">'+(m?'<b class="removepos" data-act="remove_point">×</b>':"")+'<i class="'+Q[K].iconcolor+'"></i><span class="mname">'+Q[K].mddname+"</span></a>"}else{P[O.length]='<a href="/travel-scenic-spot/mafengwo/'+Q[K].mddid+'.html" data-cs-l="'+Q[K].mddname+'" class="mark '+(Q[K].iconfont=="true"?"small":"")+'" data-act="open_tip" data-mddid="'+Q[K].mddid+'" style="cursor: pointer;left: '+Q[K].left+";top:"+Q[K].top+';">'+(m?'<b class="removepos" data-act="remove_point">×</b>':"")+'<i class="'+Q[K].iconcolor+'"></i><span class="mname">'+Q[K].mddname+"</span></a>"}}}J.css("left","-"+S.sLeft);J.css("top","-"+S.sTop);B.find("a.mark").remove();B.append(O.join(""));if(I){z.append(P.join(""));H=z.find("a.mark");if(m){H.each(function(T,U){x(U)})}}}if(typeof(amap)!="undefined"&&amap.aMarks){D(1,amap)}function d(N,K){var I=Math.floor(N/(1000*60*60*24)),H=Math.floor(N/(1000*3600))-(I*24),O=Math.floor(N/(1000*60))-(I*24*60)-(H*60),J=Math.floor(N/(1000))-(I*24*60*60)-(H*60*60)-(O*60);if(I==0&&H==0&&O==0&&J==1){clearInterval(interval);K.html("")}else{K.html("剩余: <em>"+I+"</em>天<em>"+H+"</em>时<em>"+O+"</em>分<em>"+J+"</em>秒");interval=setTimeout(function(){N=N-1000;d(N,K)},1000)}}function E(N,K){var I=Math.floor(N/(1000*60*60*24)),H=Math.floor(N/(1000*3600))-(I*24),O=Math.floor(N/(1000*60))-(I*24*60)-(H*60),J=Math.floor(N/(1000))-(I*24*60*60)-(H*60*60)-(O*60);if(I==0&&H==0&&O==0&&J==1){clearInterval(interval);K.html("")}else{K.html("剩余: <em>"+I+"</em>天<em>"+H+"</em>时<em>"+O+"</em>分<em>"+J+"</em>秒");interval=setTimeout(function(){N=N-1000;d(N,K)},1000)}}var q=h.find(".time"),g=$(q[0]).data("remaining"),f=$(q[1]).data("remaining");if(g){d(g*1000,$(q[0]))}if(f){d(g*1000,$(q[1]))}function t(){var J=$("#File1"),H,I=false;if(J.length){_uploader=new AjaxUpload(J,{action:"/ajax/router.php",name:"fImg",data:{sAct:"KMdd_StructWebAjax|UploadImage"},onSubmit:function(K,N){if(I){alert("上传中，请勿重复上传！");return}I=true},onComplete:function(N,K){I=false;K=$.parseJSON(K);if(K.succ){r=K.data.pid;$("#mypic1").attr("src",K.data.purl);$("#mypic2").attr("src",K.data.purl);B.find("img").attr("src",K.data.purl)}else{alert(K.error.msg)}}})}}function b(){var J=$("#File2"),H,I=false;if(J.length){_uploader2=new AjaxUpload(J,{action:"/ajax/router.php",name:"fImg",data:{sAct:"KMdd_StructWebAjax|UploadImage"},onSubmit:function(K,N){if(I){alert("上传中，请勿重复上传！");return}I=true},onComplete:function(N,K){I=false;K=$.parseJSON(K);if(K.succ){var O={sAct:"KMdd_StructWebAjax|SetMapImg",iMddid:Env.MDDID,sImg:K.data.pid};o("GET","/ajax/router.php",O,function(P){if(P.succ){alert("添加成功！请刷新页面。")}else{alert(P.error.msg)}})}else{alert(K.error.msg)}}})}}function a(){var J=s.find("input[name=edit]"),I=s.find("input[name=sure]"),H=s.find("textarea"),K={sAct:"KMdd_StructWebAjax|GetSubHotMdd",iMddid:Env.MDDID};if(m&&s){s.show();$(".uploadImgMap").show()}J.click(function(){o("GET","/ajax/router.php",K,function(N){if(N.succ){H.val(N.data);H.show()}else{alert(N.error.msg)}})});I.click(function(){K.sText=H.val();K.sAct="KMdd_StructWebAjax|SetSubHotMdd";o("POST","/ajax/router.php",K,function(N){if(N.succ){H.hide();alert("添加成功！请刷新页面。")}else{alert(N.error.msg)}})})}if(m){t();b();a()}else{z.find(".optbutton").hide()}$(".btn-collect").click(function(H){k($(H.currentTarget).get(0))});$(".btn-been").click(function(H){l($(H.currentTarget).get(0))});function l(I){var H=I.getAttribute("_ispa"),K=$(I),J=$(".go-path-pop"),N={act:H=="0"?"addPath":"delPath",mddid:I.getAttribute("_mddid")};if(!(H^0)){$.post("/mdd/ajax_mdd.php",N,function(O){if(O&&O.ret==4){show_login()}else{K.attr("_ispa",H=="0"?"1":"0");K.toggleClass("on");K.attr("href","/path/")}},"json")}}function k(H){var J=H.getAttribute("_iswg"),I=$(H),K={act:J=="0"?"addWantGo":"delWantGo",type:"mddid",iid:H.getAttribute("_mddid")};$.post("/mdd/ajax_mdd.php",K,function(N){if(N&&N.ret==4){show_login()}else{I.attr("_iswg",J=="0"?"1":"0").html(J=="0"?'<i class="icon"></i>已收藏':'<i class="icon"></i>收藏');I.toggleClass("on")}},"json")}(function n(){var I=$(".text h1"),H=80;while(I.width()+60>640){H=H-2;I.css("font-size",H+"px")}I.css("visibility","visible")})();function p(H){typeof mfwPageEvent=="function"&&mfwPageEvent("mdd","mdd_city_detail",H)}$(".place-navbar").delegate("a","click",function(I){var J=$(I.currentTarget),H=J.attr("data-cs-l");if(H){p({mode:"导航",type:H,mddid:window.Env.MDDID})}});$(".screen .photo").bind("click",function(H){p({mode:"相册",mddid:window.Env.MDDID})});$(".screen .r-side").delegate("a","click",function(H){var I=$(H.currentTarget);if(I.attr("href")!="javascript:void(0)"){p({mode:"小地图",mddid:window.Env.MDDID})}});$(".row-hotPlace").delegate("a","click",function(H){p({mode:"热门",type:"全部文字链",mddid:window.Env.MDDID})});$(".row-allPlace").delegate("a","click",function(I){var J=$(I.currentTarget),H=J.attr("class");p({mode:"热门",type:H=="maps"?"全部地图链":"全部文字链",mddid:window.Env.MDDID})});$(".row-line").delegate("a","click",function(I){var J=$(I.currentTarget),H=J.attr("data-t");if(H){p({mode:"路线",type:H,mddid:window.Env.MDDID})}});$("img.lazy").lazyload({threshold:400})});M.closure(function(b){var c=b("/js/hotel/mfwmap/mfwmap"),e,d=$(".J_map"),a={lat:map.lat,lng:map.lng};if(d.length){c.createMap({element:d[0],lat:a.lat,lng:a.lng,zoom:14,runtimes:Env.isCnmain?["amap","google","leaflet"]:["google","leaflet"],scrollwheel:true,channelType:"mdd",pageType:"normal",control:{mapType:{visible:false},zoom:{position:c.controlPosition.TOP_RIGHT,amapRuler:false,amapOffset:[0,40]}}}).then(function(j){e=j;var i=parseFloat(a.lat),f=parseFloat(a.lng);if(Env.isCnmain&&c.isWGS84(e.mapType)){var g=c.util.gcj2wgs(a.lat,a.lng);e.panTo(g.lat,g.lng);i=g.lat;f=g.lng}var h=new c.LatLngBounds({map:e})})}});M.define("PageAdmin",function(b){var e={},c=d();e.uuid=window.Env&&window.Env.uPageId||a();function a(){var f=c();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){var g=(f+Math.random()*16)%16|0;f=Math.floor(f/16);return(h==="x"?g:(g&3|8)).toString(16)})}function d(){var f=window.performance||{},g=f.now||f.mozNow||f.msNow||f.oNow||f.webkitNow||Date.now||function(){return new Date().getTime()};return g}return e});M.define("Storage",function(e,g,b){var n=document;var d=c();var f={_element:null,_expires:null,_file:document.location.hostname,init:function(){if(!this._element){try{this._element=n.createElement("input");this._element.type="hidden";this._element.addBehavior("#default#userData");n.body.appendChild(this._element);this.setItem("__detectUserDataStorage",1);this.removeItem("__detectUserDataStorage");return{setItem:this.setItem,getItem:this.getItem,removeItem:this.removeItem}}catch(p){M.error(p)}}return true},setItem:function(s,t,q){var p=j(q);this._element.expires=p.toUTCString();this._element.load(this._file);var r=a(this._element.getAttribute(s)),u=i(t,+p);this._element.setAttribute(s,u);this._element.save(this._file);k({key:s,newValue:u,oldValue:r,url:window.location.href})},getItem:function(p){this._element.load(this._file);var q=a(this._element.getAttribute(p));return q&&q.value},removeItem:function(p){this._element.load(this._file);this._element.removeAttribute(p);this._element.save(this._file)}};var l={setItem:function(r,s,q){if(!d){return}var p=j(q);localStorage.setItem(r,i(s,+p))},getItem:function(p){if(!d){return}var r=+new Date(),q=a(localStorage.getItem(p));if(q){if(r>q.timestamp){localStorage.removeItem(p);q=null}else{q=q.value}}return q},removeItem:function(p){if(!d){return}localStorage.removeItem(p)}};var h={},m={on:function(q,r){var p=h[q]||(h[q]=[]);p.push(r)},off:function(q,r){var p=h[q];if(!!p){if(!!r){M.forEach(p,function(t,s){if(t==r){p.splice(s,1)}})}else{p=[]}}return this}};M.mix(f,m);M.mix(l,m);if(window.addEventListener){window.addEventListener("storage",k,false)}else{if(window.attachEvent){window.attachEvent("onstorage",k)}}function k(u){if(!u){u=window.event}var p=M.mix({},u),w=u.newValue&&a(u.newValue),q=u.oldValue&&a(u.oldValue),v=+new Date();p.newValue=w&&w.value;if(!!q&&v<q.timestamp){p.oldValue=q.value}else{p.oldValue=null}var t=u.key,s=h[t],r=0;if(!t||!s||0===s.length){return}while(r<s.length){s[r++].call(window,p)}}function j(p){if(Object.prototype.toString.call(p)!="[object Date]"){var q=typeof p==="number"&&p>0?p:86400;p=new Date();p.setTime(+p+q*1000)}return p}function i(q,p){var r={value:q,timestamp:p};return JSON.stringify(r)}function a(p){if(p){try{p=JSON.parse(p);if(!("value" in p)||!("timestamp" in p)){p={value:p,timestamp:+j()}}}catch(q){p={value:p,timestamp:+j()}}}return p}function c(){if(window.localStorage){try{localStorage.setItem("__detectLocalStorage",1);localStorage.removeItem("__detectLocalStorage");return true}catch(p){return false}}return false}var o=window.localStorage?l:f.init();b.exports=M.mix(o,{isAvailable:c,isSupport:window.localStorage?d:("setItem" in o)})});M.define("Cookie",function(f,h,e){var g=/\+/g;var i=navigator.cookieEnabled;if(!i){document.cookie="__detectCookieEnabled=1;";i=document.cookie.indexOf("__detectCookieEnabled")!=-1?true:false;if(i){document.cookie="__detectCookieEnabled=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}}if(!i){return{isSupport:false}}var d={isSupport:true,set:function(m,n,k){k=(typeof k=="object"&&k!==null)?k:{};if(typeof k.expires==="number"){var o=k.expires,l=k.expires=new Date();l.setTime(+l+o*1000)}return(document.cookie=[j(m),"=",j(String(n)),k.expires?"; expires="+k.expires.toUTCString():"",k.path?"; path="+k.path:"",k.domain?"; domain="+k.domain:"",k.secure?"; secure":""].join(""))},get:function(q){var k=q?undefined:{};var r=document.cookie?document.cookie.split("; "):[];for(var p=0,m=r.length;p<m;p++){var s=r[p].split("=");var n=a(s.shift());var o=s.join("=");if(q&&q===n){k=b(o);break}if(!q&&(o=b(o))!==undefined){k[n]=o}}return k},remove:function(l,k){if(this.get(l)===undefined){return false}k=(typeof k=="object"&&k!==null)?k:{};k.expires=-1;this.set(l,"",k)}};function j(k){return encodeURIComponent(k)}function a(k){return decodeURIComponent(k)}function c(k){if(k.indexOf('"')===0){k=k.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{k=decodeURIComponent(k.replace(g," "));return k}catch(l){}}function b(k){var l=c(k);return l}e.exports=d});M.define("ResourceKeeper",function(d){var m=b();if(!m){return{isSupport:false}}var c=[];if(window.addEventListener){window.addEventListener("onbeforeunload",l,false)}else{if(window.attachEvent){window.attachEvent("onbeforeunload",l)}}function l(){M.forEach(c,function(n){n.release()})}var e=d("PageAdmin").uuid,j="default_resource",h="__resource_keeper",f=1000,k=2000;function a(n){n=""+n;n=n||j;this.keeping=false;this.resourceKeeperStorageKey=h+"_"+n;this.keepingRefreshInterval=0;this._initStorageListener();c.push(this)}M.mix(a.prototype,{keep:function(){this._requestKeep();return this.keeping},forceKeep:function(n){this._startKeep(n)},release:function(){if(this.keeping){var n=+new Date(),o=g(this.resourceKeeperStorageKey);if(o.currentKeeperPageUUID==e&&o.expire>n){m.remove(this.resourceKeeperStorageKey);this._setKeeping(false)}}},_initStorageListener:function(){M.Event(m).on("resource_keeper_change",M.bind(function(n){if(this.keeping&&n.key==this.resourceKeeperStorageKey&&n.pageUUID&&n.pageUUID!=e){this._setKeeping(false)}},this))},_requestKeep:function(){var n=+new Date(),o=g(this.resourceKeeperStorageKey);if(!o.currentKeeperPageUUID||o.currentKeeperPageUUID==e||o.expire<=n){this._startKeep(n)}else{this._setKeeping(false)}},_startKeep:function(n){n=n||+new Date();var o=n+k;m.set(this.resourceKeeperStorageKey,e+":"+o);this._setKeeping(true)},_setKeeping:function(n){this.keeping=n;if(this.keeping){this._startKeepingRefreshRequest()}else{this._stopKeepingRefreshRequest()}},_startKeepingRefreshRequest:function(){clearInterval(this.keepingRefreshInterval);this.keepingRefreshInterval=setInterval(M.bind(this._requestKeep,this),f)},_stopKeepingRefreshRequest:function(){clearInterval(this.keepingRefreshInterval)}});function b(){var o=null,p=d("Storage");if(p&&p.isSupport){o={set:M.bind(p.setItem,p),get:M.bind(p.getItem,p),remove:M.bind(p.removeItem,p)};if(window.addEventListener){window.addEventListener("storage",function(r){var q=r.key;if(q.indexOf(h)===0){var t="";if(r.newValue){var s=r.newValue.split(":");if(s.length==2){t=s[0]}}M.Event(o).fire("resource_keeper_change",{key:q,pageUUID:t})}},false)}}else{var n=d("Cookie");if(n&&n.isSupport){o={set:function(q,r){return n.set(q,r,k)},get:M.bind(n.get,n),remove:M.bind(n.remove,n)}}}return o}function g(p){var o={currentKeeperPageUUID:"",expire:0},n=m.get(p);if(n){n=n.split(":");o.currentKeeperPageUUID=n[0];o.expire=+n[1]}return o}function i(o){var n=new a(o);return{keep:M.bind(n.keep,n),forceKeep:M.bind(n.forceKeep,n),release:M.bind(n.release,n)}}i.isSupport=true;return i});(function(a){a.jGrowl=function(b,c){if(a("#jGrowl").size()==0){a('<div id="jGrowl"></div>').addClass((c&&c.position)?c.position:a.jGrowl.defaults.position).appendTo("body")}a("#jGrowl").jGrowl(b,c)};a.fn.jGrowl=function(b,d){if(a.isFunction(this.each)){var c=arguments;return this.each(function(){var e=this;if(a(this).data("jGrowl.instance")==undefined){a(this).data("jGrowl.instance",a.extend(new a.fn.jGrowl(),{notifications:[],element:null,interval:null}));a(this).data("jGrowl.instance").startup(this)}if(a.isFunction(a(this).data("jGrowl.instance")[b])){a(this).data("jGrowl.instance")[b].apply(a(this).data("jGrowl.instance"),a.makeArray(c).slice(1))}else{a(this).data("jGrowl.instance").create(b,d)}})}};a.extend(a.fn.jGrowl.prototype,{defaults:{pool:0,header:"",group:"",sticky:false,position:"top-right",glue:"after",theme:"default",themeState:"highlight",corners:"10px",check:250,life:3000,closeDuration:"normal",openDuration:"normal",easing:"swing",closer:true,closeTemplate:"&times;",closerTemplate:"<div>[ 关闭 ]</div>",log:function(c,b,d){},beforeOpen:function(c,b,d){},afterOpen:function(c,b,d){},open:function(c,b,d){},beforeClose:function(c,b,d){},close:function(c,b,d){},animateOpen:{opacity:"show"},animateClose:{opacity:"hide"}},notifications:[],element:null,interval:null,create:function(b,c){var c=a.extend({},this.defaults,c);if(typeof c.speed!=="undefined"){c.openDuration=c.speed;c.closeDuration=c.speed}this.notifications.push({message:b,options:c});c.log.apply(this.element,[this.element,b,c])},render:function(d){var b=this;var c=d.message;var e=d.options;var d=a('<div class="jGrowl-notification '+e.themeState+" ui-corner-all"+((e.group!=undefined&&e.group!="")?" "+e.group:"")+'"><div class="jGrowl-close">'+e.closeTemplate+'</div><div class="jGrowl-header">'+e.header+'</div><div class="jGrowl-message">'+c+"</div></div>").data("jGrowl",e).addClass(e.theme).children("div.jGrowl-close").bind("click.jGrowl",function(){a(this).parent().trigger("jGrowl.close")}).parent();a(d).bind("mouseover.jGrowl",function(){a("div.jGrowl-notification",b.element).data("jGrowl.pause",true)}).bind("mouseout.jGrowl",function(){a("div.jGrowl-notification",b.element).data("jGrowl.pause",false)}).bind("jGrowl.beforeOpen",function(){if(e.beforeOpen.apply(d,[d,c,e,b.element])!=false){a(this).trigger("jGrowl.open")}}).bind("jGrowl.open",function(){if(e.open.apply(d,[d,c,e,b.element])!=false){if(e.glue=="after"){a("div.jGrowl-notification:last",b.element).after(d)}else{a("div.jGrowl-notification:first",b.element).before(d)}a(this).animate(e.animateOpen,e.openDuration,e.easing,function(){if(a.browser.msie&&(parseInt(a(this).css("opacity"),10)===1||parseInt(a(this).css("opacity"),10)===0)){this.style.removeAttribute("filter")}a(this).data("jGrowl").created=new Date();a(this).trigger("jGrowl.afterOpen")})}}).bind("jGrowl.afterOpen",function(){e.afterOpen.apply(d,[d,c,e,b.element])}).bind("jGrowl.beforeClose",function(){if(e.beforeClose.apply(d,[d,c,e,b.element])!=false){a(this).trigger("jGrowl.close")}}).bind("jGrowl.close",function(){a(this).data("jGrowl.pause",true);a(this).animate(e.animateClose,e.closeDuration,e.easing,function(){a(this).remove();var f=e.close.apply(d,[d,c,e,b.element]);if(a.isFunction(f)){f.apply(d,[d,c,e,b.element])}})}).trigger("jGrowl.beforeOpen");if(e.corners!=""&&a.fn.corner!=undefined){a(d).corner(e.corners)}if(a("div.jGrowl-notification:parent",b.element).size()>1&&a("div.jGrowl-closer",b.element).size()==0&&this.defaults.closer!=false){a(this.defaults.closerTemplate).addClass("jGrowl-closer ui-state-highlight ui-corner-all").addClass(this.defaults.theme).appendTo(b.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){a(this).siblings().trigger("jGrowl.beforeClose");if(a.isFunction(b.defaults.closer)){b.defaults.closer.apply(a(this).parent()[0],[a(this).parent()[0]])}})}},update:function(){a(this.element).find("div.jGrowl-notification:parent").each(function(){if(a(this).data("jGrowl")!=undefined&&a(this).data("jGrowl").created!=undefined&&(a(this).data("jGrowl").created.getTime()+parseInt(a(this).data("jGrowl").life))<(new Date()).getTime()&&a(this).data("jGrowl").sticky!=true&&(a(this).data("jGrowl.pause")==undefined||a(this).data("jGrowl.pause")!=true)){a(this).trigger("jGrowl.beforeClose")}});if(this.notifications.length>0&&(this.defaults.pool==0||a(this.element).find("div.jGrowl-notification:parent").size()<this.defaults.pool)){this.render(this.notifications.shift())}if(a(this.element).find("div.jGrowl-notification:parent").size()<2){a(this.element).find("div.jGrowl-closer").animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){a(this).remove()})}},startup:function(b){this.element=a(b).addClass("jGrowl").append('<div class="jGrowl-notification"></div>');this.interval=setInterval(function(){a(b).data("jGrowl.instance").update()},parseInt(this.defaults.check));if(a.browser.msie&&parseInt(a.browser.version)<7&&!window.XMLHttpRequest){a(this.element).addClass("ie6")}},shutdown:function(){a(this.element).removeClass("jGrowl").find("div.jGrowl-notification").remove();clearInterval(this.interval)},close:function(){a(this.element).find("div.jGrowl-notification").each(function(){a(this).trigger("jGrowl.beforeClose")})}});a.jGrowl.defaults=a.fn.jGrowl.prototype.defaults})(jQuery);if(window.M&&typeof window.M.define=="function"){window.M.define("jq-jgrowl",function(){return jQuery})}M.closure(function(e){var j=e("ResourceKeeper"),t=j.isSupport?new j("new_msg_loop"):null,s=e("Storage"),b=1000,r=10000,u=40000,d=120000;var v=(function(){if(j.isSupport){return $.proxy(t.keep,t)}else{return function(){return M.windowFocused}}}());var k=function(){if(j.isSupport){t.forceKeep()}};if("addEventListener" in window){window.addEventListener("focus",k,false)}else{if("attachEvent" in document){document.attachEvent("onfocusin",k)}}$(function(){if(window.Env&&window.Env.UID>0||window.__mfw_uid>0){setTimeout(n,b)}else{setTimeout(l,r)}$("body").delegate(".jGrowl-closer","click",function(x){$.getJSON("/ajax/ajax_msg.php",{a:"closetip"});s.setItem("jgrowl_close_time",+new Date())});M.Event.on("update msg",function(){setTimeout(function(){w();s.setItem("update_msg",+new Date())},1)});s.on("update_msg",function(x){w()});function w(){if(window.Env&&window.Env.UID>0||window.__mfw_uid>0){p("msgdisplay")}else{p("nologinfeed")}}});function n(){setInterval(function(){v()&&p("msgdisplay")},u)}function l(){var x,w=1;v()&&p("nologinfeed");x=setInterval(function(){v()&&p("nologinfeed");w++;if(w==3){clearInterval(x)}},d)}function p(w){$.get("/ajax/ajax_msg.php?a="+w,function(x){if(x){o(x)}},"json")}function o(w){g();M.Event.fire("get new msg",w);if(w.msg){m()}if(w.tips&&!i()){a(w)}}e("jq-jgrowl");function a(w){var x=w.tips.split(w.split_char);M.forEach(x,function(A,z){if(A){setTimeout(function(){$.jGrowl(A,{header:"新鲜事：",closer:false,life:20000})},2000*z+10)}})}function i(){var x=s.getItem("jgrowl_close_time"),w=+new Date();if(x&&w-x<24*60*60*1000){return true}return false}var c,f=0,h=1000,q=document.title;function m(){g();c=setInterval(function(){if(v()){f++;document.title=f%2===0?"【　　　】 - "+q:"【新消息】 - "+q}else{document.title=q}},h)}function g(){clearInterval(c);document.title=q}});M.define("dialog/Layer",function(a){var g=0,f=550,d=(function(){return $.browser&&$.browser.msie&&parseInt($.browser.version,10)==7}()),c=(function(){return $.browser&&$.browser.msie&&parseInt($.browser.version,10)<7}());function b(){return g++}function e(h){this.opacity=0.8;this.background="#fff";this.impl="Dialog";this.fixed=true;M.mix(this,h);this.id="_j_layer_"+b();this.stacks=[];this.activeStackId=null;this.overflow=false;this.changeFixed=false;e.instances[this.id]=this;if(!e[this.impl]){e[this.impl]=[]}e[this.impl].push(this.id);this.init()}e.prototype={init:function(){this._createPanel()},_createPanel:function(){f++;var h={position:(!c&&this.fixed)?"fixed":"absolute",width:"100%",height:"100%",top:0,left:0},j=M.mix({},h,{"z-index":f,display:"none"}),k=M.mix({},h,{position:!c?"fixed":"absolute",background:this.background,opacity:this.opacity,"z-index":-1}),i=M.mix({},h,{"z-index":0},(!c&&this.fixed)?{"overflow-x":"hidden","overflow-y":"hidden"}:{overflow:"visible"});this._panel=$('<div id="'+this.id+'" class="layer _j_layer">                                <div class="layer_mask _j_mask"></div>                                <div class="layer_content _j_content"></div>                            </div>').css(j).appendTo("body");this._mask=this._panel.children("._j_mask").css(k);this._content=this._panel.children("._j_content").css(i)},setZIndex:function(h){f=h;this._panel.css("z-index",f)},getZIndex:function(){return +this._panel.css("z-index")},toFront:function(){this.setZIndex(f+1)},setFixed:function(h){h=!!h;if(this.fixed!=h){this.changeFixed=true;this.fixed=h;if(!c&&this.fixed){this._panel.css("position","fixed");this._content.css({position:"fixed","overflow-x":"hidden","overflow-y":"hidden"})}else{this._panel.css("position","absolute");this._content.css({position:"absolute","overflow-x":"","overflow-y":"",overflow:"visible"})}}else{this.changeFixed=false}},newStack:function(i){var h=$(i).appendTo(this._content);this.stacks.push(h);return this.stacks.length-1},getStack:function(h){return this.stacks[h]},getActiveStack:function(){return this.stacks[this.activeStackId]},setActiveStack:function(h){this.activeStackId=h},getPanel:function(){return this._panel},getMask:function(){return this._mask},getContent:function(){return this._content},show:function(j){var i=this;if(this.visible){typeof j==="function"&&j();return}e.activeId=this.id;this.visible=true;if(c){var h=document.documentElement&&document.documentElement.scrollHeight||document.body.scrollHeight;this._panel.css("height",h);this._mask.css("height",h)}this._panel.fadeIn(200,function(){typeof j==="function"&&j()})},hide:function(i){var h=this;if(!this.visible){typeof i==="function"&&i();return}this.visible=false;if(c){this._panel.css("height","");this._mask.css("height","")}this._panel.fadeOut(200,function(){typeof i==="function"&&i();h._recoverTopScroller()})},setOverFlow:function(h){this.overflow=h;if(h){if(!c&&this.fixed){this._hideTopScroller();this._content.css("overflow-y","auto")}}else{if(!c&&this.fixed){this._content.css("overflow-y","hidden")}}},_hideTopScroller:function(){if(d){$("html").css("overflow","hidden")}else{if(!c){$("body").css("overflow","hidden")}else{$("body").css("overflow-x","hidden");this._panel.height($(document).height()+20)}}},_recoverTopScroller:function(){if(d){$("html").css("overflow","")}else{if(!c){$("body").css("overflow","")}else{$("body").css("overflow-x","")}}},destroy:function(){this.hide($.proxy(function(){this._panel&&this._panel.remove();this._panel=null;if(M.indexOf(e[this.impl],this.id)!=-1){e[this.impl].splice(M.indexOf(e[this.impl],this.id),1)}delete e.instances[this.id]},this))},clear:function(){this._content.empty();this.stacks=[];this.activeStackId=null}};e.instances={};e.activeId=null;e.getInstance=function(h){return e.instances[h]};e.getActive=function(h){var i=e.getInstance(e.activeId);if(h&&i){i=i.impl===h?i:null}return i};e.getImplInstance=function(i){var h=e.getActive(i);if(!h&&M.is(e[i],"Array")&&e[i].length){h=e.getInstance(e[i][e[i].length-1])}return h};e.closeActive=function(){var h=e.getActive();if(h&&h.getActiveStack()){h.getActiveStack().trigger("close")}};$(document).keyup(function(h){if(h.keyCode==27){e.closeActive()}});$(document).unload(function(){M.forEach(e.instances,function(){e.destroy()})});return e});M.define("dialog/DialogBase",function(b){var e=b("dialog/Layer"),a=M.Event,d=(function(){return $.browser&&$.browser.msie&&parseInt($.browser.version,10)<7}());function c(f){this.newLayer=false;this.width="";this.height="";this.background="#000";this.panelBackground="#fff";this.bgOpacity=0.7;this.stackable=true;this.fixed=true;this.reposition=false;this.autoPosition=true;this.minTopOffset=20;this.layerZIndex=-1;this.impl="Dialog";M.mix(this,f);this.visible=false;this.destroyed=false;this.positioned=false;this.resizeTimer=0;this.init()}c.prototype={tpl:"<div />",init:function(){this._createDialog();this._bindEvents()},_createDialog:function(){this._panel=$(this.tpl).css({position:"absolute",opacity:0,display:"none",background:this.panelBackground,"z-index":0});this.setRect({width:this.width,height:this.height});this._layer=!this.newLayer&&e.getImplInstance(this.impl)||new e({impl:this.impl});if(this.layerZIndex>=0){this._layer.setZIndex(this.layerZIndex)}this._layer.setFixed(this.fixed);this._layer.getMask().css({background:this.background,opacity:this.bgOpacity});this._stackId=this._layer.newStack(this._panel);this.setPanelContent()},_bindEvents:function(){var f=this;$(window).resize($.proxy(this.resizePosition,this));M.Event(this).on("resize",$.proxy(this.resizePosition,this));this._panel.delegate("._j_close, a[data-dialog-button]","click",function(g){var h=$(g.currentTarget).attr("data-dialog-button");if(h=="hide"){f.hide()}else{f.close()}g.preventDefault()});this._panel.bind("close",function(g,h){f.close(h)})},resizePosition:function(){var f=this;clearTimeout(this.resizeTimer);if(f.visible&&f.autoPosition){this.resizeTimer=setTimeout(function(){f.setPosition()},100)}},addClass:function(f){this._panel.addClass(f)},removeClass:function(f){this._panel.removeClass(f)},setRect:function(f){if(f.width){this._panel.css("width",f.width);this.width=f.width}if(f.height){this._panel.css("height",f.height);this.height=f.height}},getPanel:function(){return this._panel},getLayer:function(){return this._layer},getMask:function(){return this._layer&&this._layer.getMask()},setPanelContent:function(){},_getPanelRect:function(){var f=this.getPanel(),g=f.outerHeight(),h=f.outerWidth();if(!f.is(":visible")){f.css({visibility:"hidden",display:"block"});var g=f.outerHeight(),h=f.outerWidth();f.css({visibility:"",display:""})}return{height:g,width:h}},_getNumric:function(f){f=parseInt(f,10);return isNaN(f)?0:f},setPosition:function(f){var g=this._getPanelRect(),h={width:$(window).width(),height:$(window).height()};var k=(h.width-(this._getNumric(this.width)>0?this._getNumric(this.width):g.width))/2,j=(h.height-(this._getNumric(this.height)>0?this._getNumric(this.height):g.height))*4/9;j=j<this.minTopOffset?this.minTopOffset:j;if(d||!this.fixed){var i=$(window).scrollTop();if(i>0){j+=i}}f={left:(f&&f.left)||k,top:(f&&f.top)||j};if(!d&&this.fixed){if(h.height-g.height<=f.top){this.getPanel().addClass("dialog_overflow");this._layer.setOverFlow(true)}else{this.getPanel().removeClass("dialog_overflow");this._layer.setOverFlow(false)}}var l=this.positioned?"animate":"css";$.fn[l].call(this.getPanel(),f,200);this.positioned=true;this.position=f},setFixed:function(f){this.fixed=!!f;this._layer.setFixed(this.fixed)},getPosition:function(){return this.position},show:function(f){if(this.visible){return}var h=this;a(this).fire("beforeshow");var g;if(this._layer.getActiveStack()){g=this._layer.getActiveStack();if(!this.reposition&&!f&&!this._layer.changeFixed){f=this._layer.getActiveStack().position()}}this._layer.show();this.getPanel().css({display:"","z-index":1});this.setPosition(f);g&&g.trigger("close",[true]);this.visible=true;this._layer.setActiveStack(this._stackId);this.getPanel().animate({opacity:1},{queue:false,duration:200,complete:function(){a(h).fire("aftershow")}})},close:function(){var f=this.stackable?"hide":"destroy";this[f].apply(this,Array.prototype.slice.call(arguments))},hide:function(g,f){if(typeof g=="function"){f=g;g=undefined}if(!this.visible){typeof f=="function"&&f();return}a(this).fire("beforeclose");a(this).fire("beforehide");this._layer.setActiveStack(null);this.visible=false;if(!g){this._layer.hide()}this.getPanel().animate({opacity:0},{queue:false,duration:200,complete:$.proxy(function(){this.getPanel().css({display:"none","z-index":0});a(this).fire("afterhide");a(this).fire("afterclose");typeof f=="function"&&f()},this)})},destroy:function(g,f){if(typeof g=="function"){f=g;g=undefined}if(this.destroyed){M.error("Dialog already destroyed!");typeof f=="function"&&f();return}a(this).fire("beforeclose");a(this).fire("beforedestroy");this.destroyed=true;this.hide(g,$.proxy(function(){if(this._panel.length){this._panel.undelegate();this._panel.unbind();this._panel.remove();this._panel=null}this._layer=null;a(this).fire("afterdestroy");a(this).fire("afterclose");typeof f=="function"&&f()},this))}};return c});M.define("dialog/Dialog",function(c){var d=c("dialog/DialogBase"),a='<div class="popup-box layer_dialog _j_dialog pop_no_margin">                    <div class="dialog_title" style="display:none"><div class="_j_title title"></div></div>                    <div class="dialog_body _j_content"></div>                    <a id="popup_close" class="close-btn _j_close"><i></i></a>                </div>';var b=M.extend(function(e){this.content="";this.title="";this.PANEL_CLASS="";this.MASK_CLASS="";b.$parent.call(this,e)},d);M.mix(b.prototype,{tpl:a,setPanelContent:function(){this._dialogTitle=this._panel.find("._j_title");this._dialogContent=this._panel.find("._j_content");this.setTitle(this.title);this.setContent(this.content);this.addClass(this.PANEL_CLASS);this.getMask().addClass(this.MASK_CLASS)},setTitle:function(e){if(e){this._dialogTitle.html(e).parent().css("display","")}else{this._dialogTitle.parent().css("display","none")}this.title=e},getTitle:function(){return this.title},setContent:function(e){this._dialogContent.empty().append(e)}});return b});M.define("dialog/alert",function(e,d){var b=e("dialog/Dialog"),a='<div id="popup_container" class="popup-box new-popbox"><a class="close-btn _j_close"><i></i></a><div class="pop-ico" id="_j_alertpopicon"><i class="i1"></i></div><div class="pop-ctn"><p class="hd _j_content"></p><p class="bd _j_detail"></p></div><div class="pop-btns"><a role="button" tabindex="0" class="popbtn popbtn-submit _j_close">&nbsp;确定&nbsp;</a></div></div>',f=M.extend(function(j){var i={width:420,content:"请输入内容",background:"#000",bgOpacity:0.7,PANEL_CLASS:"pop_no_margin",reposition:true,impl:"Alert",layerZIndex:10000};j=M.mix(i,j);f.$parent.call(this,j);this.bindEvents()},b),g=null,h=$.noop;M.mix(f.prototype,{tpl:a,setAlertTitle:function(i){this.setContent(i)},setAlertContent:function(i){this.getPanel().find("._j_detail").text(i)},setAssureWords:function(i){this.getPanel().find(".popbtn-submit").text(i)},setCloserHide:function(i){if(i){this.getPanel().find(".close-btn").hide()}else{this.getPanel().find(".close-btn").show()}},bindEvents:function(){var i=this.getPanel();i.on("keydown",".pop-btns ._j_close",function(j){if(j.keyCode==13){$(this).trigger("click")}}).on("click",".pop-btns ._j_close",function(j){i.data("btn_trigger",true)})}});var c=function(i,k,j){if(!g){g=new f();M.Event(g).on("afterhide",function(){var l=g.getPanel();if(typeof h=="function"){h.call(g,l)}l.data("btn_trigger",false)});M.Event(g).on("aftershow",function(){g.getPanel().find(".pop-btns ._j_close").focus()})}g.getLayer().toFront();if(M.isObject(i)){g.setAlertTitle(i.title);g.setAlertContent(i.content)}else{g.setAlertTitle(i);g.setAlertContent("")}if(M.isObject(i)){if(i.assureWords){g.setAssureWords(i.assureWords)}else{g.setAssureWords("确定")}if(i.hideCloser){g.setCloserHide(true)}else{g.setCloserHide(false)}}else{g.setAssureWords("确定");g.setCloserHide(false)}if(typeof k=="function"){h=k}else{h=$.noop}if(j){$("#_j_alertpopicon").children("i").attr("class","i"+j)}else{$("#_j_alertpopicon").children("i").attr("class","i"+1)}g.show();return g};d.pop=c;d.warning=function(i,j){c(i,j,1)};d.tip=function(i,j){c(i,j,3)}});M.define("FrequencyVerifyControl",function(c,b,d){function a(e){this.container=e.container;this.app=e.app;this.successHandler=$.noop;M.mix(this,e);this.init()}a.prototype={init:function(){this.initData();this.refreshImg();this.verifyCon.delegate("img,._j_change_img","click",$.proxy(function(e){this.refreshImg()},this));this.verifyCon.delegate("._j_fre_confirm","click",$.proxy(function(h){var g=this.verifyText.val();var f=g.length;if(f==0){this.showErro("您还没有输入验证码!");return false}else{if(f!==6){this.showErro("请输入正确的验证码!");return false}}var e=$(h.currentTarget);if(e.hasClass("waiting")){return false}e.addClass("waiting");$.post("/user/captcha/verify",{sCode:g,iApp:this.app},$.proxy(function(i){if(i){if(i.ret===1){this.successHandler(this.target);this.verifyCon.hide();this.hideErro()}else{if(i.ret===0){this.verifyText.val("");this.verifyText.focus();this.refreshImg();this.showErro("输入的验证码不正确!")}else{if(i.ret===-1){this.showErro("错误次数过多，请稍候尝试")}}}}e.removeClass("waiting")},this),"json")},this));this.verifyCon.delegate("._j_fre_text","keyup",$.proxy(function(e){if(e.keyCode==13){this.verifyCon.find("._j_fre_confirm").trigger("click")}},this))},showErro:function(e){this.errorCon.html(e);this.errorCon.show()},hideErro:function(){this.errorCon.hide()},initData:function(){this.verifyCon=this.container;this.verifyPo=this.verifyCon.find(".protectedYZM");this.verifyImg=this.verifyCon.find("img");this.verifyText=this.verifyCon.find("._j_fre_text");this.errorCon=this.verifyPo.find(".n-error")},refreshImg:function(){var e="/user/captcha/code?iApp="+this.app+"&s="+new Date().getTime();this.verifyImg.attr("src",e)}};d.exports=a});M.define("FrequencySystemVerify",function(f,e,g){var b=f("dialog/Dialog"),h=f("dialog/Layer"),d=f("FrequencyVerifyControl");var a='<div class="popYzm" style="z-index:inherit;position: relative;width:350px;height: 250px"><div class="protectedYZM" style="border: none;box-shadow: none;padding:25px 15px;"><p>亲爱的蜂蜂，你操作的速度有点像机器人<br>来证明下自己吧~</p><div class="YZMInput"><input class="_j_fre_text" type="text" placeHolder="验证码"></div><div class="YZMInput"><img src="http://images.mafengwo.net/images/home_new2015/verify.gif" width="150px" height="40px"><label><a href="javascript:void(0);" class="_j_change_img">看不清，换一张</a></label></div><div class="YZMSubmit"><a href="javascript:void(0);" class="_j_fre_confirm" title="确定">确定</a><span class="n-error">错误次数过多，请稍候尝试</span></div></div></div>';function c(i){this.app=i.app;this.init()}c.prototype={init:function(){var i=new b({content:a});if(h.getActive()){i.getLayer().setZIndex(h.getActive().getZIndex()+1)}i.show();var j=i.getPanel().find(".popYzm");new d({container:j,app:this.app,successHandler:$.proxy(function(){M.Event.fire("frequency:system:verify:success");i.close()},this)})}};g.exports=c});M.closure(function(d){var b=d("dialog/Dialog"),f=d("dialog/alert"),c=d("FrequencySystemVerify");window.show_login=a;$.ajaxSetup({dataFilter:function(i,h){try{var k=$.parseJSON(i);if(k&&k.unsafe==1){window.location.href="http://www.mafengwo.cn";return"{}"}if(k&&k.error&&k.error.msg=="login:required"){M.Event.fire("login:required");return"{}"}if(k&&k.error&&k.error.msg=="mobilebind:required"){f.pop({title:"依《网络安全法》要求，你需要在发布内容之前绑定手机号~",assureWords:"去绑定",hideCloser:true},function(m){location.href=window.Env.P_HTTP+"/setting/security/mobile/"});return{}}if(k&&k.resource&&k.resource.onload&&k.resource.onload.length){if(k.resource.onload[0]=='K.fire("login:required");'){M.Event.fire("login:required");return"{}"}}if(k&&k.error){var g=0;var l=0;if(typeof(k.error.errno)!=="undefined"){g=k.error.errno;l=k.error.error}else{if(typeof(k.error.code)!=="undefined"){g=k.error.code;l=k.error.msg}}if(g===10000){M.Event.fire("frequency:verify",l);return"{}"}}}catch(j){}return i},error:function(g){if(g.status==401){if(g.responseJSON&&g.responseJSON.data&&g.responseJSON.data.auth_type=="login"){M.Event.fire("login:required")}}}});var e=null;function a(){if($.browser.msie&&parseInt($.browser.version,10)<9){document.location.href=(window.Env&&window.Env.P_HTTP)||"https://passport.mafengwo.cn";return}if(!e){e=new b({PANEL_CLASS:"login_pop",content:'<iframe frameborder="no" border="0" scrolling="no" width="580" height="292" allowtransparency="true"></iframe>',background:"#aaa",bgOpacity:0.6,reposition:true,impl:"logindialog"})}e.show();if(!e.getPanel().find("iframe").attr("src")){M.Event(e).once("aftershow",function(){var g=window.Env.P_HTTP||"https://passport.mafengwo.cn";e.getPanel().find("iframe").attr("src",g+"/login-popup.html")})}}M.Event.on("login:required",a);M.Event.on("frequency:verify",function(g){new c({app:g})});if(M.Event.isFired("login:required")){a()}});M.define("ScrollObserver",function(e,g,c){var h=0,f={},a=false,b,d=true;g.addObserver=function(k){var j="ScrollObserver_"+h;h++;f[j]=k;d=false;return j};g.removeObserver=function(j){delete f[j];if(M.isEmpty(f)){d=true}};function i(){for(var j in f){if(f.hasOwnProperty(j)){f[j]()}}}$(window).scroll(function(){if(d){return}if(!a){b=setInterval(function(){if(a){a=false;clearTimeout(b);i()}},50)}a=true});return g});M.define("QRCode",function(b,a,c){c.exports={gen:function(e,d){var d={text:e,size:d.size||200,eclevel:d.evlevel||"H",logo:d.logo||"",__stk__:window.Env.CSTK};return"http://"+window.Env.WWW_HOST+"/qrcode.php?"+$.param(d)}}});M.closure(function(b){var l=b("ScrollObserver"),m=b("Storage"),d=window.Env||{},f=$("#_j_mfwtoolbar"),h=f.height(),a=$(window).height(),k=$(document).height(),g=$("#footer"),e=g.outerHeight();$("body").css("position","relative");$(window).resize(function(){a=$(window).height();k=$(document).height()});setInterval(function(){var n=$(document).height();if(n!=k){k=n;$(window).trigger("scroll")}},2000);if(!d.hideToolbar){if(!d.showToolbarDownArrow){f.children(".toolbar-item-down").remove()}else{f.children(".toolbar-item-down").show()}f.show();c();l.addObserver(c);f.on("click","._j_gotop",i);f.on("click","._j_gobottom",j);f.children(".toolbar-item-code").mouseenter(function(){$(this).addClass("hover")});f.children(".toolbar-item-code").mouseleave(function(){$(this).removeClass("hover")})}function c(){var n=$(window).scrollTop();if(n>500){f.children(".toolbar-item-top").show()}else{f.children(".toolbar-item-top").hide()}if(g.length){if(n+a>g.offset().top){f.css({position:"absolute",bottom:e+20})}else{f.css({position:"",bottom:""})}}}function i(){$("html, body").animate({scrollTop:0},500,function(){M.Event.fire("scroll to top")})}function j(){$("html, body").animate({scrollTop:k-a},500,function(){M.Event.fire("scroll to bottom")})}});(function(){var a=document.createElement("script"),b=window.Env&&window.Env.CNZZID||30065558;a.type="text/javascript";a.async=true;a.charset="utf-8";a.src=document.location.protocol+"//w.cnzz.com/c.php?id="+b+"&async=1";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,c)})();M.closure(function(a){M.log("只要你有梦想，就加入我们\n你即将见证互联网最新趋势的快速成长\n马蜂窝的一切资源都会成为你成长路上的最大助力\n你可以和马蜂窝一起书写互联网的风云奇迹\n在这里有一群和你一样，疯狂地热爱互联网和旅行的人们\n马蜂窝能为你实现梦想提供最广阔的平台");M.log("请将简历发送至 %csuperhr@mafengwo.com%c（ 邮件标题请以“_console”结尾）","color:#4ae;","color:inherit;");M.log("职位介绍：http://www.mafengwo.cn/s/hr.html")});M.closure(function(a){$.get("/ajax/ajax_page_onload.php",{href:document.location.href,_t:+new Date()},function(b){if(b.payload&&b.payload.apps){var c=b.payload.apps;if(!M.isEmpty(c)){var d={css_list:c.css||[]};M.loadCssJsListSeq(d,function(){if(c.html){$("body").append(c.html)}if(c.js&&c.js.length){M.loadResource(c.js)}})}}},"json")});