(function(A,I){var b=this||Function("return this")(),B=b.RegExp,l=b.Object;var x="_super",n="_init",q="prototype",k=false,z=/xyz/.test(function(){return"xyz"})?new B("\\b"+x+"\\b"):/.*/;var g={backgroundColor:1,backgroundRepeat:1,border:1,borderBottom:1,color:1,cursor:1,display:1,filter:1,font:1,fontWeight:1,height:1,left:1,lineHeight:1,overflow:1,overflowX:1,padding:1,position:1,styleFloat:1,textAlign:1,top:1,whiteSpace:1,width:1,verticalAlign:1,zIndex:1,tableLayout:1,zoom:1},D={"for":"htmlFor","class":"className",html:"innerHTML",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"};var p=l[q],e=p.toString,h=p.hasOwnProperty,o=Array[q].slice,F=Function[q].bind,a={},y={toString:1},C=!y.propertyIsEnumerable("toString"),i=!C?[]:["propertyIsEnumerable","hasOwnProperty","valueOf","isPrototypeOf","toLocaleString","toString","constructor"],H=i.length,a={};if(!String.prototype.trim){var G="[\x09\x0A-\x0D\x20\xA0\u1680\u180E\u2000-\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]";var w=new B("^"+G+G+"*");var r=new B(G+G+"*$");String.prototype.trim=function(){return String(this).replace(w,"").replace(r,"")}}var J=function(T,R,P,Q){var S,M,O,N;if(!T||!R){return}if(Q){M=Q.length;while(M--){O=Q[M];if(!h.call(R,O)){continue}S=P?false:key in T;if(P||!S){T[O]=R[O]}}}else{for(O in R){N=R[O];if(!(O in T)||(P&&T[O]!==N&&(!(O in a)||a[O]!==N))){T[O]=N}}if(C&&(M=H)){while(M){O=i[--M];N=R[O];if(!(O in T)||(T[O]!==N&&(!(O in a)||a[O]!==N))){T[O]=N}}}}return T},L=function(Q,P){var N=o.call(arguments,1),O=-1,M=N.length,R=typeof N[M-1]==="boolean"&&!!N[--M];if(P===undefined){N[0]=P=Q;Q=this}while(O<M){J(Q,N[++O],R)}return Q},K=function(Q,N,M){var P=M||b;for(var s=0,O;P&&(O=Q[s]);s++){P=(O in P?P[O]:(N?P[O]={}:undefined))}return P},u=function(M,O,N,s){var R=M.split("."),Q=R.pop(),P=K(R,true,N);if(P&&Q){if(!s&&O&&typeof O==="object"&&P[Q]!==undefined){P=P[Q]||(P[Q]={});for(Q in O){if(h.call(O,Q)){P[Q]=O[Q]}}}else{P[Q]=O}return O}},d=function(N,s,M){if(typeof N==="string"){return u(N,s,this,M)}else{if(typeof s!=="object"){s=N;N=this}if(s){J(N,s,M);return s}return null}},j=l.create||(function(){function s(){}return function(M){s.prototype=M;return new s}}()),m=function(P,O,M,R){if(!O||!P){f.error("extend failed, verify dependencies")}var Q=O.prototype,N=j(Q);P.prototype=N;N.constructor=P;P.superclass=Q;if(O!==l&&Q.constructor===octor){Q.constructor=O}if(M){L(N,M,true)}if(R){L(P,R,true)}return P},c=function(O,N,M){var Q;if(typeof O!=="string"){alert("class create failed, verify definitions")}if(!M){if(!N){alert("class create failed, verify definitions");return}M=N;N=null}function P(){if(!k){if(N){this._superprototype=N[q]}this[n].apply(this,arguments)}}function s(R){for(var S in R){if(R.hasOwnProperty(S)){if(N&&typeof(R[S])==="function"&&typeof(P[q][S])==="function"&&z.test(R[S])){P[q][S]=(function(T,U){return function(){this[x]=N[q][T];return U.apply(this,arguments)}})(S,R[S])}else{P[q][S]=R[S]}}}}if(N){k=true;P[q]=new N();P[q].constructor=P;k=false}Q=typeof M;if(Q==="object"){s(M)}else{if(Q==="function"){M.call(P[q],N?N[q]:null)}}if(O){P[q].$name=O.split(".").pop();P[q].$namespace=O;f.declare(O,P)}return P},t=function(N){var O,M,s;if(N&&typeof N==="object"){s=N.length;if(typeof s==="number"){O=new Array(s);while(s--){O[s]=t(N[s])}}else{O={};for(M in N){if(N.hasOwnProperty(M)){O[M]=t(N[M])}}}return O}return N},v=function(N){var s=false,M;return function(){if(s){return M}s=true;return M=N.apply(this,arguments)}};var E=function(){var R,Q,s;R=document.createElement("div");R.className="a";R.innerHTML='<p style="color:red;"><a href="#" style="opacity:.45;float:left;">a</a></p>';R.setAttribute("class","t");Q=R.getElementsByTagName("p")[0];s=Q.getElementsByTagName("a")[0];var O=R.className==="t",N=/;/.test(Q.style.cssText),M=/^0.45$/.test(s.style.opacity),P=!!(document.defaultView&&document.defaultView.getComputedStyle);return{setAttr:O,cssText:N,opacity:M,classList:!!R.classList,cssFloat:!!s.style.cssFloat,getComputedStyle:P}}();function f(){}J(f,{declare:d,klass:c,clone:t,once:v});f.declare("dom",{getViewPort:function(s){s=s||document.documentElement;var M={x:s.scrollLeft,y:s.scrollTop,w:s.clientWidth,h:s.clientHeight,sw:Math.max(s.clientWidth,s.scrollWidth),sh:Math.max(s.clientHeight,s.scrollHeight)};return M},setOpacity:function(s,M){if(E.opacity){s.style.opacity=(M===1?"":""+M)}else{s.style.filter="alpha(opacity="+M*100+");";s.style.zoom=1}},createElement:function(P,U,M,O){if(!P){return null}var T,R,Q;O=O||document;if(P.toUpperCase()==="TABLE"){P="<table>"+(U.html||U.innerHTML||"")+"</table>"}if(P.charAt(0)==="<"){if(!rhtml.test(P)){return O.createTextNode(P)}else{P=P.replace(rxhtmlTag,"<$1></$2>");var V=(rtagName.exec(P)||["",""])[1].toLowerCase(),N=wrapMap[V]||wrapMap._default,S=N[0],s=O.createElement("div");s.innerHTML=N[1]+P+N[2];while(S--){s=s.lastChild}P=s.lastChild}if(U){Q=U.html?"html":U.innerHTML?"innerHTML":"";Q&&delete U[Q]}}else{P=O.createElement(P)}if(U){for(R in U){f.dom.setAttribute(P,R,U[R])}}if(M){for(R in M){P.style[R]=M[R]}}return P},node:function(Q,s,P){var O,M,N={},R={};for(M in P){(g[M]?R:N)[M]=P[M]}O=f.dom.createElement(s,N,R,Q&&Q.ownerDocument);if(Q){Q.appendChild(O);if(O.nodeType===11){O=Q.lastChild}}return O},setAttribute:function(M,N,s){N=D[N]||N;if(N==="className"||N==="innerHTML"){M[N]=s}else{M.setAttribute(N,s===true?N:s)}},setWH:function(O,M,N){var s="width:"+M+"px;height:"+N+"px";this.setCSSText(O,s)},setCSSText:function(N,O){var s=N.style,M=s.cssText||"";if(!E.cssText){M+=";"}s.cssText=M+O}});f.declare("event",{on:function(O,N,s,M){if(!O||(typeof N==="string"&&!s)){console.log("addListener failed, invalid element or callback")}A(O).on(N,{me:M},s)},un:function(N,M,s){A(N).off(M,s)},trigger:function(M,s){A(M).trigger(s)}});f.declare("string",{encodeHTML:function(s){s=s||document.documentElement;var M={x:s.scrollLeft,y:s.scrollTop,w:s.clientWidth,h:s.clientHeight};return M}});f.declare("date",{parse:function(O,V){V||(V="yyyy-MM-dd");V=V.replace(/\W/g,",").split(",");O=O.replace(/\D/g,",").split(",");var U=2000,S=0,T=1,Q=0,P=0,W=0,R=Number;f.each(V,function(s,M){if(O[M]!==""&&!isNaN(O[M])){if(find(s,"y")){U=R(O[M])}if(find(s,"M")){S=R(O[M])-1}if(find(s,"d")){T=R(O[M])}if(find(s,"h")){Q=R(O[M])}if(find(s,"m")){P=R(O[M])}if(find(s,"s")){W=R(O[M])}if(find(s,"w")){W=R(O[M])}}});return new Date(U,S,T,Q,P,W)},format:function(N,Q){var T=N.getFullYear(),M=N.getMonth()+1,R=N.getDate(),P=N.getHours(),S=N.getMinutes(),O=N.getSeconds();switch(Q){case 10:return T+"年"+M+"月"+R+"日(星期"+("日一二三四五六".charAt(N.getDay()))+") "+(["上午","下午"][N.getHours()<12?0:1])+(P<10?"0"+P:P)+":"+(S<10?"0"+S:S);default:return T+"-"+M+"-"+R+" "+P+":"+S+":"+O}}});f.klass("ui.Component",function(){var M=f.dom,s=f.once(function(){var O=new f.ui.ModalPanel(),P=document.createElement("div");O.init(P);O.setVisible(false);document.body.appendChild(P);P=null;return O}),N=function(){var O=new f.ui.ModalPanel(),P=document.createElement("div");O.init(P);O.setVisible(false);document.body.appendChild(P);P=null;return O};this._init=function(){this._parent=null;this._doc=null;this._self=null;this._width=null;this._height=null;this._dockRect={x:0,y:0,w:0,h:0}};this.init=function(O){this._self=O};this.initParentDocEnv=function(P){if(P){this._parent=P;if(!this._doc){var O=this._doc=P.ownerDocument||(P._self&&P._self.ownerDocument)||document;this._win=O.parentWindow||O.defaultView}}};this.resize=function(O,P){this.setWidth(Number(O));this.setHeight(Number(P))};this.setWidth=function(O){O=!O||O<0?0:O;this._width=O;this.setStyle("width",O+"px");if(this._dockRect.w==0){this._dockRect.w=O}};this.setHeight=function(O){O=!O||O<0?0:O;this._height=O;this.setStyle("height",O+"px");if(this._dockRect.h==0){this._dockRect.h=O}};this.setStyle=function(O,P){this._self.style[O]=P};this.getViewPort=function(){var O=this._self;return{x:O.scrollLeft,y:O.scrollTop,w:O.clientWidth,h:Math.max(O.clientHeight,O.parentNode.clientHeight)}};this.moveTo=function(O,P){this.setLeft(O);this.setTop(P)};this.moveToCenter=function(){var R=this._parent&&this._parent.getViewPort?this._parent.getViewPort():M.getViewPort(),P=Math.max(document.documentElement.scrollTop,document.body.scrollTop),O=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),Q=this._width||this._self.offsetWidth,S=this._height||this._self.offsetHeight;this.moveTo(O+R.x+Math.round((R.w-Q)/2),P+R.y+Math.round((R.h-S)/2))};this.setLeft=function(O){this._left=O;this.setStyle("left",O+"px")};this.setTop=function(O){this._top=O;this.setStyle("top",O+"px")};this.showModal=function(P){var O=s();return O.setVisible(P)};this.setVisible=function(O){if(O==this._visible){return}this._visible=O;if(O){this.setStyle("display",",A,B,I,U,SPAN,INPUT,BUTTON,".indexOf(this._self.tagName)!=-1?"":"block")}else{this.setStyle("display","none")}};this.setOpacity=function(O){if(this._opacity!=O){this._opacity=O;M.setOpacity(this._self,O)}}});f.klass("util.Delegation",function(){var s="_act",N=f.event;function M(R,Q,P){if(!R||R.nodeType!==1){return null}while(R){if(R===Q){return null}else{if(R.getAttribute&&R.getAttribute(P)){return R}}R=R.parentNode}}function O(P){Array.prototype.slice.call(P)}this._init=function(){this._self=this;this.el=null;this.type="click";this.hook=s;this.hash={};this.inited=false};this.init=function(){var P=O(arguments),Q;this.el=Q=arguments[0];this.type=arguments[1]||"click";this.hook=arguments[2]||s;if(this.inited){return}N.on(Q,this.type,this.handle,this);this.inited=true};this.dispose=function(){var R=this,Q=R.el;N.un(Q,R.type||s,R.handle);R.el=null;for(var P in R.hash){R.hach[P]=null}};this.handle=function(S){var R=S.data.me,U=R.hook,V=S.target,T=V.getAttribute(U),Q;if(!T&&(Q=M(V,R.el,R.hook))){return P(Q)}P();function P(X){var X=X||V,ac=ac||X.getAttribute(U),W=R.hash&&R.hash[ac];if(!W){return}var Z=W.scope,ab=W.data,Y=W.handler,aa=typeof ab==="function";if(R.handlerDispatch){R.handlerDispatch(ac,X)}if(aa&&ab.apply(Z||X,[X])===false){return}if(V.nodeName!=="INPUT"){S.preventDefault()}S.stopPropagation();Y.apply(Z||X,[X,S,!aa&&ab])}};this.add=function(S,Q,P,R){if(S in this.hash){return}this.hash[S]={handler:Q,scope:P,data:R}};this.on=function(S,Q){var R,P;for(R in S){P=S[R];this.add(R,P.handler,Q||P.scope,P.data)}};this.remove=function(P){delete this.hash[P]}});f.klass("ui.DragDrop",function(){var s=f.event;this._init=function(){this.target=null;this.bridge=null;this.dragable=true;this.dragX=0;this.dragY=0;this.area=null;this.mousedownObj=null;this.mouseupObj=null;this.mousemoveObj=null;this.diffX=0;this.diffY=0;this.cursor="move"};this.init=function(M){this.target=M.target;this.bridge=M.bridge;this.dragable=M.dragable!=false;this.dragX=M.dragX!=false;this.dragY=M.dragY!=false;this.area=M.area;this.cursor=M.cursor||"move";this.mousedownObj=M.mousedownObj;this.mouseupObj=M.mouseupObj;this.mousemoveObj=M.mousemoveObj;var O=this.bridge||this.target;var N=this;s.on(O,"mouseover",function(){this.style.cursor=N.cursor},this);s.on(O,"mousedown",this.onMouseDown,this)};this.dragX=function(){this.dragX=true;this.dragY=false};this.dragY=function(M){this.dragY=true;this.dragX=false};this.dragAll=function(){this.dragX=true;this.dragY=true};this.setArea=function(M){this.area=M};this.setBridge=function(M){this.bridge=M};this.setDragable=function(M){this.dragable=M};this.getDragX=function(){return this.dragX};this.getDragY=function(){return this.dragY};this.onMouseDown=function(O){var P=O.data.me,M=P.target,N=P.mousedownObj;M.style.position="absolute";if(N&&N.fn){N.fn.call(N.scope)}if(window.captureEvents){O.stopPropagation();O.preventDefault();A(window).on("blur",{me:P},P.onMouseUp)}else{if(M.setCapture){M.setCapture();O.cancelBubble=true;A(M).bind("losecapture",{me:P},P.onMouseUp)}}P.diffX=O.clientX-M.offsetLeft;P.diffY=O.clientY-M.offsetTop;A(document).on("mousemove",{me:P},P.onMouseMove);A(document).on("mouseup",{me:P},function(Q){Q.data.me.onMouseUp(Q)})};this.onMouseMove=function(V){var U=V.data.me,P=U.target,S=V.clientX-U.diffX,Q=V.clientY-U.diffY;var T,N,R,M;if(U.area){T=U.area[0];N=U.area[1];R=U.area[2];M=U.area[3];S<T&&(S=T);S>N&&(S=N);Q<R&&(Q=R);Q>M&&(Q=M)}if(U.dragable){S=S-(parseInt(P.style.marginLeft,10)||0);Q=Q-(parseInt(P.style.marginTop,10)||0);U.dragX&&(P.style.left=S+"px");U.dragY&&(P.style.top=Q+"px");var O=U.mousemoveObj;if(O){O.fn.apply(O.scope)}}};this.onMouseUp=function(O){var P=O.data.me,N=P.target,M=P.mouseupObj;P.bridge.style.cursor="";if(M&&M.fn){M.fn.call(M.scope)}A(document).unbind("mousemove");A(document).unbind("mouseup",P.onMouseUp);if(window.releaseEvents){A(window).off("blur",{me:P},P.onMouseUp)}if(N.releaseCapture){A(N).off("losecapture",{me:P},P.onMouseUp);N.releaseCapture()}return false}});f.klass("ui.Dailog",f.ui.Component,function(O){var P=f.event,N=f.dom,M=27,Q=document;function s(){return false}this._init=function(){O._init.call(this);this._head=null;this._body=null;this._footer=null;this._close=null;this._caption="对话框标题";this._tpl="";this._keepAlive=true;this._modal=null;this._callback=null;this._defaulttpl='<div class="dheader"><span>标题</span><a _act="close" style="z-index:99" class="close-btn" href="javascript:void(0);" id="popup_close"><i></i></a></div><div class="dbody"></div><div class="dfooter"><span _act="ok">确定</span><span _act="close">取消</span></div>'};this.init=function(T){O.init.apply(this,arguments);this._head=this._self.childNodes[0];this._body=this._self.childNodes[1];this._footer=this._self.childNodes[1];this._caption=this._head.firstChild;this._btnClose=this._head.lastChild;this._dragdrop=new f.ui.DragDrop();var S=this,R=this._self;this._dragdrop.init({bridge:this._head,target:R,mousedownObj:{fn:function(){var U=N.getViewPort();S._dragdrop.setArea([0,U.sw-R.offsetWidth,0,U.sh-R.offsetHeight]);S.UnActiveUserSelect()},scope:this},mouseupObj:{fn:this.ActiveUserSelect,scope:this}});P.on(this._self,"keyup",this.onKeyUp,this);this.initAction()};this.create=function(S){var R=document.createElement("div");R.className=S.cls||"popup-box";R.innerHTML=this._defaulttpl;document.body.appendChild(R);this.init(R);if(S.tpl){this._body.innerHTML=S.tpl}if(S.caption){this.setCaption(S.caption)}if(S.width&&S.height){this.resize(S.width,S.height)}if(S.callback){this._callback=S.callback}this.showModal(true);this.moveToCenter()};this.setCaption=function(R){this._caption.innerHTML=R};this.UnActiveUserSelect=function(){this._head.onselectstart=s;document.body.style.MozUserSelect="none"};this.ActiveUserSelect=function(){document.body.style.MozUserSelect=""};this.setHeadStyle=function(R){N.addClass(this._head,R)};this.hideHead=function(){this._head.style.display="none"};this.hideFooter=function(){this._footer.style.display="none"};this.hideClose=function(){this._btnClose.style.display="none"};this.initAction=function(){this._delegate=new f.util.Delegation();this._delegate.init(this._self);this._delegate.add("close",this.do_close,this);this._delegate.add("ok",this.do_ok,this)};this.showModal=function(R){var S=O.showModal.apply(this,arguments);if(R){this._self.style.zIndex=S+1}this._modal=R;this.setVisible(R)};this.onKeyUp=function(R){var S=R.data.me;switch(R.keyCode){case M:P.trigger(S._btnClose,"click");break}};this.close=function(){if(this._modal){this.showModal(false)}if(this._keepAlive){this._self.style.display="none"}else{if(this._self&&this._self.parentNode){this._self.parentNode.removeChild(this._self)}}};this.do_close=function(R,S){this.close()};this.do_ok=function(R,S){if(this._callback){this._callback.call(this)}this.close()};this.do_dlg_min=function(){this.close()};this.show=function(){this.showModal(true);this.moveToCenter()}});f.klass("ui.ModalPanel",f.ui.Component,function(N){var s=navigator.userAgent,P=/MSIE\s([^;]*)/.test(s)||/MSIE([^;]*)/.test(s),M=f.dom,O=f.event;this._init=function(){N._init.call(this);this._iframe=null;this._panel=null;this._zindex=120};this.init=function(Q){N.init.apply(this,arguments);this._self.className="wui-ModalPanel";this._self.style.zIndex=this._zindex;this.moveTo(0,0);this.setOpacity(0.4);if(P){this._iframe=M.node(this._self,"iframe",{scrolling:"no",frameBorder:"0",frameSpacing:"0",src:"about:blank",display:"none",width:"100%",height:"100%"});this._panel=M.node(this._self,"div",{display:"none",position:"absolute",left:"0px",top:"0px"})}var R=this;O.on(window,"resize",function(){setTimeout(function(){var U=document.documentElement,S=Math.max(U.clientWidth,U.scrollWidth),T=Math.max(U.clientHeight,U.scrollHeight);R.resize(S,T)},10)},this)};this.dispose=function(){if(this._disposed){return}if(P){this._panel=null;this._iframe=null}N.dispose.apply(this)};this.setVisible=function(Q){if(!Q&&this._zindex>120){this._zindex=this._zindex-2;this._self.style.zIndex=this._zindex;return this._zindex}this._self.style.zIndex=this._zindex=(Q?this._zindex+2:this._zindex-2);N.setVisible.apply(this,arguments);var R=M.getViewPort();this.resize(R.sw,R.sh);if(P){this._iframe.style.display=Q?"":"none";this._panel.style.display=Q?"":"none"}return this._zindex};this.resize=function(Q,R){N.resize.apply(this,arguments);if(P){M.setWH(this._panel,Q,R)}}});f.klass("util.TestObj",{_init:function(){alert("TestObj__init")},init:function(){alert("TestObj_init")}});f.klass("util.TestObj1",f.util.TestObj,function(s){this._init=function(){s._init.call(this);alert("TestObj1__init")};this.init=function(){alert("TestObj1_init")}});f.klass("util.TestFun",function(){this._init=function(){alert("TestFun__init")};this.init=function(){alert("TestFun_init")}});f.klass("util.TestFun1",f.util.TestFun,function(s){this._init=function(){s._init.call(this);alert("TestFun1__init")};this.init=function(){alert("TestFun1_init")}});I.R=f})(jQuery,window);(function(){function log(){if(typeof(console)!="undefined"&&typeof(console.log)=="function"){Array.prototype.unshift.call(arguments,"[Ajax Upload]");console.log(Array.prototype.join.call(arguments," "))}}function addEvent(el,type,fn){if(el.addEventListener){el.addEventListener(type,fn,false)}else{if(el.attachEvent){el.attachEvent("on"+type,function(){fn.call(el)})}else{throw new Error("not supported or DOM not loaded")}}}function addResizeEvent(fn){var timeout;addEvent(window,"resize",function(){if(timeout){clearTimeout(timeout)}timeout=setTimeout(fn,100)})}if(document.documentElement.getBoundingClientRect){var getOffset=function(el){var box=el.getBoundingClientRect();var doc=el.ownerDocument;var body=doc.body;var docElem=doc.documentElement;var clientTop=docElem.clientTop||body.clientTop||0;var clientLeft=docElem.clientLeft||body.clientLeft||0;var zoom=1;if(body.getBoundingClientRect){var bound=body.getBoundingClientRect();zoom=(bound.right-bound.left)/body.clientWidth}if(zoom>1){clientTop=0;clientLeft=0}var top=box.top/zoom+(window.pageYOffset||docElem&&docElem.scrollTop/zoom||body.scrollTop/zoom)-clientTop,left=box.left/zoom+(window.pageXOffset||docElem&&docElem.scrollLeft/zoom||body.scrollLeft/zoom)-clientLeft;return{top:top,left:left}}}else{var getOffset=function(el){var top=0,left=0;do{top+=el.offsetTop||0;left+=el.offsetLeft||0;el=el.offsetParent}while(el);return{left:left,top:top}}}function getBox(el){var left,right,top,bottom;var offset=getOffset(el);left=offset.left;top=offset.top;right=left+el.offsetWidth;bottom=top+el.offsetHeight;return{left:left,right:right,top:top,bottom:bottom}}function addStyles(el,styles){for(var name in styles){if(styles.hasOwnProperty(name)){el.style[name]=styles[name]}}}function copyLayout(from,to){var box=getBox(from);addStyles(to,{position:"absolute",left:box.left+"px",top:box.top+"px",width:from.offsetWidth+"px",height:from.offsetHeight+"px"})}var toElement=(function(){var div=document.createElement("div");return function(html){div.innerHTML=html;var el=div.firstChild;return div.removeChild(el)}})();var getUID=(function(){var id=0;return function(){return"ValumsAjaxUpload"+id++}})();function fileFromPath(file){return file.replace(/.*(\/|\\)/,"")}function getExt(file){return(-1!==file.indexOf("."))?file.replace(/.*[.]/,""):""}function hasClass(el,name){var re=new RegExp("\\b"+name+"\\b");return re.test(el.className)}function addClass(el,name){if(!hasClass(el,name)){el.className+=" "+name}}function removeClass(el,name){var re=new RegExp("\\b"+name+"\\b");el.className=el.className.replace(re,"")}function removeNode(el){el.parentNode.removeChild(el)}window.AjaxUpload=function(button,options){this._settings={action:"upload.php",name:"userfile",data:{},autoSubmit:true,responseType:false,hoverClass:"hover",disabledClass:"disabled",height:"20px",onChange:function(file,extension){},onSubmit:function(file,extension){},onComplete:function(file,response){}};for(var i in options){if(options.hasOwnProperty(i)){this._settings[i]=options[i]}}if(button.jquery){button=button[0]}else{if(typeof button=="string"){if(/^#.*/.test(button)){button=button.slice(1)}button=document.getElementById(button)}}if(!button||button.nodeType!==1){throw new Error("Please make sure that you're passing a valid element")}if(button.nodeName.toUpperCase()=="A"){addEvent(button,"click",function(e){if(e&&e.preventDefault){e.preventDefault()}else{if(window.event){window.event.returnValue=false}}})}this._button=button;this._input=null;this._disabled=false;this.enable();this._rerouteClicks()};AjaxUpload.prototype={setData:function(data){this._settings.data=data},disable:function(){addClass(this._button,this._settings.disabledClass);this._disabled=true;var nodeName=this._button.nodeName.toUpperCase();if(nodeName=="INPUT"||nodeName=="BUTTON"){this._button.setAttribute("disabled","disabled")}},enable:function(){removeClass(this._button,this._settings.disabledClass);this._button.removeAttribute("disabled");this._disabled=false},_createInput:function(){var self=this;var input=document.createElement("input");input.setAttribute("type","file");input.setAttribute("name",this._settings.name);addStyles(input,{position:"absolute",right:0,margin:0,padding:0,fontSize:this._settings.height,cursor:"pointer"});var div=document.createElement("div");addStyles(div,{display:"block",position:"absolute",overflow:"hidden",margin:0,padding:0,opacity:0,direction:"ltr",zIndex:2147483583});if(div.style.opacity!=="0"){if(typeof(div.filters)=="undefined"){throw new Error("Opacity not supported by the browser")}div.style.filter="alpha(opacity=0)"}addEvent(input,"change",function(){if(!input||input.value===""){return}var file=fileFromPath(input.value);if(false===self._settings.onChange.call(self,file,getExt(file))){self._clearInput();return}if(self._settings.autoSubmit){self.submit()}});addEvent(input,"mouseover",function(){addClass(self._button,self._settings.hoverClass)});addEvent(input,"mouseout",function(){removeClass(self._button,self._settings.hoverClass);self._input.parentNode.style.visibility="hidden"});div.appendChild(input);document.body.appendChild(div);this._input=input},_clearInput:function(){if(!this._input){return}removeNode(this._input.parentNode);this._input=null;this._createInput();removeClass(this._button,this._settings.hoverClass)},_rerouteClicks:function(){var self=this;addEvent(self._button,"mouseover",function(){if(self._disabled){return}if(!self._input){self._createInput()}var div=self._input.parentNode;copyLayout(self._button,div);div.style.visibility="visible"})},_createIframe:function(){var id=getUID();var iframe=toElement('<iframe src="javascript:false;" name="'+id+'" />');iframe.setAttribute("id",id);iframe.style.display="none";document.body.appendChild(iframe);return iframe},_createForm:function(iframe){var settings=this._settings;var form=toElement('<form method="post" enctype="multipart/form-data"></form>');form.setAttribute("action",settings.action);form.setAttribute("target",iframe.name);form.style.display="none";document.body.appendChild(form);for(var prop in settings.data){if(settings.data.hasOwnProperty(prop)){var el=document.createElement("input");el.setAttribute("type","hidden");el.setAttribute("name",prop);el.setAttribute("value",settings.data[prop]);form.appendChild(el)}}return form},_getResponse:function(iframe,file){var toDeleteFlag=false,self=this,settings=this._settings;addEvent(iframe,"load",function(){if(iframe.src=="javascript:'%3Chtml%3E%3C/html%3E';"||iframe.src=="javascript:'<html></html>';"){if(toDeleteFlag){setTimeout(function(){removeNode(iframe)},0)}return}var doc=iframe.contentDocument?iframe.contentDocument:window.frames[iframe.id].document;if(doc.readyState&&doc.readyState!="complete"){return}if(doc.body&&doc.body.innerHTML=="false"){return}var response;if(doc.XMLDocument){response=doc.XMLDocument}else{if(doc.body){response=doc.body.innerHTML;if(settings.responseType&&settings.responseType.toLowerCase()=="json"){if(doc.body.firstChild&&doc.body.firstChild.nodeName.toUpperCase()=="PRE"){response=doc.body.firstChild.firstChild.nodeValue}if(response){response=eval("("+response+")")}else{response={}}}}else{response=doc}}settings.onComplete.call(self,file,response);toDeleteFlag=true;iframe.src="javascript:'<html></html>';"})},submit:function(){var self=this,settings=this._settings;if(!this._input||this._input.value===""){return}var file=fileFromPath(this._input.value);if(false===settings.onSubmit.call(this,file,getExt(file))){this._clearInput();return}var iframe=this._createIframe();var form=this._createForm(iframe);removeNode(this._input.parentNode);removeClass(self._button,self._settings.hoverClass);form.appendChild(this._input);form.submit();removeNode(form);form=null;removeNode(this._input);this._input=null;this._getResponse(iframe,file);this._createInput()}}})();(function(c,b,a,e){var d=c(b);c.fn.lazyload=function(f){var h=this;var i;var g={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:true,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};function j(){var k=0;h.each(function(){var l=c(this);if(g.skip_invisible&&!l.is(":visible")){return}if(c.abovethetop(this,g)||c.leftofbegin(this,g)){}else{if(!c.belowthefold(this,g)&&!c.rightoffold(this,g)){l.trigger("appear");k=0}else{if(++k>g.failure_limit){return false}}}})}if(f){if(e!==f.failurelimit){f.failure_limit=f.failurelimit;delete f.failurelimit}if(e!==f.effectspeed){f.effect_speed=f.effectspeed;delete f.effectspeed}c.extend(g,f)}i=(g.container===e||g.container===b)?d:c(g.container);if(0===g.event.indexOf("scroll")){i.bind(g.event,function(){return j()})}this.each(function(){var k=this;var l=c(k);k.loaded=false;if(l.attr("src")===e||l.attr("src")===false){if(l.is("img")){l.attr("src",g.placeholder)}}l.one("appear",function(){if(!this.loaded){if(g.appear){var m=h.length;g.appear.call(k,m,g)}c("<img />").bind("load",function(){var o=l.attr("data-"+g.data_attribute);l.hide();if(l.is("img")){l.attr("src",o)}else{l.css("background-image","url('"+o+"')")}l[g.effect](g.effect_speed);k.loaded=true;var n=c.grep(h,function(q){return !q.loaded});h=c(n);if(g.load){var p=h.length;g.load.call(k,p,g)}}).attr("src",l.attr("data-"+g.data_attribute))}});if(0!==g.event.indexOf("scroll")){l.bind(g.event,function(){if(!k.loaded){l.trigger("appear")}})}});d.bind("resize",function(){j()});if((/(?:iphone|ipod|ipad).*os 5/gi).test(navigator.appVersion)){d.bind("pageshow",function(k){if(k.originalEvent&&k.originalEvent.persisted){h.each(function(){c(this).trigger("appear")})}})}c(a).ready(function(){j()});return this};c.belowthefold=function(g,h){var f;if(h.container===e||h.container===b){f=(b.innerHeight?b.innerHeight:d.height())+d.scrollTop()}else{f=c(h.container).offset().top+c(h.container).height()}return f<=c(g).offset().top-h.threshold};c.rightoffold=function(g,h){var f;if(h.container===e||h.container===b){f=d.width()+d.scrollLeft()}else{f=c(h.container).offset().left+c(h.container).width()}return f<=c(g).offset().left-h.threshold};c.abovethetop=function(g,h){var f;if(h.container===e||h.container===b){f=d.scrollTop()}else{f=c(h.container).offset().top}return f>=c(g).offset().top+h.threshold+c(g).height()};c.leftofbegin=function(g,h){var f;if(h.container===e||h.container===b){f=d.scrollLeft()}else{f=c(h.container).offset().left}return f>=c(g).offset().left+h.threshold+c(g).width()};c.inviewport=function(f,g){return !c.rightoffold(f,g)&&!c.leftofbegin(f,g)&&!c.belowthefold(f,g)&&!c.abovethetop(f,g)};c.extend(c.expr[":"],{"below-the-fold":function(f){return c.belowthefold(f,{threshold:0})},"above-the-top":function(f){return !c.belowthefold(f,{threshold:0})},"right-of-screen":function(f){return c.rightoffold(f,{threshold:0})},"left-of-screen":function(f){return !c.rightoffold(f,{threshold:0})},"in-viewport":function(f){return c.inviewport(f,{threshold:0})},"above-the-fold":function(f){return !c.belowthefold(f,{threshold:0})},"right-of-fold":function(f){return c.rightoffold(f,{threshold:0})},"left-of-fold":function(f){return !c.rightoffold(f,{threshold:0})}})})(jQuery,window,document);