M.define("/js/Dropdown",function(c,b,d){function a(e){this.$nav=typeof e.nav==="string"?$(e.nav):e.nav;this.$panel=typeof e.panel==="string"?$(e.panel):e.panel;this.showCallback=e.showCallback;this.hideCallback=e.hideCallback;this.delay=e.delay||0;this.event=e.event||"mouseenterleave";this._isShow=false;this.init()}a.prototype={init:function(){if(this.event==="mouseenterleave"){this.$nav.on("mouseenter.dropdown",M.bind(function(e){this.show()},this)).on("mouseleave.dropdown",M.bind(function(e){if($(e.relatedTarget).closest(this.$panel).length===0){this.hide(true)}},this));this.$panel.on("mouseenter.dropdown",M.bind(function(e){this.show()},this)).on("mouseleave.dropdown",M.bind(function(e){if($(e.relatedTarget).closest(this.$nav).length===0){this.hide(false)}},this))}if(this.event==="click"){this.$nav.on("click.dropdown",M.bind(function(e){this.show()},this));$(document).on("click.dropdown",M.bind(function(e){if($(e.target).closest(this.$nav).length===0&&$(e.target).closest(this.$panel).length===0){this.hide(false)}},this))}},show:function(){this.$panel.show();this._isShow=true;if(M.isFunction(this.showCallback)){this.showCallback.call(this,this.$nav,this.$panel)}},hide:function(e){this._isShow=false;if(e&&this.delay>0){setTimeout(M.bind(function(){if(!this._isShow){this.$panel.hide();if(M.isFunction(this.hideCallback)){this.hideCallback.call(this,this.$nav,this.$panel)}}},this),this.delay)}else{this.$panel.hide();if(M.isFunction(this.hideCallback)){this.hideCallback.call(this,this.$nav,this.$panel)}}},destory:function(){if(this.event==="mouseenterleave"){this.$nav.off("mouseenter.dropdown").off("mouseleave.dropdown");this.$panel.off("mouseenter.dropdown").off("mouseleave.dropdown")}if(this.event==="click"){this.$nav.off("click.dropdown")}this.$panel.hide()}};d.exports=a});M.define("/js/pageletcommon/pageHeadUserInfoWWWNormal",function(c){var a=c("/js/Dropdown"),b=window.Env||{};return{events:{},init:function(){var k=$("#head-btn-daka");$(function(){$(".new_daka_tips").addClass("on")});$(".ndt_close").on("click",function(){$(this).parent().hide()});M.Event.on("afterDaka",l);function l(q){if(q&&q.dakaFlag){k.closest(".head-daka").addClass("daka-complete")}}var e=i("dakaday");if(e!==null){$(".head-btn-daka").attr("data-day",e)}function i(q){var s=new RegExp("(^|&)"+q+"=([^&]*)(&|$)");var t=window.location.search.substr(1).match(s);if(t!==null){return unescape(t[2])}return null}var g=new a({nav:"#_j_head_user",panel:"#_j_user_panel",showCallback:function(q,r){q.find(".drop-trigger").addClass("drop-trigger-active")},hideCallback:function(q,r){q.find(".drop-trigger").removeClass("drop-trigger-active")},delay:500});var d=0,p=$("#_j_head_msg"),o=$("#_j_msg_panel"),n=p.find(".head-msg-new"),j=$("#_j_msg_float_panel");var f=new a({nav:p.selector,panel:o.selector,showCallback:function(q,r){q.find(".drop-trigger").addClass("drop-trigger-active")},hideCallback:function(q,r){q.find(".drop-trigger").removeClass("drop-trigger-active")},delay:200});M.Event.on("get new msg",function(q){if(q.msg||d>0){o.find("ul").html(q.menu_index);h()}});o.on("click","a",function(q){M.Event.fire("update msg")});j.on("click","ul a",function(q){M.Event.fire("update msg")});j.on("click",".close-newmsg",function(q){m()});function m(){n.hide();j.hide();$.ajax({url:"http://"+b.WWW_HOST+"/ajax/ajax_msg.php",dataType:"jsonp",data:{a:"ignore",from:"1"},success:function(q){M.Event.fire("update msg")}})}window.close_msg_tips=m;function h(){var q="";d=0;o.find(".num").each(function(r,t){var s=$(t);d+=Number(s.html());q+="<li>"+s.closest("li").html()+"</li>"});if(d>0){n.html((d>99?"99+":d)).show();j.find("ul").html(q).end().show()}else{n.hide();j.hide()}}h()}}});
/*!
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright 2011, Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(i,f){var t=i.fn.domManip,h="_tmplitem",u=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,p={},e={},y,x={key:0,data:{}},w=0,q=0,g=[];function k(B,A,D,E){var C={data:E||(E===0||E===false)?E:(A?A.data:{}),_wrap:A?A._wrap:null,tmpl:null,parent:A||null,nodes:[],calls:c,nest:b,wrap:n,html:r,update:z};if(B){i.extend(C,B,{nodes:[],parent:A})}if(D){C.tmpl=D;C._ctnt=C._ctnt||C.tmpl(i,C);C.key=++w;(g.length?e:p)[w]=C}return C}i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(A,B){i.fn[A]=function(C){var F=[],I=i(C),E,G,D,J,H=this.length===1&&this[0].parentNode;y=p||{};if(H&&H.nodeType===11&&H.childNodes.length===1&&I.length===1){I[B](this[0]);F=this}else{for(G=0,D=I.length;G<D;G++){q=G;E=(G>0?this.clone(true):this).get();i(I[G])[B](E);F=F.concat(E)}q=0;F=this.pushStack(F,A,I.selector)}J=y;y=null;i.tmpl.complete(J);return F}});i.fn.extend({tmpl:function(C,B,A){return i.tmpl(this[0],C,B,A)},tmplItem:function(){return i.tmplItem(this[0])},template:function(A){return i.template(A,this[0])},domManip:function(E,H,G,I){if(E[0]&&i.isArray(E[0])){var B=i.makeArray(arguments),A=E[0],F=A.length,C=0,D;while(C<F&&!(D=i.data(A[C++],"tmplItem"))){}if(D&&q){B[2]=function(J){i.tmpl.afterManip(this,J,G)}}t.apply(this,B)}else{t.apply(this,arguments)}q=0;if(!y){i.tmpl.complete(p)}return this}});i.extend({tmpl:function(C,F,E,B){var D,A=!B;if(A){B=x;C=i.template[C]||i.template(null,C);e={}}else{if(!C){C=B.tmpl;p[B.key]=B;B.nodes=[];if(B.wrapped){s(B,B.wrapped)}return i(m(B,null,B.tmpl(i,B)))}}if(!C){return[]}if(typeof F==="function"){F=F.call(B||{})}if(E&&E.wrapped){s(E,E.wrapped)}D=i.isArray(F)?i.map(F,function(G){return G?k(E,B,C,G):null}):[k(E,B,C,F)];return A?i(m(B,null,D)):D},tmplItem:function(B){var A;if(B instanceof i){B=B[0]}while(B&&B.nodeType===1&&!(A=i.data(B,"tmplItem"))&&(B=B.parentNode)){}return A||x},template:function(B,A){if(A){if(typeof A==="string"){A=l(A)}else{if(A instanceof i){A=A[0]||{}}}if(A.nodeType){A=i.data(A,"tmpl")||i.data(A,"tmpl",l(A.innerHTML))}return typeof B==="string"?(i.template[B]=A):A}return B?(typeof B!=="string"?i.template(null,B):(i.template[B]||i.template(null,u.test(B)?B:i(B)))):null},encode:function(A){return(""+A).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});i.extend(i.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(A){p={}},afterManip:function v(C,A,D){var B=A.nodeType===11?i.makeArray(A.childNodes):A.nodeType===1?[A]:[];D.call(C,A);o(B);q++}});function m(A,E,C){var D,B=C?i.map(C,function(F){return(typeof F==="string")?(A.key?F.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+h+'="'+A.key+'" $2'):F):m(F,A,F._ctnt)}):A;if(E){return B}B=B.join("");B.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(G,H,F,I){D=i(F).get();o(D);if(H){D=a(H).concat(D)}if(I){D=D.concat(a(I))}});return D?D:a(B)}function a(B){var A=document.createElement("div");A.innerHTML=B;return i.makeArray(A.childNodes)}function l(A){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+i.trim(A).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(I,C,G,D,E,J,F){var L=i.tmpl.tag[G],B,H,K;if(!L){throw"Unknown template tag: "+G}B=L._default||[];if(J&&!/\w$/.test(E)){E+=J;J=""}if(E){E=j(E);F=F?(","+j(F)+")"):(J?")":"");H=J?(E.indexOf(".")>-1?E+j(J):("("+E+").call($item"+F)):E;K=J?H:"(typeof("+E+")==='function'?("+E+").call($item):("+E+"))"}else{K=H=B.$1||"null"}D=j(D);return"');"+L[C?"close":"open"].split("$notnull_1").join(E?"typeof("+E+")!=='undefined' && ("+E+")!=null":"true").split("$1a").join(K).split("$1").join(H).split("$2").join(D||B.$2||"")+"__.push('"})+"');}return __;")}function s(B,A){B._wrap=m(B,true,i.isArray(A)?A:[u.test(A)?A:i(A).html()]).join("")}function j(A){return A?A.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function d(A){var B=document.createElement("div");B.appendChild(A.cloneNode(true));return B.innerHTML}function o(G){var I="_"+q,B,A,E={},F,D,C;for(F=0,D=G.length;F<D;F++){if((B=G[F]).nodeType!==1){continue}A=B.getElementsByTagName("*");for(C=A.length-1;C>=0;C--){H(A[C])}H(B)}function H(P){var L,O=P,N,J,K;if((K=P.getAttribute(h))){while(O.parentNode&&(O=O.parentNode).nodeType===1&&!(L=O.getAttribute(h))){}if(L!==K){O=O.parentNode?(O.nodeType===11?0:(O.getAttribute(h)||0)):0;if(!(J=p[K])){J=e[K];J=k(J,p[O]||e[O]);J.key=++w;p[w]=J}if(q){Q(K)}}P.removeAttribute(h)}else{if(q&&(J=i.data(P,"tmplItem"))){Q(J.key);p[J.key]=J;O=i.data(P.parentNode,"tmplItem");O=O?O.key:0}}if(J){N=J;while(N&&N.key!=O){N.nodes.push(P);N=N.parent}delete J._ctnt;delete J._wrap;i.data(P,"tmplItem",J)}function Q(R){R=R+I;J=E[R]=(E[R]||k(J,p[J.parent.key+I]||J.parent))}}}function c(C,A,D,B){if(!C){return g.pop()}g.push({_:C,tmpl:A,item:this,data:D,options:B})}function b(A,C,B){return i.tmpl(i.template(A),C,B,this)}function n(C,A){var B=C.options||{};B.wrapped=A;return i.tmpl(i.template(C.tmpl),C.data,B,C.item)}function r(B,C){var A=this._wrap;return i.map(i(i.isArray(A)?A.join(""):A).filter(B||"*"),function(D){return C?D.innerText||D.textContent:D.outerHTML||d(D)})}function z(){var A=this.nodes;i.tmpl(null,null,null,this).insertBefore(A[0]);i(A).remove()}if(window.M&&typeof M.define=="function"){M.define("jq-tmpl",function(){return i})}})(jQuery);M.define("InputListener",function(c,b,d){var a={listen:function(f,e){f=$(f);f.each($.proxy(function(g,h){h=$(h);if(!h.is("input")&&!h.is("textarea")){throw new Error("input listener only apply to input or textarea")}this.initListen(h,e)},this))},unlisten:function(e){e=$(e);e.each($.proxy(function(h,k){k=$(k);if(!k.is("input")&&!k.is("textarea")){throw new Error("input listener only apply to input or textarea")}if(arguments.length==1){k.unbind("focus",this.getStartListenFunc());k.unbind("blur",this.getStopListenFunc());k.removeData("__input_listener_handlers")}else{if(typeof arguments[1]=="function"){var j=arguments[1],g=k.data("__input_listener_listeninterval");for(var h=0,f=g.length;h<f;h++){if(g[h]==j){g.splice(h,1);h--}}}}},this))},initListen:function(f,e){f.data("__input_listener_currentval",f.val());if(!f.data("__input_listener_handlers")){this.bindListenEvent(f)}this.addListenHandler(f,e);if(f.is(":focus")){f.blur();f.focus()}},bindListenEvent:function(e){e.data("__input_listener_handlers",[]);e.focus(this.getStartListenFunc());e.blur(this.getStopListenFunc())},getStartListenFunc:function(){if(!this.bindStartListenFunc){this.bindStartListenFunc=$.proxy(this.startListen,this)}return this.bindStartListenFunc},getStopListenFunc:function(){if(!this.bindStopListenFunc){this.bindStopListenFunc=$.proxy(this.stopListen,this)}return this.bindStopListenFunc},startListen:function(e){var f=$(e.target);f.data("__input_listener_currentval",f.val());f.data("__input_listener_listeninterval",setInterval($.proxy(function(){var h=f.data("__input_listener_currentval"),g=f.val();if(h!=g){f.data("__input_listener_currentval",g);this.triggerListenHandler(f)}},this),100))},stopListen:function(e){var f=$(e.target);clearInterval(f.data("__input_listener_listeninterval"))},addListenHandler:function(f,e){if(typeof e=="function"){f.data("__input_listener_handlers").push(e)}},triggerListenHandler:function(h){var f=h.data("__input_listener_handlers");for(var g=0,e=f.length;g<e;g++){f[g].call(null,{target:h.get(0)})}}};return a});M.define("SuggestionXHR",function(b,a,c){function d(e){this.URL=null;this.delay=200;this.dataType="text";$.extend(this,e);this.delayTimer=null;this.xhr=null;this.cache={};this.init()}d.prototype={init:function(){if(!this.URL){throw new Error("no url for suggestion")}},getSuggestion:function(g,h){var f=this.getQuery(g),e=this.cache[f];h=typeof h==="function"?h:$.noop;this.stop();if(e){h(e)}else{this.getXHRData(f,h)}},stop:function(){clearTimeout(this.delayTimer);if(this.xhr&&this.xhr.readyState!==4){this.xhr.abort()}},getQuery:function(h){var g="";if(typeof h=="string"){g=encodeURIComponent(h)}else{if(h&&typeof h=="object"){var e=[];for(var f in h){if(h.hasOwnProperty(f)){e.push(f+"="+encodeURIComponent(h[f]))}}g=e.join("&")}}return g},getXHRData:function(e,h){var f=this.xhr,g={url:this.URL,data:e,dataType:this.dataType,success:M.bind(function(i){h(i);this.cache[e]=i},this)};this.delayTimer=setTimeout(M.bind(function(){this.xhr=$.ajax(g)},this),this.delay)}};return d});M.define("DropList",function(c,b,d){var a=M.Event;function e(f){this.trigger=null;this.container=null;this.itemSelector="._j_listitem";this.itemHoverClass="on";this.firstItemHover=false;$.extend(this,f);this.trigger=$(this.trigger);this.container=$(this.container);this.mouseon=false;this.visible=false;this.init()}M.mix(e.prototype,{createContainer:$.noop,updateList:$.noop,init:function(){if(!this.trigger.length){M.error("no trigger for drop list")}if(!this.container.length){this.container=this.createContainer()}if(!this.container.length){M.error("no container for drop list")}this.bindEvents()},bindEvents:function(){this.trigger.on("keydown",$.proxy(function(g){var h=g.keyCode;if(this.visible&&h==13){var f=this.getFocusItem();if(f.length){this.selectItem(f);g.preventDefault()}}else{if(this.visible&&h==38){this.moveFocus(-1)}else{if(this.visible&&h==40){this.moveFocus(1)}}}},this));this.container.on("mouseenter",this.itemSelector,$.proxy(this.moveFocus,this)).on("click",this.itemSelector,$.proxy(this.clickItem,this)).on("mouseenter",$.proxy(this.mouseOverCnt,this)).on("mouseleave",$.proxy(this.mouseOutCnt,this))},show:function(g){this.updateList(g);this.container.show();if(this.firstItemHover){var f=this.container.find(this.itemSelector);if(f.length){this.moveFocus(1)}}this.visible=true},hide:function(){this.container.hide();this.visible=false},clickItem:function(g){var f=this.getFocusItem();this.selectItem(f);g.preventDefault()},selectItem:function(f){a(this).fire("itemselected",{item:f})},moveFocus:function(i){var h=this.container.find(this.itemSelector),j=this.getFocusItem(),g=j,f;if(i===-1){if(j.length){f=h.index(j)-1}if(!j.length||f==-1){g=h.last()}else{g=h.eq(f)}}else{if(i===1){if(j.length){f=h.index(j)+1}if(!j.length||f==h.length){g=h.first()}else{g=h.eq(f)}}else{if(i.currentTarget){g=$(i.currentTarget)}}}j.removeClass(this.itemHoverClass);g.addClass(this.itemHoverClass);a(this).fire("itemfocused",{prevItem:j,focusItem:g})},getFocusItem:function(){var f=this.container.find(this.itemSelector);return f.filter("."+this.itemHoverClass)},mouseOverCnt:function(){this.mouseon=true},mouseOutCnt:function(){this.mouseon=false}});return e});M.define("Suggestion",function(c){c("jq-tmpl");var a=c("InputListener");var b='{{each(i, item) list}}<li class="${listItemClass}" data-value="${item.value}">${item.text}</li>{{/each}}';function d(e){e.suggestionURL=e.url||$(e.input).data("suggestionurl");this.dropListClass="droplist";this.listItemSelector="._j_listitem";this.listItemHoverClass="on";this.listFirstItemHover=false;this.keyParamName="key";this.dataType="json";this.suggestionParams={};this.listContainer=null;M.mix(this,e);this.input=$(this.input);this.listTmpl=this.listTmpl||b;this.actOnList=false;this.init()}M.mix(d.prototype,{init:function(){a.listen(this.input,$.proxy(this.inputChange,this));this.input.blur($.proxy(function(f){var e=$(f.currentTarget);if(e.data("droplist")){setTimeout($.proxy(function(){if(!this.actOnList&&e.data("droplist")){e.data("droplist").hide()}this.actOnList=false},this),200)}},this));this.input.keyup($.proxy(function(f){var e=$(f.currentTarget);if(f.keyCode==40&&(!e.data("droplist")||!e.data("droplist").visible)){this.inputChange(f)}},this))},inputChange:function(i){var f=$(i.target),k=$.trim(f.val()),j=c("SuggestionXHR"),h=c("DropList");var g=f.data("droplist");if(!g){f.data("droplist",g=new h({trigger:f,itemSelector:this.listItemSelector,itemHoverClass:this.listItemHoverClass,firstItemHover:this.listFirstItemHover,container:this.listContainer,createContainer:$.proxy(function(){var l=this.createListContainer(f);this.listContainer=l;return l},this),updateList:$.proxy(this.updateList,this)}));M.Event(g).on("itemselected",$.proxy(function(l){this.dropItemSelected(f,l.item)},this));M.Event(g).on("itemfocused",$.proxy(function(l){M.Event(this).fire("itemfocused",l)},this))}g.hide=function(){setTimeout($.proxy(function(){if(M.windowFocused){this.container.hide();this.visible=false}},this),1)};var e=f.data("suggestion");if(!e){f.data("suggestion",e=new j({URL:this.suggestionURL,dataType:this.dataType}))}if(!k.length){e.stop();g.hide();M.Event(this).fire("after hide list")}else{this.suggestionParams[this.keyParamName]=k;M.Event(this).fire("before suggestion xhr");e.getSuggestion(this.suggestionParams,$.proxy(function(m){M.Event(this).fire("before show list");var l=this.handleSuggest(m);if(l){f.data("droplist").show(l)}},this))}},handleSuggest:function(f){var e="";if(this.dataType=="json"){e=$.tmpl(this.listTmpl,f)}return e},createListContainer:function(f){var g=$("<ul />"),e=f.position();g.css({display:"none",position:"absolute",left:e.left,top:e.top+f.outerHeight()}).addClass(this.dropListClass);g.insertAfter(f);return g},updateList:function(e){this.listContainer.html(e)},hideDropList:function(){this.input.data("droplist")&&this.input.data("droplist").hide()},dropItemSelected:function(e,f){a.unlisten(e);M.Event(this).fire("itemselected",{item:f,input:e});a.listen(e,$.proxy(this.inputChange,this))}});return d});M.define("MesSearchEvent",function(b,a,c){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(f,j){var l=e,h=[],g;j=j||l.length;if(f){for(g=0;g<f;g++){h[g]=l[0|Math.random()*j]}}else{var k;h[8]=h[13]=h[18]=h[23]="-";h[14]="4";for(g=0;g<36;g++){if(!h[g]){k=0|Math.random()*16;h[g]=l[(g==19)?(k&3)|8:k]}}}return h.join("")};Math.uuidFast=function(){var k=e,h=new Array(36),g=0,j;for(var f=0;f<36;f++){if(f==8||f==13||f==18||f==23){h[f]="-"}else{if(f==14){h[f]="4"}else{if(g<=2){g=33554432+(Math.random()*16777216)|0}j=g&15;g=g>>4;h[f]=k[(f==19)?(j&3)|8:j]}}}return h.join("")};Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){var g=Math.random()*16|0,f=h=="x"?g:(g&3|8);return f.toString(16)})};var d={uuid:function(){return Math.uuid()},search:function(f){var g=Math.uuid();f.id=g;!!mfwPageEvent&&mfwPageEvent("se","v2_search",f);return g},searchCache:function(f){var g=Math.uuid();f.id=g;!!mfwPageEvent&&mfwPageEvent("se","v2_search_cache",f);return g},resultClick:function(f){!!mfwPageEvent&&mfwPageEvent("se","v2_result_click",f);return f.id}};c.exports=d});M.define("/js/SiteSearch",function(e){var d="1.0.0",h=e("Suggestion"),f=e("MesSearchEvent"),g=M.cssSupport("transition"),b=M.cssSupport("transform"),c=window.Env||{};var a=function(C){var E=$("#"+C.input+""),T=!!C.submit?$("#"+C.submit+""):null,t=C.additionalClass?C.additionalClass:"",K=!!C.isRelevant,s=C.maxCount||0,z=C.hideOnScroll||false,n=false,J=false,i="",y="",l="",p="";if(C.input==="_j_index_search_input_all"){var H=[];if(E.val()===""&&H&&H.length){var S=Math.floor(Math.random()*H.length),I=H[S];E.val(I.name).data("url",I.url)}E.on("focus",function(V){if(E.data("url")){E.val("").data("url","")}})}if(c.is_async_site_search){n=true}var P=new h({url:(c.WWW_HOST?window.location.protocol+"//"+c.WWW_HOST:"")+"/search/ss.php",suggestionParams:{isHeader:Number(K)},input:E,listItemHoverClass:"active",listFirstItemHover:false,dataType:"jsonp",createListContainer:function(){var V=$('<div class="m-search-suggest '+t+' hide"><ul class="mss-list"></ul></div>').appendTo("body");V.on("mouseenter",".mss-place .mss-title, .mss-place .mss-nav a",function(X){var W=$(X.currentTarget),Y=W.closest(".mss-place");Y.find(".mss-title").removeClass("active").removeClass("frozen").end().find(".mss-nav a").removeClass("active").end();W.addClass("active")}).on("mouseleave",".mss-place .mss-title, .mss-place .mss-nav a",function(X){var W=$(X.currentTarget);W.removeClass("active")});return V},handleSuggest:function(aB){i=aB.keyword;J=!!aB.is_hit;l="http://"+aB.www_host;var aw=aB.keyword_cut,ay=aB.show_types,W=aB.hide_types;var aq=$("<ul>");var aa=aB.first_poi;if(!!aa){var al=aa,aj=$('<li class="mss-item _j_listitem" data-type="poi">').appendTo(aq),ao=$('<div class="mss-title">').appendTo(aj);aj.attr("data-url",al.url);ao.append('<span class="mss-fr">'+(!!al.mddname?al.mddname:"")+al.typename+"</span>");ao.append('<span class="mss-cn">'+al.dis_name+"</span>")}var ag=aB.article_info;if(ag&&ag.result){for(var ar=0;ar<ag.result.length;ar++){var af=ag.result[ar],aj=$('<li class="mss-item _j_listitem" data-type="article_promoted">').appendTo(aq),ao=$('<div class="mss-title">').appendTo(aj);aj.attr("data-url",af.link);ao.html(af.name_display)}}var ak=aB.mdd_info;if(ak&&ak.result){for(var ar=0;ar<ak.result.length;ar++){var Z=ak.result[ar],aj=$('<li class="mss-item _j_listitem" data-type="mdd">').appendTo(aq),ao=$('<div class="mss-title">').appendTo(aj);aj.attr("data-url",Z.url);if(!!Z.parent){ao.append('<span class="mss-fr">'+Z.parent+"</span>")}ao.append('<span class="mss-cn">'+Z.dis_name+"</span>");ao.append('<span class="mss-gl"> '+Z.infoname+"</span>")}}var an=aB.hotel_info;if(an&&an.result&&!K){for(var ar=0;ar<an.result.length;ar++){var az=an.result[ar],aj=$('<li class="mss-item _j_listitem" data-type="hotel_promoted">').appendTo(aq),ao=$('<div class="mss-title">').appendTo(aj);aj.attr("data-url",az.url);ao.append('<span class="mss-fr">'+az.typename+"</span>");ao.append('<span class="mss-cn">'+az.title+"</span>");ao.append('<span class="mss-gl"> '+az.infoname+"</span>")}}var ad=aB.gl_info;if(ad&&ad.result){for(var ar=0;ar<ad.result.length;ar++){var ap=ad.result[ar],aj=$('<li class="mss-item _j_listitem" data-type="sales_gonglve">').appendTo(aq),ao=$('<div class="mss-title">').appendTo(aj);aj.attr("data-url",ap.url);ao.append('<span class="mss-fr">'+ap.typename+"</span>");ao.append('<span class="mss-cn">'+ap.title+"</span>")}}var Y=aB.sales_info;if(Y&&Y.result&&!K){for(var ar=0;ar<Y.result.length;ar++){var V=Y.result[ar],aj=$('<li class="mss-item _j_listitem" data-type="sales_promoted">').appendTo(aq),ao=$('<div class="mss-title">').appendTo(aj);aj.attr("data-url",V.url);ao.append('<span class="mss-fr">'+V.typename+"</span>");ao.append('<span class="mss-cn">'+V.title+"</span>");ao.append('<span class="mss-gl"> '+V.infoname+"</span>")}}var ae=aB.route_info;if(ae&&ae.result&&!K){for(var ar=0;ar<ae.result.length;ar++){var ax=ae.result[ar],aj=$('<li class="mss-item _j_listitem" data-type="route_promoted">').appendTo(aq),ao=$('<div class="mss-title">').appendTo(aj);aj.attr("data-url",ax.url);ao.append('<span class="mss-fr">'+ax.typename+"</span>");ao.append('<span class="mss-cn">'+ax.title+"</span>");ao.append('<span class="mss-gl"> '+ax.infoname+"</span>")}}var at=aB.qa_info;if(at&&at.result){for(var ar=0;ar<at.result.length;ar++){var ah=at.result[ar],aj=$('<li class="mss-item _j_listitem" data-type="wenda">').appendTo(aq),ao=$('<div class="mss-title">').appendTo(aj);aj.attr("data-url",ah.url);ao.append('<span class="mss-fr">'+ah.typename+"</span>");ao.append('<span class="mss-cn">'+ah.title+"</span>")}}var ac=aB.poi_info,av=!K;if(M.isArray(ay)&&M.indexOf(ay,"poi")!==-1){av=true}if(ac&&ac.result&&av){for(var ar=0;ar<ac.result.length;ar++){var al=ac.result[ar],X="hotel"===al.stype?"hotel":"poi",aj=$('<li class="mss-item _j_listitem" data-type="'+X+'">').appendTo(aq),ao=$('<div class="mss-title">').appendTo(aj);aj.attr("data-url",al.url);ao.append('<span class="mss-fr">'+(!!al.mddname?al.mddname:"")+al.typename+"</span>");ao.append('<span class="mss-cn" style="color:#999;">'+al.dis_name+"</span>")}}var ai=aB.sekey_info,au=K;if(M.isArray(W)&&M.indexOf(W,"sekey")!==-1){au=false}if(ai&&ai.result&&au){for(var ar=0;ar<ai.result.length;ar++){if(ar>4){break}var aA=ai.result[ar],aj=$('<li class="mss-item _j_listitem" data-type="sekey">').appendTo(aq);aj.attr("data-url",aA.url);aj.append('<div class="mss-title">'+aA.name+"</div>")}}var ab=aB.ginfo_num;if(!!ab){var aj=$('<li class="mss-item _j_listitem" data-type="info">').appendTo(aq);aj.append('<div class="mss-title">搜“<span class="mss-key">'+aw+'</span>”相关游记<span class="mss-num">'+ab+"篇</span></div>")}var am=aB.user_num;if(!!ab){var aj=$('<li class="mss-item _j_listitem" data-type="user">').appendTo(aq);aj.append('<div class="mss-title">搜“<span class="mss-key">'+aw+"</span>”相关用户</div>")}if(s>0){aq.find("._j_listitem").each(function(aC,aD){if(aC>s){$(aD).remove()}})}return aq.html()},updateList:function(V){this.listContainer.find(".mss-list").html(V);if(K){this.listContainer.find(".mss-list").addClass("shrink-list")}if(J){P.input.data("droplist").moveFocus(1)}}});if(n){var A=e("InputListener"),w=e("SuggestionXHR"),D=new w({URL:(c.WWW_HOST?"http://"+c.WWW_HOST:"")+"/search/s.php",dataType:"json"}),v=$("#_j_mfw_search_main"),U=E.closest(".search-wrapper"),L=$('<div class="search-keyword-tip"></div>').appendTo(U),B=C.input==="_j_index_search_input_all",G=false,u,q,N,k,r;A.listen(E,function(W){var V=$(W.target),X=$.trim(V.val());if(!G&&X){G=true}L.hide()});M.Event(P).on("before suggestion xhr",function(){var V=P.suggestionParams[P.keyParamName];if(V&&V!==y){D.getSuggestion({q:V,gall:1},$.proxy(function(X){var ab=$.trim(E.val());if(!ab){return false}if(!X||!X.keyword||(!X.result&&!X.unmatch)){return false}if(X.unmatch===1){L.hide()}else{y=V;if(U[0]){var Y=X.keyword.length,W=X.keyword.replace(/[A-Za-z0-9\s]/g,"").length,aa=Y-W;setTimeout(function(){L.html(X.keyword).css("left",32+W*14+aa*7).show()},1)}v.html($(X.result).css("minHeight",0).html());if(g&&b){v.find("> .wid").addClass("anim-climb");setTimeout(function(){v.find("> .wid").removeClass("anim-climb")},1)}var Z=c.search_type||"all";c.search_seid=Q(V,Z);c.search_keyword=V;c.is_search_cache=true;c.is_search_updated=true}},P))}})}M.Event(P).on("before suggestion xhr",function(){R(E,P.listContainer)});M.Event(P).on("before show list",function(){P.listContainer.find(".mss-list").show()});M.Event(P).on("itemfocused",function(W){var V=W.prevItem,X=W.focusItem,Y=P.listContainer;if(1<Y.find(".mss-place").length){if(X.hasClass("mss-place")){Y.find(".mss-place").removeClass("frozen")}if(!X.hasClass("mss-place")&&!!V&&V.hasClass("mss-place")){Y.find(".mss-place").removeClass("frozen");V.addClass("frozen")}}if(X.hasClass("mss-place")){X.find(".mss-title").addClass("frozen")}});M.Event(P).on("itemselected",function(X){var Z=X.item;if(Z.length){var Y=Z.data("type"),W=Z.data("url"),ab=E.attr("id")==="_j_head_search_input"?"header":"default";if(Y==="flight_hotel"||Y==="flight"||Y==="local"){Y="sales"}p=m(i,"all",ab,"suggest");if("info"===Y||"user"===Y){var aa=m(i,Y,ab,"suggest");location.href=l+"/search/s.php?q="+encodeURIComponent(i)+"&t="+Y+"&seid="+aa}else{var W=Z.data("url"),V=P.listContainer.find(".mss-item").index(Z.closest(".mss-item"))+1;O(W,V,Y);location.href=Z.data("url")}}else{if(i!==""){location.href=l+"/search/s.php?q="+encodeURIComponent(i)}}});var x=E.closest(".head-search-wrapper");if(x[0]){E.on("focus",function(V){setTimeout(function(){x.addClass("head-search-focus")},1)}).on("blur",function(V){setTimeout(function(){if(M.windowFocused){x.removeClass("head-search-focus")}},1)})}if(T&&T[0]){T.on("click",function(X){var W=$.trim(E.val());if(E.data("url")){if(E.data("url").indexOf("http")!==-1){location.href=E.data("url")}else{location.href=(c.WWW_HOST?"http://"+c.WWW_HOST:"")+E.data("url")}return true}if(W!==""){if(P.listContainer){P.listContainer.hide()}var Z=E.attr("id")==="_j_head_search_input"?"header":"default",aa=c.search_type||"all",Y=m(W,aa,Z,"form"),V=l+"/search/s.php?q="+encodeURIComponent(W);if(c.search_type&&location.pathname==="/search/s.php"){V+="&t="+c.search_type}V+="&seid="+Y;location.href=V}})}if(E&&E[0]){E.on("keydown",function(X){if(X.keyCode==13){var aa=P.input.data("droplist");if(aa&&aa.getFocusItem().length){return true}var W=$.trim(E.val());if(W!==""){if(P.listContainer){P.listContainer.hide()}var Z=E.attr("id")==="_j_head_search_input"?"header":"default",ab=c.search_type||"all",Y=m(W,ab,Z,"form"),V=l+"/search/s.php?q="+encodeURIComponent(W);if(c.search_type&&location.pathname==="/search/s.php"){V+="&t="+c.search_type}V+="&seid="+Y;location.href=V}}})}$(window).resize(function(){if(P.listContainer&&P.listContainer.length&&P.listContainer.is(":visible")){R(E,P.listContainer)}});$(window).on("scroll",function(V){if(z){P.hideDropList()}});function R(V,X){var W=V.offset();X.css({left:W.left+(C.input==="_j_index_search_input_all"?0:1),top:W.top+E.outerHeight()-2})}function m(V,Z,Y,X){var W={keyword:V,content_category:Z,searchbox_category:"main_search",searchbox_position:Y,search_type:X,version:d};return f.search(W)}function Q(V,X){var W={keyword:V,content_category:X,version:d};return f.searchCache(W)}function O(Y,W,X){var V={id:p,keyword:i,click_url:Y,index:W,content_category:X,search_type:"suggest",version:d};return f.resultClick(V)}function F(W,aa){var X=[],ac=W.split("|");aa=j(aa);for(var Z=0;Z<ac.length;Z++){var Y=$.trim(ac[Z]);if(Y=="search://"){var V=X.length;X[V]=ac[Z++];X[V+1]=ac[Z++];X[V+2]=ac[Z++];X[V+3]=ac[Z++];X[V+4]=ac[Z++];X[V+5]=ac[Z];continue}if(Y){try{Y=Y.replace(new RegExp(aa,"ig"),function(ad){return'<span class="highlight">'+ad+"</span>"})}catch(ab){Y=Y.replace(aa,function(ad){return'<span class="highlight">'+ad+"</span>"})}X[X.length]=Y}}return X}var o=$("<div/>");function j(V){return o.text(V).html()}};return a});M.closure(function(c){var r=$("#header");if(!r.length){return false}var o=c("/js/Dropdown");var n=c("/js/SiteSearch");new n({input:"_j_head_search_input",submit:"_j_head_search_link",isRelevant:true});$("#_j_nav_sales").find("[data-sales-nav]").on("click",function(){var t=$(this).data("salesNav");mfwPageEvent("sales","index_sales_nav",{name:t})});if(!window.showBarFlag){$("._j_sales_nav_show").off("hover")}else{var b=0,p=0;$("._j_sales_nav_show").hover(function(){clearTimeout(b);p=setTimeout(function(){$("._j_sales_nav_show").addClass("head-nav-hover");$("._j_sales_top").fadeIn(300)},200)},function(){clearTimeout(p);b=setTimeout(function(){$("._j_sales_nav_show").removeClass("head-nav-hover");$("._j_sales_top").fadeOut(300)},200)})}var m=0,f=0;$("._j_shequ_nav_show").hover(function(){clearTimeout(m);f=setTimeout(function(){$("._j_shequ_nav_show").addClass("head-nav-hover");$("._j_shequ_top").fadeIn(300)},200)},function(){clearTimeout(f);m=setTimeout(function(){$("._j_shequ_nav_show").removeClass("head-nav-hover");$("._j_shequ_top").fadeOut(300)},200)});var q=$("#_j_community_panel"),i=q.find(".panel-image").length,j=Math.floor(Math.random()*i);if(j===i){j--}q.find(".panel-image").eq(j).show();$("#_j_showlogin").click(function(t){if(window.location.host===Env.WWW_HOST){t.preventDefault()}M.Event.fire("login:required")});var g=window.location.hostname,k=window.location.pathname+window.location.search,a=$("#_j_head_nav");if(g.indexOf("www")===0){if(k===""||k==="/"){a.children("li:eq(0)").addClass("head-nav-active")}var h=new RegExp("^/(mdd|photo/mdd|poi|photo/poi|travel-scenic-spot|jd|cy|gw|yl|yj|xc|baike)/|sFrom=mdd.*|sFrom=smdd.*","i");if(h.test(k)){a.children("li:eq(1)").addClass("head-nav-active")}var e=new RegExp("^/gonglve/.*","i");if(e.test(k)){a.children("li:eq(2)").addClass("head-nav-active")}var d=window.Env&&window.Env.sales_title_tag;if(d){if(d==="flight_hotel"){a.children("li:eq(3)").find("ul>li:eq(0)>a").addClass("on")}else{if(d==="visa"){a.children("li:eq(3)").find("ul>li:eq(2)>a").addClass("on")}else{if(d==="localdeals"){a.children("li:eq(3)").find("ul>li:eq(1)>a").addClass("on")}else{if(d==="insurance"){a.children("li:eq(3)").find("ul>li:eq(4)>a").addClass("on")}}}}a.find("li:eq(3)").addClass("head-nav-active")}if(/^\/insurance\//i.test(k)){a.find("li:eq(3)").addClass("head-nav-active")}var s=new RegExp("^/hotel/(?!.*sFrom=mdd).*","ig");if(s.test(k)){a.children("li:eq(4)").addClass("head-nav-active");a.children("li:eq(4)").find(".head-act616").remove()}var l=new RegExp("^/(wenda|qa|mall|together|group|i|traveller|rudder|paimai|club|postal|school|photo_pk|focus)/(?!.*sFrom=mdd|s.php*).*","i");if(l.test(k)){a.children("li:eq(5)").addClass("head-nav-active")}}});(function(c,d){c.fn.jPlayer=function(h){var g="jPlayer";var e=typeof h==="string",f=Array.prototype.slice.call(arguments,1),i=this;h=!e&&f.length?c.extend.apply(null,[true,h].concat(f)):h;if(e&&h.charAt(0)==="_"){return i}if(e){this.each(function(){var j=c.data(this,g),k=j&&c.isFunction(j[h])?j[h].apply(j,f):j;if(k!==j&&k!==d){i=k;return false}})}else{this.each(function(){var j=c.data(this,g);if(j){j.option(h||{})}else{c.data(this,g,new c.jPlayer(h,this))}})}return i};c.jPlayer=function(f,g){if(arguments.length){this.element=c(g);this.options=c.extend(true,{},this.options,f);var e=this;this.element.bind("remove.jPlayer",function(){e.destroy()});this._init()}};c.jPlayer.emulateMethods="load play pause";c.jPlayer.emulateStatus="src readyState networkState currentTime duration paused ended playbackRate";c.jPlayer.emulateOptions="muted volume";c.jPlayer.reservedEvent="ready flashreset resize repeat error warning";c.jPlayer.event={ready:"jPlayer_ready",flashreset:"jPlayer_flashreset",resize:"jPlayer_resize",repeat:"jPlayer_repeat",click:"jPlayer_click",error:"jPlayer_error",warning:"jPlayer_warning",loadstart:"jPlayer_loadstart",progress:"jPlayer_progress",suspend:"jPlayer_suspend",abort:"jPlayer_abort",emptied:"jPlayer_emptied",stalled:"jPlayer_stalled",play:"jPlayer_play",pause:"jPlayer_pause",loadedmetadata:"jPlayer_loadedmetadata",loadeddata:"jPlayer_loadeddata",waiting:"jPlayer_waiting",playing:"jPlayer_playing",canplay:"jPlayer_canplay",canplaythrough:"jPlayer_canplaythrough",seeking:"jPlayer_seeking",seeked:"jPlayer_seeked",timeupdate:"jPlayer_timeupdate",ended:"jPlayer_ended",ratechange:"jPlayer_ratechange",durationchange:"jPlayer_durationchange",volumechange:"jPlayer_volumechange"};c.jPlayer.htmlEvent=["loadstart","abort","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","ratechange"];c.jPlayer.pause=function(){c.each(c.jPlayer.prototype.instances,function(f,e){if(e.data("jPlayer").status.srcSet){e.jPlayer("pause")}})};c.jPlayer.timeFormat={showHour:false,showMin:true,showSec:true,padHour:false,padMin:true,padSec:true,sepHour:":",sepMin:":",sepSec:""};c.jPlayer.convertTime=function(j){var k=new Date(j*1000);var f=k.getUTCHours();var h=k.getUTCMinutes();var i=k.getUTCSeconds();var g=(c.jPlayer.timeFormat.padHour&&f<10)?"0"+f:f;var l=(c.jPlayer.timeFormat.padMin&&h<10)?"0"+h:h;var e=(c.jPlayer.timeFormat.padSec&&i<10)?"0"+i:i;return((c.jPlayer.timeFormat.showHour)?g+c.jPlayer.timeFormat.sepHour:"")+((c.jPlayer.timeFormat.showMin)?l+c.jPlayer.timeFormat.sepMin:"")+((c.jPlayer.timeFormat.showSec)?e+c.jPlayer.timeFormat.sepSec:"")};c.jPlayer.uaBrowser=function(j){var f=j.toLowerCase();var h=/(webkit)[ \/]([\w.]+)/;var k=/(opera)(?:.*version)?[ \/]([\w.]+)/;var g=/(msie) ([\w.]+)/;var i=/(mozilla)(?:.*? rv:([\w.]+))?/;var e=h.exec(f)||k.exec(f)||g.exec(f)||f.indexOf("compatible")<0&&i.exec(f)||[];return{browser:e[1]||"",version:e[2]||"0"}};c.jPlayer.uaPlatform=function(k){var h=k.toLowerCase();var l=/(ipad|iphone|ipod|android|blackberry|playbook|windows ce|webos)/;var j=/(ipad|playbook)/;var g=/(android)/;var i=/(mobile)/;var e=l.exec(h)||[];var f=j.exec(h)||!i.exec(h)&&g.exec(h)||[];if(e[1]){e[1]=e[1].replace(/\s/g,"_")}return{platform:e[1]||"",tablet:f[1]||""}};c.jPlayer.browser={};c.jPlayer.platform={};var b=c.jPlayer.uaBrowser(navigator.userAgent);if(b.browser){c.jPlayer.browser[b.browser]=true;c.jPlayer.browser.version=b.version}var a=c.jPlayer.uaPlatform(navigator.userAgent);if(a.platform){c.jPlayer.platform[a.platform]=true;c.jPlayer.platform.mobile=!a.tablet;c.jPlayer.platform.tablet=!!a.tablet}c.jPlayer.prototype={count:0,version:{script:"2.2.0",needFlash:"2.2.0",flash:"unknown"},options:{swfPath:"js",solution:"html, flash",supplied:"mp3",preload:"metadata",volume:0.8,muted:false,wmode:"opaque",backgroundColor:"#000000",cssSelectorAncestor:"#jp_container_1",cssSelector:{videoPlay:".jp-video-play",play:".jp-play",pause:".jp-pause",stop:".jp-stop",seekBar:".jp-seek-bar",playBar:".jp-play-bar",mute:".jp-mute",unmute:".jp-unmute",volumeBar:".jp-volume-bar",volumeBarValue:".jp-volume-bar-value",volumeMax:".jp-volume-max",currentTime:".jp-current-time",duration:".jp-duration",fullScreen:".jp-full-screen",restoreScreen:".jp-restore-screen",repeat:".jp-repeat",repeatOff:".jp-repeat-off",gui:".jp-gui",noSolution:".jp-no-solution"},fullScreen:false,autohide:{restored:false,full:true,fadeIn:200,fadeOut:600,hold:1000},loop:false,repeat:function(e){if(e.jPlayer.options.loop){c(this).unbind(".jPlayerRepeat").bind(c.jPlayer.event.ended+".jPlayer.jPlayerRepeat",function(){c(this).jPlayer("play")})}else{c(this).unbind(".jPlayerRepeat")}},nativeVideoControls:{},noFullScreen:{msie:/msie [0-6]/,ipad:/ipad.*?os [0-4]/,iphone:/iphone/,ipod:/ipod/,android_pad:/android [0-3](?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,webos:/webos/},noVolume:{ipad:/ipad/,iphone:/iphone/,ipod:/ipod/,android_pad:/android(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,webos:/webos/,playbook:/playbook/},verticalVolume:false,idPrefix:"jp",noConflict:"jQuery",emulateHtml:false,errorAlerts:false,warningAlerts:false},optionsAudio:{size:{width:"0px",height:"0px",cssClass:""},sizeFull:{width:"0px",height:"0px",cssClass:""}},optionsVideo:{size:{width:"480px",height:"270px",cssClass:"jp-video-270p"},sizeFull:{width:"100%",height:"100%",cssClass:"jp-video-full"}},instances:{},status:{src:"",media:{},paused:true,format:{},formatType:"",waitForPlay:true,waitForLoad:true,srcSet:false,video:false,seekPercent:0,currentPercentRelative:0,currentPercentAbsolute:0,currentTime:0,duration:0,readyState:0,networkState:0,playbackRate:1,ended:0},internal:{ready:false},solution:{html:true,flash:true},format:{mp3:{codec:'audio/mpeg; codecs="mp3"',flashCanPlay:true,media:"audio"},m4a:{codec:'audio/mp4; codecs="mp4a.40.2"',flashCanPlay:true,media:"audio"},oga:{codec:'audio/ogg; codecs="vorbis"',flashCanPlay:false,media:"audio"},wav:{codec:'audio/wav; codecs="1"',flashCanPlay:false,media:"audio"},webma:{codec:'audio/webm; codecs="vorbis"',flashCanPlay:false,media:"audio"},fla:{codec:"audio/x-flv",flashCanPlay:true,media:"audio"},rtmpa:{codec:'audio/rtmp; codecs="rtmp"',flashCanPlay:true,media:"audio"},m4v:{codec:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:true,media:"video"},ogv:{codec:'video/ogg; codecs="theora, vorbis"',flashCanPlay:false,media:"video"},webmv:{codec:'video/webm; codecs="vorbis, vp8"',flashCanPlay:false,media:"video"},flv:{codec:"video/x-flv",flashCanPlay:true,media:"video"},rtmpv:{codec:'video/rtmp; codecs="rtmp"',flashCanPlay:true,media:"video"}},_init:function(){var f=this;this.element.empty();this.status=c.extend({},this.status);this.internal=c.extend({},this.internal);this.internal.domNode=this.element.get(0);this.formats=[];this.solutions=[];this.require={};this.htmlElement={};this.html={};this.html.audio={};this.html.video={};this.flash={};this.css={};this.css.cs={};this.css.jq={};this.ancestorJq=[];this.options.volume=this._limitValue(this.options.volume,0,1);c.each(this.options.supplied.toLowerCase().split(","),function(o,i){var m=i.replace(/^\s+|\s+$/g,"");if(f.format[m]){var n=false;c.each(f.formats,function(q,p){if(m===p){n=true;return false}});if(!n){f.formats.push(m)}}});c.each(this.options.solution.toLowerCase().split(","),function(o,m){var i=m.replace(/^\s+|\s+$/g,"");if(f.solution[i]){var n=false;c.each(f.solutions,function(q,p){if(i===p){n=true;return false}});if(!n){f.solutions.push(i)}}});this.internal.instance="jp_"+this.count;this.instances[this.internal.instance]=this.element;if(!this.element.attr("id")){this.element.attr("id",this.options.idPrefix+"_jplayer_"+this.count)}this.internal.self=c.extend({},{id:this.element.attr("id"),jq:this.element});this.internal.audio=c.extend({},{id:this.options.idPrefix+"_audio_"+this.count,jq:d});this.internal.video=c.extend({},{id:this.options.idPrefix+"_video_"+this.count,jq:d});this.internal.flash=c.extend({},{id:this.options.idPrefix+"_flash_"+this.count,jq:d,swf:this.options.swfPath+(this.options.swfPath.toLowerCase().slice(-4)!==".swf"?(this.options.swfPath&&this.options.swfPath.slice(-1)!=="/"?"/":"")+"Jplayer.swf":"")});this.internal.poster=c.extend({},{id:this.options.idPrefix+"_poster_"+this.count,jq:d});c.each(c.jPlayer.event,function(i,m){if(f.options[i]!==d){f.element.bind(m+".jPlayer",f.options[i]);f.options[i]=d}});this.require.audio=false;this.require.video=false;c.each(this.formats,function(i,m){f.require[f.format[m].media]=true});if(this.require.video){this.options=c.extend(true,{},this.optionsVideo,this.options)}else{this.options=c.extend(true,{},this.optionsAudio,this.options)}this._setSize();this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls);this.status.noFullScreen=this._uaBlocklist(this.options.noFullScreen);this.status.noVolume=this._uaBlocklist(this.options.noVolume);this._restrictNativeVideoControls();this.htmlElement.poster=document.createElement("img");this.htmlElement.poster.id=this.internal.poster.id;this.htmlElement.poster.onload=function(){if(!f.status.video||f.status.waitForPlay){f.internal.poster.jq.show()}};this.element.append(this.htmlElement.poster);this.internal.poster.jq=c("#"+this.internal.poster.id);this.internal.poster.jq.css({width:this.status.width,height:this.status.height});this.internal.poster.jq.hide();this.internal.poster.jq.bind("click.jPlayer",function(){f._trigger(c.jPlayer.event.click)});this.html.audio.available=false;if(this.require.audio){this.htmlElement.audio=document.createElement("audio");this.htmlElement.audio.id=this.internal.audio.id;this.html.audio.available=!!this.htmlElement.audio.canPlayType&&this._testCanPlayType(this.htmlElement.audio)}this.html.video.available=false;if(this.require.video){this.htmlElement.video=document.createElement("video");this.htmlElement.video.id=this.internal.video.id;this.html.video.available=!!this.htmlElement.video.canPlayType&&this._testCanPlayType(this.htmlElement.video)}this.flash.available=this._checkForFlash(10);this.html.canPlay={};this.flash.canPlay={};c.each(this.formats,function(i,m){f.html.canPlay[m]=f.html[f.format[m].media].available&&""!==f.htmlElement[f.format[m].media].canPlayType(f.format[m].codec);f.flash.canPlay[m]=f.format[m].flashCanPlay&&f.flash.available});this.html.desired=false;this.flash.desired=false;c.each(this.solutions,function(n,i){if(n===0){f[i].desired=true}else{var o=false;var m=false;c.each(f.formats,function(p,q){if(f[f.solutions[0]].canPlay[q]){if(f.format[q].media==="video"){m=true}else{o=true}}});f[i].desired=(f.require.audio&&!o)||(f.require.video&&!m)}});this.html.support={};this.flash.support={};c.each(this.formats,function(i,m){f.html.support[m]=f.html.canPlay[m]&&f.html.desired;f.flash.support[m]=f.flash.canPlay[m]&&f.flash.desired});this.html.used=false;this.flash.used=false;c.each(this.solutions,function(m,i){c.each(f.formats,function(n,o){if(f[i].support[o]){f[i].used=true;return false}})});this._resetActive();this._resetGate();this._cssSelectorAncestor(this.options.cssSelectorAncestor);if(!(this.html.used||this.flash.used)){this._error({type:c.jPlayer.error.NO_SOLUTION,context:"{solution:'"+this.options.solution+"', supplied:'"+this.options.supplied+"'}",message:c.jPlayer.errorMsg.NO_SOLUTION,hint:c.jPlayer.errorHint.NO_SOLUTION});if(this.css.jq.noSolution.length){this.css.jq.noSolution.show()}}else{if(this.css.jq.noSolution.length){this.css.jq.noSolution.hide()}}if(this.flash.used){var j,k="jQuery="+encodeURI(this.options.noConflict)+"&id="+encodeURI(this.internal.self.id)+"&vol="+this.options.volume+"&muted="+this.options.muted;if(c.jPlayer.browser.msie&&Number(c.jPlayer.browser.version)<=8){var e='<object id="'+this.internal.flash.id+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="0" height="0"></object>';var h=['<param name="movie" value="'+this.internal.flash.swf+'" />','<param name="FlashVars" value="'+k+'" />','<param name="allowScriptAccess" value="always" />','<param name="bgcolor" value="'+this.options.backgroundColor+'" />','<param name="wmode" value="'+this.options.wmode+'" />'];j=document.createElement(e);for(var g=0;g<h.length;g++){j.appendChild(document.createElement(h[g]))}}else{var l=function(m,q,i){var o=document.createElement("param");o.setAttribute("name",q);o.setAttribute("value",i);m.appendChild(o)};j=document.createElement("object");j.setAttribute("id",this.internal.flash.id);j.setAttribute("data",this.internal.flash.swf);j.setAttribute("type","application/x-shockwave-flash");j.setAttribute("width","1");j.setAttribute("height","1");l(j,"flashvars",k);l(j,"allowscriptaccess","always");l(j,"bgcolor",this.options.backgroundColor);l(j,"wmode",this.options.wmode)}this.element.append(j);this.internal.flash.jq=c(j)}if(this.html.used){if(this.html.audio.available){this._addHtmlEventListeners(this.htmlElement.audio,this.html.audio);this.element.append(this.htmlElement.audio);this.internal.audio.jq=c("#"+this.internal.audio.id)}if(this.html.video.available){this._addHtmlEventListeners(this.htmlElement.video,this.html.video);this.element.append(this.htmlElement.video);this.internal.video.jq=c("#"+this.internal.video.id);if(this.status.nativeVideoControls){this.internal.video.jq.css({width:this.status.width,height:this.status.height})}else{this.internal.video.jq.css({width:"0px",height:"0px"})}this.internal.video.jq.bind("click.jPlayer",function(){f._trigger(c.jPlayer.event.click)})}}if(this.options.emulateHtml){this._emulateHtmlBridge()}if(this.html.used&&!this.flash.used){setTimeout(function(){f.internal.ready=true;f.version.flash="n/a";f._trigger(c.jPlayer.event.repeat);f._trigger(c.jPlayer.event.ready)},100)}this._updateNativeVideoControls();this._updateInterface();this._updateButtons(false);this._updateAutohide();this._updateVolume(this.options.volume);this._updateMute(this.options.muted);if(this.css.jq.videoPlay.length){this.css.jq.videoPlay.hide()}c.jPlayer.prototype.count++},destroy:function(){this.clearMedia();this._removeUiClass();if(this.css.jq.currentTime.length){this.css.jq.currentTime.text("")}if(this.css.jq.duration.length){this.css.jq.duration.text("")}c.each(this.css.jq,function(e,f){if(f.length){f.unbind(".jPlayer")}});this.internal.poster.jq.unbind(".jPlayer");if(this.internal.video.jq){this.internal.video.jq.unbind(".jPlayer")}if(this.options.emulateHtml){this._destroyHtmlBridge()}this.element.removeData("jPlayer");this.element.unbind(".jPlayer");this.element.empty();delete this.instances[this.internal.instance]},enable:function(){},disable:function(){},_testCanPlayType:function(f){try{f.canPlayType(this.format.mp3.codec);return true}catch(e){return false}},_uaBlocklist:function(f){var e=navigator.userAgent.toLowerCase(),g=false;c.each(f,function(i,h){if(h&&h.test(e)){g=true;return false}});return g},_restrictNativeVideoControls:function(){if(this.require.audio){if(this.status.nativeVideoControls){this.status.nativeVideoControls=false;this.status.noFullScreen=true}}},_updateNativeVideoControls:function(){if(this.html.video.available&&this.html.used){this.htmlElement.video.controls=this.status.nativeVideoControls;this._updateAutohide();if(this.status.nativeVideoControls&&this.require.video){this.internal.poster.jq.hide();this.internal.video.jq.css({width:this.status.width,height:this.status.height})}else{if(this.status.waitForPlay&&this.status.video){this.internal.poster.jq.show();this.internal.video.jq.css({width:"0px",height:"0px"})}}}},_addHtmlEventListeners:function(e,g){var f=this;e.preload=this.options.preload;e.muted=this.options.muted;e.volume=this.options.volume;e.addEventListener("progress",function(){if(g.gate){f._getHtmlStatus(e);f._updateInterface();f._trigger(c.jPlayer.event.progress)}},false);e.addEventListener("timeupdate",function(){if(g.gate){f._getHtmlStatus(e);f._updateInterface();f._trigger(c.jPlayer.event.timeupdate)}},false);e.addEventListener("durationchange",function(){if(g.gate){f._getHtmlStatus(e);f._updateInterface();f._trigger(c.jPlayer.event.durationchange)}},false);e.addEventListener("play",function(){if(g.gate){f._updateButtons(true);f._html_checkWaitForPlay();f._trigger(c.jPlayer.event.play)}},false);e.addEventListener("playing",function(){if(g.gate){f._updateButtons(true);f._seeked();f._trigger(c.jPlayer.event.playing)}},false);e.addEventListener("pause",function(){if(g.gate){f._updateButtons(false);f._trigger(c.jPlayer.event.pause)}},false);e.addEventListener("waiting",function(){if(g.gate){f._seeking();f._trigger(c.jPlayer.event.waiting)}},false);e.addEventListener("seeking",function(){if(g.gate){f._seeking();f._trigger(c.jPlayer.event.seeking)}},false);e.addEventListener("seeked",function(){if(g.gate){f._seeked();f._trigger(c.jPlayer.event.seeked)}},false);e.addEventListener("volumechange",function(){if(g.gate){f.options.volume=e.volume;f.options.muted=e.muted;f._updateMute();f._updateVolume();f._trigger(c.jPlayer.event.volumechange)}},false);e.addEventListener("suspend",function(){if(g.gate){f._seeked();f._trigger(c.jPlayer.event.suspend)}},false);e.addEventListener("ended",function(){if(g.gate){if(!c.jPlayer.browser.webkit){f.htmlElement.media.currentTime=0}f.htmlElement.media.pause();f._updateButtons(false);f._getHtmlStatus(e,true);f._updateInterface();f._trigger(c.jPlayer.event.ended)}},false);e.addEventListener("error",function(){if(g.gate){f._updateButtons(false);f._seeked();if(f.status.srcSet){clearTimeout(f.internal.htmlDlyCmdId);f.status.waitForLoad=true;f.status.waitForPlay=true;if(f.status.video&&!f.status.nativeVideoControls){f.internal.video.jq.css({width:"0px",height:"0px"})}if(f._validString(f.status.media.poster)&&!f.status.nativeVideoControls){f.internal.poster.jq.show()}if(f.css.jq.videoPlay.length){f.css.jq.videoPlay.show()}f._error({type:c.jPlayer.error.URL,context:f.status.src,message:c.jPlayer.errorMsg.URL,hint:c.jPlayer.errorHint.URL})}}},false);c.each(c.jPlayer.htmlEvent,function(j,h){e.addEventListener(this,function(){if(g.gate){f._trigger(c.jPlayer.event[h])}},false)})},_getHtmlStatus:function(i,f){var e=0,g=0,h=0,j=0;if(isFinite(i.duration)){this.status.duration=i.duration}e=i.currentTime;g=(this.status.duration>0)?100*e/this.status.duration:0;if((typeof i.seekable==="object")&&(i.seekable.length>0)){h=(this.status.duration>0)?100*i.seekable.end(i.seekable.length-1)/this.status.duration:100;j=(this.status.duration>0)?100*i.currentTime/i.seekable.end(i.seekable.length-1):0}else{h=100;j=g}if(f){e=0;j=0;g=0}this.status.seekPercent=h;this.status.currentPercentRelative=j;this.status.currentPercentAbsolute=g;this.status.currentTime=e;this.status.readyState=i.readyState;this.status.networkState=i.networkState;this.status.playbackRate=i.playbackRate;this.status.ended=i.ended},_resetStatus:function(){this.status=c.extend({},this.status,c.jPlayer.prototype.status)},_trigger:function(f,e,g){var h=c.Event(f);h.jPlayer={};h.jPlayer.version=c.extend({},this.version);h.jPlayer.options=c.extend(true,{},this.options);h.jPlayer.status=c.extend(true,{},this.status);h.jPlayer.html=c.extend(true,{},this.html);h.jPlayer.flash=c.extend(true,{},this.flash);if(e){h.jPlayer.error=c.extend({},e)}if(g){h.jPlayer.warning=c.extend({},g)}this.element.trigger(h)},jPlayerFlashEvent:function(g,e){if(g===c.jPlayer.event.ready){if(!this.internal.ready){this.internal.ready=true;this.internal.flash.jq.css({width:"0px",height:"0px"});this.version.flash=e.version;if(this.version.needFlash!==this.version.flash){this._error({type:c.jPlayer.error.VERSION,context:this.version.flash,message:c.jPlayer.errorMsg.VERSION+this.version.flash,hint:c.jPlayer.errorHint.VERSION})}this._trigger(c.jPlayer.event.repeat);this._trigger(g)}else{if(this.flash.gate){if(this.status.srcSet){var h=this.status.currentTime,f=this.status.paused;this.setMedia(this.status.media);if(h>0){if(f){this.pause(h)}else{this.play(h)}}}this._trigger(c.jPlayer.event.flashreset)}}}if(this.flash.gate){switch(g){case c.jPlayer.event.progress:this._getFlashStatus(e);this._updateInterface();this._trigger(g);break;case c.jPlayer.event.timeupdate:this._getFlashStatus(e);this._updateInterface();this._trigger(g);break;case c.jPlayer.event.play:this._seeked();this._updateButtons(true);this._trigger(g);break;case c.jPlayer.event.pause:this._updateButtons(false);this._trigger(g);break;case c.jPlayer.event.ended:this._updateButtons(false);this._trigger(g);break;case c.jPlayer.event.click:this._trigger(g);break;case c.jPlayer.event.error:this.status.waitForLoad=true;this.status.waitForPlay=true;if(this.status.video){this.internal.flash.jq.css({width:"0px",height:"0px"})}if(this._validString(this.status.media.poster)){this.internal.poster.jq.show()}if(this.css.jq.videoPlay.length&&this.status.video){this.css.jq.videoPlay.show()}if(this.status.video){this._flash_setVideo(this.status.media)}else{this._flash_setAudio(this.status.media)}this._updateButtons(false);this._error({type:c.jPlayer.error.URL,context:e.src,message:c.jPlayer.errorMsg.URL,hint:c.jPlayer.errorHint.URL});break;case c.jPlayer.event.seeking:this._seeking();this._trigger(g);break;case c.jPlayer.event.seeked:this._seeked();this._trigger(g);break;case c.jPlayer.event.ready:break;default:this._trigger(g)}}return false},_getFlashStatus:function(e){this.status.seekPercent=e.seekPercent;this.status.currentPercentRelative=e.currentPercentRelative;this.status.currentPercentAbsolute=e.currentPercentAbsolute;this.status.currentTime=e.currentTime;this.status.duration=e.duration;this.status.readyState=4;this.status.networkState=0;this.status.playbackRate=1;this.status.ended=false},_updateButtons:function(e){if(e!==d){this.status.paused=!e;if(this.css.jq.play.length&&this.css.jq.pause.length){if(e){this.css.jq.play.hide();this.css.jq.pause.show()}else{this.css.jq.play.show();this.css.jq.pause.hide()}}}if(this.css.jq.restoreScreen.length&&this.css.jq.fullScreen.length){if(this.status.noFullScreen){this.css.jq.fullScreen.hide();this.css.jq.restoreScreen.hide()}else{if(this.options.fullScreen){this.css.jq.fullScreen.hide();this.css.jq.restoreScreen.show()}else{this.css.jq.fullScreen.show();this.css.jq.restoreScreen.hide()}}}if(this.css.jq.repeat.length&&this.css.jq.repeatOff.length){if(this.options.loop){this.css.jq.repeat.hide();this.css.jq.repeatOff.show()}else{this.css.jq.repeat.show();this.css.jq.repeatOff.hide()}}},_updateInterface:function(){if(this.css.jq.seekBar.length){this.css.jq.seekBar.width(this.status.seekPercent+"%")}if(this.css.jq.playBar.length){this.css.jq.playBar.width(this.status.currentPercentRelative+"%")}if(this.css.jq.currentTime.length){this.css.jq.currentTime.text(c.jPlayer.convertTime(this.status.currentTime))}if(this.css.jq.duration.length){this.css.jq.duration.text(c.jPlayer.convertTime(this.status.duration))}},_seeking:function(){if(this.css.jq.seekBar.length){this.css.jq.seekBar.addClass("jp-seeking-bg")}},_seeked:function(){if(this.css.jq.seekBar.length){this.css.jq.seekBar.removeClass("jp-seeking-bg")}},_resetGate:function(){this.html.audio.gate=false;this.html.video.gate=false;this.flash.gate=false},_resetActive:function(){this.html.active=false;this.flash.active=false},setMedia:function(g){var f=this,e=false,h=this.status.media.poster!==g.poster;this._resetMedia();this._resetGate();this._resetActive();c.each(this.formats,function(i,k){var j=f.format[k].media==="video";c.each(f.solutions,function(m,l){if(f[l].support[k]&&f._validString(g[k])){var n=l==="html";if(j){if(n){f.html.video.gate=true;f._html_setVideo(g);f.html.active=true}else{f.flash.gate=true;f._flash_setVideo(g);f.flash.active=true}if(f.css.jq.videoPlay.length){f.css.jq.videoPlay.show()}f.status.video=true}else{if(n){f.html.audio.gate=true;f._html_setAudio(g);f.html.active=true}else{f.flash.gate=true;f._flash_setAudio(g);f.flash.active=true}if(f.css.jq.videoPlay.length){f.css.jq.videoPlay.hide()}f.status.video=false}e=true;return false}});if(e){return false}});if(e){if(!(this.status.nativeVideoControls&&this.html.video.gate)){if(this._validString(g.poster)){if(h){this.htmlElement.poster.src=g.poster}else{this.internal.poster.jq.show()}}}this.status.srcSet=true;this.status.media=c.extend({},g);this._updateButtons(false);this._updateInterface()}else{this._error({type:c.jPlayer.error.NO_SUPPORT,context:"{supplied:'"+this.options.supplied+"'}",message:c.jPlayer.errorMsg.NO_SUPPORT,hint:c.jPlayer.errorHint.NO_SUPPORT})}},_resetMedia:function(){this._resetStatus();this._updateButtons(false);this._updateInterface();this._seeked();this.internal.poster.jq.hide();clearTimeout(this.internal.htmlDlyCmdId);if(this.html.active){this._html_resetMedia()}else{if(this.flash.active){this._flash_resetMedia()}}},clearMedia:function(){this._resetMedia();if(this.html.active){this._html_clearMedia()}else{if(this.flash.active){this._flash_clearMedia()}}this._resetGate();this._resetActive()},load:function(){if(this.status.srcSet){if(this.html.active){this._html_load()}else{if(this.flash.active){this._flash_load()}}}else{this._urlNotSetError("load")}},play:function(e){e=(typeof e==="number")?e:NaN;if(this.status.srcSet){if(this.html.active){this._html_play(e)}else{if(this.flash.active){this._flash_play(e)}}}else{this._urlNotSetError("play")}},videoPlay:function(){this.play()},pause:function(e){e=(typeof e==="number")?e:NaN;if(this.status.srcSet){if(this.html.active){this._html_pause(e)}else{if(this.flash.active){this._flash_pause(e)}}}else{this._urlNotSetError("pause")}},pauseOthers:function(){var e=this;c.each(this.instances,function(g,f){if(e.element!==f){if(f.data("jPlayer").status.srcSet){f.jPlayer("pause")}}})},stop:function(){if(this.status.srcSet){if(this.html.active){this._html_pause(0)}else{if(this.flash.active){this._flash_pause(0)}}}else{this._urlNotSetError("stop")}},stopOthers:function(){var e=this;c.each(this.instances,function(g,f){if(e.element!==f){if(f.data("jPlayer").status.srcSet){f.jPlayer("stop")}}})},playHead:function(e){e=this._limitValue(e,0,100);if(this.status.srcSet){if(this.html.active){this._html_playHead(e)}else{if(this.flash.active){this._flash_playHead(e)}}}else{this._urlNotSetError("playHead")}},_muted:function(e){this.options.muted=e;if(this.html.used){this._html_mute(e)}if(this.flash.used){this._flash_mute(e)}if(!this.html.video.gate&&!this.html.audio.gate){this._updateMute(e);this._updateVolume(this.options.volume);this._trigger(c.jPlayer.event.volumechange)}},mute:function(e){e=e===d?true:!!e;this._muted(e)},unmute:function(e){e=e===d?true:!!e;this._muted(!e)},_updateMute:function(e){if(e===d){e=this.options.muted}if(this.css.jq.mute.length&&this.css.jq.unmute.length){if(this.status.noVolume){this.css.jq.mute.hide();this.css.jq.unmute.hide()}else{if(e){this.css.jq.mute.hide();this.css.jq.unmute.show()}else{this.css.jq.mute.show();this.css.jq.unmute.hide()}}}},volume:function(e){e=this._limitValue(e,0,1);this.options.volume=e;if(this.html.used){this._html_volume(e)}if(this.flash.used){this._flash_volume(e)}if(!this.html.video.gate&&!this.html.audio.gate){this._updateVolume(e);this._trigger(c.jPlayer.event.volumechange)}},volumeBar:function(j){if(this.css.jq.volumeBar.length){var k=this.css.jq.volumeBar.offset(),f=j.pageX-k.left,g=this.css.jq.volumeBar.width(),l=this.css.jq.volumeBar.height()-j.pageY+k.top,i=this.css.jq.volumeBar.height();if(this.options.verticalVolume){this.volume(l/i)}else{this.volume(f/g)}}if(this.options.muted){this._muted(false)}},volumeBarValue:function(f){this.volumeBar(f)},_updateVolume:function(e){if(e===d){e=this.options.volume}e=this.options.muted?0:e;if(this.status.noVolume){if(this.css.jq.volumeBar.length){this.css.jq.volumeBar.hide()}if(this.css.jq.volumeBarValue.length){this.css.jq.volumeBarValue.hide()}if(this.css.jq.volumeMax.length){this.css.jq.volumeMax.hide()}}else{if(this.css.jq.volumeBar.length){this.css.jq.volumeBar.show()}if(this.css.jq.volumeBarValue.length){this.css.jq.volumeBarValue.show();this.css.jq.volumeBarValue[this.options.verticalVolume?"height":"width"]((e*100)+"%")}if(this.css.jq.volumeMax.length){this.css.jq.volumeMax.show()}}},volumeMax:function(){this.volume(1);if(this.options.muted){this._muted(false)}},_cssSelectorAncestor:function(f){var e=this;this.options.cssSelectorAncestor=f;this._removeUiClass();this.ancestorJq=f?c(f):[];if(f&&this.ancestorJq.length!==1){this._warning({type:c.jPlayer.warning.CSS_SELECTOR_COUNT,context:f,message:c.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.ancestorJq.length+" found for cssSelectorAncestor.",hint:c.jPlayer.warningHint.CSS_SELECTOR_COUNT})}this._addUiClass();c.each(this.options.cssSelector,function(g,h){e._cssSelector(g,h)})},_cssSelector:function(g,h){var e=this;if(typeof h==="string"){if(c.jPlayer.prototype.options.cssSelector[g]){if(this.css.jq[g]&&this.css.jq[g].length){this.css.jq[g].unbind(".jPlayer")}this.options.cssSelector[g]=h;this.css.cs[g]=this.options.cssSelectorAncestor+" "+h;if(h){this.css.jq[g]=c(this.css.cs[g])}else{this.css.jq[g]=[]}if(this.css.jq[g].length){var f=function(i){e[g](i);c(this).blur();return false};this.css.jq[g].bind("click.jPlayer",f)}if(h&&this.css.jq[g].length!==1){this._warning({type:c.jPlayer.warning.CSS_SELECTOR_COUNT,context:this.css.cs[g],message:c.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.css.jq[g].length+" found for "+g+" method.",hint:c.jPlayer.warningHint.CSS_SELECTOR_COUNT})}}else{this._warning({type:c.jPlayer.warning.CSS_SELECTOR_METHOD,context:g,message:c.jPlayer.warningMsg.CSS_SELECTOR_METHOD,hint:c.jPlayer.warningHint.CSS_SELECTOR_METHOD})}}else{this._warning({type:c.jPlayer.warning.CSS_SELECTOR_STRING,context:h,message:c.jPlayer.warningMsg.CSS_SELECTOR_STRING,hint:c.jPlayer.warningHint.CSS_SELECTOR_STRING})}},seekBar:function(i){if(this.css.jq.seekBar){var j=this.css.jq.seekBar.offset();var f=i.pageX-j.left;var g=this.css.jq.seekBar.width();var h=100*f/g;this.playHead(h)}},playBar:function(f){this.seekBar(f)},repeat:function(){this._loop(true)},repeatOff:function(){this._loop(false)},_loop:function(e){if(this.options.loop!==e){this.options.loop=e;this._updateButtons();this._trigger(c.jPlayer.event.repeat)}},currentTime:function(){},duration:function(){},gui:function(){},noSolution:function(){},option:function(k,n){var f=k;if(arguments.length===0){return c.extend(true,{},this.options)}if(typeof k==="string"){var m=k.split(".");if(n===d){var h=c.extend(true,{},this.options);for(var g=0;g<m.length;g++){if(h[m[g]]!==d){h=h[m[g]]}else{this._warning({type:c.jPlayer.warning.OPTION_KEY,context:k,message:c.jPlayer.warningMsg.OPTION_KEY,hint:c.jPlayer.warningHint.OPTION_KEY});return d}}return h}f={};var l=f;for(var e=0;e<m.length;e++){if(e<m.length-1){l[m[e]]={};l=l[m[e]]}else{l[m[e]]=n}}}this._setOptions(f);return this},_setOptions:function(f){var e=this;c.each(f,function(g,h){e._setOption(g,h)});return this},_setOption:function(f,g){var e=this;switch(f){case"volume":this.volume(g);break;case"muted":this._muted(g);break;case"cssSelectorAncestor":this._cssSelectorAncestor(g);break;case"cssSelector":c.each(g,function(h,i){e._cssSelector(h,i)});break;case"fullScreen":if(this.options[f]!==g){this._removeUiClass();this.options[f]=g;this._refreshSize()}break;case"size":if(!this.options.fullScreen&&this.options[f].cssClass!==g.cssClass){this._removeUiClass()}this.options[f]=c.extend({},this.options[f],g);this._refreshSize();break;case"sizeFull":if(this.options.fullScreen&&this.options[f].cssClass!==g.cssClass){this._removeUiClass()}this.options[f]=c.extend({},this.options[f],g);this._refreshSize();break;case"autohide":this.options[f]=c.extend({},this.options[f],g);this._updateAutohide();break;case"loop":this._loop(g);break;case"nativeVideoControls":this.options[f]=c.extend({},this.options[f],g);this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls);this._restrictNativeVideoControls();this._updateNativeVideoControls();break;case"noFullScreen":this.options[f]=c.extend({},this.options[f],g);this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls);this.status.noFullScreen=this._uaBlocklist(this.options.noFullScreen);this._restrictNativeVideoControls();this._updateButtons();break;case"noVolume":this.options[f]=c.extend({},this.options[f],g);this.status.noVolume=this._uaBlocklist(this.options.noVolume);this._updateVolume();this._updateMute();break;case"emulateHtml":if(this.options[f]!==g){this.options[f]=g;if(g){this._emulateHtmlBridge()}else{this._destroyHtmlBridge()}}break}return this},_refreshSize:function(){this._setSize();this._addUiClass();this._updateSize();this._updateButtons();this._updateAutohide();this._trigger(c.jPlayer.event.resize)},_setSize:function(){if(this.options.fullScreen){this.status.width=this.options.sizeFull.width;this.status.height=this.options.sizeFull.height;this.status.cssClass=this.options.sizeFull.cssClass}else{this.status.width=this.options.size.width;this.status.height=this.options.size.height;this.status.cssClass=this.options.size.cssClass}this.element.css({width:this.status.width,height:this.status.height})},_addUiClass:function(){if(this.ancestorJq.length){this.ancestorJq.addClass(this.status.cssClass)}},_removeUiClass:function(){if(this.ancestorJq.length){this.ancestorJq.removeClass(this.status.cssClass)}},_updateSize:function(){this.internal.poster.jq.css({width:this.status.width,height:this.status.height});if(!this.status.waitForPlay&&this.html.active&&this.status.video||this.html.video.available&&this.html.used&&this.status.nativeVideoControls){this.internal.video.jq.css({width:this.status.width,height:this.status.height})}else{if(!this.status.waitForPlay&&this.flash.active&&this.status.video){this.internal.flash.jq.css({width:this.status.width,height:this.status.height})}}},_updateAutohide:function(){var e=this,i="mousemove.jPlayer",h=".jPlayerAutohide",f=i+h,g=function(){e.css.jq.gui.fadeIn(e.options.autohide.fadeIn,function(){clearTimeout(e.internal.autohideId);e.internal.autohideId=setTimeout(function(){e.css.jq.gui.fadeOut(e.options.autohide.fadeOut)},e.options.autohide.hold)})};if(this.css.jq.gui.length){this.css.jq.gui.stop(true,true);clearTimeout(this.internal.autohideId);this.element.unbind(h);this.css.jq.gui.unbind(h);if(!this.status.nativeVideoControls){if(this.options.fullScreen&&this.options.autohide.full||!this.options.fullScreen&&this.options.autohide.restored){this.element.bind(f,g);this.css.jq.gui.bind(f,g);this.css.jq.gui.hide()}else{this.css.jq.gui.show()}}else{this.css.jq.gui.hide()}}},fullScreen:function(){this._setOption("fullScreen",true)},restoreScreen:function(){this._setOption("fullScreen",false)},_html_initMedia:function(){this.htmlElement.media.src=this.status.src;if(this.options.preload!=="none"){this._html_load()}this._trigger(c.jPlayer.event.timeupdate)},_html_setAudio:function(f){var e=this;c.each(this.formats,function(g,h){if(e.html.support[h]&&f[h]){e.status.src=f[h];e.status.format[h]=true;e.status.formatType=h;return false}});this.htmlElement.media=this.htmlElement.audio;this._html_initMedia()},_html_setVideo:function(f){var e=this;c.each(this.formats,function(g,h){if(e.html.support[h]&&f[h]){e.status.src=f[h];e.status.format[h]=true;e.status.formatType=h;return false}});if(this.status.nativeVideoControls){this.htmlElement.video.poster=this._validString(f.poster)?f.poster:""}this.htmlElement.media=this.htmlElement.video;this._html_initMedia()},_html_resetMedia:function(){if(this.htmlElement.media){if(this.htmlElement.media.id===this.internal.video.id&&!this.status.nativeVideoControls){this.internal.video.jq.css({width:"0px",height:"0px"})}this.htmlElement.media.pause()}},_html_clearMedia:function(){if(this.htmlElement.media){this.htmlElement.media.src="";this.htmlElement.media.load()}},_html_load:function(){if(this.status.waitForLoad){this.status.waitForLoad=false;this.htmlElement.media.load()}clearTimeout(this.internal.htmlDlyCmdId)},_html_play:function(g){var e=this;this._html_load();this.htmlElement.media.play();if(!isNaN(g)){try{this.htmlElement.media.currentTime=g}catch(f){this.internal.htmlDlyCmdId=setTimeout(function(){e.play(g)},100);return}}this._html_checkWaitForPlay()},_html_pause:function(g){var e=this;if(g>0){this._html_load()}else{clearTimeout(this.internal.htmlDlyCmdId)}this.htmlElement.media.pause();if(!isNaN(g)){try{this.htmlElement.media.currentTime=g}catch(f){this.internal.htmlDlyCmdId=setTimeout(function(){e.pause(g)},100);return}}if(g>0){this._html_checkWaitForPlay()}},_html_playHead:function(g){var e=this;this._html_load();try{if((typeof this.htmlElement.media.seekable==="object")&&(this.htmlElement.media.seekable.length>0)){this.htmlElement.media.currentTime=g*this.htmlElement.media.seekable.end(this.htmlElement.media.seekable.length-1)/100}else{if(this.htmlElement.media.duration>0&&!isNaN(this.htmlElement.media.duration)){this.htmlElement.media.currentTime=g*this.htmlElement.media.duration/100}else{throw"e"}}}catch(f){this.internal.htmlDlyCmdId=setTimeout(function(){e.playHead(g)},100);return}if(!this.status.waitForLoad){this._html_checkWaitForPlay()}},_html_checkWaitForPlay:function(){if(this.status.waitForPlay){this.status.waitForPlay=false;if(this.css.jq.videoPlay.length){this.css.jq.videoPlay.hide()}if(this.status.video){this.internal.poster.jq.hide();this.internal.video.jq.css({width:this.status.width,height:this.status.height})}}},_html_volume:function(e){if(this.html.audio.available){this.htmlElement.audio.volume=e}if(this.html.video.available){this.htmlElement.video.volume=e}},_html_mute:function(e){if(this.html.audio.available){this.htmlElement.audio.muted=e}if(this.html.video.available){this.htmlElement.video.muted=e}},_flash_setAudio:function(g){var e=this;try{c.each(this.formats,function(h,i){if(e.flash.support[i]&&g[i]){switch(i){case"m4a":case"fla":e._getMovie().fl_setAudio_m4a(g[i]);break;case"mp3":e._getMovie().fl_setAudio_mp3(g[i]);break;case"rtmpa":e._getMovie().fl_setAudio_rtmp(g[i]);break}e.status.src=g[i];e.status.format[i]=true;e.status.formatType=i;return false}});if(this.options.preload==="auto"){this._flash_load();this.status.waitForLoad=false}}catch(f){this._flashError(f)}},_flash_setVideo:function(g){var e=this;try{c.each(this.formats,function(h,i){if(e.flash.support[i]&&g[i]){switch(i){case"m4v":case"flv":e._getMovie().fl_setVideo_m4v(g[i]);break;case"rtmpv":e._getMovie().fl_setVideo_rtmp(g[i]);break}e.status.src=g[i];e.status.format[i]=true;e.status.formatType=i;return false}});if(this.options.preload==="auto"){this._flash_load();this.status.waitForLoad=false}}catch(f){this._flashError(f)}},_flash_resetMedia:function(){this.internal.flash.jq.css({width:"0px",height:"0px"});this._flash_pause(NaN)},_flash_clearMedia:function(){try{this._getMovie().fl_clearMedia()}catch(e){this._flashError(e)}},_flash_load:function(){try{this._getMovie().fl_load()}catch(e){this._flashError(e)}this.status.waitForLoad=false},_flash_play:function(f){try{this._getMovie().fl_play(f)}catch(e){this._flashError(e)}this.status.waitForLoad=false;this._flash_checkWaitForPlay()},_flash_pause:function(f){try{this._getMovie().fl_pause(f)}catch(e){this._flashError(e)}if(f>0){this.status.waitForLoad=false;this._flash_checkWaitForPlay()}},_flash_playHead:function(f){try{this._getMovie().fl_play_head(f)}catch(e){this._flashError(e)}if(!this.status.waitForLoad){this._flash_checkWaitForPlay()}},_flash_checkWaitForPlay:function(){if(this.status.waitForPlay){this.status.waitForPlay=false;if(this.css.jq.videoPlay.length){this.css.jq.videoPlay.hide()}if(this.status.video){this.internal.poster.jq.hide();this.internal.flash.jq.css({width:this.status.width,height:this.status.height})}}},_flash_volume:function(e){try{this._getMovie().fl_volume(e)}catch(f){this._flashError(f)}},_flash_mute:function(e){try{this._getMovie().fl_mute(e)}catch(f){this._flashError(f)}},_getMovie:function(){return document[this.internal.flash.id]},_checkForFlash:function(g){var f=false;var i;if(window.ActiveXObject){try{i=new ActiveXObject(("ShockwaveFlash.ShockwaveFlash."+g));f=true}catch(j){}}else{if(navigator.plugins&&navigator.mimeTypes.length>0){i=navigator.plugins["Shockwave Flash"];if(i){var h=navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/,"$1");if(h>=g){f=true}}}}return f},_validString:function(e){return(e&&typeof e==="string")},_limitValue:function(g,f,e){return(g<f)?f:((g>e)?e:g)},_urlNotSetError:function(e){this._error({type:c.jPlayer.error.URL_NOT_SET,context:e,message:c.jPlayer.errorMsg.URL_NOT_SET,hint:c.jPlayer.errorHint.URL_NOT_SET})},_flashError:function(e){var f;if(!this.internal.ready){f="FLASH"}else{f="FLASH_DISABLED"}this._error({type:c.jPlayer.error[f],context:this.internal.flash.swf,message:c.jPlayer.errorMsg[f]+e.message,hint:c.jPlayer.errorHint[f]});this.internal.flash.jq.css({width:"1px",height:"1px"})},_error:function(e){this._trigger(c.jPlayer.event.error,e);if(this.options.errorAlerts){this._alert("Error!"+(e.message?"\n\n"+e.message:"")+(e.hint?"\n\n"+e.hint:"")+"\n\nContext: "+e.context)}},_warning:function(e){this._trigger(c.jPlayer.event.warning,d,e);if(this.options.warningAlerts){this._alert("Warning!"+(e.message?"\n\n"+e.message:"")+(e.hint?"\n\n"+e.hint:"")+"\n\nContext: "+e.context)}},_alert:function(e){alert("jPlayer "+this.version.script+" : id='"+this.internal.self.id+"' : "+e)},_emulateHtmlBridge:function(){var e=this;c.each(c.jPlayer.emulateMethods.split(/\s+/g),function(g,f){e.internal.domNode[f]=function(h){e[f](h)}});c.each(c.jPlayer.event,function(g,h){var f=true;c.each(c.jPlayer.reservedEvent.split(/\s+/g),function(k,j){if(j===g){f=false;return false}});if(f){e.element.bind(h+".jPlayer.jPlayerHtml",function(){e._emulateHtmlUpdate();var i=document.createEvent("Event");i.initEvent(g,false,true);e.internal.domNode.dispatchEvent(i)})}})},_emulateHtmlUpdate:function(){var e=this;c.each(c.jPlayer.emulateStatus.split(/\s+/g),function(g,f){e.internal.domNode[f]=e.status[f]});c.each(c.jPlayer.emulateOptions.split(/\s+/g),function(g,f){e.internal.domNode[f]=e.options[f]})},_destroyHtmlBridge:function(){var e=this;this.element.unbind(".jPlayerHtml");var f=c.jPlayer.emulateMethods+" "+c.jPlayer.emulateStatus+" "+c.jPlayer.emulateOptions;c.each(f.split(/\s+/g),function(h,g){delete e.internal.domNode[g]})}};c.jPlayer.error={FLASH:"e_flash",FLASH_DISABLED:"e_flash_disabled",NO_SOLUTION:"e_no_solution",NO_SUPPORT:"e_no_support",URL:"e_url",URL_NOT_SET:"e_url_not_set",VERSION:"e_version"};c.jPlayer.errorMsg={FLASH:"jPlayer's Flash fallback is not configured correctly, or a command was issued before the jPlayer Ready event. Details: ",FLASH_DISABLED:"jPlayer's Flash fallback has been disabled by the browser due to the CSS rules you have used. Details: ",NO_SOLUTION:"No solution can be found by jPlayer in this browser. Neither HTML nor Flash can be used.",NO_SUPPORT:"It is not possible to play any media format provided in setMedia() on this browser using your current options.",URL:"Media URL could not be loaded.",URL_NOT_SET:"Attempt to issue media playback commands, while no media url is set.",VERSION:"jPlayer "+c.jPlayer.prototype.version.script+" needs Jplayer.swf version "+c.jPlayer.prototype.version.needFlash+" but found "};c.jPlayer.errorHint={FLASH:"Check your swfPath option and that Jplayer.swf is there.",FLASH_DISABLED:"Check that you have not display:none; the jPlayer entity or any ancestor.",NO_SOLUTION:"Review the jPlayer options: support and supplied.",NO_SUPPORT:"Video or audio formats defined in the supplied option are missing.",URL:"Check media URL is valid.",URL_NOT_SET:"Use setMedia() to set the media URL.",VERSION:"Update jPlayer files."};c.jPlayer.warning={CSS_SELECTOR_COUNT:"e_css_selector_count",CSS_SELECTOR_METHOD:"e_css_selector_method",CSS_SELECTOR_STRING:"e_css_selector_string",OPTION_KEY:"e_option_key"};c.jPlayer.warningMsg={CSS_SELECTOR_COUNT:"The number of css selectors found did not equal one: ",CSS_SELECTOR_METHOD:"The methodName given in jPlayer('cssSelector') is not a valid jPlayer method.",CSS_SELECTOR_STRING:"The methodCssSelector given in jPlayer('cssSelector') is not a String or is empty.",OPTION_KEY:"The option requested in jPlayer('option') is undefined."};c.jPlayer.warningHint={CSS_SELECTOR_COUNT:"Check your css selector and the ancestor.",CSS_SELECTOR_METHOD:"Check your method name.",CSS_SELECTOR_STRING:"Check your css selector is a string.",OPTION_KEY:"Check your option name."}})(jQuery);if(window.M&&typeof window.M.define=="function"){window.M.define("/js/jquery.jplayer.js",function(){return jQuery})}M.define("TopTip",function(b,a,c){c.exports={show:function(d){var d=$('<div id="over_container"><div id="over_message">'+d+"</div></div>").appendTo("body");setTimeout(function(){d.hide("fast",function(){d.remove()})},3000)}}});M.define("dialog/Layer",function(a){var g=0,f=550,d=(function(){return $.browser&&$.browser.msie&&parseInt($.browser.version,10)==7}()),c=(function(){return $.browser&&$.browser.msie&&parseInt($.browser.version,10)<7}());function b(){return g++}function e(h){this.opacity=0.8;this.background="#fff";this.impl="Dialog";this.fixed=true;M.mix(this,h);this.id="_j_layer_"+b();this.stacks=[];this.activeStackId=null;this.overflow=false;this.changeFixed=false;e.instances[this.id]=this;if(!e[this.impl]){e[this.impl]=[]}e[this.impl].push(this.id);this.init()}e.prototype={init:function(){this._createPanel()},_createPanel:function(){f++;var h={position:(!c&&this.fixed)?"fixed":"absolute",width:"100%",height:"100%",top:0,left:0},j=M.mix({},h,{"z-index":f,display:"none"}),k=M.mix({},h,{position:!c?"fixed":"absolute",background:this.background,opacity:this.opacity,"z-index":-1}),i=M.mix({},h,{"z-index":0},(!c&&this.fixed)?{"overflow-x":"hidden","overflow-y":"hidden"}:{overflow:"visible"});this._panel=$('<div id="'+this.id+'" class="layer _j_layer">                                <div class="layer_mask _j_mask"></div>                                <div class="layer_content _j_content"></div>                            </div>').css(j).appendTo("body");this._mask=this._panel.children("._j_mask").css(k);this._content=this._panel.children("._j_content").css(i)},setZIndex:function(h){f=h;this._panel.css("z-index",f)},getZIndex:function(){return +this._panel.css("z-index")},toFront:function(){this.setZIndex(f+1)},setFixed:function(h){h=!!h;if(this.fixed!=h){this.changeFixed=true;this.fixed=h;if(!c&&this.fixed){this._panel.css("position","fixed");this._content.css({position:"fixed","overflow-x":"hidden","overflow-y":"hidden"})}else{this._panel.css("position","absolute");this._content.css({position:"absolute","overflow-x":"","overflow-y":"",overflow:"visible"})}}else{this.changeFixed=false}},newStack:function(i){var h=$(i).appendTo(this._content);this.stacks.push(h);return this.stacks.length-1},getStack:function(h){return this.stacks[h]},getActiveStack:function(){return this.stacks[this.activeStackId]},setActiveStack:function(h){this.activeStackId=h},getPanel:function(){return this._panel},getMask:function(){return this._mask},getContent:function(){return this._content},show:function(j){var i=this;if(this.visible){typeof j==="function"&&j();return}e.activeId=this.id;this.visible=true;if(c){var h=document.documentElement&&document.documentElement.scrollHeight||document.body.scrollHeight;this._panel.css("height",h);this._mask.css("height",h)}this._panel.fadeIn(200,function(){typeof j==="function"&&j()})},hide:function(i){var h=this;if(!this.visible){typeof i==="function"&&i();return}this.visible=false;if(c){this._panel.css("height","");this._mask.css("height","")}this._panel.fadeOut(200,function(){typeof i==="function"&&i();h._recoverTopScroller()})},setOverFlow:function(h){this.overflow=h;if(h){if(!c&&this.fixed){this._hideTopScroller();this._content.css("overflow-y","auto")}}else{if(!c&&this.fixed){this._content.css("overflow-y","hidden")}}},_hideTopScroller:function(){if(d){$("html").css("overflow","hidden")}else{if(!c){$("body").css("overflow","hidden")}else{$("body").css("overflow-x","hidden");this._panel.height($(document).height()+20)}}},_recoverTopScroller:function(){if(d){$("html").css("overflow","")}else{if(!c){$("body").css("overflow","")}else{$("body").css("overflow-x","")}}},destroy:function(){this.hide($.proxy(function(){this._panel&&this._panel.remove();this._panel=null;if(M.indexOf(e[this.impl],this.id)!=-1){e[this.impl].splice(M.indexOf(e[this.impl],this.id),1)}delete e.instances[this.id]},this))},clear:function(){this._content.empty();this.stacks=[];this.activeStackId=null}};e.instances={};e.activeId=null;e.getInstance=function(h){return e.instances[h]};e.getActive=function(h){var i=e.getInstance(e.activeId);if(h&&i){i=i.impl===h?i:null}return i};e.getImplInstance=function(i){var h=e.getActive(i);if(!h&&M.is(e[i],"Array")&&e[i].length){h=e.getInstance(e[i][e[i].length-1])}return h};e.closeActive=function(){var h=e.getActive();if(h&&h.getActiveStack()){h.getActiveStack().trigger("close")}};$(document).keyup(function(h){if(h.keyCode==27){e.closeActive()}});$(document).unload(function(){M.forEach(e.instances,function(){e.destroy()})});return e});M.define("dialog/DialogBase",function(b){var e=b("dialog/Layer"),a=M.Event,d=(function(){return $.browser&&$.browser.msie&&parseInt($.browser.version,10)<7}());function c(f){this.newLayer=false;this.width="";this.height="";this.background="#000";this.panelBackground="#fff";this.bgOpacity=0.7;this.stackable=true;this.fixed=true;this.reposition=false;this.autoPosition=true;this.minTopOffset=20;this.layerZIndex=-1;this.impl="Dialog";M.mix(this,f);this.visible=false;this.destroyed=false;this.positioned=false;this.resizeTimer=0;this.init()}c.prototype={tpl:"<div />",init:function(){this._createDialog();this._bindEvents()},_createDialog:function(){this._panel=$(this.tpl).css({position:"absolute",opacity:0,display:"none",background:this.panelBackground,"z-index":0});this.setRect({width:this.width,height:this.height});this._layer=!this.newLayer&&e.getImplInstance(this.impl)||new e({impl:this.impl});if(this.layerZIndex>=0){this._layer.setZIndex(this.layerZIndex)}this._layer.setFixed(this.fixed);this._layer.getMask().css({background:this.background,opacity:this.bgOpacity});this._stackId=this._layer.newStack(this._panel);this.setPanelContent()},_bindEvents:function(){var f=this;$(window).resize($.proxy(this.resizePosition,this));M.Event(this).on("resize",$.proxy(this.resizePosition,this));this._panel.delegate("._j_close, a[data-dialog-button]","click",function(g){var h=$(g.currentTarget).attr("data-dialog-button");if(h=="hide"){f.hide()}else{f.close()}g.preventDefault()});this._panel.bind("close",function(g,h){f.close(h)})},resizePosition:function(){var f=this;clearTimeout(this.resizeTimer);if(f.visible&&f.autoPosition){this.resizeTimer=setTimeout(function(){f.setPosition()},100)}},addClass:function(f){this._panel.addClass(f)},removeClass:function(f){this._panel.removeClass(f)},setRect:function(f){if(f.width){this._panel.css("width",f.width);this.width=f.width}if(f.height){this._panel.css("height",f.height);this.height=f.height}},getPanel:function(){return this._panel},getLayer:function(){return this._layer},getMask:function(){return this._layer&&this._layer.getMask()},setPanelContent:function(){},_getPanelRect:function(){var f=this.getPanel(),g=f.outerHeight(),h=f.outerWidth();if(!f.is(":visible")){f.css({visibility:"hidden",display:"block"});var g=f.outerHeight(),h=f.outerWidth();f.css({visibility:"",display:""})}return{height:g,width:h}},_getNumric:function(f){f=parseInt(f,10);return isNaN(f)?0:f},setPosition:function(f){var g=this._getPanelRect(),h={width:$(window).width(),height:$(window).height()};var k=(h.width-(this._getNumric(this.width)>0?this._getNumric(this.width):g.width))/2,j=(h.height-(this._getNumric(this.height)>0?this._getNumric(this.height):g.height))*4/9;j=j<this.minTopOffset?this.minTopOffset:j;if(d||!this.fixed){var i=$(window).scrollTop();if(i>0){j+=i}}f={left:(f&&f.left)||k,top:(f&&f.top)||j};if(!d&&this.fixed){if(h.height-g.height<=f.top){this.getPanel().addClass("dialog_overflow");this._layer.setOverFlow(true)}else{this.getPanel().removeClass("dialog_overflow");this._layer.setOverFlow(false)}}var l=this.positioned?"animate":"css";$.fn[l].call(this.getPanel(),f,200);this.positioned=true;this.position=f},setFixed:function(f){this.fixed=!!f;this._layer.setFixed(this.fixed)},getPosition:function(){return this.position},show:function(f){if(this.visible){return}var h=this;a(this).fire("beforeshow");var g;if(this._layer.getActiveStack()){g=this._layer.getActiveStack();if(!this.reposition&&!f&&!this._layer.changeFixed){f=this._layer.getActiveStack().position()}}this._layer.show();this.getPanel().css({display:"","z-index":1});this.setPosition(f);g&&g.trigger("close",[true]);this.visible=true;this._layer.setActiveStack(this._stackId);this.getPanel().animate({opacity:1},{queue:false,duration:200,complete:function(){a(h).fire("aftershow")}})},close:function(){var f=this.stackable?"hide":"destroy";this[f].apply(this,Array.prototype.slice.call(arguments))},hide:function(g,f){if(typeof g=="function"){f=g;g=undefined}if(!this.visible){typeof f=="function"&&f();return}a(this).fire("beforeclose");a(this).fire("beforehide");this._layer.setActiveStack(null);this.visible=false;if(!g){this._layer.hide()}this.getPanel().animate({opacity:0},{queue:false,duration:200,complete:$.proxy(function(){this.getPanel().css({display:"none","z-index":0});a(this).fire("afterhide");a(this).fire("afterclose");typeof f=="function"&&f()},this)})},destroy:function(g,f){if(typeof g=="function"){f=g;g=undefined}if(this.destroyed){M.error("Dialog already destroyed!");typeof f=="function"&&f();return}a(this).fire("beforeclose");a(this).fire("beforedestroy");this.destroyed=true;this.hide(g,$.proxy(function(){if(this._panel.length){this._panel.undelegate();this._panel.unbind();this._panel.remove();this._panel=null}this._layer=null;a(this).fire("afterdestroy");a(this).fire("afterclose");typeof f=="function"&&f()},this))}};return c});M.define("dialog/Dialog",function(c){var d=c("dialog/DialogBase"),a='<div class="popup-box layer_dialog _j_dialog pop_no_margin">                    <div class="dialog_title" style="display:none"><div class="_j_title title"></div></div>                    <div class="dialog_body _j_content"></div>                    <a id="popup_close" class="close-btn _j_close"><i></i></a>                </div>';var b=M.extend(function(e){this.content="";this.title="";this.PANEL_CLASS="";this.MASK_CLASS="";b.$parent.call(this,e)},d);M.mix(b.prototype,{tpl:a,setPanelContent:function(){this._dialogTitle=this._panel.find("._j_title");this._dialogContent=this._panel.find("._j_content");this.setTitle(this.title);this.setContent(this.content);this.addClass(this.PANEL_CLASS);this.getMask().addClass(this.MASK_CLASS)},setTitle:function(e){if(e){this._dialogTitle.html(e).parent().css("display","")}else{this._dialogTitle.parent().css("display","none")}this.title=e},getTitle:function(){return this.title},setContent:function(e){this._dialogContent.empty().append(e)}});return b});M.define("dialog/alert",function(e,d){var b=e("dialog/Dialog"),a='<div id="popup_container" class="popup-box new-popbox"><a class="close-btn _j_close"><i></i></a><div class="pop-ico" id="_j_alertpopicon"><i class="i1"></i></div><div class="pop-ctn"><p class="hd _j_content"></p><p class="bd _j_detail"></p></div><div class="pop-btns"><a role="button" tabindex="0" class="popbtn popbtn-submit _j_close">&nbsp;确定&nbsp;</a></div></div>',f=M.extend(function(j){var i={width:420,content:"请输入内容",background:"#000",bgOpacity:0.7,PANEL_CLASS:"pop_no_margin",reposition:true,impl:"Alert",layerZIndex:10000};j=M.mix(i,j);f.$parent.call(this,j);this.bindEvents()},b),g=null,h=$.noop;M.mix(f.prototype,{tpl:a,setAlertTitle:function(i){this.setContent(i)},setAlertContent:function(i){this.getPanel().find("._j_detail").text(i)},setAssureWords:function(i){this.getPanel().find(".popbtn-submit").text(i)},setCloserHide:function(i){if(i){this.getPanel().find(".close-btn").hide()}else{this.getPanel().find(".close-btn").show()}},bindEvents:function(){var i=this.getPanel();i.on("keydown",".pop-btns ._j_close",function(j){if(j.keyCode==13){$(this).trigger("click")}}).on("click",".pop-btns ._j_close",function(j){i.data("btn_trigger",true)})}});var c=function(i,k,j){if(!g){g=new f();M.Event(g).on("afterhide",function(){var l=g.getPanel();if(typeof h=="function"){h.call(g,l)}l.data("btn_trigger",false)});M.Event(g).on("aftershow",function(){g.getPanel().find(".pop-btns ._j_close").focus()})}g.getLayer().toFront();if(M.isObject(i)){g.setAlertTitle(i.title);g.setAlertContent(i.content)}else{g.setAlertTitle(i);g.setAlertContent("")}if(M.isObject(i)){if(i.assureWords){g.setAssureWords(i.assureWords)}else{g.setAssureWords("确定")}if(i.hideCloser){g.setCloserHide(true)}else{g.setCloserHide(false)}}else{g.setAssureWords("确定");g.setCloserHide(false)}if(typeof k=="function"){h=k}else{h=$.noop}if(j){$("#_j_alertpopicon").children("i").attr("class","i"+j)}else{$("#_j_alertpopicon").children("i").attr("class","i"+1)}g.show();return g};d.pop=c;d.warning=function(i,j){c(i,j,1)};d.tip=function(i,j){c(i,j,3)}});M.define("dialog/confirm",function(c,e){var g=c("dialog/Dialog"),a='<div id="popup_container" class="popup-box new-popbox"><a class="close-btn _j_close _j_false"><i></i></a><div class="pop-ico" id="popup_icon"><i class="i2"></i></div><div class="pop-ctn"><p class="hd _j_content"></p><p class="bd _j_detail"></p></div><div class="pop-btns"><a role="button" tabindex="0" class="popbtn popbtn-cancel popbtn-half _j_close _j_false">&nbsp;取消&nbsp;</a><a role="button" tabindex="0" class="popbtn popbtn-submit popbtn-half _j_close _j_true">&nbsp;确定&nbsp;</a></div></div>',h=M.extend(function(k){var j={width:420,content:"请输入内容",background:"#000",bgOpacity:0.7,PANEL_CLASS:"pop_no_margin",reposition:true,impl:"Confirm",layerZIndex:10000};k=M.mix(j,k);h.$parent.call(this,k);this.bindEvents()},g),d=null,b=$.noop,i=$.noop,f=false;M.mix(h.prototype,{tpl:a,setConfirmTitle:function(j){this.setContent(j)},setConfirmContent:function(j){this.getPanel().find("._j_detail").text(j)},setAssureWords:function(j){this.getPanel().find(".popbtn-submit").text(j)},setCancelWords:function(j){this.getPanel().find(".popbtn-cancel").text(j)},bindEvents:function(){this.getPanel().on("click","._j_false",function(){f=false}).on("click","._j_true",function(){f=true}).on("keydown","._j_false",function(j){if(j.keyCode==13){$(this).trigger("click")}else{if(j.keyCode==39){$(this).next().focus()}}}).on("keydown","._j_true",function(j){if(j.keyCode==13){$(this).trigger("click")}else{if(j.keyCode==37){$(this).prev().focus()}}})}});e.pop=function(k,j,l){if(!d){d=new h();M.Event(d).on("afterhide",function(){if(f){b()}else{i()}});M.Event(d).on("aftershow",function(){d.getPanel().find("._j_true").focus()})}d.getLayer().toFront();if(M.isObject(k)){d.setConfirmTitle(k.title);d.setConfirmContent(k.content)}else{d.setConfirmTitle(k);d.setConfirmContent("")}if(M.isObject(k)){if(k.assureWords){d.setAssureWords(k.assureWords)}else{d.setAssureWords("确定")}if(k.cancelWords){d.setCancelWords(k.cancelWords)}else{d.setCancelWords("取消")}}else{d.setAssureWords("确定");d.setCancelWords("取消")}if(typeof j=="function"){b=j}else{b=$.noop}if(typeof l=="function"){i=l}else{i=$.noop}d.show();return d}});M.define("ScrollObserver",function(e,g,c){var h=0,f={},a=false,b,d=true;g.addObserver=function(k){var j="ScrollObserver_"+h;h++;f[j]=k;d=false;return j};g.removeObserver=function(j){delete f[j];if(M.isEmpty(f)){d=true}};function i(){for(var j in f){if(f.hasOwnProperty(j)){f[j]()}}}$(window).scroll(function(){if(d){return}if(!a){b=setInterval(function(){if(a){a=false;clearTimeout(b);i()}},50)}a=true});return g});M.define("/js/note/PagesCommunication",function(b){var a=window.Env.uPageId+"";var d={name:"Communication_",init:function(e){var f=this;if(!f.paramIsRight(e)){return}f.name+=e;f.online();f.destory()},informOther:function(f){var e=this;if(e.isInformRequired()){localStorage.setItem(e.name,a+new Date().getTime());if(f){localStorage.setItem(e.name+"_func",f)}}},isInformRequired:function(){var g=this;var f=localStorage.getItem(g.name);var e=true;if(f){e=f.match(a)?false:true}return e},online:function(){var e=this;window.addEventListener("storage",function(g){if(g.key==e.name){var f=localStorage.getItem(e.name+"_func");if(f){(Function("("+f+")()"))()}}})},destory:function(){var e=this;window.addEventListener("onbeforeunload",function(){localStorage.removeItem(e.name)})},paramIsRight:function(e){var f="";if(!(typeof e==="string"&&e!=0)){f+="name 必须为非空字符串."}if(f){console.error(f);return false}else{return true}}};var c=Function.prototype.bind?{init:d.init.bind(d),informOther:d.informOther.bind(d)}:{init:function(){},informOther:function(){}};return c});M.define("/js/note/ControllerHead",function(j){j("/js/jquery.jplayer.js");var d=j("TopTip"),k=j("dialog/alert"),s=j("dialog/confirm"),g=j("dialog/Dialog"),t=j("ScrollObserver"),a=null,p=null,e=null,i=null,n=null,f=null,q=null,b=null,h=null,m=null,o=null;var l={events:{"click,._j_do_fav":"addFav","click,._j_has_fav":"hasFavNotice","mouseover,._j_activity_notice":"showActInfo","mouseout,._j_activity_notice":"hideActInfo"},init:function(){this.initSharedata();this.initDom();this.initFloatRight();this.initMusic();this.initBottomTotal();this.bindConfirm();this.initVideo()},isMusicClickOn:false,isMusicPlay:false,initVideo:function(){M.Event.on("videoplay",$.proxy(function(){c.informOther(r);if(this.isMusicPlay){this.pauseMusic()}},this));M.Event.on("videopause",$.proxy(function(){if(this.isMusicClickOn){this.playMusic()}},this))},initDom:function(){p=$("._j_open_reward_container");e=$("._j_close_reward_container");i=$("._j_open_reward");f=$("._j_float_right");q=$("._j_share_father");h=$("._j_ding_father");b=$("._j_music_father");m=$("._j_help_total")},initSharedata:function(){if(this.data&&this.data.share_info){M.Event.fire("note:share:info:ready",this.data.share_info);window.Env.share_info=this.data.share_info}},initBottomTotal:function(){if(this.data&&this.data.pv){m.find("._j_total_person").text(this.data.pv)}if(this.data&&this.data.mdd_name){m.find("._j_total_mdd").text(this.data.mdd_name)}},initFloatRight:function(){f.children(".quick_reply").before(q.children().clone(true));f.delegate("._j_do_fav","click",function(){q.find("._j_do_fav").trigger("click")});f.delegate("._j_has_fav","click",function(){q.find("._j_has_fav").trigger("click")});var v=h.children();if(v.length>0){f.children(".post-up").append(v.clone(true))}var u=b.children();if(u.length>0){f.children(".quick_reply").after(u.clone(true));f.children(".music_botton").addClass("quick_music").children(".hd_audio").remove()}this.bindFloatRight()},bindFloatRight:function(){if($("._j_top_share_group").length>0){var y=$("._j_top_share_group .bs_share"),w=$("#_js_circle_forLowBrowser"),v=y.offset().top+y.outerHeight(true);x();t.addObserver(x);$(window).resize(function(){v=y.offset().top+y.outerHeight(true)})}function x(){var z=$(window).scrollTop();var A=(z+document.documentElement.clientHeight)/document.body.clientHeight;A=parseInt(A*100,10);u(A);if($(".float-bar").is(":hidden")&&z>v){if($.browser.msie&&parseInt($.browser.version,10)<9){$(".float-bar").show()}else{$(".float-bar").fadeIn(300)}}else{if($(".float-bar").is(":visible")&&z<v){if($.browser.msie&&parseInt($.browser.version,10)<9){$(".float-bar").hide()}else{$(".float-bar").fadeOut(300)}}}}function u(B){var A=16;var C=(A-1)/A;if(w.parent().hasClass("support_canvas")){return}var z=B*A/100;var z=B>C?Math.floor(z):Math.ceil(z);w.get(0).className="circle_per"+z}},pauseMusic:function(){this.isMusicPlay=false;o.jPlayer("pause");a.addClass("pause").removeClass("play")},playMusic:function(){this.isMusicPlay=true;$("video").each(function(u,v){v.pause()});o.jPlayer("play");a.addClass("begin_play").removeClass("pause");setTimeout(function(){a.addClass("play").removeClass("begin_play")},500)},initMusic:function(){a=$("._j_m_control");o=$(".music_botton .hd_audio");o.jPlayer({ready:function(){$(this).jPlayer("setMedia",{mp3:o.data("music")});a[0].click()},ended:function(){$(this).jPlayer("setMedia",{mp3:o.data("music")}).jPlayer("play");a.addClass("play").removeClass("pause")},swfPath:"/swf",supplied:"mp3",wmode:"window"});a.on("click",$.proxy(function(){var u=o.data("jPlayer");if(u.status.paused||u.status.ended||u.status.waitForPlay){c.informOther(r);this.playMusic();this.isMusicClickOn=true}else{this.pauseMusic();this.isMusicClickOn=false}},this))},addFav:function(u){u.preventDefault();var v=$(u.currentTarget);if(v.hasClass("unique")){return false}v.addClass("unique");$.post("/note/ajax/post/fav",{iIid:this.data.iid,__ctk__:window.Env.__ctk__},$.proxy(function(y){if(!y.error&&y.payload){if(y.payload.ret===1||y.payload.ret===-4){var x=$("._j_do_fav");x.removeClass("_j_do_fav").addClass("_j_has_fav");var w=(+v.children("span").text())+1;x.find("span").html(w);$(".bs_collect").addClass("collected");d.show("成功将该文章收藏！")}else{k.pop("收藏失败")}}v.removeClass("unique")},this),"json")},hasFavNotice:function(u){u.preventDefault();d.show("该文章您已经收藏过了！")},showActInfo:function(u){var v=$(u.currentTarget);v.children(".if_pop").removeClass("hide")},hideActInfo:function(u){var v=$(u.currentTarget);v.children(".if_pop").addClass("hide")},closeReward:function(u){alert("打赏功能已关闭");return},openReward:function(u){alert("打赏功能已关闭");return},confirmOpenReward:function(){alert("打赏功能已关闭");return},bindConfirm:function(){$("._j_confirm_open_reward").live("click",$.proxy(function(){this.confirmOpenReward()},this))}};var c=j("/js/note/PagesCommunication");window.Communication={media:l};var r=function(){$("video").each(function(u,v){v.pause()});setTimeout(function(){window.Communication.media.pauseMusic()},50)};c.init("media");return l});M.closure(function(){var c=$(".block-newer-guide");var b=$("._j_stas_content");c.on("click",function(e){var f=$(this);var d=f.attr("data-flag");if(e.target.className==="icon-close"){f.hide();a(d);return}window.location.href="https://imfw.cn/l/21811889"});b.on("click","._j_close_lead_tip .icon-close",function(d){var e=$(this);a("mddLead",function(){e.closest(".dashed-round ").hide()})});function a(d,e){$.ajax({type:"GET",url:"/note/noteClickAction/click",data:{action:d},error:function(f){},success:function(f){typeof e==="function"&&e(f)}})}});M.define("Slider",function(b,a,c){function d(e){this.viewSize=1;this.slideCnt=null;this.slideList=null;this.prev=$();this.next=$();this.indexer=$();this.itemSize=null;this.slideTime=200;this.slideSize=1;this.indexerOnClass="on";this.disabledClass="disabled";this.indexAttr="index";this.shStyle="slide";this.index=1;M.mix(this,e);this.init()}d.prototype={init:function(){this.hasMore=true;this.bindEvents();this.updateStatus();if(!this.itemSize){this.itemSize=$(this.slideList).eq(0).outerWidth(true)}},bindEvents:function(){this.prev.click($.proxy(this.toPrev,this));this.next.click($.proxy(this.toNext,this));this.indexer.click($.proxy(function(g){g.preventDefault();var e=$(g.currentTarget),f=e.index()+1;if(!e.hasClass(this.indexerOnClass)&&!this.sliding&&!isNaN(f)){this.toIndex(f)}},this))},toPrev:function(e){if(!this.prev.hasClass(this.disabledClass)&&!this.sliding){this.slide(-this.slideSize)}e.preventDefault()},toNext:function(e){if(!this.next.hasClass(this.disabledClass)&&!this.sliding){this.slide(this.slideSize)}e.preventDefault()},toIndex:function(e){this.slide(e-this.index)},updateStatus:function(){if(this.index===1){this.prev.addClass(this.disabledClass)}else{this.prev.removeClass(this.disabledClass)}if((this.index+this.viewSize-1)>=$(this.slideList).length&&!this.hasMore){this.next.addClass(this.disabledClass)}else{this.next.removeClass(this.disabledClass)}this.indexer.filter("."+this.indexerOnClass).removeClass(this.indexerOnClass);this.indexer.eq(this.index-1).addClass(this.indexerOnClass);M.Event(this).fire("slide",{data:{index:this.index,total:$(this.slideList).length}})},slide:function(e){this.sliding=true;this.realSlideNum=e;this.prepareData($.proxy(function(){var f=this;d.shower[this.shStyle].show(this,function(){f.index+=f.realSlideNum;f.sliding=false;f.updateStatus()})},this))},prepareData:function(h){var f=this.realSlideNum,e=$(this.slideList).length,h=typeof h==="function"?h:$.noop,g=f>=0?(e-this.index-this.viewSize+1):(this.index-1);if(g<=1){this.hasMore=false}if(g<=0){this.realSlideNum=0}else{this.realSlideNum=Math.abs(f)>g?g:f;if(f<0&&this.realSlideNum>0){this.realSlideNum=-this.realSlideNum}}h()},reset:function(){this.index=1;this.hasMore=true;this.updateStatus();if(this.shStyle==="slide"){this.slideCnt.css("left",0)}}};d.shower={slide:{show:function(f,h){var e=parseInt($(f.slideCnt).css("left"),10),g=f.itemSize*f.realSlideNum;e=isNaN(e)?0:e,$(f.slideCnt).animate({left:e-g},f.slideTime,function(){h()})}},fadeInOut:{show:function(f,h){var g=$(f.slideList[f.index-1]),e=$(f.slideList[f.index+f.realSlideNum-1]);g.fadeOut(f.slideTime);e.fadeIn(f.slideTime,function(){h()})}}};return d});M.define("/js/note/ControllerRelate",function(a){var b=a("Slider");return{init:function(){this.initAuto()},initAuto:function(){var e=400,d=5000,k=false,i=$("#_j_gl_slide_container"),j=i.find(".gs_content"),h=i.find(".gs_nav"),c=j.children("li"),g=c.length;var f=new b({slideCnt:j,slideList:c,slideTime:e,indexer:h.children("li"),indexerOnClass:"on",shStyle:"slide"});j.add(h).bind("mouseenter",function(){k=true}).bind("mouseleave",function(){k=false});setInterval(function(){if(!k&&M.windowFocused){if(f.index<g){f.toIndex(f.index+1)}else{f.toIndex(1)}}},d)}}});M.define("/js/note/ControllerRec",function(a){var b=a("Slider");return{init:function(){this.initAuto()},initAuto:function(){var e=400,d=5000,k=false,i=$("#_j_rec_slide_container"),j=i.find(".gs_content"),h=i.find(".gs_nav"),c=j.children("li"),g=c.length;var f=new b({slideCnt:j,slideList:c,slideTime:e,indexer:h.children("li"),indexerOnClass:"on",shStyle:"slide"});j.add(h).bind("mouseenter",function(){k=true}).bind("mouseleave",function(){k=false});setInterval(function(){if(!k&&M.windowFocused){if(f.index<g){f.toIndex(f.index+1)}else{f.toIndex(1)}}},d)}}});M.define("/js/note/ControllerCatalog",function(a){return{init:function(){var b=$("#_j_catalogtitle");if(b.children().length==2){b.on("click",".side_tab_item",function(c){var e=$(c.currentTarget),d=e.data("target");e.addClass("on").siblings().removeClass("on");M.Event.fire("right bottom catalog change",{target:d})})}}}});
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
/*!
 * jQuery Mousewheel 3.1.12
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){module.exports=a}else{a(jQuery)}}}(function(c){var d=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],k=("onwheel" in document||document.documentMode>=9)?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice,j,b;if(c.event.fixHooks){for(var e=d.length;e;){c.event.fixHooks[d[--e]]=c.event.mouseHooks}}var f=c.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var m=k.length;m;){this.addEventListener(k[--m],l,false)}}else{this.onmousewheel=l}c.data(this,"mousewheel-line-height",f.getLineHeight(this));c.data(this,"mousewheel-page-height",f.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var m=k.length;m;){this.removeEventListener(k[--m],l,false)}}else{this.onmousewheel=null}c.removeData(this,"mousewheel-line-height");c.removeData(this,"mousewheel-page-height")},getLineHeight:function(m){var i=c(m),n=i["offsetParent" in c.fn?"offsetParent":"parent"]();if(!n.length){n=c("body")}return parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(i){return c(i).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};c.fn.extend({mousewheel:function(i){return i?this.bind("mousewheel",i):this.trigger("mousewheel")},unmousewheel:function(i){return this.unbind("mousewheel",i)}});function l(i){var o=i||window.event,u=h.call(arguments,1),w=0,q=0,p=0,t=0,s=0,r=0;i=c.event.fix(o);i.type="mousewheel";if("detail" in o){p=o.detail*-1}if("wheelDelta" in o){p=o.wheelDelta}if("wheelDeltaY" in o){p=o.wheelDeltaY}if("wheelDeltaX" in o){q=o.wheelDeltaX*-1}if("axis" in o&&o.axis===o.HORIZONTAL_AXIS){q=p*-1;p=0}w=p===0?q:p;if("deltaY" in o){p=o.deltaY*-1;w=p}if("deltaX" in o){q=o.deltaX;if(p===0){w=q*-1}}if(p===0&&q===0){return}if(o.deltaMode===1){var v=c.data(this,"mousewheel-line-height");w*=v;p*=v;q*=v}else{if(o.deltaMode===2){var n=c.data(this,"mousewheel-page-height");w*=n;p*=n;q*=n}}t=Math.max(Math.abs(p),Math.abs(q));if(!b||t<b){b=t;if(a(o,t)){b/=40}}if(a(o,t)){w/=40;q/=40;p/=40}w=Math[w>=1?"floor":"ceil"](w/b);q=Math[q>=1?"floor":"ceil"](q/b);p=Math[p>=1?"floor":"ceil"](p/b);if(f.settings.normalizeOffset&&this.getBoundingClientRect){var m=this.getBoundingClientRect();s=i.clientX-m.left;r=i.clientY-m.top}i.deltaX=q;i.deltaY=p;i.deltaFactor=b;i.offsetX=s;i.offsetY=r;i.deltaMode=0;u.unshift(i,w,q,p);if(j){clearTimeout(j)}j=setTimeout(g,200);return(c.event.dispatch||c.event.handle).apply(this,u)}function g(){b=null}function a(m,i){return f.settings.adjustOldDeltas&&m.type==="mousewheel"&&i%120===0}}));if(window.M&&typeof window.M.define=="function"){window.M.define("jq-mousewheel",function(){return jQuery})}M.define("ScrollBar",function(a){a("jq-mousewheel");var c=15;function b(d){this.wrap=null;this.container=null;this.dir=1;this.barTPL='<div style="position:absolute; top:0; right:0; padding:1px"><div style="width:7px; height:100%; background:#bbb"></div></div>';this.maxHeight=0;M.mix(this,d);this.container=$(this.container);this.wrap=$(this.wrap);this.scrollBar=null;this.stopped=false;this.scrollToEnd=false;this.init()}b.prototype={init:function(){if(!this.container.length){M.error("ScrollBar init failed for no scroll container.");return false}this.posDir=this.dir===0?"left":"top";this.lengthDir=this.dir===0?"width":"height";this.scrollScale=this.dir===0?"scrollWidth":"scrollHeight";this.clientScale=this.dir===0?"clientWidth":"clientHeight";this.scrollDir=this.dir===0?"scrollLeft":"scrollTop";this.initWrap();this.bindEvents();this.setted=false},initWrap:function(){this.container.css({position:"relative"});if(this.dir==1){this.container.css({"overflow-y":"hidden"})}else{this.container.css({"overflow-x":"hidden"})}if(this.maxHeight&&!isNaN(this.maxHeight)){this.container.css("max-"+this.lengthDir,this.maxHeight).addClass("maxh")}if(!this.wrap.length){this.container.wrap('<div style="position:relative"></div>');this.wrap=this.container.parent()}else{if(this.wrap.css("position")=="static"){this.wrap.css("position","relative")}}this.createScrollBar();if(this.container.height()>0){this.setScrollBar()}},createScrollBar:function(){this.container[0][this.scrollDir]=0;this.scrollBar=$(this.barTPL).css("opacity",0).appendTo(this.wrap)},bindEvents:function(){this.wrap.bind("mouseenter",$.proxy(this.enterWrap,this)).bind("mouseleave",$.proxy(this.leaveWrap,this)).mousewheel($.proxy(this.rollWrap,this));this.scrollBar.mousedown($.proxy(this.holdBar,this));M.Event(this).on("contentchange",$.proxy(this.checkShowScrollBar,this))},setScrollBar:function(){this.checkShowScrollBar()},setDimension:function(){this.wrapStart=this.wrap.offset()[this.posDir]},checkShowScrollBar:function(){var e=this.container[0];this.wrap.css("height",this.container.height());this.wrapLength=this.dir===0?this.wrap.width():this.wrap.height();this.scrollLength=this.dir===0?e.scrollWidth:e.scrollHeight;this.clientLength=this.dir===0?e.clientWidth:e.clientHeight;var d=e[this.scrollDir];if(this.scrollLength>this.clientLength){this.updateScrollBarLength();this.scrollBar.show();if(d<=this.scrollLength-this.clientLength){this.scroll(d)}else{this.scroll(this.scrollLength-this.clientLength)}}else{this.scrollBar.hide()}},updateScrollBarLength:function(){this.barLength=this.wrapLength*(this.clientLength/this.scrollLength);this.barLength=this.barLength<c?c:this.barLength;this.scrollBar.css((this.dir===0?"width":"height"),this.barLength);this.barLength=this.dir===0?this.scrollBar.outerWidth():this.scrollBar.outerHeight()},enterWrap:function(){if(!this.setted){this.setScrollBar();this.setted=true}this.on=true;this.setDimension();this.scrollBar.stop(true,true).animate({opacity:0.8},300)},leaveWrap:function(){this.on=false;if(!this.holded){this.scrollBar.stop(true,true).animate({opacity:0},300)}},stop:function(){this.stopped=true},start:function(){this.stopped=false},rollWrap:function(f,h){if(this.stopped){return true}var d=this.getScrollUnit(-h*f.deltaFactor);d=d<0?Math.floor(d):Math.ceil(d);var g=0,e=this.container[0][this.scrollDir];if(e+d<0){g=0}else{if(e+d+this.clientLength>this.scrollLength){g=this.scrollLength-this.clientLength}else{g=e+d}}this.scroll(g);if(this.scrollBar.is(":visible")){f.preventDefault();f.stopPropagation()}},getScrollUnit:function(d){if($.browser.msie&&parseInt($.browser.version,10)<9){d=30*d}return d},holdBar:function(d){this.holded=true;this.cursorPosition=this.dir===0?d.clientX:d.clientY;this.startCursorOffset=this.cursorPosition-this.scrollBar.offset()[this.posDir];this.listenMouseMove();d.preventDefault()},listenMouseMove:function(){$(document).bind("mousemove",this.getMoveCursorHandler()).bind("mouseup",this.getReleaseCursorHandler())},stopListenMouseMove:function(){$(document).unbind("mousemove",this.getMoveCursorHandler()).unbind("mouseup",this.getReleaseCursorHandler())},getMoveCursorHandler:function(){if(!this.moveCursorHandler){this.moveCursorHandler=$.proxy(this.moveCursor,this)}return this.moveCursorHandler},getReleaseCursorHandler:function(){if(!this.releaseCursorHandler){this.releaseCursorHandler=$.proxy(this.releaseCursor,this)}return this.releaseCursorHandler},moveCursor:function(i){if(this.holded){var e=this.dir===0?i.clientX:i.clientY,h=e-this.cursorPosition,j=this.cursorPosition-this.startCursorOffset-this.wrapStart,g=e-this.startCursorOffset-this.wrapStart,d=this.cursorPosition+(this.barLength-this.startCursorOffset)-this.wrapStart-this.wrapLength,f=e+(this.barLength-this.startCursorOffset)-this.wrapStart-this.wrapLength;if(g>0&&f<0&&h!==0){this.cursorPosition=e;this.moveScrollBar(h)}else{if(g<=0&&j>0&&h!==0){h=-j;this.cursorPosition=this.cursorPosition+h;this.moveScrollBar(h)}else{if(f>=0&&d<0&&h!==0){h=-d;this.cursorPosition=this.cursorPosition+h;this.moveScrollBar(h)}}}}i.preventDefault()},moveScrollBar:function(e){var f=parseInt(this.scrollBar.css(this.posDir),10),d=this.wrapLength-this.barLength-f;if(e<0&&e>-f||e>0&&e<d){f=f+e}else{if(e<0){f=0}else{if(e>0){f=f+d}}}this.scroll((f/(this.wrapLength-this.barLength))*(this.scrollLength-this.clientLength))},scroll:function(d){this.scrollBar.css(this.posDir,d*(this.wrapLength-this.barLength)/(this.scrollLength-this.clientLength));this.container[0][this.scrollDir]=d;M.Event(this).fire("scroll");if(d===0){M.Event(this).fire("scrollToTop");this.scrollToEnd=true}else{if(d+this.container[0][this.clientScale]>=this.container[0][this.scrollScale]){M.Event(this).fire("scrollToBottom");this.scrollToEnd=true}else{this.scrollToEnd=false}}},scrollLength:function(){return this.container[0][this.scrollDir]},releaseCursor:function(){this.holded=false;this.stopListenMouseMove();if(!this.on){this.scrollBar.stop(true,true).animate({opacity:0},300)}}};return b});M.define("StickyAndStayBlock",function(e,h,b){var a=0,d={},j={};function i(){a++;return"_j_fix_block_abs_"+a}function g(){a++;return"_j_fix_block_fix_"+a}var c=e("ScrollBar");function f(k){this.elem=null;this.heightCover=false;this.offsetTop=0;this.offsetBottom=0;this.stayToElement=null;this.absStyleClass="_j_sticky_abs";this.fixStyleClass="_j_sticky_fix";M.mix(this,k);this.elem=$(this.elem);this.stayToElement=$(this.stayToElement);if(!this.elem.length){M.error("fix block need block element")}this.elemHeight=this.elem.height();this.elemWidth=this.elem.width();this.elemTop=this.elem.offset().top;this.stayToElementHeight=this.stayToElement.length?this.stayToElement.height():0;this.stayToElementTop=this.stayToElement.length?this.stayToElement.offset().top:0;this.elemPadding=this.getElemVerticalPadding(this.elem);this.stayToElementPadding=this.getElemVerticalPadding(this.stayToElement);this.offsetParent=this.elem.offsetParent();this.fixClass="";this.beforeAbsClass=[];this.absClass="";this.beforeFixClass=[];this.positionMode="static";this.cannotHeightCover=false;this.absClassChanged=false;this.fixClassChanged=false;if(this.stayToElement.length>0){if(this.elemTop+this.elemHeight+this.elemPadding+this.offsetBottom+this.offsetTop>this.stayToElementHeight+this.stayToElementPadding+this.stayToElementTop){this.offsetBottom=this.stayToElementHeight+this.stayToElementPadding+this.stayToElementTop-this.elemTop-this.elemHeight-this.elemPadding-this.offsetTop;this.offsetBottom=this.offsetBottom<0?0:this.offsetBottom}this.resetCannotHeightCover()}this.init()}M.mix(f.prototype,{init:function(){this.bindEvents();this.createModeStyle();setTimeout(function(){$(window).trigger("scroll")},1)},bindEvents:function(){$(window).scroll($.proxy(function(){this.setPositionMode(this.getPositionMode($(window).scrollTop()))},this));var k=0;$(window).resize($.proxy(function(){clearTimeout(k);k=setTimeout($.proxy(function(){this.resetCannotHeightCover();this.resetPosition()},this),200)},this));M.Event(this).on("element height change",$.proxy(function(l){this.resetElemHeight(l&&l.height)},this));M.Event(this).on("element top change",$.proxy(function(l){this.resetElemTop(l&&l.top);this.resetCannotHeightCover();this.resetPosition()},this));M.Event(this).on("stay element height change",$.proxy(function(l){this.resetBottomStayElementHeight(l&&l.height);this.resetCannotHeightCover();this.resetPosition()},this));M.Event(this).on("stay element top change",$.proxy(function(l){this.resetBottomStayElementTop(l&&l.top);this.resetCannotHeightCover();this.resetPosition()},this));setInterval($.proxy(function(){if(this.elem.height()!=this.elemHeight){M.Event(this).fire("element height change",{height:this.elem.height()})}if(this.stayToElement.length&&this.stayToElement.height()!=this.stayToElementHeight){M.Event(this).fire("stay element height change",{height:this.stayToElement.height()})}if(this.positionMode=="static"){if(this.elem.offset().top!=this.elemTop){M.Event(this).fire("element top change",{top:this.elem.offset().top})}}if(this.stayToElement.length&&this.stayToElement.offset().top!=this.stayToElementTop){M.Event(this).fire("stay element top change",{top:this.stayToElement.offset().top})}},this),2000)},getElemVerticalPadding:function(l){var n=0;if(l.length){var k=parseInt(l.css("padding-top"),10),m=parseInt(l.css("padding-bottom"),10);k=isNaN(k)?0:k;m=isNaN(m)?0:m;n=k+m}return n},resetCannotHeightCover:function(){if(this.stayToElementTop+this.stayToElementHeight+this.stayToElementPadding-this.elemTop<$(window).height()-this.offsetBottom){this.cannotHeightCover=true}else{this.cannotHeightCover=false}},resetElemHeight:function(k){this.elemHeight=k||this.elem.height();this.resetPosition()},resetBottomStayElementHeight:function(k){this.stayToElementHeight=k||this.stayToElement.height();this.createModeStyle();this.setPositionMode(this.getPositionMode($(window).scrollTop()))},resetElemTop:function(k){if(typeof k!="number"){k=this.positionMode=="static"?this.elem.offset().top:this.placeholder.offset().top}this.elemTop=k},resetBottomStayElementTop:function(k){this.stayToElementTop=k||this.stayToElement.offset().top},createModeStyle:function(){var n=$(window).height()-this.offsetTop-this.offsetBottom;var p=["position:fixed","top:"+this.offsetTop+"px"];if(this.heightCover&&!this.cannotHeightCover){p.push("bottom:"+this.offsetBottom+"px")}var m=p.join(";");if(!(m in j)||j[m]!=this.fixClass){if(this.fixClass){this.beforeFixClass.push(this.fixClass)}if(m in j){this.fixClass=j[m]}else{this.fixClass=g();M.addStyle("."+this.fixClass+"{"+m+"}");j[m]=this.fixClass}this.fixClassChanged=true}if(this.stayToElement.length){var k=["position:absolute"];if(this.stayToElement.is(this.offsetParent)){k.push("bottom:"+this.offsetBottom+"px")}else{var l=this.stayToElementTop+this.stayToElementHeight+this.stayToElementPadding;k.push("top:"+(l-this.offsetBottom-this.offsetParent.offset().top-(this.heightCover&&!this.cannotHeightCover?n:(this.elemHeight+this.elemPadding)))+"px")}if(this.heightCover&&!this.cannotHeightCover){k.push("height:"+n+"px")}var o=k.join(";");if(!(o in d)||d[o]!=this.absClass){if(this.absClass){this.beforeAbsClass.push(this.absClass)}if(o in d){this.absClass=d[o]}else{this.absClass=i();M.addStyle("."+this.absClass+"{"+o+"}");d[o]=this.absClass}this.absClassChanged=true}}},getPositionMode:function(k){if(this.stayToElement.length){if(k+this.offsetTop+this.elemHeight+this.elemPadding+this.offsetBottom>=this.stayToElementTop+this.stayToElementHeight+this.stayToElementPadding){return"absolute"}else{if(k+this.offsetTop>=this.elemTop){return"fixed"}else{return"static"}}}else{if(k+this.offsetTop>=this.elemTop){return"fixed"}else{return"static"}}},resetPosition:function(){this.createModeStyle();this.setPositionMode(this.getPositionMode($(window).scrollTop()))},setPositionMode:function(m){if(m!=this.positionMode){var l=false,k=false;if(m=="fixed"){this.elem.removeClass(this.absClass+" "+this.absStyleClass+" "+this.beforeAbsClass.join(" ")+" "+this.beforeFixClass.join(" "));this.elem.addClass(this.fixClass+" "+this.fixStyleClass);if(this.positionMode=="static"){this.showPlaceholder();l=true}this.fixClassChanged=false}else{if(m=="absolute"){this.elem.removeClass(this.fixClass+" "+this.fixStyleClass+" "+this.beforeAbsClass.join(" ")+" "+this.beforeFixClass.join(" "));this.elem.addClass(this.absClass+" "+this.absStyleClass);if(this.positionMode=="static"){this.showPlaceholder();l=true}this.absClassChanged=false}else{if(m=="static"){if(this.positionMode=="absolute"){this.elem.removeClass(this.absClass+" "+this.absStyleClass+" "+this.beforeAbsClass.join(" ")+" "+this.beforeFixClass.join(" "))}else{this.elem.removeClass(this.fixClass+" "+this.fixStyleClass)}this.hidePlaceholder();k=true}}}this.positionMode=m;if((l||k)&&this.heightCover&&!this.cannotHeightCover){M.Event(this).fire("element height change",{height:this.elem.height()})}M.Event(this).fire("mode change",{mode:this.positionMode})}else{if(m=="fixed"&&this.fixClassChanged){this.elem.removeClass(this.beforeFixClass.join(" "));this.elem.addClass(this.fixClass);this.fixClassChanged=false}else{if(m=="absolute"&&this.absClassChanged){this.elem.removeClass(this.beforeAbsClass.join(" "));this.elem.addClass(this.absClass);this.absClassChanged=false}}}},showPlaceholder:function(){if(!this.placeholder){this.placeholder=$('<div style="display:none"></div>').insertBefore(this.elem)}this.placeholder.css({height:this.elem.outerHeight(true)}).show()},hidePlaceholder:function(){this.placeholder&&this.placeholder.hide()}});b.exports=f});M.closure(function(b){var a=b("StickyAndStayBlock");var d=$("._j_sticky_block");if(!d.length){return false}var c=new a({elem:d,stayToElement:$(".view"),offsetTop:-150,heightCover:true,absStyleClass:"sticky_mode_abs",fixStyleClass:"sticky_mode_fix"});M.Event(c).on("element height change",function(e){M.Event.fire("sticky element height change",e)});M.Event.on("new html appended",function(){M.Event(c).fire("element top change")})});M.define("/js/note/ControllerExpand",function(a){var b=a("dialog/alert");return{events:{"click,._j_restore":"restoreNote",},init:function(){this.initUsaZuche()},restoreNote:function(c){c.preventDefault();var e=$(c.currentTarget);if(e.hasClass("unique")){return false}e.addClass("unique");var d=e.data("iid");$.ajax({type:"POST",url:"/note/ajax/post/restoreNote",data:{iId:d,__ctk__:window.Env.__ctk__},dataType:"json",success:function(f){if(!f.error){window.location.reload()}else{b.pop(f.error.error)}e.remove("unique")}})},initUsaZuche:function(){if(this.data.is_relate_usa){$(".link").each(function(){var d=$(this);var c=d.attr("href");if(c&&c.indexOf("zuche.mafengwo.cn/jump_landing_page.php")!==-1){d.attr("href",c+"&region=us")}})}}}});M.define("Storage",function(e,g,b){var n=document;var d=c();var f={_element:null,_expires:null,_file:document.location.hostname,init:function(){if(!this._element){try{this._element=n.createElement("input");this._element.type="hidden";this._element.addBehavior("#default#userData");n.body.appendChild(this._element);this.setItem("__detectUserDataStorage",1);this.removeItem("__detectUserDataStorage");return{setItem:this.setItem,getItem:this.getItem,removeItem:this.removeItem}}catch(p){M.error(p)}}return true},setItem:function(s,t,q){var p=j(q);this._element.expires=p.toUTCString();this._element.load(this._file);var r=a(this._element.getAttribute(s)),u=i(t,+p);this._element.setAttribute(s,u);this._element.save(this._file);k({key:s,newValue:u,oldValue:r,url:window.location.href})},getItem:function(p){this._element.load(this._file);var q=a(this._element.getAttribute(p));return q&&q.value},removeItem:function(p){this._element.load(this._file);this._element.removeAttribute(p);this._element.save(this._file)}};var l={setItem:function(r,s,q){if(!d){return}var p=j(q);localStorage.setItem(r,i(s,+p))},getItem:function(p){if(!d){return}var r=+new Date(),q=a(localStorage.getItem(p));if(q){if(r>q.timestamp){localStorage.removeItem(p);q=null}else{q=q.value}}return q},removeItem:function(p){if(!d){return}localStorage.removeItem(p)}};var h={},m={on:function(q,r){var p=h[q]||(h[q]=[]);p.push(r)},off:function(q,r){var p=h[q];if(!!p){if(!!r){M.forEach(p,function(t,s){if(t==r){p.splice(s,1)}})}else{p=[]}}return this}};M.mix(f,m);M.mix(l,m);if(window.addEventListener){window.addEventListener("storage",k,false)}else{if(window.attachEvent){window.attachEvent("onstorage",k)}}function k(u){if(!u){u=window.event}var p=M.mix({},u),w=u.newValue&&a(u.newValue),q=u.oldValue&&a(u.oldValue),v=+new Date();p.newValue=w&&w.value;if(!!q&&v<q.timestamp){p.oldValue=q.value}else{p.oldValue=null}var t=u.key,s=h[t],r=0;if(!t||!s||0===s.length){return}while(r<s.length){s[r++].call(window,p)}}function j(p){if(Object.prototype.toString.call(p)!="[object Date]"){var q=typeof p==="number"&&p>0?p:86400;p=new Date();p.setTime(+p+q*1000)}return p}function i(q,p){var r={value:q,timestamp:p};return JSON.stringify(r)}function a(p){if(p){try{p=JSON.parse(p);if(!("value" in p)||!("timestamp" in p)){p={value:p,timestamp:+j()}}}catch(q){p={value:p,timestamp:+j()}}}return p}function c(){if(window.localStorage){try{localStorage.setItem("__detectLocalStorage",1);localStorage.removeItem("__detectLocalStorage");return true}catch(p){return false}}return false}var o=window.localStorage?l:f.init();b.exports=M.mix(o,{isAvailable:c,isSupport:window.localStorage?d:("setItem" in o)})});M.define("ClickToggle",function(b,a,c){function d(e){this.context="body";this.container=null;this.innerSelector=null;this.handler=$.noop;this.outHandler=$.noop;M.mix(this,e);this.outHandled=false;this.init()}d.prototype={init:function(){if(!M.is(this.innerSelector,"string")||!M.is(this.container,"string")){M.error("In Toggle Module multiple mode, innerSelector and container must be string selector")}this.context=$(this.context);this.context.delegate(this.innerSelector,"click",$.proxy(function(f){var g=$(f.currentTarget),e=g.closest(this.container);e.data("inner",true);this.handler(g,f)},this));this.context.delegate(this.container,"click",$.proxy(function(e){var f=$(e.currentTarget);if(!f.data("inner")){this.outHandler(f,e)}else{f.data("inner",false)}this.outHandled=true},this));this.context.click($.proxy(function(e){var f=$(e.currentTarget);if(!this.outHandled){this.outHandler(f,e)}else{this.outHandled=false}},this))}};c.exports=d});M.define("/js/EmotionsHd",function(b){var a="https://"+window.Env.IMG_HOST+"/images/i/face/daily_v2/",c="https://"+window.Env.IMG_HOST+"/images/i/face/brands_v3/";return{golden:[{title:"大笑",file:a+"1@2x.png"},{title:"微笑",file:a+"2@2x.png"},{title:"亲亲",file:a+"3@2x.png"},{title:"色色",file:a+"5@2x.png"},{title:"笑cry",file:a+"79@2x.png"},{title:"无奈",file:a+"6@2x.png"},{title:"睡觉",file:a+"19@2x.png"},{title:"害羞",file:a+"8@2x.png"},{title:"酷",file:a+"9@2x.png"},{title:"鬼脸",file:a+"12@2x.png"},{title:"大哭",file:a+"21@2x.png"},{title:"生气",file:a+"27@2x.png"},{title:"抓狂",file:a+"52@2x.png"},{title:"汗",file:a+"54@2x.png"},{title:"惊悚",file:a+"83@2x.png"},{title:"生病",file:a+"47@2x.png"},{title:"闭嘴",file:a+"25@2x.png"},{title:"精灵",file:a+"44@2x.png"},{title:"邪恶",file:a+"85@2x.png"},{title:"魅力四射",file:a+"30@2x.png"},{title:"吻",file:a+"33@2x.png"},{title:"爱心",file:a+"32@2x.png"},{title:"心碎",file:a+"31@2x.png"},{title:"剪刀手",file:a+"88@2x.png"},{title:"再见",file:a+"20@2x.png"},{title:"赞",file:a+"28@2x.png"},{title:"鼓掌",file:a+"96@2x.png"},{title:"祈祷",file:a+"78@2x.png"},{title:"甜蜜",file:a+"104@2x.png"},{title:"太阳",file:a+"72@2x.png"},{title:"下雨",file:a+"67@2x.png"},{title:"闪电",file:a+"110@2x.png"},{title:"雪",file:a+"112@2x.png"},{title:"星星",file:a+"43@2x.png"},{title:"月亮",file:a+"62@2x.png"},{title:"飞机",file:a+"114@2x.png"},{title:"自行车",file:a+"132@2x.png"},{title:"人民币",file:a+"56@2x.png"},{title:"王冠",file:a+"162@2x.png"},{title:"足球",file:a+"41@2x.png"},{title:"苹果",file:a+"38@2x.png"},{title:"香蕉",file:a+"184@2x.png"},{title:"西瓜",file:a+"39@2x.png"},{title:"糖果",file:a+"196@2x.png"},{title:"蜂蜜",file:a+"197@2x.png"},{title:"餐厅",file:a+"64@2x.png"},{title:"咖啡",file:a+"40@2x.png"},{title:"干杯",file:a+"16@2x.png"},{title:"蝴蝶结",file:a+"201@2x.png"},{title:"礼物",file:a+"37@2x.png"},{title:"生日蛋糕",file:a+"36@2x.png"},{title:"庆祝",file:a+"207@2x.png"},{title:"蚂蚁",file:a+"211@2x.png"},{title:"蜜蜂",file:a+"212@2x.png"},{title:"狗狗",file:a+"69@2x.png"},{title:"猫猫",file:a+"68@2x.png"},{title:"兔子",file:a+"215@2x.png"},{title:"樱花",file:a+"232@2x.png"},{title:"玫瑰",file:a+"35@2x.png"},{title:"时钟",file:a+"235@2x.png"},{title:"放大镜",file:a+"237@2x.png"},{title:"注意",file:a+"51@2x.png"},{title:"铅笔",file:a+"240@2x.png"},{title:"信",file:a+"73@2x.png"},{title:"灯泡",file:a+"243@2x.png"},{title:"对话",file:a+"245@2x.png"},{title:"图钉",file:a+"246@2x.png"},{title:"喇叭",file:a+"247@2x.png"},{title:"音乐",file:a+"63@2x.png"},{title:"置顶",file:a+"258@2x.png"}],brands:[{title:"愤怒小蜂",file:c+"38@2x.png",size:28},{title:"害羞小蜂",file:c+"39@2x.png",size:28},{title:"白眼小蜂",file:c+"40@2x.png",size:28},{title:"机智小蜂",file:c+"41@2x.png",size:28},{title:"奸笑小蜂",file:c+"42@2x.png",size:28},{title:"扮酷小蚂",file:c+"2@2x.png",size:28},{title:"大哭小蜂",file:c+"4@2x.png",size:28},{title:"大笑小蜂",file:c+"5@2x.png",size:28},{title:"得意小蜂",file:c+"6@2x.png",size:28},{title:"犯色相小蚂",file:c+"7@2x.png",size:28},{title:"害羞小蚂",file:c+"9@2x.png",size:28},{title:"尴尬小蜂",file:c+"10@2x.png",size:28},{title:"哼小蚂",file:c+"11@2x.png",size:28},{title:"坏笑小蜂",file:c+"12@2x.png",size:28},{title:"可怜哭小蜂",file:c+"13@2x.png",size:28},{title:"困小蜂",file:c+"15@2x.png",size:28},{title:"流汗小蚂",file:c+"16@2x.png",size:28},{title:"么么哒小蚂",file:c+"17@2x.png",size:28},{title:"晕小蜂",file:c+"18@2x.png",size:28},{title:"爱心小蜂",file:c+"20@2x.png",size:28},{title:"偷笑小蚂",file:c+"21@2x.png",size:28},{title:"微笑小蚂",file:c+"23@2x.png",size:28},{title:"心碎小蜂",file:c+"24@2x.png",size:28},{title:"再见小蜂",file:c+"28@2x.png",size:28},{title:"赞小蜂",file:c+"29@2x.png",size:28},{title:"抓狂小蚂",file:c+"31@2x.png",size:28},{title:"捂脸小蜂",file:c+"36@2x.png",size:28},{title:"笑哭",file:c+"37@2x.png",size:28}],character:[{title:"大笑",file:a+"1@2x.png"},{title:"微笑",file:a+"2@2x.png"},{title:"亲亲",file:a+"3@2x.png"},{title:"色色",file:a+"5@2x.png"},{title:"笑cry",file:a+"79@2x.png"},{title:"无奈",file:a+"6@2x.png"},{title:"睡觉",file:a+"19@2x.png"},{title:"害羞",file:a+"8@2x.png"},{title:"酷",file:a+"9@2x.png"},{title:"晕倒",file:a+"10@2x.png"},{title:"眨眼",file:a+"11@2x.png"},{title:"鬼脸",file:a+"12@2x.png"},{title:"大哭",file:a+"21@2x.png"},{title:"大怒",file:a+"46@2x.png"},{title:"生气",file:a+"27@2x.png"},{title:"不爽",file:a+"53@2x.png"},{title:"尴尬",file:a+"80@2x.png"},{title:"嘴馋",file:a+"50@2x.png"},{title:"呵呵",file:a+"81@2x.png"},{title:"冷漠",file:a+"131@2x.png"},{title:"失落",file:a+"34@2x.png"},{title:"困惑",file:a+"17@2x.png"},{title:"吃惊",file:a+"14@2x.png"},{title:"抓狂",file:a+"52@2x.png"},{title:"汗",file:a+"54@2x.png"},{title:"焦虑",file:a+"82@2x.png"},{title:"惊悚",file:a+"83@2x.png"},{title:"生病",file:a+"47@2x.png"},{title:"药丸",file:a+"76@2x.png"},{title:"闭嘴",file:a+"25@2x.png"},{title:"小丑",file:a+"45@2x.png"},{title:"精灵",file:a+"44@2x.png"},{title:"天使",file:a+"84@2x.png"},{title:"邪恶",file:a+"85@2x.png"},{title:"骷髅",file:a+"70@2x.png"},{title:"魅力四射",file:a+"30@2x.png"},{title:"吻",file:a+"33@2x.png"},{title:"爱心",file:a+"32@2x.png"},{title:"心碎",file:a+"31@2x.png"},{title:"看",file:a+"86@2x.png"},{title:"嘴唇",file:a+"87@2x.png"},{title:"剪刀手",file:a+"88@2x.png"},{title:"击掌",file:a+"89@2x.png"},{title:"上",file:a+"90@2x.png"},{title:"下",file:a+"91@2x.png"},{title:"左",file:a+"92@2x.png"},{title:"右",file:a+"93@2x.png"},{title:"再见",file:a+"20@2x.png"},{title:"OK",file:a+"94@2x.png"},{title:"赞",file:a+"28@2x.png"},{title:"加油",file:a+"95@2x.png"},{title:"鼓掌",file:a+"96@2x.png"},{title:"祈祷",file:a+"78@2x.png"},{title:"举手",file:a+"97@2x.png"},{title:"不行",file:a+"98@2x.png"},{title:"狼狈",file:a+"130@2x.png"},{title:"男孩",file:a+"74@2x.png"},{title:"女孩",file:a+"75@2x.png"},{title:"男人",file:a+"99@2x.png"},{title:"女人",file:a+"100@2x.png"},{title:"爷爷",file:a+"101@2x.png"},{title:"奶奶",file:a+"102@2x.png"},{title:"宝宝",file:a+"103@2x.png"},{title:"甜蜜",file:a+"104@2x.png"},{title:"家庭",file:a+"105@2x.png"},{title:"情侣",file:a+"106@2x.png"},{title:"基友",file:a+"107@2x.png"},{title:"闺蜜",file:a+"108@2x.png"}],travel:[{title:"太阳",file:a+"72@2x.png"},{title:"云",file:a+"109@2x.png"},{title:"下雨",file:a+"67@2x.png"},{title:"闪电",file:a+"110@2x.png"},{title:"多云",file:a+"111@2x.png"},{title:"雪",file:a+"112@2x.png"},{title:"星星",file:a+"43@2x.png"},{title:"月亮",file:a+"62@2x.png"},{title:"地球",file:a+"113@2x.png"},{title:"飞机",file:a+"114@2x.png"},{title:"火箭",file:a+"115@2x.png"},{title:"直升机",file:a+"116@2x.png"},{title:"火车",file:a+"117@2x.png"},{title:"电车",file:a+"118@2x.png"},{title:"高铁",file:a+"119@2x.png"},{title:"地铁",file:a+"120@2x.png"},{title:"火车站",file:a+"121@2x.png"},{title:"巴士",file:a+"122@2x.png"},{title:"出租车",file:a+"123@2x.png"},{title:"汽车",file:a+"124@2x.png"},{title:"加油站",file:a+"125@2x.png"},{title:"码头",file:a+"126@2x.png"},{title:"游轮",file:a+"127@2x.png"},{title:"帆船",file:a+"128@2x.png"},{title:"缆车",file:a+"129@2x.png"},{title:"自行车",file:a+"132@2x.png"},{title:"红绿灯",file:a+"133@2x.png"},{title:"路障",file:a+"134@2x.png"},{title:"停车场",file:a+"135@2x.png"},{title:"残疾人专用",file:a+"136@2x.png"},{title:"ATM",file:a+"137@2x.png"},{title:"换钱",file:a+"138@2x.png"},{title:"银行卡",file:a+"139@2x.png"},{title:"人民币",file:a+"56@2x.png"},{title:"美元",file:a+"140@2x.png"},{title:"欧元",file:a+"141@2x.png"},{title:"中国",file:a+"142@2x.png"},{title:"德国",file:a+"143@2x.png"},{title:"英国",file:a+"144@2x.png"},{title:"美国",file:a+"145@2x.png"},{title:"俄罗斯",file:a+"146@2x.png"},{title:"西班牙",file:a+"147@2x.png"},{title:"意大利",file:a+"148@2x.png"},{title:"法国",file:a+"149@2x.png"},{title:"日本",file:a+"150@2x.png"},{title:"韩国",file:a+"151@2x.png"},{title:"日出",file:a+"152@2x.png"},{title:"夜景",file:a+"153@2x.png"},{title:"露营",file:a+"154@2x.png"},{title:"星空",file:a+"155@2x.png"},{title:"火山",file:a+"156@2x.png"},{title:"彩虹",file:a+"157@2x.png"},{title:"游乐园",file:a+"158@2x.png"},{title:"海浪",file:a+"159@2x.png"},{title:"房子",file:a+"160@2x.png"},{title:"足迹",file:a+"161@2x.png"}],apparel:[{title:"王冠",file:a+"162@2x.png"},{title:"草帽",file:a+"163@2x.png"},{title:"零钱包",file:a+"164@2x.png"},{title:"眼镜",file:a+"165@2x.png"},{title:"女装",file:a+"166@2x.png"},{title:"男装",file:a+"167@2x.png"},{title:"裤子",file:a+"168@2x.png"},{title:"裙子",file:a+"169@2x.png"},{title:"比基尼",file:a+"170@2x.png"},{title:"和服",file:a+"171@2x.png"},{title:"跳舞",file:a+"172@2x.png"},{title:"走路",file:a+"173@2x.png"},{title:"跑步",file:a+"174@2x.png"},{title:"冲浪",file:a+"175@2x.png"},{title:"滑雪",file:a+"176@2x.png"},{title:"游泳",file:a+"177@2x.png"},{title:"钓鱼",file:a+"178@2x.png"},{title:"足球",file:a+"41@2x.png"},{title:"篮球",file:a+"179@2x.png"},{title:"赛车",file:a+"180@2x.png"},{title:"冠军",file:a+"181@2x.png"}],food:[{title:"苹果",file:a+"38@2x.png"},{title:"西瓜",file:a+"39@2x.png"},{title:"柠檬",file:a+"182@2x.png"},{title:"葡萄",file:a+"183@2x.png"},{title:"香蕉",file:a+"184@2x.png"},{title:"橙子",file:a+"185@2x.png"},{title:"菠萝",file:a+"186@2x.png"},{title:"樱桃",file:a+"187@2x.png"},{title:"草莓",file:a+"188@2x.png"},{title:"汉堡",file:a+"189@2x.png"},{title:"肉",file:a+"190@2x.png"},{title:"面条",file:a+"191@2x.png"},{title:"快餐",file:a+"192@2x.png"},{title:"寿司",file:a+"193@2x.png"},{title:"冰淇淋",file:a+"194@2x.png"},{title:"巧克力",file:a+"195@2x.png"},{title:"糖果",file:a+"196@2x.png"},{title:"蜂蜜",file:a+"197@2x.png"},{title:"餐厅",file:a+"64@2x.png"},{title:"咖啡",file:a+"40@2x.png"},{title:"红酒",file:a+"198@2x.png"},{title:"果汁",file:a+"199@2x.png"},{title:"啤酒",file:a+"200@2x.png"},{title:"干杯",file:a+"16@2x.png"},{title:"蝴蝶结",file:a+"201@2x.png"},{title:"礼物",file:a+"37@2x.png"},{title:"生日蛋糕",file:a+"36@2x.png"},{title:"万圣节",file:a+"202@2x.png"},{title:"圣诞节",file:a+"203@2x.png"},{title:"圣诞老人",file:a+"204@2x.png"},{title:"雪人",file:a+"205@2x.png"},{title:"铃铛",file:a+"206@2x.png"},{title:"庆祝",file:a+"207@2x.png"},{title:"气球",file:a+"208@2x.png"},{title:"风铃",file:a+"209@2x.png"},{title:"灯笼",file:a+"210@2x.png"}],animal:[{title:"蚂蚁",file:a+"211@2x.png"},{title:"蜜蜂",file:a+"212@2x.png"},{title:"瓢虫",file:a+"213@2x.png"},{title:"狗狗",file:a+"69@2x.png"},{title:"猫猫",file:a+"68@2x.png"},{title:"牛",file:a+"214@2x.png"},{title:"虎",file:a+"263@2x.png"},{title:"兔子",file:a+"215@2x.png"},{title:"熊猫",file:a+"216@2x.png"},{title:"熊",file:a+"285@2x.png"},{title:"考拉",file:a+"217@2x.png"},{title:"猴子",file:a+"218@2x.png"},{title:"猪头",file:a+"60@2x.png"},{title:"青蛙",file:a+"219@2x.png"},{title:"仓鼠",file:a+"220@2x.png"},{title:"鸡",file:a+"221@2x.png"},{title:"企鹅",file:a+"222@2x.png"},{title:"章鱼",file:a+"223@2x.png"},{title:"海豚",file:a+"224@2x.png"},{title:"鱼",file:a+"225@2x.png"},{title:"马",file:a+"226@2x.png"},{title:"羊",file:a+"227@2x.png"},{title:"大象",file:a+"228@2x.png"},{title:"骆驼",file:a+"229@2x.png"},{title:"仙人掌",file:a+"230@2x.png"},{title:"椰子树",file:a+"231@2x.png"},{title:"樱花",file:a+"232@2x.png"},{title:"玫瑰",file:a+"35@2x.png"},{title:"向日葵",file:a+"233@2x.png"},{title:"枫叶",file:a+"234@2x.png"}],tool:[{title:"时钟",file:a+"235@2x.png"},{title:"倒计时",file:a+"236@2x.png"},{title:"放大镜",file:a+"237@2x.png"},{title:"环保",file:a+"238@2x.png"},{title:"注意",file:a+"51@2x.png"},{title:"停止",file:a+"239@2x.png"},{title:"铅笔",file:a+"240@2x.png"},{title:"信",file:a+"73@2x.png"},{title:"邮筒",file:a+"241@2x.png"},{title:"书",file:a+"242@2x.png"},{title:"灯泡",file:a+"243@2x.png"},{title:"火",file:a+"244@2x.png"},{title:"对话",file:a+"245@2x.png"},{title:"图钉",file:a+"246@2x.png"},{title:"喇叭",file:a+"247@2x.png"},{title:"电话",file:a+"248@2x.png"},{title:"手机",file:a+"249@2x.png"},{title:"信号",file:a+"250@2x.png"},{title:"电池",file:a+"251@2x.png"},{title:"插头",file:a+"252@2x.png"},{title:"照相机",file:a+"253@2x.png"},{title:"录像机",file:a+"254@2x.png"},{title:"票",file:a+"255@2x.png"},{title:"音乐",file:a+"63@2x.png"},{title:"绘画",file:a+"256@2x.png"},{title:"锁",file:a+"257@2x.png"},{title:"置顶",file:a+"258@2x.png"},{title:"十八禁",file:a+"259@2x.png"},{title:"秘密",file:a+"260@2x.png"},{title:"正确",file:a+"261@2x.png"},{title:"错误",file:a+"262@2x.png"}],quick:[{title:"大笑",file:a+"1@2x.png"},{title:"微笑",file:a+"2@2x.png"},{title:"亲亲",file:a+"3@2x.png"},{title:"色色",file:a+"5@2x.png"},{title:"笑cry",file:a+"79@2x.png"},{title:"害羞",file:a+"8@2x.png"},{title:"酷",file:a+"9@2x.png"},{title:"鬼脸",file:a+"12@2x.png"},{title:"大哭",file:a+"21@2x.png"},{title:"抓狂",file:a+"52@2x.png"},{title:"汗",file:a+"54@2x.png"},{title:"邪恶",file:a+"85@2x.png"},{title:"魅力四射",file:a+"30@2x.png"},{title:"吻",file:a+"33@2x.png"},{title:"爱心",file:a+"32@2x.png"},{title:"心碎",file:a+"31@2x.png"},{title:"剪刀手",file:a+"88@2x.png"},{title:"再见",file:a+"20@2x.png"},{title:"赞",file:a+"28@2x.png"},{title:"加油",file:a+"95@2x.png"},{title:"鼓掌",file:a+"96@2x.png"},{title:"祈祷",file:a+"78@2x.png"},{title:"太阳",file:a+"72@2x.png"},{title:"干杯",file:a+"16@2x.png"},{title:"庆祝",file:a+"207@2x.png"},{title:"蜜蜂",file:a+"212@2x.png"},{title:"玫瑰",file:a+"35@2x.png"},{title:"灯泡",file:a+"243@2x.png"},{title:"对话",file:a+"245@2x.png"},{title:"置顶",file:a+"258@2x.png"}]}});M.define("/js/module/app/Page",function(b,a,d){function c(e){M.mix(this,e);this.container=$(this.container);if(!this.container.length){this.container=$(document)}this.init();if(!M.isEmptyObject(this.events)){this.setEvents(this.events)}this.bindEvents()}M.mix(c.prototype,{container:null,events:[],init:$.noop,bindEvents:$.noop,setEvents:function(e){M.forEach(e,$.proxy(function(i,g){var j=g.split(","),h=$.trim(j[0]),f=j.slice(1);if(i in this.eventHandlers){if(f.length){f=$.trim(f.join(","));this.container.on(h,f,$.proxy(this.eventHandlers[i],this))}else{this.container.on(h,$.proxy(this.eventHandlers[i],this))}}},this))},destroy:$.noop,eventHandlers:{}});d.exports=c});M.define("FrequencyVerifyControl",function(c,b,d){function a(e){this.container=e.container;this.app=e.app;this.successHandler=$.noop;M.mix(this,e);this.init()}a.prototype={init:function(){this.initData();this.refreshImg();this.verifyCon.delegate("img,._j_change_img","click",$.proxy(function(e){this.refreshImg()},this));this.verifyCon.delegate("._j_fre_confirm","click",$.proxy(function(h){var g=this.verifyText.val();var f=g.length;if(f==0){this.showErro("您还没有输入验证码!");return false}else{if(f!==6){this.showErro("请输入正确的验证码!");return false}}var e=$(h.currentTarget);if(e.hasClass("waiting")){return false}e.addClass("waiting");$.post("/user/captcha/verify",{sCode:g,iApp:this.app},$.proxy(function(i){if(i){if(i.ret===1){this.successHandler(this.target);this.verifyCon.hide();this.hideErro()}else{if(i.ret===0){this.verifyText.val("");this.verifyText.focus();this.refreshImg();this.showErro("输入的验证码不正确!")}else{if(i.ret===-1){this.showErro("错误次数过多，请稍候尝试")}}}}e.removeClass("waiting")},this),"json")},this));this.verifyCon.delegate("._j_fre_text","keyup",$.proxy(function(e){if(e.keyCode==13){this.verifyCon.find("._j_fre_confirm").trigger("click")}},this))},showErro:function(e){this.errorCon.html(e);this.errorCon.show()},hideErro:function(){this.errorCon.hide()},initData:function(){this.verifyCon=this.container;this.verifyPo=this.verifyCon.find(".protectedYZM");this.verifyImg=this.verifyCon.find("img");this.verifyText=this.verifyCon.find("._j_fre_text");this.errorCon=this.verifyPo.find(".n-error")},refreshImg:function(){var e="/user/captcha/code?iApp="+this.app+"&s="+new Date().getTime();this.verifyImg.attr("src",e)}};d.exports=a});M.define("FrequencyAppVerify",function(e,c,f){var b=e("FrequencyVerifyControl");var d=0,g='<div class="popYzm _j_fre_verify_',a='"><div class="protectedYZM"><p>亲爱的蜂蜂，你发表速度有点像机器人<br>来证明下自己吧~</p><div class="YZMInput"><input class="_j_fre_text" type="text" placeHolder="验证码"></div><div class="YZMInput"><img src="http://images.mafengwo.net/images/home_new2015/verify.gif" width="150px" height="40px"><label><a href="javascript:void(0);" class="_j_change_img">看不清，换一张</a></label></div><div class="YZMSubmit"><a href="javascript:void(0);" class="_j_fre_confirm" title="确定">确定</a><span class="n-error">错误次数过多，请稍候尝试</span></div></div></div>';function h(i){this.target=i.target;this.content=i.content;this.app=i.app;this.left=i.left;this.top=i.top;this.successHandler=$.noop;M.mix(this,i);this.init()}h.prototype={init:function(){$("body").append(g+d+a);this.initData();this.initPostion();this._baseFrequency=new b({container:this.verifyCon,app:this.app,successHandler:$.proxy(function(){M.Event.fire("frequency:app:verify:success");this.verifyCon.remove();this.successHandler(this.target)},this)});d++},initData:function(){this.verifyCon=$("._j_fre_verify_"+d);this.verifyCon.find("p").html(this.content);this.verifyPo=this.verifyCon.find(".protectedYZM")},initPostion:function(){var o=this.target.offset().left;if(typeof this.top==="undefined"){var i=this.target.offset().top}else{var i=this.top;this.verifyCon.css("position","fixed")}var p=this.target.outerHeight();var l=this.target.outerWidth();this.verifyCon.css({left:o+"px",top:i+"px"});var j=$(document).width();var k=$(document).height();var q="l";if(o>j/2){q="r"}var n="t";if(i>k/2){n="b"}var m="";if(q=="l"&&n=="t"){if(i>200){m="atTop"}else{this.verifyCon.css({top:(i+p+5)+"px"})}}else{if(q=="r"&&n=="t"){if(i>200){m="atTopRight"}else{m="atRight"}this.verifyCon.css({left:(o+l)+"px"})}else{if(q=="r"&&n=="b"){m="atTopRight";this.verifyCon.css({left:(o+l)+"px"})}else{m="atTop"}}}if(m.length>0){this.verifyPo.addClass(m)}},show:function(){this.verifyCon.show();return this},hide:function(){this.verifyCon.hide();return this},refreshImg:function(){this._baseFrequency.refreshImg();return this},destroy:function(){this.verifyCon.undelegate();this.verifyCon.remove();this.verifyCon=null;M.Event(this).fire("afterdestroy")}};f.exports=h});M.define("/js/Selection",function(b,a,c){c.exports={getFocusPos:function(f){if(f.selectionStart){return f.selectionStart}else{if(document.selection){var e=document.selection.createRange();if(e==null){return 0}var d=f.createTextRange(),g=d.duplicate();d.moveToBookmark(e.getBookmark());g.setEndPoint("EndToStart",d);return g.text.length}}return 0},setCursorArea:function(g,h,d){if(g.setSelectionRange){g.setSelectionRange(h,d);g.focus()}else{if(document.selection){var f=document.selection.createRange();if(f==null){return 0}var e=g.createTextRange();e.collapse(true);e.moveEnd("character",d);e.moveStart("character",h);e.select()}}},selectAllRangs:function(f){var f=$(f).get(0);var d,e;if(window.getSelection){e=window.getSelection();d=document.createRange();d.selectNodeContents(f);e.removeAllRanges();e.addRange(d)}else{if(document.body.createTextRange){d=document.body.createTextRange();d.moveToElementText(f);d.select()}}},movePointForwardNode:function(e,g){var f,d;if(window.getSelection){f=window.getSelection();d=f.getRangeAt(0);d.setStart(e,0);d.setEnd(e,0);f.removeAllRanges();f.addRange(d)}else{if(document.selection){f=document.selection;if(f.type!="Control"){d=f.createRange();d.moveToElementText(e);d.collapse(true);d.select()}}}g&&g()}}});M.define("/js/EmotionFastDelete",function(c,a,e){var g=c("/js/EmotionsHd"),f=c("/js/Selection");var b={};if(!window._emotionList){for(var d in g){if(g.hasOwnProperty(d)){M.forEach(g[d],function(j,i){b[j.title]=1})}}window._emotionList=b}function h(i){this.container=i.container||$("body");this.editor=i.editor;this.bindEvents()}h.prototype={bindEvents:function(){if(window._emotionList&&this.container.find(this.editor).length){this.container.on("keydown",this.editor,$.proxy(this.keyDown,this))}},keyDown:function(i){if(i.keyCode===8){this.deleteEmotion(i.currentTarget)}},deleteEmotion:function(k){var j=f.getFocusPos(k);if(!k.setSelectionRange||!j){return false}var l=$(k).val();var n=j>10?j-10:0;var i=j>10?10:j;l=l.substr(n,i);var m=l.match(/\(([\u4e00-\u9fa5]+)\)$/);if(m&&m.length>1&&m[1] in window._emotionList){f.setCursorArea(k,j-m[1].length-2,j)}}};e.exports=h});M.define("dialog/BindMobileAlert",function(b,a){var c=b("dialog/alert");return{pop:function(d,e){!!mfwPageEvent&&mfwPageEvent("ugc","needbindmobile",{act:"show"});return c.pop(d,e)}}});M.define("/js/note/GiveSign",function(a){a("jq-tmpl");var b=null;return b={flag:false,data:{},acquireGiveSignData:function(d){var c=this,f,e=new jQuery.Deferred();$.ajax({url:"/note/reply/board",dataType:"json",success:function(g){if(Number(g.code)===0){c.data=g.body;c.flag=true;d.resolve()}else{d.reject(g.body)}}})},renderGiveSignComponent:function(d){if(b.isAuthorLogin()){return false}var c=this,e=$.Deferred();if(!c.flag){c.acquireGiveSignData.call(c,e);$.when(e).then(function(){return c.createGiveSignComponent.call(c,d)})}else{return c.createGiveSignComponent.call(c,d)}},createGiveSignComponent:function(f){var l=this,g=$(f.el),k=f.type,j=$(f.giveSignEntry),c=$(f.showSelectedGiveSign),d=$(f.deleteSelectedGiveSign),h='<div><span class="title">举牌子</span><span class="about-amount"><label>金币 : </label><span class="amount">${coin}</span><span class="need-amount"></span></span></div>';giveSignItemTmpl='<div><li data-index="${index}" data-id="${id}" data-price="${price}" class="give-sign-single {{if type === "small"}}small-sign{{/if}} {{if price > coin}}disabled{{/if}} {{if index%4 != 0}}l{{/if}} {{if index > 3}}t{{/if}}"><img src="${image_url}" class="give-sign-single-icon {{if type === "small"}}small-sign{{/if}}">{{if badge_image_url}}<img class="badge-image" src="${badge_image_url}">{{/if}}</li></div>',giveSignTitleTemplate="",giveSignTemplate="";$.template("GiveSignTitleTmpl",h);$.template("GiveSignItemTmpl",giveSignItemTmpl);if(l.data&&l.data.boards&&l.data.boards.length){j.show();giveSignTitleTemplate=$.tmpl("GiveSignTitleTmpl",{coin:l.data.coin}).html();$.each(l.data.boards,function(n,m){giveSignTemplate+=$.tmpl("GiveSignItemTmpl",{image_url:m.image_url,badge_image_url:m.badge_image_url,id:m.id,price:m.price,index:n,coin:l.data.coin,type:k}).html()})}var e=g.find(".give-sign-details-title-section"),i=g.find(".give-sign-details-list-section");e.html(giveSignTitleTemplate);i.html(giveSignTemplate);g.closest("._j_editor").removeData("selectGiveSignId");i.off().on("click","li",function(p){p.preventDefault();p.stopPropagation();var q=$(this),n=q.attr("data-index"),r=q.attr("data-id"),o="-"+q.attr("data-price"),m=l.data.boards[n].image_url;if(!q.hasClass("disabled")){q.siblings().removeClass("active");q.addClass("active");g.find(".give-sign-details-title-section").find(".need-amount").text("("+o+")");c.find(".selected-give-sign").remove();c.prepend('<img class="selected-give-sign" src="'+m+'">');g.closest("._j_editor").data("selectGiveSignId",r);q.closest(".give-sign-details").hide()}});i.find("li").mouseenter(function(n){n.preventDefault();n.stopPropagation();var o=$(this),m="-"+o.attr("data-price");if(!o.hasClass("disabled")){g.find(".give-sign-details-title-section").find(".need-amount").text("("+m+")")}else{g.find(".give-sign-details-title-section").find(".need-amount").text("")}});i.mouseleave(function(){var n=i.find("li.active");if(n.length){var m="-"+n.attr("data-price");g.find(".give-sign-details-title-section").find(".need-amount").text(" ("+m+") ")}else{g.find(".give-sign-details-title-section").find(".need-amount").text("")}});d.on("click",function(m){m.preventDefault();m.stopPropagation();c.find(".selected-give-sign").remove();i.find("li").removeClass("active");e.find(".need-amount").text("");g.closest("._j_editor").removeData("selectGiveSignId")})},clearSelectedGiveSign:function(d){var c=$(d);c.find(".selected-give-sign").remove();c.closest("._j_editor").find(".give-sign-details-list-section li").removeClass("active");c.closest("._j_editor").find(".need-amount").text("");c.closest("._j_editor").removeData("selectGiveSignId")},syncCoin:function(c){if(c&&c.targets&&c.targets.length){$.each(c.targets,function(d,f){var e=$(f);e.text(c.coin);b.data.coin=c.coin})}},acquirePrice:function(d){for(var c=0;c<b.data.boards.length;c++){if(Number(d)===Number(b.data.boards[c].id)){return b.data.boards[c].price}}return 0},isAuthorLogin:function(){var c=window.Env.UID,d=window.Env.author_uid;if(Number(c)===Number(d)){return true}else{return false}}}});M.define("/js/note/GinfoReply",function(d,g,c){var l=d("/js/module/app/Page"),e=d("FrequencyAppVerify"),k=d("/js/Selection"),a=d("/js/EmotionFastDelete"),i=d("dialog/alert"),h=d("dialog/BindMobileAlert"),j=d("TopTip"),b=d("/js/note/GiveSign");var f=function(o){var m=o.container;var n=o.appType;new l({container:m,events:{"click,._j_publish_reply":"publishReply","click,._j_face_pop ._j_emojiitem":"insertFace","click,._j_face_switch":"pageFace","click,._j_prop_item":"chooseTag","click,.art_submit":"insertAt","click,.result li":"chooseAtName","click,._quick_give_sign_btn":"clickShowTag","blur,._j_replyarea":"recordPos","focus,._j_replyarea":"checkBindMobile"},init:function(){this.data={};this.data.is_note=window.Env.is_new_note;this.initEmothionFastDelete()},initEmothionFastDelete:function(){new a({container:m,editor:"._j_replyarea"})},bindEvents:function(){var p=($.browser.msie&&parseInt($.browser.version,10)<9)?"keyup":"input";var q=0;this.container.delegate("._j_at_txt",p,function(){var t=$(this);var s=$.trim(t.val());var r=t.closest("._j_at_inner");var u=t.siblings(".result");clearTimeout(q);if(!s){u.empty().hide()}else{q=setTimeout(function(){$.getJSON("/note/create.php/userSuggest?word="+s,function(w){u.empty();if(w.length>0){for(var v in w){$("<li>"+w[v].name+"</li>").data("id",w[v].id).appendTo(u)}}u.css("top",r.height()).show().get(0).scrollTop=0})},500)}}).delegate(".art_search","click",function(){$(this).find("._j_at_txt").trigger("focus")}).delegate("span.added i","click",function(){$(this).closest(".added").fadeOut(300,function(){$(this).remove()})})},publishReplyWithTarget:function(t){var s=t.closest("._j_editor");var p=0;var v=s.find("._j_prop_normal ._j_prop_item.on");if(v.length){p=parseInt(v.data("propid"),10)}var r=s.find("textarea[name='reply_content']");var q=r.val();if($.trim(q).length==0){i.pop("请输入内容");return false}if(t.hasClass("current-loading")){return false}t.addClass("current-loading");var u={iid:window.Env.iid,content:q,board_id:s.data("selectGiveSignId"),reply_id:s.data("objid"),ref_image:s.data("link"),ref_text:s.data("quote")};$.post("/note/reply/reply",u,$.proxy(function(x){if(Number(x.code)===0){t.removeClass("current-loading");if(x.body){if(x.body.rid){var w=x.body.rid;r.val("");if(p>0){this.hideProp()}if(n=="quick"){this.quickAfterReply("");b.clearSelectedGiveSign("#_js_quickSelectedGiveSign")}else{if(n=="quote"){this.quoteAfterReply("");b.clearSelectedGiveSign("#_js_quoteSelectedGiveSign")}else{this.defaultAfterReply(w)}}b.syncCoin({coin:b.data.coin-b.acquirePrice(u.board_id),targets:["#_js_giveSign .amount","#_js_QuickGiveSign .amount","#_js_quoteGiveSign .amount"]})}else{i.pop("发表回复失败")}}}else{if(Number(x.code)===12){new e({target:t,app:x.body,content:"亲爱的蜂蜂，你发表回复的速度有点像机器人<br>来证明下自己吧~",successHandler:$.proxy(function(){t.removeClass("current-loading");this.publishReplyWithTarget(t)},this)})}else{t.removeClass("current-loading");i.pop(x.body)}}},this),"json")},eventHandlers:{recordPos:function(p){$(p.currentTarget).data("position",k.getFocusPos(p.currentTarget))},checkBindMobile:function(p){if(window.Env.UID&&!window.Env.MOBILE_BINDED){p.preventDefault();h.pop({title:"依《网络安全法》要求，你需要在发布内容之前绑定手机号~",assureWords:"去绑定"},function(q){if(q.data("btn_trigger")){location.href=window.Env.P_HTTP+"/setting/security/mobile/"}})}},publishReply:function(p){p.preventDefault();var q=$(p.currentTarget);this.publishReplyWithTarget(q)},clickShowTag:function(p){var q=$(p.currentTarget);if(q.hasClass("tags_tips")){$("._j_show_tags").removeClass("tags_tips");$.post("/note/ajax_post.php",{sAction:"setTagIcon",__ctk__:window.Env.__ctk__})}},insertFace:function(s){var t=$(s.currentTarget);var r=t.closest("._j_editor");var p=r.find("._j_replyarea");var u=r.find("._j_face_pop");var q=t.data("value");if(typeof(q)=="undefined"){q=t.attr("title")}this.insertText(p.get(0),"("+q+")");u.hide()},pageFace:function(A){var w=$(A.currentTarget),v=w.parent(".newtab-pagin"),x=w.parents(".art_pop"),s=x.find("._j_switch_container"),u=4,p=80,B=1;var y=parseInt(v.data("page"),10);var t=Math.ceil(x.find("._j_face_tab").length/u);var r=w.data("type")==="prev"?-1:1;var z=Math.min(Math.max(y+r,1),t);if(z!==y){v.data("page",z);var q=(p+B)*u*(z-1)*-1;if(z==t){v.find("._j_face_switch").removeClass("disabled");v.find("._j_face_switch[data-type='next']").addClass("disabled")}if(z==1){v.find("._j_face_switch").removeClass("disabled");v.find("._j_face_switch[data-type='prev']").addClass("disabled")}s.css("left",q+"px")}},chooseTag:function(t){t.preventDefault();var u=$(t.currentTarget);var r=u.closest("._j_editor");var s=r.find("._j_prop_normal");if(u.hasClass("on")){s.find("._j_prop_item").removeClass("on")}else{s.find("._j_prop_item").removeClass("on");u.toggleClass("on")}if(u.parents("._j_quick_card_ch").length){var v=r.find("._j_show_tags");var q=r.find("._j_tags_pop");if(s.find("._j_prop_item.on").length){var p=u.text();if(u.hasClass("l17")||u.hasClass("llong")){v.addClass("l17")}v.addClass("on").html(p+"<i></i>")}else{v.removeClass("on").html("举牌<i></i>").removeClass("l17")}q.hide()}},insertAt:function(u){u.preventDefault();var v=$(u.currentTarget);var q=v.closest("._j_at_pop_box").find("._j_at_inner");var t=q.find("span.added");var s=v.closest("._j_editor");var p=s.find("._j_replyarea");var r=s.find(".art_pop");t.each($.proxy(function(x,y){var z=$(y).data("id");var w=$(y).data("name");this.insertText(p.get(0)," @"+w+"("+z+") ")},this));q.find("span").remove();r.hide()},chooseAtName:function(s){var t=$(s.currentTarget);var u=t.data("id");var q=t.text();var p=t.closest("._j_at_inner");if(p.find('span[rel="'+u+'"]').size()>0){return false}p.find("._j_at_txt").val("");var r=$('<span rel="'+u+'" class="added">'+q+"<i>×</i></span>").data({id:u,name:q});p.find("._j_at_txt").before(r);p.find(".result").hide()}},insertText:function(p,v){if(document.selection){this.focusText(p);var q=document.selection.createRange();q.text=v}else{if(typeof p.selectionStart==="number"&&typeof p.selectionEnd==="number"){var s=p.selectionStart,r=p.selectionEnd,t=s,u=$(p).val();$(p).val(u.substring(0,s)+v+u.substring(r,u.length));$(p).focus();t+=v.length;p.selectionStart=p.selectionEnd=t}else{$(p).val($(p).val()+v)}}},hideProp:function(){$("._j_show_tags").hide();$("._j_tags_def").hide();M.Event.fire("hideTagBtn")},focusText:function(p){var r=$(p).data("position");if(!r){r=0}if(p.createTextRange){var q=p.createTextRange();q.collapse(!0);q.moveStart("character",r);q.select()}},quoteAfterReply:function(p){m.data("flag",0);m.data("quote","");m.data("link","");M.Event.fire("quoteDialogClose");var q=(p!="")?p:"回复成功";j.show(q)},quickAfterReply:function(r){var p=$("._j_quick_reply");var q=parseInt(p.find("span").html())+1;p.find("span").html(q);m.find("._j_show_tags").removeClass("on").html("举牌");m.find("._j_prop_normal ul li a").removeClass("on");m.find("._j_at_inner span").remove();m.closest("._j_qr_box").hide();m.find("._j_at_txt").val("");m.find("._j_at_inner .result").empty().hide();var s=(r!="")?r:"回复成功";j.show(s)},defaultAfterReply:function(q,p){window.location.href="/note/r.php?iId="+window.Env.iid+"&iRid="+q}})};c.exports=f});M.define("Caret",function(a){var b=function(){};M.mix(b,{_gettingCaretPosition:false,getCaretPosition:function(f){f=$(f).get(0);var e=f.tagName;if(e!="TEXTAREA"&&e!="INPUT"){return{start:undefined,end:undefined}}if(!document.selection){return{start:f.selectionStart,end:f.selectionEnd}}if(e=="INPUT"){var d=document.selection.createRange();return{start:-d.moveStrt("character",-f.value.length),end:-d.moveEnd("character",-f.value.length)}}else{if(!this._gettingCaretPosition){this._gettingCaretPosition=true;f.focus();this._gettingCaretPosition=false}var d=document.selection.createRange();var g=d.duplicate();g.moveToElementText(f);g.setEndPoint("StartToEnd",d);var c=f.value.length-g.text.length;g.setEndPoint("StartToStart",d);return{start:f.value.length-g.text.length,end:c}}},setCaretPosition:function(f,g,c){f=$(f).get(0);if(document.selection){if(f.tagName=="TEXTAREA"){var e=f.value.indexOf("\r",0);while(e!=-1&&e<c){c--;if(e<g){g--}e=f.value.indexOf("\r",e+1)}}var d=f.createTextRange();d.collapse(true);d.moveStart("character",g);if(c!=undefined){d.moveEnd("character",c-g)}d.select()}else{f.selectionStart=g;c=c==undefined?g:c;f.selectionEnd=Math.min(c,f.value.length);f.focus()}},insertContent:function(g,c){g=$(g)[0];if($.browser.msie){g.focus();document.selection.createRange().text=c}else{var h=g.selectionStart,e=g.value,d=e.substring(0,h),f=e.substring(h);g.focus();g.value=d+c+f;this.setCaretPosition(g,(d+c).length)}}});return b});M.define("HoverTip",function(c,b,d){var e=M.mix,a=M.Event;function f(g){this.context=g.context||"body";this.selector=g.selector;this.single=true;this.tip=undefined;this.showWait=20;this.hideWait=100;this.showTime=100;this.hideTime=100;this.shStyle="fadeInOut";e(this,g);this.popUpTimer=null;this.popDownTimer=null;this.init()}f.prototype={init:function(){$(this.context).on("mouseenter",this.selector,$.proxy(this.popUp,this)).on("mouseleave",this.selector,$.proxy(this.popDown,this))},popUp:function(h){var g=$(h.currentTarget);if(this.single){clearTimeout(this.popDownTimer);if(this.showWait>0){this.popUpTimer=setTimeout($.proxy(function(){this.showPopUp(g)},this),this.showWait)}else{this.showPopUp(g)}}else{clearTimeout(g.data("popDownTimer"));if(this.showWait>0){g.data("popUpTimer",setTimeout($.proxy(function(){this.showPopUp(g)},this),this.showWait))}else{this.showPopUp(g)}}},popDown:function(h){var g=$(h.currentTarget);if(this.single){clearTimeout(this.popUpTimer);if(this.hideWait>0){this.popDownTimer=setTimeout($.proxy(function(){this.hidePopUp(g)},this),this.hideWait)}else{this.hidePopUp(g)}}else{clearTimeout(g.data("popUpTimer"));if(this.hideWait>0){g.data("popDownTimer",setTimeout($.proxy(function(){this.hidePopUp(g)},this),this.hideWait))}else{this.hidePopUp(g)}}},showPopUp:function(g){var h=this.getTip(g);if(!h&&this.setTip){h=this.setTip(g);if(this.single){this.tip=h}else{g.data("popuptip",h)}}if(h){if(!h.data("__hoverpop_tiphoverevent")){this.bindPopUpHoverEvent(h,g);h.data("__hoverpop_tiphoverevent",true)}if(this.deferShow){this.deferShow(g,h,$.proxy(function(){this.show(g,h)},this))}else{this.show(g,h)}}},getTip:function(g){return this.single?this.tip:$(g).data("popuptip")},hidePopUp:function(g){var h=this.getTip(g);if(h){this.hide(g,h)}},bindPopUpHoverEvent:function(h,g){var i=this;h.hover(function(){if(i.single){clearTimeout(i.popDownTimer)}else{clearTimeout(g.data("popDownTimer"))}},function(){if(i.single){if(i.hideWait>0){i.popDownTimer=setTimeout(function(){i.hidePopUp(g)},i.hideWait)}else{i.hidePopUp(g)}}else{if(i.hideWait>0){g.data("popDownTimer",setTimeout(function(){i.hidePopUp(g)},i.hideWait))}else{i.hidePopUp(g)}}})},show:function(g,h){a(this).fire("beforeshow",{trigger:g,tip:h});f.shower[this.shStyle].show(h,this.showTime,$.proxy(function(){a(this).fire("aftershow",{trigger:g,tip:h})},this))},hide:function(g,h){a(this).fire("beforehide",{trigger:g,tip:h});f.shower[this.shStyle].hide(h,this.hideTime,$.proxy(function(){a(this).fire("afterhide",{trigger:g,tip:h})},this))}};f.shower={fadeInOut:{show:function(g,h,i){$(g).stop(true,true).fadeIn(h,i)},hide:function(g,h,i){$(g).stop(true,true).fadeOut(h,i)}},showHide:{show:function(g,h,i){$(g).stop(true,true).show(h,i)},hide:function(g,h,i){$(g).stop(true,true).hide(h,i)}},slideDownUp:{show:function(g,h,i){$(g).stop(true,true).slideDown(h,i)},hide:function(g,h,i){$(g).stop(true,true).slideUp(h,i)}}};d.exports=f});M.define("/js/note/ControllerReply",function(i){i("jq-tmpl");var u=i("Storage"),l=i("ClickToggle"),g=i("/js/EmotionsHd"),f=i("/js/note/GinfoReply"),q=i("Caret"),j=i("dialog/alert"),t=i("dialog/confirm"),k=i("HoverTip"),o=i("/js/note/GiveSign"),m=null,e=null,h=null,b='<div><li data-index="${index}" data-id="${id}" data-price="${price}" class="give-sign-single"><a style="background-image: url(${image_url})" class="give-sign-single-icon"></a>{{if badge_image_url}}<i class="badge-image" style="background-image: url(${badge_image_url})"></i>{{/if}}</li></div>',p=null;return{events:{"click,._j_modify_reply":"modifyReplyUi","click,._j_mr_publish":"modifyReply","click,._j_delete_reply":"deleteReply","click,._j_reply":"replyBlockUi","click,._j_reward_tag":"jumpReward","click,._j_replytab ._j_publish_tab":"switchReplyTab","click,._j_reward_pay":"loadRewardPay","click,._j_reward_set":"loadRewardSet","click,._j_set_top":"setTopReply","click,._j_expand_top":"expandTop","mouseenter,.avatar":"showUserInfo","mouseleave,.avatar":"hideUserInfo",},init:function(){m=$("._j_reward_mao"),e=$("#_j_reply_list"),h=$("._j_replywrap");this.initActivityHoverTip();this.initMFWAppHoverTip();this.initTagUi();var v=new l({container:"#_j_editor",innerSelector:".at,._j_face_tab,._j_at_pop,.expression,._j_face_switch,._bottom_give_sign_btn,#_js_selectedGiveSign",handler:function(D,C){C.preventDefault();if(D.hasClass("expression")){var z=$("#_js_replyExpression");z.show().siblings(".art_pop").hide();var x=z.find(".art_newface");if(x.find("ul li").length===0){var B=z.find("._j_emojilist");B.each(function(F,G){G=$(G);if(G.data("emotion") in g){G.children("ul").html(M.map(g[G.data("emotion")],function(H){return'<li class="_j_emojiitem" title="'+H.title+'"><img src="'+H.file+'"></li>'}).join(""))}})}}else{if(D.hasClass("at")){var z=$("#_js_replyAt");var E=z.find(".art_arrow");var y=z.find("._j_at_inner");E.css("left",D.position().left+Math.round(D.outerWidth()/2)-Math.round(E.outerWidth()/2));y.find("._j_at_txt").val("");y.find(".result").empty();y.find("span").remove();z.show().siblings(".art_pop").hide()}else{if(D.hasClass("give_sign_btn")){var A=D.closest("._j_editor");A.find(".give-sign-details").show();var z=$("#_js_giveSign");z.show().siblings(".art_pop").hide()}}}},outHandler:function(y,x){$("#_j_editor .art_pop").hide()}});var w=new f({container:this.container.find("#_j_editor"),appType:"default"});$(function(){s();d()})},initActivityHoverTip:function(){var v=new k({selector:"._j_in_activity_icon",single:false,setTip:function(w){return w.children("dl")}})},initMFWAppHoverTip:function(){var v=new k({selector:"._j_fromapp_link",single:false,setTip:function(w){return w.children("img")}})},initTagUi:function(){o.renderGiveSignComponent({el:"#_js_giveSign",type:"big",showSelectedGiveSign:"#_js_selectedGiveSign",deleteSelectedGiveSign:"#_js_deleteShowGiveSign",giveSignEntry:"._bottom_give_sign_btn"})},modifyReplyUi:function(A){var B=$(A.currentTarget);if(!window.Env.UID){M.Event.fire("login:required");return false}this.container.find("._j_publish_tab[data-mode='article']").trigger("click");var y=B.closest("._j_reply_item");var x=y.data("rid");var w=this.container.find("#_j_editor");w.data("rid",x);var z=y.find("._j_reply_content").data("content");this.container.find("._j_publish_reply").addClass("_j_mr_publish").removeClass("_j_publish_reply");var v=this.container.find("textarea[name='reply_content']");v.val(z).focus().removeAttr("placeholder");q.setCaretPosition(v,z.length);var C=this.container.find("a[name='note_publish_reply']").offset();$(window).scrollTop(C.top)},modifyReply:function(z){z.preventDefault();var A=$(z.currentTarget);var B=this.container;var w=this.container.find("textarea[name='reply_content']");var v=w.val();var y=this.container.find("#_j_editor");var x=y.data("rid");if($.trim(v).length===0){j.pop("请输入内容");return false}if(A.hasClass("loading")){return false}A.addClass("loading");$.ajax({type:"POST",url:"/note/ajax/post/modifyReply",data:{iRid:x,sContent:v,__ctk__:window.Env.__ctk__},dataType:"json",success:function(G){A.removeClass("loading");if(!G.error){if(G.payload){var E=G.payload.html_content;var F=G.payload.orignal_content;if(G.payload.rid&&E){var D=G.payload.rid;B.find("textarea[name='reply_content']").val("");var C=B.find("._j_reply_item[data-rid='"+D+"']");var H=C.offset();$(window).scrollTop(H.top-72);C.find("._j_reply_content").html(E).data("content",F);B.find("._j_mr_publish").addClass("_j_publish_reply").removeClass("_j_mr_publish")}else{j.pop("发表回复失败")}}}else{j.pop(G.error.error)}}})},setTopReply:function(x){x.preventDefault();var y=$(x.currentTarget);var v=y.parents("._j_reply_item");var w=v.data("rid");$.post("/note/ajax_post.php",{sAction:"setTopReply",iRid:w},function(z){if(!z.error){y.remove();j.pop("成功选为精彩回复!")}else{j.pop("设置失败，请重试!")}},"json")},expandTop:function(w){w.preventDefault();var x=$(w.currentTarget);var v=x.children("em");if(x.hasClass("won-swich-hide")){x.removeClass("won-swich-hide");v.text("共有");$("#_j_top_reply_list div._j_reply_item").each(function(y,z){if(y>=3){$(z).hide()}})}else{x.addClass("won-swich-hide");v.text("收起");$("#_j_top_reply_list div._j_reply_item").each(function(){$(this).show()})}},deleteReply:function(x){x.preventDefault();var y=$(x.currentTarget);var v=y.parents("._j_reply_item");var w=v.data("rid");t.pop("确定删除该回复么？",function(){$.ajax({type:"POST",url:"/note/ajax/post/deleteReply",data:{iRid:w,__ctk__:window.Env.__ctk__},dataType:"json",success:function(z){if(!z.error){if(z.payload){if(z.payload.ret==1){v.slideUp(600,function(){v.remove();if(v.attr("id")=="top_reply_"+w){if($("#_j_top_reply_list div._j_reply_item").length==0){$("#_j_top_reply_list").remove()}$("#reply_"+w).slideUp(600,function(){$("#reply_"+w).remove();if($("#_j_reply_list div._j_reply_item").length===0&&window.Env.curr_page>1){window.location.href="/note/r.php?iId="+window.Env.iid+"&iPage="+(window.Env.curr_page-1)+"&sAction=page"}})}else{$("#top_reply_"+w).slideUp(600,function(){$("#top_reply_"+w).remove();if($("#_j_top_reply_list div._j_reply_item").length==0){$("#_j_top_reply_list").remove()}});if($("#_j_reply_list ._j_reply_item").length===0&&window.Env.curr_page>1){window.location.href="/note/r.php?iId="+window.Env.iid+"&iPage="+(window.Env.curr_page-1)+"&sAction=page"}}})}else{j.pop("删除回复失败")}}}else{j.pop(z.error.error)}}})})},replyBlockUi:function(A){A.preventDefault();var B=$(A.currentTarget);if(!window.Env.UID){M.Event.fire("login:required");return false}this.container.find("._j_publish_tab[data-mode='article']").trigger("click");this.container.find("._j_mr_publish").addClass("_j_publish_reply").removeClass("_j_mr_publish");var w=B.parents("._j_reply_item");var z=w.data("username");var v=w.data("rid");var y=this.container.find("#_j_editor");y.data("flag",2);y.data("objid",v);var C=this.container.find("a[name='note_publish_reply']").offset();$(window).scrollTop(C.top);var x=this.container.find("textarea[name='reply_content']");x.attr("placeholder","回复"+z+"：").val("").focus()},quoteBlockUi:function(z){z.preventDefault();var A=$(z.currentTarget);if(!window.Env.UID){M.Event.fire("login:required");return false}this.container.find("._j_mr_publish").addClass("_j_publish_reply").removeClass("_j_mr_publish");var w=A.parents("._j_reply_item");var y=w.data("username");var v=w.data("rid");var C=this.container.find("#_j_editor");C.data("flag",3);C.data("objid",v);var B=this.container.find("a[name='note_publish_reply']").offset();$(window).scrollTop(B.top);var x=this.container.find("textarea[name='reply_content']");x.attr("placeholder","回复"+y+"的引文：").val("").focus()},showUserInfo:function(w){var x=$(w.currentTarget);if(x.data("inited")){x.find(".card_pop").show()}else{var v=x.data("uid");$.get("/ajax/ajax_user_pop.php",{uid:v},function(y){if(y.ret==1){$(y.html).appendTo(x).show()}},"json");x.data("inited",true)}},hideUserInfo:function(v){var w=$(v.currentTarget);w.find(".card_pop").hide()},switchReplyTab:function(v){v.preventDefault();var w=$(v.currentTarget);var x=w.data("mode");h.find("._j_publish_tab").removeClass("on");w.addClass("on");h.find("#_j_editor,._j_reward_mode").hide();h.find("._j_"+x+"_mode").show()},jumpReward:function(v){m.trigger("click");var w=(m.offset().top-70)+"px";$("html, body").animate({scrollTop:w},{duration:1000,easing:"swing"})},loadRewardPay:function(v){v.preventDefault();var w=$(v.currentTarget);i.async(["/js/note/GinfoReward"],function(x){var y=new x()});w.removeClass("_j_reward_pay")},loadRewardSet:function(v){v.preventDefault();var w=$(v.currentTarget);i.async(["/js/note/GinfoRewardSet"],function(x){var y=new x()});w.removeClass("_j_reward_set")},};function a(y){var z=document.location.href;var x=z.indexOf(y+"=");if(x==-1){return false}var w=z.slice(y.length+x+1);var v=w.indexOf("&");if(v!=-1){w=w.slice(0,v)}return w}function s(){var z=a("h"),x=false,v=200;if(z.length>0&&e.children().length>0){var w=$("#reply_"+z);if(w.length){c();x=true;var y=(w.offset().top-65);y-=v;$("html, body").animate({scrollTop:y+"px"},{duration:1000,easing:"swing",complete:r(function(){$("html, body").animate({scrollTop:y+v+"px"},{duration:1000,complete:r(function(){n(1)})})})})}}}function r(v){var w=null;return function(){clearTimeout(w);w=setTimeout(function(){v()},50)}}function c(){window.startScrollToReply=true;M.Event.fire("start scroll to reply")}function n(v){M.Event.fire("after scroll to reply",{isScrollReply:v});window.hasScrollToReply=v?2:1}function d(){var v=a("s");if(v.length>0){if(v=="0"){if(m.length){m.trigger("click");var w=($("._j_reward_mao").offset().top-70)+"px";$("html, body").animate({scrollTop:w},{duration:1000,easing:"swing"});if(window.Env.author_uid==window.Env.UID){var x=u.getItem("ginfo:open:reward:"+window.Env.UID+":"+window.Env.iid);if(!x){$("._j_reward_set_btn").addClass("btn-tips")}}}}}}});(function(a){if(typeof define==="function"&&define.amd){define(a)}else{window.purl=a()}})(function(){var h={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href",embed:"src",object:"data"},n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],c={anchor:"fragment"},a={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},f=/^[0-9]+$/;function e(r,u){var w=decodeURI(r),t=a[u||false?"strict":"loose"].exec(w),v={attr:{},param:{},seg:{}},s=14;while(s--){v.attr[n[s]]=t[s]||""}v.param.query=i(v.attr.query);v.param.fragment=i(v.attr.fragment);v.seg.path=v.attr.path.replace(/^\/+|\/+$/g,"").split("/");v.seg.fragment=v.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");v.attr.base=v.attr.host?(v.attr.protocol?v.attr.protocol+"://"+v.attr.host:v.attr.host)+(v.attr.port?":"+v.attr.port:""):"";return v}function b(s){var r=s.tagName;if(typeof r!=="undefined"){return h[r.toLowerCase()]}return r}function q(v,u){if(v[u].length===0){return v[u]={}}var s={};for(var r in v[u]){s[r]=v[u][r]}v[u]=s;return s}function d(v,t,s,w){var r=v.shift();if(!r){if(g(t[s])){t[s].push(w)}else{if("object"==typeof t[s]){t[s]=w}else{if("undefined"==typeof t[s]){t[s]=w}else{t[s]=[t[s],w]}}}}else{var u=t[s]=t[s]||[];if("]"==r){if(g(u)){if(""!==w){u.push(w)}}else{if("object"==typeof u){u[p(u).length]=w}else{u=t[s]=[t[s],w]}}}else{if(~r.indexOf("]")){r=r.substr(0,r.length-1);if(!f.test(r)&&g(u)){u=q(t,s)}d(v,u,r,w)}else{if(!f.test(r)&&g(u)){u=q(t,s)}d(v,u,r,w)}}}}function k(v,u,x){if(~u.indexOf("]")){var w=u.split("[");d(w,v,"base",x)}else{if(!f.test(u)&&g(v.base)){var s={};for(var r in v.base){s[r]=v.base[r]}v.base=s}if(u!==""){l(v.base,u,x)}}return v}function i(r){return j(String(r).split(/&|;/),function(s,x){try{x=decodeURIComponent(x.replace(/\+/g," "))}catch(u){}var y=x.indexOf("="),w=o(x),t=x.substr(0,w||y),v=x.substr(w||y,x.length);v=v.substr(v.indexOf("=")+1,v.length);if(t===""){t=x;v=""}return k(s,t,v)},{base:{}}).base}function l(t,s,u){var r=t[s];if(typeof r==="undefined"){t[s]=u}else{if(g(r)){r.push(u)}else{t[s]=[r,u]}}}function o(u){var r=u.length,t,v;for(var s=0;s<r;++s){v=u[s];if("]"==v){t=false}if("["==v){t=true}if("="==v&&!t){return s}}}function j(v,s){var t=0,r=v.length>>0,u=arguments[2];while(t<r){if(t in v){u=s.call(undefined,u,v[t],t,v)}++t}return u}function g(r){return Object.prototype.toString.call(r)==="[object Array]"}function p(s){var r=[];for(var t in s){if(s.hasOwnProperty(t)){r.push(t)}}return r}function m(r,s){if(arguments.length===1&&r===true){s=true;r=undefined}s=s||false;r=r||window.location.toString();return{data:e(r,s),attr:function(t){t=c[t]||t;return typeof t!=="undefined"?this.data.attr[t]:this.data.attr},param:function(t){return typeof t!=="undefined"?this.data.param.query[t]:this.data.param.query},fparam:function(t){return typeof t!=="undefined"?this.data.param.fragment[t]:this.data.param.fragment},segment:function(t){if(typeof t==="undefined"){return this.data.seg.path}else{t=t<0?this.data.seg.path.length+t:t-1;return this.data.seg.path[t]}},fsegment:function(t){if(typeof t==="undefined"){return this.data.seg.fragment}else{t=t<0?this.data.seg.fragment.length+t:t-1;return this.data.seg.fragment[t]}}}}m.jQuery=function(r){if(r!=null){r.fn.url=function(t){var s="";if(this.length){s=r(this).attr(b(this[0]))||""}return m(s,t)};r.url=m}};m.jQuery(window.jQuery);return m});if(window.M&&typeof window.M.define=="function"){window.M.define("/js/purl",function(){return jQuery})}M.define("Movearound",function(b){function a(c){this.Class="movearound";this.Step=1;this.Times=50;M.mix(this,c);this.init()}M.mix(a.prototype,{init:function(){this.eStyle();this.moveAround()},moveAround:function(){var f,g,d,i=$("."+this.Class+""),e=this.Step,h=this.Times;var c=function(l,j,k){d=0;g=function(){if(d==l.get(0).scrollLeft){l.get(0).scrollLeft+=j;d+=j}else{l.get(0).scrollLeft-=j;d-=j}};g();f=setInterval(g,k)};i.mouseover(function(){var j=$(this);c(j,e,h)}).mouseout(function(){clearInterval(f);var j=$(this);j.get(0).scrollLeft=0})},eStyle:function(){var c=$("."+this.Class+"");c.css({"white-space":"nowrap","word-wrap":"normal"})}});return a});M.closure(function(b){var e=false,d="note-reply-bottomReplyApi",a=function(m){var n=document.location.href;var l=n.indexOf(m+"=");if(l==-1){return false}var k=n.slice(m.length+l+1);var j=k.indexOf("&");if(j!=-1){k=k.slice(0,j)}return k};function f(){if(e){return}e=true;M.Pagelet.createFromContainer(d,b("/js/note/ControllerReply"))}M.Event.on("load reply content",function(){f()});if((a("h"))){f()}$(window).scroll(function(){var l=$(window).scrollTop(),j=document.getElementById(d).offsetTop,k=window.innerHeight;if(j<=l+k*2){f()}});b("/js/purl");var h=b("Storage"),i=b("Movearound"),g=b("TopTip");c();$(function(){var n=$("#_j_cover_box");q();$(window).resize(q);function q(){n.height($(window).width()/3)}var k=h.getItem("video_tip");if(!k&&$("._j_video_tip").length){$("._j_video_tip").show();$("._j_video_tip_close").click(function(){h.setItem("video_tip",1,86400*365);$("._j_video_tip").fadeOut(300)})}var j={Class:"textmove",Step:1,Times:50},p={Class:"headtext",Step:2,Times:50};var l=new i(j),o=new i(p);if(window.Env.anchor_pid){var m=$('._j_anchor[data-poiid="'+window.Env.anchor_pid+'"]').eq(0).closest("._j_anchorcnt");if(m.length){$("html, body").animate({scrollTop:m.offset().top-60},500);$(window).trigger("scroll")}}$(window).bind("beforeunload",function(){document.documentElement.scrollTop=0})});function c(){window.onerror=function(m,k,j,l,n){mfwPageEvent&&mfwPageEvent("ginfo","pc:detail:page:web:error",{souce:"pc",iid:window.Env.iid||0,error_info:m,error_file:k,error_position:j+":"+l,error_detail:n})}}});M.closure(function(d){var a=d("/js/module/app/Page"),e=d("dialog/alert");var b=$(window).height(),c=$(document).height(),f=300,g=$("a[name=replylist]");$(window).resize(function(){b=$(window).height();c=$(document).height()});new a({forwardLoadXHR:null,backwardLoadXHR:null,forwardHasMore:window.Env.has_more,backwardHasMore:false,forwardLoading:false,backwardLoading:false,firstChunkLoaded:true,scrollLoadTimer:0,maxChunkSize:1000,loadChunkThreshold:2500,isRetina:window.devicePixelRatio>1?1:0,id:window.Env.iid,iid:window.Env.new_iid,container:$("._j_master_content"),init:function(){this.contentBox=this.container.children("._j_content_box");if(!this.contentBox.length){M.Event.fire("load reply content");return false}M.Event.fire("init lazyload");this.listenEvents();this.setReplyStatus();this.forwardHasMore&&this.autoLoadChunk()},setReplyStatus:function(){if(window.startScrollToReply){this.firstChunkLoaded=false}else{M.Event.on("start scroll to reply",M.bind(function(h){this.firstChunkLoaded=false},this))}if(window.hasScrollToReply){this.setLoadLast(window.hasScrollToReply===2)}else{M.Event.on("after scroll to reply",M.bind(function(h){this.setLoadLast(h.isScrollReply)},this))}},setLoadLast:function(j){if(j){var i=$(window).scrollTop();var h=this.contentBox.height();this.container.addClass("hide_loading");this.loadLastChunk(M.bind(function(){this.container.removeClass("hide_loading");$(window).scrollTop(i+this.contentBox.height()-h);setTimeout(M.bind(function(){this.firstChunkLoaded=true},this),1000)},this),$.proxy(function(){this.contentBox.empty()},this))}else{this.firstChunkLoaded=true}},listenEvents:function(){M.Event.on("catalog nav trigger content",M.bind(function(i){var h=[];if(i.seq>0){h=$('._j_seqitem[data-seq="'+i.seq+'"]')}else{if(!this.backwardHasMore){h=$("._j_seqitem:eq(0)")}}if(h.length){$(window).scrollTop(h.offset().top-50)}else{this.loadSeqChunk(i.seq)}},this));M.Event.on("scroll to top",$.proxy(function(){if(this.backwardHasMore){this.firstChunkLoaded=false;this.forwardLoadXHR&&this.forwardLoadXHR.abort();this.forwardLoading=false;this.backwardLoadXHR&&this.backwardLoadXHR.abort();this.backwardLoading=false;this.container.removeClass("backward_load");this.contentBox.empty();this.loadContentChunk(0,false,M.bind(function(){$(window).scrollTop(0);this.backwardHasMore=false;this.firstChunkLoaded=true},this))}},this))},loadSeqChunk:function(h){$(window).scrollTop(this.container.offset().top-100);this.container.removeClass("backward_load forward_load");this.firstChunkLoaded=false;this.forwardLoadXHR&&this.forwardLoadXHR.abort();this.forwardLoading=false;this.backwardLoadXHR&&this.backwardLoadXHR.abort();this.contentBox.empty();if(h>0){this.backwardLoading=true;this.loadContentChunk(h,true,M.bind(function(){this.backwardLoading=false;this.forwardLoading=true;this.loadContentChunk(this.contentBox.children("._j_seqitem:last").data("seq"),false,$.proxy(function(){this.forwardLoading=false;$(window).scrollTop($('._j_seqitem[data-seq="'+h+'"]').offset().top-50);this.firstChunkLoaded=true},this))},this))}else{this.backwardLoading=false;this.loadContentChunk(0,false,function(){$(window).scrollTop($("._j_seqitem:eq(0)").offset().top-100)})}},loadLastChunk:function(i,h){this.forwardLoadXHR&&this.forwardLoadXHR.abort();this.backwardLoadXHR&&this.backwardLoadXHR.abort();this.container.removeClass("forward_load");this.loadContentChunk(0,true,$.proxy(function(){typeof i=="function"&&i();this.forwardHasMore=false;this.backwardHasMore=true},this),h)},loadContentChunk:function(i,j,l,h){var k={id:this.id,iid:this.iid,seq:i,back:j?1:0};this.container.addClass(j?"backward_load":"forward_load");this[j?"backwardLoadXHR":"forwardLoadXHR"]=$.get("/note/ajax/detail/getNoteDetailContentChunk",k,M.bind(function(m){this.container.removeClass(j?"backward_load":"forward_load");if(m.error){e.pop(m.error.msg)}else{typeof h=="function"&&h();this[j?"backwardHasMore":"forwardHasMore"]=m.data.has_more;if(m.data&&m.data.html){if(j&&this.contentBox.children().length>0){this.contentBox.children(":first").before(m.data.html)}else{this.contentBox.append(m.data.html)}}M.Event.fire("init lazyload");M.Event.fire("note:share:info:ready");M.Event.fire("init video play");typeof l=="function"&&l(m.data)}},this),"json")},autoLoadChunk:function(){var j=$(window).scrollTop(),k=false,h=this.contentBox,i=300;$(window).scroll($.proxy(function(m){var n=$(window).scrollTop();if(this.firstChunkLoaded&&!k){documentHeight=$(document).height(),isBack=n<j,lastContentTop=this.contentBox.children(":last").offset().top;replyOffsetTop=g.offset().top,meetLoadForwardCondition=n>j&&n+b+this.loadChunkThreshold>lastContentTop&&this.forwardHasMore&&!this.forwardLoading,meetLoadBackwardCondition=n<this.loadChunkThreshold&&this.backwardHasMore&&!this.backwardLoading;if(!isBack&&meetLoadForwardCondition){this.forwardLoading=true;this.loadContentChunk(h.find("._j_seqitem:last").data("seq"),false,$.proxy(function(){this.forwardLoading=false},this))}else{if(isBack&&meetLoadBackwardCondition){this.backwardLoading=true;var l=h.height();this.loadContentChunk(h.children("._j_seqitem:first").data("seq"),true,$.proxy(function(){k=true;$(window).scrollTop($(window).scrollTop()+(h.height()-l-f));k=false;this.backwardLoading=false},this))}}clearTimeout(this.scrollLoadTimer);this.scrollLoadTimer=setTimeout($.proxy(function(){var r=$(document).height();if(isBack){if(n<r/2&&h.children().length>this.maxChunkSize&&!this.forwardLoading){var o=h.children("._j_seqitem").eq(this.maxChunkSize/4);h.children(":gt("+o.index()+")").remove();this.forwardHasMore=true}}else{if(n>r/2&&h.children().length>this.maxChunkSize&&!this.backwardLoading){var o=h.children("._j_seqitem").eq(-this.maxChunkSize/4),q=h.children(":lt("+o.index()+")"),p=h.height();q.remove();k=true;$(window).scrollTop(n-(p-h.height()));k=false;this.backwardHasMore=true}}},this),100)}j=n},this))}})});(function(a){a.fn.UpNum=function(d,e,b,c){return this.each(function(){var g=a(this).offset();var j=Math.round(g.left)+"px";var h=Math.round(g.top)+"px";if(d.toString().indexOf("-")==0){var k=Math.round(g.top)+30+"px"}else{var k=Math.round(g.top)-30+"px"}var f="20px";if(b){f=b}c=c||"120";var i=d||a(this).attr("money");a("<div/>").appendTo(a("body")).addClass("numeric").css({position:"absolute",top:h,left:j,color:(d.toString().indexOf("-")==0)?"#333":"red",fontFamily:"Georgia",fontSize:f,zIndex:c}).html(i).animate({top:k},{duration:1000,complete:function(){a(this).remove();if(e){e()}}})})};if(window.M&&typeof M.define=="function"){M.define("jq-upnum",function(){return jQuery})}})(jQuery);M.closure(function(a){a("jq-upnum");var d=a("TopTip"),b=a("dialog/alert");$.fn.imgMenu=function(e){var f={color:"",border:"",backgroundColor:"",control:[{cls:"ptb-reply",fn:function(h,i,g){if(window.Env.UID>0){$("#pnl_pop_reply").data("pop_reply_data",{link:h});M.Event.fire("quoteImgShow",{type:"quoteImg"})}else{M.Event.fire("login:required")}}},{cls:"ptb-collect",fn:function(h,i,g){if(!i.hasClass("on")){if(window.Env.UID>0){$.post("/plan/ajax.php?s=addFav",{id:window.Env.iid,subtype:0,type:3,content:g.attr("src"),pid:g.data("pid")},function(j){var k=$(i).offset();i.addClass("on");if(j.ret==-1){M.Event.fire("login:required")}else{d.show("收藏成功")}},"json")}else{M.Event.fire("login:required")}}}},{cls:"btn-ding",fn:function(i,k,h,l){if(window.Env.UID>0){var j=k;var g=l.data("pid");if(!g){g=h.parent("a").data("pid")}if(j.hasClass("on")){$.post("/mdd/photo/ajax_post.php",{sAction:"cancelVote",iAlid:g,iIid:window.Env.iid},function(p){if(!p.error){if(p.payload){if(p.payload.ret==1){var m=h.data("menu");var n=m.find(".ptb-ding span");j.removeClass("on");var o=parseInt(n.html(),10);n.html(Math.max(0,o-1))}else{b.pop("失败，请稍后再试")}}}else{b.pop(p.error.error)}},"json")}else{$.post("/mdd/photo/ajax_post.php",{sAction:"addVote",iAlid:g,iIid:window.Env.iid},function(p){if(!p.error){if(p.payload){if(p.payload.ret==1){var m=h.data("menu");var n=m.find(".ptb-ding span");j.addClass("on");j.UpNum("+1");var o=parseInt(n.html(),10);n.html(Math.max(0,o+1))}else{b.pop("失败，请稍后再试")}}}else{b.pop(p.error.error)}},"json")}}else{M.Event.fire("login:required")}}}],tmpl:'<div class="pic-toolbar" style="position:absolute;"><div class="ptb-share"><span>分享到</span><a class="weibo" data-japp="sns_share" data-jappfedata="" data-key="wb" rel="nofollow" title="分享到新浪微博">新浪微博</a><a class="qzone" data-japp="sns_share" data-jappfedata="" data-key="qz" rel="nofollow" title="分享到QQ空间">QQ空间</a></div><div class="ptb-option"><a class="ptb-reply" href="javascript:void(0);" rel="nofollow"><i></i>引用到回复</a><a class="ptb-collect" href="javascript:void(0);" rel="nofollow"><i></i>收藏</a></div><div class="ptb-ding" style="display: none"><a class="btn-ding" href="javascript:void(0);" rel="nofollow" title="顶">顶</a><span>0</span></div></div>',showReply:true};e=$.extend(f,e);return this.each(function(){var g=jQuery(this);var i=g.parents(".add_pic");g.hover(function(){var p=jQuery(this).attr("src");if(!/^.+\.mafengwo\.net/.test(p)||/^.+\.mafengwo.net\/images\/i\//.test(p)||/^.+\.mafengwo.net\/images\/sys\//.test(p)){return}if(jQuery(this).data("menu")&&!jQuery(this).data("menu").is(":visible")){var n=jQuery(this).offset().top;jQuery(this).data("menu").css("top",n+"px").show()}else{var l=Math.max(370,g.width()),m=jQuery(e.tmpl).appendTo(jQuery("body")).css({top:g.offset().top,left:g.offset().left,width:l});m.find("a.weibo").attr({"data-title":c.share_title,"data-content":c.share_content.wb,"data-url":c.share_url,"data-pic":g.attr("src")});m.find("a.qzone").attr({"data-title":c.share_title,"data-content":c.share_content.qz,"data-url":c.share_url,"data-pic":g.attr("src")});for(var k=0;k<e.control.length;k++){var o=m.find("a."+e.control[k].cls);if(o.length){o.data("fn",e.control[k].fn);o.click(function(){jQuery(this).data("fn")(g.attr("src"),jQuery(this),g,i)})}}var j=i.data("pid");if(!j){j=g.parent("a").data("pid")}if(j){$.get("/note/ajax/detail/getPhotoUgc",{iPid:j,iIid:window.Env.iid},function(q){if(!q.error){if(q.payload){if(q.payload.ret==1){m.find(".ptb-ding span").html(q.payload.info.vote.num);if(q.payload.info.vote.is_vote==1){m.find(".btn-ding").addClass("on")}m.find(".ptb-ding").show()}}}},"json")}jQuery(this).data("menu",m);m.hover(function(){jQuery(this).show()},function(){jQuery(this).hide()})}},function(){if(jQuery(this).data("menu")&&jQuery(this).data("menu").remove){jQuery(this).data("menu").hide()}});g.removeClass("_j_needInitShare");var h=g.attr("src");if(/^.+\.mafengwo.net\/images\/i\//.test(h)){return}g.css({display:"block"})})};$(window).resize(function(){var e=$(".vc_article");if(e.length){var f=e.offset().left;$(".pic-toolbar").css("left",f+"px")}});var c=null;M.Event.on("note:share:info:ready",function(e){if(!c){if(!e){return false}c=e}$("._j_needInitShare").imgMenu()});if(window.Env.share_info&&$("._j_needInitShare").length){M.Event.fire("note:share:info:ready",window.Env.share_info)}});jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,f,a,h,g){return jQuery.easing[jQuery.easing.def](e,f,a,h,g)},easeInQuad:function(e,f,a,h,g){return h*(f/=g)*f+a},easeOutQuad:function(e,f,a,h,g){return -h*(f/=g)*(f-2)+a},easeInOutQuad:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f+a}return -h/2*((--f)*(f-2)-1)+a},easeInCubic:function(e,f,a,h,g){return h*(f/=g)*f*f+a},easeOutCubic:function(e,f,a,h,g){return h*((f=f/g-1)*f*f+1)+a},easeInOutCubic:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f+a}return h/2*((f-=2)*f*f+2)+a},easeInQuart:function(e,f,a,h,g){return h*(f/=g)*f*f*f+a},easeOutQuart:function(e,f,a,h,g){return -h*((f=f/g-1)*f*f*f-1)+a},easeInOutQuart:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f+a}return -h/2*((f-=2)*f*f*f-2)+a},easeInQuint:function(e,f,a,h,g){return h*(f/=g)*f*f*f*f+a},easeOutQuint:function(e,f,a,h,g){return h*((f=f/g-1)*f*f*f*f+1)+a},easeInOutQuint:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f*f+a}return h/2*((f-=2)*f*f*f*f+2)+a},easeInSine:function(e,f,a,h,g){return -h*Math.cos(f/g*(Math.PI/2))+h+a},easeOutSine:function(e,f,a,h,g){return h*Math.sin(f/g*(Math.PI/2))+a},easeInOutSine:function(e,f,a,h,g){return -h/2*(Math.cos(Math.PI*f/g)-1)+a},easeInExpo:function(e,f,a,h,g){return(f==0)?a:h*Math.pow(2,10*(f/g-1))+a},easeOutExpo:function(e,f,a,h,g){return(f==g)?a+h:h*(-Math.pow(2,-10*f/g)+1)+a},easeInOutExpo:function(e,f,a,h,g){if(f==0){return a}if(f==g){return a+h}if((f/=g/2)<1){return h/2*Math.pow(2,10*(f-1))+a}return h/2*(-Math.pow(2,-10*--f)+2)+a},easeInCirc:function(e,f,a,h,g){return -h*(Math.sqrt(1-(f/=g)*f)-1)+a},easeOutCirc:function(e,f,a,h,g){return h*Math.sqrt(1-(f=f/g-1)*f)+a},easeInOutCirc:function(e,f,a,h,g){if((f/=g/2)<1){return -h/2*(Math.sqrt(1-f*f)-1)+a}return h/2*(Math.sqrt(1-(f-=2)*f)+1)+a},easeInElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return -(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e},easeOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k)==1){return e+l}if(!j){j=k*0.3}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}return g*Math.pow(2,-10*h)*Math.sin((h*k-i)*(2*Math.PI)/j)+l+e},easeInOutElastic:function(f,h,e,l,k){var i=1.70158;var j=0;var g=l;if(h==0){return e}if((h/=k/2)==2){return e+l}if(!j){j=k*(0.3*1.5)}if(g<Math.abs(l)){g=l;var i=j/4}else{var i=j/(2*Math.PI)*Math.asin(l/g)}if(h<1){return -0.5*(g*Math.pow(2,10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j))+e}return g*Math.pow(2,-10*(h-=1))*Math.sin((h*k-i)*(2*Math.PI)/j)*0.5+l+e},easeInBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*(f/=h)*f*((g+1)*f-g)+a},easeOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}return i*((f=f/h-1)*f*((g+1)*f+g)+1)+a},easeInOutBack:function(e,f,a,i,h,g){if(g==undefined){g=1.70158}if((f/=h/2)<1){return i/2*(f*f*(((g*=(1.525))+1)*f-g))+a}return i/2*((f-=2)*f*(((g*=(1.525))+1)*f+g)+2)+a},easeInBounce:function(e,f,a,h,g){return h-jQuery.easing.easeOutBounce(e,g-f,0,h,g)+a},easeOutBounce:function(e,f,a,h,g){if((f/=g)<(1/2.75)){return h*(7.5625*f*f)+a}else{if(f<(2/2.75)){return h*(7.5625*(f-=(1.5/2.75))*f+0.75)+a}else{if(f<(2.5/2.75)){return h*(7.5625*(f-=(2.25/2.75))*f+0.9375)+a}else{return h*(7.5625*(f-=(2.625/2.75))*f+0.984375)+a}}}},easeInOutBounce:function(e,f,a,h,g){if(f<g/2){return jQuery.easing.easeInBounce(e,f*2,0,h,g)*0.5+a}return jQuery.easing.easeOutBounce(e,f*2-g,0,h,g)*0.5+h*0.5+a}});if(window.M&&typeof window.M.define=="function"){window.M.define("jq-easing",function(){return jQuery})}M.define("Toggle",function(b,a,c){function d(e){this.context="body";this.trigger=null;this.board=null;this.handler=$.noop;this.triggerHandler=$.noop;this.boardHandler=$.noop;M.mix(this,e);this.inner=false;this.init()}d.prototype={init:function(){if(typeof this.trigger==="string"){$(this.context).delegate(this.trigger,"click",$.proxy(function(e){this.triggerHandler(e);this.inner=true},this))}else{$(this.trigger).click($.proxy(function(e){this.triggerHandler(e);this.inner=true},this))}if(typeof this.board==="string"){$(this.context).delegate(this.board,"click",$.proxy(function(e){this.inner=true},this))}else{$(this.board).click($.proxy(function(e){this.inner=true},this))}$(this.context).click($.proxy(function(e){if(!this.inner){this.handler()}else{this.inner=false}},this))}};c.exports=d});M.define("CopyrightProtecte",function(b,a,c){function d(e){this.container=null;M.mix(this,e);this.init()}d.prototype={init:function(){$(this.container).bind("copy",$.proxy(function(k){if(!window.getSelection()){return false}var f=window.getSelection().toString();if(!window.getSelection().getRangeAt(0)){return false}if(!window.getSelection().getRangeAt(0).getBoundingClientRect()){return false}$(".copyright_container").remove();var i=window.getSelection().getRangeAt(0).getBoundingClientRect();var j=$(document).scrollTop()+i.top;var g=i.left;var m=$('<div class="copyright_container" style="position:absolute;padding: 8px 0 5px;z-index: 87;"><img width="35" src="'+this.logo+'" style="border-radius:50%;position:absolute;"><div class="message" style="margin-left:45px;position:relative;padding: 5px;background: #65CEA7;color: #fff;border-radius: 5px;-webkit-border-radius: 5px;"><span style="border-right: 8px solid #65CEA7;display: block;position: absolute;top: 6px;left: -7px;width: 0;height: 0;border-top: 8px solid transparent;border-bottom: 8px solid transparent;"></span><span style="color: #fff;font-size: 14px;line-height: 20px;">此内容著作权归作者<b style="color: #ff9d00;">'+this.name+"</b>本人所有，未经允许不得转载。</span></div></div>").appendTo("body");m.css({top:j-56+"px",left:g+"px",position:"absolute"}).show("fast");setTimeout(function(){m.hide("fast",function(){m.remove()})},2000);var h="_j_cpoyright_protecte";var l=$("#"+h);if(l.length===0){l=$('<input id="'+h+'">');$("body").append(l)}var e="   作者："+this.name+" 链接："+this.link+" 来源：蚂蜂窝 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。";l.val(f+e).select();document.execCommand("copy");M.Event.fire("content:copy:success");return false},this))}};c.exports=d});
/*!
 * Lazy Load - jQuery plugin for lazy loading images
 *
 * Copyright (c) 2007-2015 Mika Tuupola
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 *
 * Project home:
 *   http://www.appelsiini.net/projects/lazyload
 *
 * Version:  1.9.7
 *
 */
(function(c,b,a,e){var d=c(b);c.fn.lazyload=function(f){var h=this;var i;var g={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:false,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};function j(){var k=0;h.each(function(){var l=c(this);if(g.skip_invisible&&!l.is(":visible")){return}if(c.abovethetop(this,g)||c.leftofbegin(this,g)){}else{if(!c.belowthefold(this,g)&&!c.rightoffold(this,g)){l.trigger("appear");k=0}else{if(++k>g.failure_limit){return false}}}})}if(f){if(e!==f.failurelimit){f.failure_limit=f.failurelimit;delete f.failurelimit}if(e!==f.effectspeed){f.effect_speed=f.effectspeed;delete f.effectspeed}c.extend(g,f)}i=(g.container===e||g.container===b)?d:c(g.container);if(0===g.event.indexOf("scroll")){i.bind(g.event,function(){return j()})}this.each(function(){var k=this;var l=c(k);k.loaded=false;if(l.attr("src")===e||l.attr("src")===false){if(l.is("img")){l.attr("src",g.placeholder)}}l.one("appear",function(){if(!this.loaded){if(g.appear){var m=h.length;g.appear.call(k,m,g)}c("<img />").bind("load",function(){var o=l.attr("data-"+g.data_attribute);l.hide();if(l.is("img")){l.attr("src",o)}else{l.css("background-image","url('"+o+"')")}l[g.effect](g.effect_speed);k.loaded=true;var n=c.grep(h,function(q){return !q.loaded});h=c(n);if(g.load){var p=h.length;g.load.call(k,p,g)}}).attr("src",l.attr("data-"+g.data_attribute))}});if(0!==g.event.indexOf("scroll")){l.bind(g.event,function(){if(!k.loaded){l.trigger("appear")}})}});d.bind("resize",function(){j()});if((/(?:iphone|ipod|ipad).*os 5/gi).test(navigator.appVersion)){d.bind("pageshow",function(k){if(k.originalEvent&&k.originalEvent.persisted){h.each(function(){c(this).trigger("appear")})}})}c(a).ready(function(){j()});return this};c.belowthefold=function(g,h){var f;if(h.container===e||h.container===b){f=(b.innerHeight?b.innerHeight:d.height())+d.scrollTop()}else{f=c(h.container).offset().top+c(h.container).height()}return f<=c(g).offset().top-h.threshold};c.rightoffold=function(g,h){var f;if(h.container===e||h.container===b){f=d.width()+d.scrollLeft()}else{f=c(h.container).offset().left+c(h.container).width()}return f<=c(g).offset().left-h.threshold};c.abovethetop=function(g,h){var f;if(h.container===e||h.container===b){f=d.scrollTop()}else{f=c(h.container).offset().top}return f>=c(g).offset().top+h.threshold+c(g).height()};c.leftofbegin=function(g,h){var f;if(h.container===e||h.container===b){f=d.scrollLeft()}else{f=c(h.container).offset().left}return f>=c(g).offset().left+h.threshold+c(g).width()};c.inviewport=function(f,g){return !c.rightoffold(f,g)&&!c.leftofbegin(f,g)&&!c.belowthefold(f,g)&&!c.abovethetop(f,g)};c.extend(c.expr[":"],{"below-the-fold":function(f){return c.belowthefold(f,{threshold:0})},"above-the-top":function(f){return !c.belowthefold(f,{threshold:0})},"right-of-screen":function(f){return c.rightoffold(f,{threshold:0})},"left-of-screen":function(f){return !c.rightoffold(f,{threshold:0})},"in-viewport":function(f){return c.inviewport(f,{threshold:0})},"above-the-fold":function(f){return !c.belowthefold(f,{threshold:0})},"right-of-fold":function(f){return c.rightoffold(f,{threshold:0})},"left-of-fold":function(f){return !c.rightoffold(f,{threshold:0})}})})(jQuery,window,document);if(window.M&&typeof window.M.define=="function"){window.M.define("/js/jquery.lazyload",function(){return jQuery})}M.define("/js/common/TextSelectionTip",function(b){var a='<div class="tooltip" style="position: absolute"><a role ="button" class="addComt_icon"></a></div>';function c(d){this.context=d.context?$(d.context):$(document);this.textBlock=d.block;this.tipTpl=d.tipTpl||a;this.tipTitle=d.tipTitle||"引用";this.init()}M.mix(c.prototype,{init:function(){this.selectTimer=0;this.tip=null;this.selectText="";this.context.on("mouseup",this.textBlock,$.proxy(function(f){var e=f.pageX,d=f.pageY;clearTimeout(this.selectTimer);this.selectTimer=setTimeout($.proxy(function(){var i="",j=null;if(document.selection){var g=document.selection.createRange();j=g.parentElement();if(j){i=g.text}}else{if(typeof window.getSelection=="function"){var h=window.getSelection();if(h.focusNode){j=h.focusNode.parentNode;i=h.toString()}}}i=$.trim(i);if(i.length){if(!this.tip){this.createTip()}this.tip.css({top:d+5,left:e+5}).stop(true,true).fadeIn(50);this.selectText=i;this.focusNode=j}},this),50)},this));this.context.on("mousedown",$.proxy(function(d){var e=$(d.target);if(e.closest(".tooltip").length===0){this.hideTip()}},this))},createTip:function(){this.tip=$(this.tipTpl).appendTo("body").css("display","none").attr("title",this.tipTitle);this.tip.click($.proxy(function(){M.Event(this).fire("tip clicked",{text:this.selectText,focusNode:this.focusNode});this.hideTip()},this))},hideTip:function(){this.tip&&this.tip.hide();this.selectText=""}});return c});M.closure(function(i){i("jq-tmpl");i("jq-easing");var p=i("Toggle"),h=i("/js/EmotionsHd"),o=i("CopyrightProtecte"),l=i("/js/module/app/Page"),f=i("/js/note/GinfoReply"),A=i("FrequencyAppVerify"),v=i("/js/jquery.lazyload"),e=i("dialog/Dialog"),n=i("ClickToggle"),b=i("TopTip"),q=i("Slider"),B=i("Storage"),C=i("ScrollObserver"),z=i("/js/common/TextSelectionTip"),t=i("/js/note/GiveSign"),u=$("#_j_pnl_pop_reply"),a=$("#pnl_pop_reply"),j=$("._j_tag_notice"),w=true,d=false,s=null,x=null,y=false,m=false;var k=window.devicePixelRatio>1&&window.Env.is_new_note?"rt-src":"src",c={threshold:2000,event:"scroll:lazy",data_attribute:k,load:function(){$(this).removeClass("_j_lazyload")}};function r(){$("img._j_lazyload").lazyload(c)}r();M.Event.on("init lazyload",function(){r()});C.addObserver(function(){$(window).trigger("scroll:lazy")});var g=new l({init:function(){this.initData();this.initUI();this.initSelectionTip()},events:{"click,._j_tn_close":"closeTagNotice","click,.vc_reply ._j_publish_tab":"switchReplyTab","click,#_j_editor ._j_face_tab":"switchFaceSeries"},initSelectionTip:function(){this.selectionTip=new z({block:$("._j_note_content"),tipTitle:"引用到回复"});M.Event(this.selectionTip).on("tip clicked",function(D){a.data("pop_reply_data",{content:D.text});M.Event.fire("quoteImgShow",{type:"quoteTxt"})})},bindEvents:function(){M.Event.on("quoteImgShow",$.proxy(function(D){this.checkLogin();$("#plantip").remove();var E=D.type?D.type:"quoteImg";if(a.data("pop_reply_data")){var G=a.data("pop_reply_data");var F="回复"+window.Env.author_name;if("quoteTxt"==E){F+="的引文：";this.showQuoteDialog(F,G.content,4,"","block")}else{if("quoteImg"==E){F+="的图片：";this.showQuoteDialog(F,"",1,G.link,"none")}}}},this));M.Event.on("quoteDialogClose",$.proxy(function(D){if(s){s.hide()}},this));M.Event.on("hideTagBtn",$.proxy(function(D){if(w){w=false}},this));M.Event.on("recommend:hotel:ready",$.proxy(function(D){i.async(["/js/note/GinfoHotel"],function(F){var E=new F()})},this));M.Event.on("content:copy:success",function(){$("#plantip").remove()});M.Event.on("coin:update",function(D){t.syncCoin({coin:D.coin,targets:["#_js_giveSign .amount","#_js_QuickGiveSign .amount","#_js_quoteGiveSign .amount"]})})},eventHandlers:{switchFaceSeries:function(E){var F=$(E.currentTarget),D=F.index();if(!F.hasClass("cur")){F.addClass("cur").siblings().removeClass("cur");$("#_js_replyExpression").children("._j_emojilist").eq(D).removeClass("hide").siblings(".art_newface").addClass("hide")}},closeTagNotice:function(D){D.preventDefault();$.post("/note/ajax_post.php",{sAction:"setTagNotice",__ctk__:window.Env.__ctk__});j.hide()}},initData:function(){this.data={};this.data.is_note=window.Env.is_new_note;if(!this.data.is_note){this.initGinfoData()}this.activeRecommendHotel()},initUI:function(){var D=new n({container:"#_j_editor_quick,#_j_editor_quote",innerSelector:"._j_show_at,._j_at_pop,._j_show_tags,._j_tags_pop,._j_show_expression,._j_face_pop,.give_sign_btn,.close-selected-give-sign",handler:function(I,H){var G=I.closest("._j_editor");if(I.hasClass("_j_show_at")){G.find(".art_pop").hide();G.find("._j_at_pop").show()}else{if(I.hasClass("give_sign_btn")){G.find(".art_pop").hide();G.find("._j_tags_pop").show()}else{if(I.hasClass("_j_show_expression")){G.find(".art_pop").hide();var J=G.find("._j_face_pop");if(J.find("ul li").length===0){$.each(h.quick,function(L,K){$('<li class="_j_emojiitem" title="'+K.title+'"><img src="'+K.file+'" /></li>').data("value",K.title).appendTo(J.find("ul"))})}J.show()}}}},outHandler:function(J,I){var H=J.closest("._j_editor");var G=H.find("._j_at_pop,._j_tags_pop,._j_face_pop");G.hide()}});var F=new f({container:$("#_j_editor_quick"),appType:"quick"});var E=new p({trigger:"._j_quick_reply",board:"._j_qr_box",handler:function(){$(this.board).hide()},triggerHandler:function(G){$(this.board).show();var H=$(G.currentTarget);if(H.hasClass("_j_quick_reply")){if(!y){y=true;t.renderGiveSignComponent({el:"#_js_QuickGiveSign",type:"small",showSelectedGiveSign:"#_js_quickSelectedGiveSign",deleteSelectedGiveSign:"#_js_quickDeleteShowGiveSign",giveSignEntry:"._quick_give_sign_btn"})}}}})},activeRecommendHotel:function(){if(!d){var F=[];var D=[];$(".link[data-poi_id]").each(function(){var G=$(this).data("poi_id");if(!F[G]){F[G]=1;D.push(G)}});if(D.length>0){var E=JSON.stringify(D);$.get("/note/ajax/detail/isHotelRecommend",{sIds:E},$.proxy(function(I){if(I.payload.ret==1){if(!d){d=true;if(I.payload.allow.length>0){var H=[10083,12684,10183,10184,10189,10035,10062,10171];var G=false;if(H.indexOf(parseInt(window.Env.mddid,10))!==-1){G=true}$.each(I.payload.allow,function(J,L){var K=$(".link[data-poi_id='"+L+"']");K.addClass("_j_recommend_hotel");if(G){K.addClass("poi-link-hotel").prepend("<i></i>")}});M.Event.fire("recommend:hotel:ready")}}}},this),"json")}}},checkLogin:function(){if(!window.Env.UID){M.Event.fire("login:required");return false}},setQuoteUi:function(K,J,D,F,I){var E=u.tmpl({title:K,word:J,flag:D,link:F,display:I}).html();s=new e({content:E,PANEL_CLASS:"replypop"});x=$("#_j_editor_quote");if(!w){x.find("._j_show_tags").hide()}var G=$("#_j_editor_quick");if(w&&G.find(".give-sign-details-list-section li").length>0){x.find(".give_sign_btn").show()}s.show();var H=new f({container:x,appType:"quote"})},resetQuoteData:function(F,D,E){x.find("textarea[name='reply_content']").val("");x.data("quote",F);x.data("flag",D);x.data("link",E)},resetQuoteUi:function(G,F,E){var D=x.closest("._j_comment_layer");D.find(".tit").html(G);D.find(".quoteInfo").html(F).css("display",E);x.find(".reply_tags ul li a").removeClass("on");x.find("._j_at_inner span").remove();x.find(".art_pop").hide();x.find("._j_at_txt").val("");x.find("._j_at_inner .result").empty().hide();if(!w){x.find("._j_show_tags").hide()}},showQuoteDialog:function(H,G,D,E,F){if(!s){this.setQuoteUi(H,G,D,E,F)}else{this.resetQuoteUi(H,G,F);this.resetQuoteData(G,D,E);s.show()}if(!m){m=true;t.renderGiveSignComponent({el:"#_js_quoteGiveSign",type:"small",showSelectedGiveSign:"#_js_quoteSelectedGiveSign",deleteSelectedGiveSign:"#_js_quoteDeleteShowGiveSign",giveSignEntry:"._quote_give_sign_btn"})}},initGinfoData:function(){$.ajax({type:"GET",url:"/group/ajax_ginfo_ready.php",data:{sAction:"initGinfo",iId:window.Env.iid},dataType:"json",success:$.proxy(function(D){if(!D.error){if($("#postal_ticket").length>0&&D.payload.new_tickets_num>0){$("#postal_ticket dd").html("此篇大作已获得"+D.payload.give_tickets_user_name+"奖励的<span>明信片券 "+D.payload.new_tickets_num+" 张</span>。<br>快去DIY你的专属明信片吧！");$("#postal_ticket").show()}if($("._j_hot_wenda").length>0&&D.payload.hot_wenda){$("._j_hot_wenda").html(D.payload.hot_wenda).show()}}},this)})},showTextPop:function(E){var D=$("#_js_replyExpression");D.show().siblings(".art_pop").hide();return D}});$(function(){$(".quick_reply_tips").delegate(".close","click",function(){$(".quick_reply_tips").hide()});if(window.Env.score_article){b.show(window.Env.score_article)}$(".vc_article").delegate("a","click",function(){var H=$(this).attr("href"),E=$(this).text(),J=$.url(H);if(J.attr("host")&&J.attr("host").indexOf(".mafengwo.")===-1){var F=J.attr("host").split("."),I=["edu","com","cn","net","org","gov","hk","uc","ca","co","uk"];for(var G=(F.length-2);G>=0;G--){if($.inArray(F[G],I)<0){M.Utils.opLog({type:"tosl",key:F[G],subkey:E,params:'{"url":"'+H+'", "tid":"'+window.Env.iid+'"}'});break}}}});var D;$("body").delegate(".bs_share","mouseenter",function(E){E.preventDefault();if(D){clearTimeout(D)}$(this).find(".bs_pop").show()});$("body").delegate(".bs_share","mouseleave",function(E){E.preventDefault();var F=$(this);D=setTimeout(function(){F.find(".bs_pop").hide()},500)});M.Event.on("weixin share triggered",function(E){$.post("/group/ajax_ginfo_share.php",{action:"get_qr_url",topiid:window.Env.iid})});M.Event.on("sns share triggered",function(E){var F=E.key=="wb"?"sina":"qq";$.getJSON("/group/ajax_ginfo_share.php",{action:"ginfo_share",topiid:window.Env.iid,share_type:F})})})});$(function(){M.closure(function(c){var a=c("dialog/Dialog");var b="/note/activity/anotice.php?sAction=getNotice&mddid="+window.Env.mddid;$.get(b,function(i){if(i.payload.ret){f(i.payload)}},"json");$(".noticeClose").on("click",function(){var i=$(this).closest(".aNotice").attr("noticeId");h(i,0)});$(".noticeUrl").live("click",function(){var i=$(this).closest(".aNotice").attr("noticeId");if(i==-1){d()}else{h(i,1)}});function h(i,l){var j="/note/activity/anotice.php";var k={};k.sAction="closeNotice";k.noticeId=i;k.ifCount=l;$(".aNoticeH").hide();$(".bread-nav").show();$(".aNoticeM").hide("slow");$.post(j,k,function(m){},"json")}function f(i){$(".aNotice").attr("noticeId",i.id);$(".noticeDes").html(i.description);$(".noticeUrl").attr("href",i.url);$(".bread-nav").hide();$(".aNoticeH").show();$(".aNoticeM").show("slow");if(i.id==-1){$(".noticeUrl").removeAttr("target")}}var g=false;var e;function d(){if(!g){e=new a({content:'<div class="wx-mfw-pop" style="background:#FFF;"><p>扫描二维码</p><p>查看正在出租的蜂蜂</p><p><img width="150" height="150" src="http://css.mafengwo.net/images/post/new_notes/wx_zhuren.png"></p></div>'})}e.show()}})});M.closure(function(a){$(document).ready(function(){var i=window.Env.iid,d=window.Env.UID,g,f;var c=a("dialog/alert");var e=a("ScrollBar");if(i>0&&d>0){$.get("/note/ajax_poiofnote.php",{act:"poiofnote",iid:i,uid:d},function(j){if(!j.error&&j.data.html){$("body").append(j.data.html);g=$("#_js_dpGuide");f=g.data("poiinfo")}},"json")}$("body").delegate(".reviews-award .hd","click",function(j){j.preventDefault();$(this).parents(".reviews-award").toggleClass("extend")}).delegate("._j_poi_comment_close","click",function(j){j.preventDefault();g.hide();$.post("/note/ajax_poiofnote.php",{act:"addlog",noteid:i,action:"pop_win_close",__ctk__:window.Env.__ctk__})});M.Event.on("comment form loaded",function(j){var k=j.poi_id,l=b(k);M.Event.fire("out img insert",{imgs:l})});function b(k){var l=[];for(var j=0;j<f[k].length;j++){if(j==5){break}l[j]={imgstr:f[k][j].imgstr,src:f[k][j].imgsrc,title:""}}return l}function h(j){return f[j][0].pid}M.Event.on("comment published",function(j){$.post("/note/ajax_poiofnote.php",{act:"givehoney",commentid:j.info.comment_id,noteid:i,__ctk__:window.Env.__ctk__},function(k){if(!k.error&&k.data){g.html(k.data.html);g.addClass("expand");if(k.data.msg){c.pop(k.data.msg,"",3)}}},"json")});$("body").on("click","._j_choney_tpl_poi",function(k){var m=$(k.currentTarget);var j=m.data("poi_id");var n=h(j);var l=$("#_j_photo_"+n);$("html, body").animate({scrollTop:l.offset().top-60},500)})})});M.define("RollNumbers",function(c,b,e){var f=M.mix,a=M.Event;function d(g){this.numberList=$(g.numberList);this.itemHeight=g.itemHeight;this.rollTime=g.rollTime||2000;this.style=g.style||1;this.number=0;this.strNumber="";this.ended=false;this.randIndex=5;this.init()}d.prototype={init:function(){if(!this.numberList.length){M.error("no number list to roll")}this.numberList.each(function(){$(this).css({overflow:"hidden",position:"relative"})});this.initNumberWrap();this.roll()},initNumberWrap:function(){this.strNumber=M.map(this.numberList,function(i){return(($(i).data("number")|0)+"").slice(0,1)}).join("");this.number=parseInt(this.strNumber,10);if(this.number>0){var k=false,j;for(var h=0,g=this.strNumber.length;h<g;h++){j=+this.strNumber.charAt(h);if(j>0){k=true}if(k){this.numberList.eq(h).html(this.createNumberWrap())}}if(!(M.is(this.itemHeight,"Number")&&this.itemHeight>0)){this.itemHeight=this.numberList.eq(0).find("._j_rollitem").eq(0).outHeight()}}},roll:function(){if(this.number>0){var k=0,j=false,m,l=0;for(var h=0,g=this.strNumber.length;h<g;h++){m=+this.strNumber.charAt(h);if(m>0){j=true}if(j){l=m+(this.style==1?l*10:0);if(l>0){this.startRoll(this.numberList.eq(h),l)}}}}},startRoll:function(h,j){var i=h.children().eq(0);var l=0,k=20,g=1,n=j*this.itemHeight;if(this.rollTime/k>n){k=this.rollTime/n}else{g=n/(this.rollTime/k)}if(g>this.itemHeight-6){g=this.itemHeight/2+this.randIndex;this.randIndex-=1}var m=setInterval($.proxy(function(){n-=g;if(n<-2||this.ended){clearInterval(m);i.css("top",-j%10*this.itemHeight);this.ended=true;return}l-=g;if(l<=(-10*this.itemHeight)){l+=10*this.itemHeight}i.css("top",parseInt(l,10))},this),k)},createNumberWrap:function(){var g=[];g.push('<span class="_j_rollsplit" style="padding:0;margin:0">');for(var h=0;h<=9;h++){g.push('<span class="_j_rollitem" style="display:inline-block;padding:0;margin:0;width:100%;'+(this.itemHeight>0?"height:"+this.itemHeight:"")+'px">'+h+"</span>")}g.push('</span><span class="_j_rollsplit" style="padding:0;margin:0">');for(var h=0;h<=9;h++){g.push('<span class="_j_rollitem" style="display:inline-block;padding:0;margin:0;width:100%;'+(this.itemHeight>0?"height:"+this.itemHeight:"")+'px">'+h+"</span>")}g.push("</span>");return'<span style="position:relative">'+g.join("")+"</span>"}};e.exports=d});M.define("/js/note/initHlsVideo",function(c,a,d){var h=null,g=false,f=location.protocol+"//"+window.Env.IMG_HOST+"/images/post/new_notes/unsupport_placeholder.jpg";if(window.Set&&!($.browser&&$.browser.msie&&$.browser.version<11)){c.async("/js/hls/hls.min",function(i){h=i,g=i.isSupported();M.Event.fire("hls video play inited",{supportHlsVideo:g,unsupportImg:f,init:b})})}else{M.Event.fire("hls video play inited",{supportHlsVideo:g,unsupportImg:f,init:$.noop})}function b(i){if(!g){return false}$("._js_videojs_hls").each(function(m,n){var p=$(n);if(p.data("hasInitHls")){return}p.data("hasInitHls",true);if(p.attr("width")!=="100%"){var j=+p.attr("width"),l=+p.attr("height");if(!j||!l){l=420}else{l=(l*680/j)>480?480:"auto"}j=680;p.attr("width",j).attr("height",l)}if(p.data("noneedinit")){e(p);M.isFunction(i)&&i(n);return true}var k=new h();k.loadSource(p.data("url"));k.attachMedia(n);k.on(h.Events.MANIFEST_PARSED,function(){e(p);M.isFunction(i)&&i(n)})})}function e(i){if(i.data("hasBindPlay")){return}i.data("hasBindPlay",true).on("play",function(){i.parent().addClass("video_playing");$("._js_videojs_hls").each(function(j,k){k!==i.get(0)&&k.pause()});M.Event.fire("videoplay")}).on("pause",function(j){i.parent().removeClass("video_playing");M.Event.fire("videopause")})}});M.closure(function(d){var e=d("dialog/alert");var a=null;supportHlsVideo=false;var g=$("._j_load_cover img");if(g.length>0){var b=g.attr("src");function c(){$(".fully_loading").hide();$("._j_load_cover").css({"background-image":"url("+b+")",opacity:0}).animate({opacity:1},500)}M.loadIMG(b,c)}M.Event.on("init video play",function(){$(".add_video").each(function(j,k){var h=$(k);if(h.data("has_inited")){return true}f(h)})});M.Event.on("hls video play inited",function(h){a=h;supportHlsVideo=h.supportHlsVideo;(function(){if(supportHlsVideo){$(".play_before").show()}$("#_j_cover_box").on("click","._j_play",function(){if(supportHlsVideo){var k=$("#_j_cover_box");k.find(".play_before").addClass("play_again").hide();var l=k.find(".play_now").css({"z-index":100,opacity:1});$(".person").addClass("little");$(".view_info").css("z-index",0);$("#_j_swf_head video").get(0).play()}else{e.pop('<p style="font-size: 16px">您的浏览器版本过低，无法播放该视频</p><p style="font-size: 16px">推荐使用最新版 chrome/firefox/IE11及以上等浏览器</p>')}});if($(".play_now").length){f($("#_j_swf_head"),true,function(k){$(k).on("ended",function(){var l=$("#_j_cover_box");l.find(".play_before").removeClass("play_again").show();var m=l.find(".play_now").css({"z-index":0,opacity:0});$(".person").removeClass("little");$(".view_info").css("z-index",15)})})}var i=$("#_j_swf_head video"),j=false;if(supportHlsVideo&&i.length){$(window).scroll(function(n){var m=$("#_j_cover_box").height();var l=$("#header").height();var k=$(window).scrollTop();if(!j&&k>m+l){i.get(0).pause();j=true}else{if(j&&k<=m+l){j=false}}})}}());M.Event.fire("init video play")});d("/js/note/initHlsVideo");function f(s,l,p){var k="",o=s.data("type"),m=l?1:+s.data("ready"),q=l?0:+s.data("audit"),n=s.data("vid"),i=s.data("url"),h=l?"100%":+s.data("width"),r=l?"100%":+s.data("height");if(m==0){k='<div class="video_transcoding"><span class="video_circle_btn"></span><span class="video_play_btn"></span>视频正在转码中，1-3分钟后刷新页面即可播放</div>'}else{if(!i&&!n){return}if(o==1){k='<embed type="application/x-shockwave-flash" src="'+i+'" quality="high" align="middle" allowScriptAccess="never" allowFullScreen="true" wmode="transparent" width="600" height="400" ></embed>'}else{if(supportHlsVideo){var j='data-url="';j+=location.protocol+"//"+window.Env.WWW_HOST+"/rest/app/note/video/";j+=n+'?jsondata=%7B%22data_style%22%3A%22jump%22%7D"';if(l){j='data-url="'+s.data("link")+'"'}k='<video data-type="'+o+'" width="'+h+'" height="'+r+'" '+j+' class="_js_videojs_hls" data-noneedinit="0" controls></video>'}else{if(!l){k='<img src="'+a.unsupportImg+'" style=" width:680px; height:420px;">'}}}if(q&&o!=1){k+='<div class="video_audit"><span>视频正在审核，通过后即可正常显示，目前仅自己可见</span></div>'}}s.html(k).data("has_inited",true);o!=1&&a.init(p)}});M.define("PowWorker",function(c,a,d){var g=window.Worker,b=window.Blob,h=window.URL&&window.URL.createObjectURL,f;function e(i){this.task=i;f=this;this.workSpace=this.createWorkSpace();this.bindEvents()}e.prototype.bindEvents=function(){window._workerSpace=this.workSpace;$(window).on("focus",this.workSpace.onFocus);$(window).on("blur",this.workSpace.onBlur);M.Event(this.workSpace).on("finish",function(i){$(window).off("focus",f.workSpace.onFocus);$(window).off("blur",f.workSpace.onBlur);M.Event(f).fire("finish",{answer:i.answer})})};e.prototype.runTask=function(){this.workSpace.run()};e.prototype.createWorkSpace=function(){if(g&&h&&b){return this.createWebWorkerWorkSpace()}else{return this.createNormalWorkSpace()}};e.prototype.createWebWorkerWorkSpace=function(){return{createWebWorker:function(){this.worker=new Worker(URL.createObjectURL(new Blob([this.genWorkerContent()],{type:"application/javascript"})));this.worker.onmessage=function(i){if(i.data.action=="finish"){M.Event(f.workSpace).fire("finish",{answer:i.data.answer})}}},run:function(){this.createWebWorker();this.worker.postMessage({action:"run",task:f.task})},genWorkerContent:function(){return('(function() {				createWorkSpace(self);				self.onmessage = function(e) {					if(e.data.action == "run") {						self.workSpace(e.data.task.seed, e.data.task.target);					} else if(e.data.action == "event") {						if(e.data.type == "focus") {							self.workSpace.onFocus()						} else {							self.workSpace.onBlur()						}					}				};				self.workSpace.finishWork = function(answer) {					self.postMessage({"action": "finish", "answer": answer})				};'+createWorkSpace.toString()+"})()")},onFocus:function(i){this._workerSpace.worker.postMessage({action:"event",type:"focus"})},onBlur:function(){this._workerSpace.worker.postMessage({action:"event",type:"blur"})}}};e.prototype.createNormalWorkSpace=function(){createWorkSpace(this);this.workSpace.run=function(){f.workSpace(f.task.seed,f.task.target)};this.workSpace.finishWork=function(i){M.Event(this).fire("finish",{answer:i})};return this.workSpace};return e});function createWorkSpace(h){var c=true,i=[],g=0,d=self.M,e=[{INTERVAL:8,LOOP:1000},{INTERVAL:24,LOOP:4095}][d?0:1],b,f=[];function a(k,j){if(!String.prototype.endsWith){String.prototype.endsWith=function(o,n){if(n===undefined||n>this.length){n=this.length}return this.substring(n-o.length,n)===o}}b=k;f=j;var m=setInterval(function(){if(c){l()}},e.INTERVAL);function l(){var n=0;while(n<e.LOOP){n++;b++;if(md5(b).endsWith(f[g])){i.push(b);g++}if(i.length==f.length){clearInterval(m);a.finishWork(i);break}}}(function(G){function x(s,o){var p=(65535&s)+(65535&o);return(s>>16)+(o>>16)+(p>>16)<<16|65535&p}function B(p,o){return p<<o|p>>>32-o}function O(A,s,t,p,v,r){return x(B(x(x(s,A),x(p,r)),v),t)}function F(T,s,v,C,p,S,A){return O(s&v|~s&C,T,s,p,S,A)}function w(T,s,v,C,p,S,A){return O(s&C|v&~C,T,s,p,S,A)}function Q(T,s,v,C,p,S,A){return O(s^v^C,T,s,p,S,A)}function N(T,s,v,C,p,S,A){return O(v^(s|~C),T,s,p,S,A)}function J(p,o){p[o>>5]|=128<<o%32,p[14+(o+64>>>9<<4)]=o;var S,u,U,T,A,t=1732584193,C=-271733879,V=-1732584194,s=271733878;for(S=0;S<p.length;S+=16){u=t,U=C,T=V,A=s,C=N(C=N(C=N(C=N(C=Q(C=Q(C=Q(C=Q(C=w(C=w(C=w(C=w(C=F(C=F(C=F(C=F(C,V=F(V,s=F(s,t=F(t,C,V,s,p[S],7,-680876936),C,V,p[S+1],12,-389564586),t,C,p[S+2],17,606105819),s,t,p[S+3],22,-1044525330),V=F(V,s=F(s,t=F(t,C,V,s,p[S+4],7,-176418897),C,V,p[S+5],12,1200080426),t,C,p[S+6],17,-1473231341),s,t,p[S+7],22,-45705983),V=F(V,s=F(s,t=F(t,C,V,s,p[S+8],7,1770035416),C,V,p[S+9],12,-1958414417),t,C,p[S+10],17,-42063),s,t,p[S+11],22,-1990404162),V=F(V,s=F(s,t=F(t,C,V,s,p[S+12],7,1804603682),C,V,p[S+13],12,-40341101),t,C,p[S+14],17,-1502002290),s,t,p[S+15],22,1236535329),V=w(V,s=w(s,t=w(t,C,V,s,p[S+1],5,-165796510),C,V,p[S+6],9,-1069501632),t,C,p[S+11],14,643717713),s,t,p[S],20,-373897302),V=w(V,s=w(s,t=w(t,C,V,s,p[S+5],5,-701558691),C,V,p[S+10],9,38016083),t,C,p[S+15],14,-660478335),s,t,p[S+4],20,-405537848),V=w(V,s=w(s,t=w(t,C,V,s,p[S+9],5,568446438),C,V,p[S+14],9,-1019803690),t,C,p[S+3],14,-187363961),s,t,p[S+8],20,1163531501),V=w(V,s=w(s,t=w(t,C,V,s,p[S+13],5,-1444681467),C,V,p[S+2],9,-51403784),t,C,p[S+7],14,1735328473),s,t,p[S+12],20,-1926607734),V=Q(V,s=Q(s,t=Q(t,C,V,s,p[S+5],4,-378558),C,V,p[S+8],11,-2022574463),t,C,p[S+11],16,1839030562),s,t,p[S+14],23,-35309556),V=Q(V,s=Q(s,t=Q(t,C,V,s,p[S+1],4,-1530992060),C,V,p[S+4],11,1272893353),t,C,p[S+7],16,-155497632),s,t,p[S+10],23,-1094730640),V=Q(V,s=Q(s,t=Q(t,C,V,s,p[S+13],4,681279174),C,V,p[S],11,-358537222),t,C,p[S+3],16,-722521979),s,t,p[S+6],23,76029189),V=Q(V,s=Q(s,t=Q(t,C,V,s,p[S+9],4,-640364487),C,V,p[S+12],11,-421815835),t,C,p[S+15],16,530742520),s,t,p[S+2],23,-995338651),V=N(V,s=N(s,t=N(t,C,V,s,p[S],6,-198630844),C,V,p[S+7],10,1126891415),t,C,p[S+14],15,-1416354905),s,t,p[S+5],21,-57434055),V=N(V,s=N(s,t=N(t,C,V,s,p[S+12],6,1700485571),C,V,p[S+3],10,-1894986606),t,C,p[S+10],15,-1051523),s,t,p[S+1],21,-2054922799),V=N(V,s=N(s,t=N(t,C,V,s,p[S+8],6,1873313359),C,V,p[S+15],10,-30611744),t,C,p[S+6],15,-1560198380),s,t,p[S+13],21,1309151649),V=N(V,s=N(s,t=N(t,C,V,s,p[S+4],6,-145523070),C,V,p[S+11],10,-1120210379),t,C,p[S+2],15,718787259),s,t,p[S+9],21,-343485551),t=x(t,u),C=x(C,U),V=x(V,T),s=x(s,A)}return[t,C,V,s]}function R(u){var o,p="",s=32*u.length;for(o=0;o<s;o+=8){p+=String.fromCharCode(u[o>>5]>>>o%32&255)}return p}function P(u){var o,p=[];for(p[(u.length>>2)-1]=void 0,o=0;o<p.length;o+=1){p[o]=0}var s=8*u.length;for(o=0;o<s;o+=8){p[o>>5]|=(255&u.charCodeAt(o/8))<<o%32}return p}function K(o){return R(J(P(o),8*o.length))}function I(T,s){var v,A,C=P(T),p=[],S=[];for(p[15]=S[15]=void 0,C.length>16&&(C=J(C,8*T.length)),v=0;v<16;v+=1){p[v]=909522486^C[v],S[v]=1549556828^C[v]}return A=J(p.concat(P(s)),512+8*s.length),R(J(S.concat(A),640))}function L(u){var o,p,s="";for(p=0;p<u.length;p+=1){o=u.charCodeAt(p),s+="0123456789abcdef".charAt(o>>>4&15)+"0123456789abcdef".charAt(15&o)}return s}function q(o){return unescape(encodeURIComponent(o))}function H(o){return K(q(o))}function E(o){return L(H(o))}function y(p,o){return I(q(p),q(o))}function z(p,o){return L(y(p,o))}function D(s,o,p){return o?p?y(o,s):z(o,s):p?H(s):E(s)}G.md5=D;return D})(self)}a.onFocus=function(){c=true};a.onBlur=function(){c=false};h.workSpace=a}M.closure(function(c){var g=c("PowWorker"),e=+new Date;if(window.Env.pv_workkey&&window.Env.pv_worktask){window.mfwPageEvent&&window.mfwPageEvent("test","note_pow_pv_start",{iid:window.Env.iid,key:window.Env.pv_workkey});var d=window.Env.pv_worktask.split(","),b={seed:d[0],target:d.slice(1)};var f=new g(b);f.runTask();M.Event(f).on("finish",a)}function a(h){var i=+new Date;window.mfwPageEvent&&window.mfwPageEvent("test","note_pow_pv",{iid:window.Env.iid,key:window.Env.pv_workkey,time:i-e});$.post(location.protocol+"//"+Env.WWW_HOST+"/note/ajax_workforpv.php",{pv_workkey:window.Env.pv_workkey,pv_workproof:h.answer.join(","),__ctk__:window.Env.__ctk__},function(j){if(j.ret==1){}})}});M.define("PageAdmin",function(b){var e={},c=d();e.uuid=window.Env&&window.Env.uPageId||a();function a(){var f=c();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){var g=(f+Math.random()*16)%16|0;f=Math.floor(f/16);return(h==="x"?g:(g&3|8)).toString(16)})}function d(){var f=window.performance||{},g=f.now||f.mozNow||f.msNow||f.oNow||f.webkitNow||Date.now||function(){return new Date().getTime()};return g}return e});M.define("Cookie",function(f,h,e){var g=/\+/g;var i=navigator.cookieEnabled;if(!i){document.cookie="__detectCookieEnabled=1;";i=document.cookie.indexOf("__detectCookieEnabled")!=-1?true:false;if(i){document.cookie="__detectCookieEnabled=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}}if(!i){return{isSupport:false}}var d={isSupport:true,set:function(m,n,k){k=(typeof k=="object"&&k!==null)?k:{};if(typeof k.expires==="number"){var o=k.expires,l=k.expires=new Date();l.setTime(+l+o*1000)}return(document.cookie=[j(m),"=",j(String(n)),k.expires?"; expires="+k.expires.toUTCString():"",k.path?"; path="+k.path:"",k.domain?"; domain="+k.domain:"",k.secure?"; secure":""].join(""))},get:function(q){var k=q?undefined:{};var r=document.cookie?document.cookie.split("; "):[];for(var p=0,m=r.length;p<m;p++){var s=r[p].split("=");var n=a(s.shift());var o=s.join("=");if(q&&q===n){k=b(o);break}if(!q&&(o=b(o))!==undefined){k[n]=o}}return k},remove:function(l,k){if(this.get(l)===undefined){return false}k=(typeof k=="object"&&k!==null)?k:{};k.expires=-1;this.set(l,"",k)}};function j(k){return encodeURIComponent(k)}function a(k){return decodeURIComponent(k)}function c(k){if(k.indexOf('"')===0){k=k.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{k=decodeURIComponent(k.replace(g," "));return k}catch(l){}}function b(k){var l=c(k);return l}e.exports=d});M.define("ResourceKeeper",function(d){var m=b();if(!m){return{isSupport:false}}var c=[];if(window.addEventListener){window.addEventListener("onbeforeunload",l,false)}else{if(window.attachEvent){window.attachEvent("onbeforeunload",l)}}function l(){M.forEach(c,function(n){n.release()})}var e=d("PageAdmin").uuid,j="default_resource",h="__resource_keeper",f=1000,k=2000;function a(n){n=""+n;n=n||j;this.keeping=false;this.resourceKeeperStorageKey=h+"_"+n;this.keepingRefreshInterval=0;this._initStorageListener();c.push(this)}M.mix(a.prototype,{keep:function(){this._requestKeep();return this.keeping},forceKeep:function(n){this._startKeep(n)},release:function(){if(this.keeping){var n=+new Date(),o=g(this.resourceKeeperStorageKey);if(o.currentKeeperPageUUID==e&&o.expire>n){m.remove(this.resourceKeeperStorageKey);this._setKeeping(false)}}},_initStorageListener:function(){M.Event(m).on("resource_keeper_change",M.bind(function(n){if(this.keeping&&n.key==this.resourceKeeperStorageKey&&n.pageUUID&&n.pageUUID!=e){this._setKeeping(false)}},this))},_requestKeep:function(){var n=+new Date(),o=g(this.resourceKeeperStorageKey);if(!o.currentKeeperPageUUID||o.currentKeeperPageUUID==e||o.expire<=n){this._startKeep(n)}else{this._setKeeping(false)}},_startKeep:function(n){n=n||+new Date();var o=n+k;m.set(this.resourceKeeperStorageKey,e+":"+o);this._setKeeping(true)},_setKeeping:function(n){this.keeping=n;if(this.keeping){this._startKeepingRefreshRequest()}else{this._stopKeepingRefreshRequest()}},_startKeepingRefreshRequest:function(){clearInterval(this.keepingRefreshInterval);this.keepingRefreshInterval=setInterval(M.bind(this._requestKeep,this),f)},_stopKeepingRefreshRequest:function(){clearInterval(this.keepingRefreshInterval)}});function b(){var o=null,p=d("Storage");if(p&&p.isSupport){o={set:M.bind(p.setItem,p),get:M.bind(p.getItem,p),remove:M.bind(p.removeItem,p)};if(window.addEventListener){window.addEventListener("storage",function(r){var q=r.key;if(q.indexOf(h)===0){var t="";if(r.newValue){var s=r.newValue.split(":");if(s.length==2){t=s[0]}}M.Event(o).fire("resource_keeper_change",{key:q,pageUUID:t})}},false)}}else{var n=d("Cookie");if(n&&n.isSupport){o={set:function(q,r){return n.set(q,r,k)},get:M.bind(n.get,n),remove:M.bind(n.remove,n)}}}return o}function g(p){var o={currentKeeperPageUUID:"",expire:0},n=m.get(p);if(n){n=n.split(":");o.currentKeeperPageUUID=n[0];o.expire=+n[1]}return o}function i(o){var n=new a(o);return{keep:M.bind(n.keep,n),forceKeep:M.bind(n.forceKeep,n),release:M.bind(n.release,n)}}i.isSupport=true;return i});(function(a){a.jGrowl=function(b,c){if(a("#jGrowl").size()==0){a('<div id="jGrowl"></div>').addClass((c&&c.position)?c.position:a.jGrowl.defaults.position).appendTo("body")}a("#jGrowl").jGrowl(b,c)};a.fn.jGrowl=function(b,d){if(a.isFunction(this.each)){var c=arguments;return this.each(function(){var e=this;if(a(this).data("jGrowl.instance")==undefined){a(this).data("jGrowl.instance",a.extend(new a.fn.jGrowl(),{notifications:[],element:null,interval:null}));a(this).data("jGrowl.instance").startup(this)}if(a.isFunction(a(this).data("jGrowl.instance")[b])){a(this).data("jGrowl.instance")[b].apply(a(this).data("jGrowl.instance"),a.makeArray(c).slice(1))}else{a(this).data("jGrowl.instance").create(b,d)}})}};a.extend(a.fn.jGrowl.prototype,{defaults:{pool:0,header:"",group:"",sticky:false,position:"top-right",glue:"after",theme:"default",themeState:"highlight",corners:"10px",check:250,life:3000,closeDuration:"normal",openDuration:"normal",easing:"swing",closer:true,closeTemplate:"&times;",closerTemplate:"<div>[ 关闭 ]</div>",log:function(c,b,d){},beforeOpen:function(c,b,d){},afterOpen:function(c,b,d){},open:function(c,b,d){},beforeClose:function(c,b,d){},close:function(c,b,d){},animateOpen:{opacity:"show"},animateClose:{opacity:"hide"}},notifications:[],element:null,interval:null,create:function(b,c){var c=a.extend({},this.defaults,c);if(typeof c.speed!=="undefined"){c.openDuration=c.speed;c.closeDuration=c.speed}this.notifications.push({message:b,options:c});c.log.apply(this.element,[this.element,b,c])},render:function(d){var b=this;var c=d.message;var e=d.options;var d=a('<div class="jGrowl-notification '+e.themeState+" ui-corner-all"+((e.group!=undefined&&e.group!="")?" "+e.group:"")+'"><div class="jGrowl-close">'+e.closeTemplate+'</div><div class="jGrowl-header">'+e.header+'</div><div class="jGrowl-message">'+c+"</div></div>").data("jGrowl",e).addClass(e.theme).children("div.jGrowl-close").bind("click.jGrowl",function(){a(this).parent().trigger("jGrowl.close")}).parent();a(d).bind("mouseover.jGrowl",function(){a("div.jGrowl-notification",b.element).data("jGrowl.pause",true)}).bind("mouseout.jGrowl",function(){a("div.jGrowl-notification",b.element).data("jGrowl.pause",false)}).bind("jGrowl.beforeOpen",function(){if(e.beforeOpen.apply(d,[d,c,e,b.element])!=false){a(this).trigger("jGrowl.open")}}).bind("jGrowl.open",function(){if(e.open.apply(d,[d,c,e,b.element])!=false){if(e.glue=="after"){a("div.jGrowl-notification:last",b.element).after(d)}else{a("div.jGrowl-notification:first",b.element).before(d)}a(this).animate(e.animateOpen,e.openDuration,e.easing,function(){if(a.browser.msie&&(parseInt(a(this).css("opacity"),10)===1||parseInt(a(this).css("opacity"),10)===0)){this.style.removeAttribute("filter")}a(this).data("jGrowl").created=new Date();a(this).trigger("jGrowl.afterOpen")})}}).bind("jGrowl.afterOpen",function(){e.afterOpen.apply(d,[d,c,e,b.element])}).bind("jGrowl.beforeClose",function(){if(e.beforeClose.apply(d,[d,c,e,b.element])!=false){a(this).trigger("jGrowl.close")}}).bind("jGrowl.close",function(){a(this).data("jGrowl.pause",true);a(this).animate(e.animateClose,e.closeDuration,e.easing,function(){a(this).remove();var f=e.close.apply(d,[d,c,e,b.element]);if(a.isFunction(f)){f.apply(d,[d,c,e,b.element])}})}).trigger("jGrowl.beforeOpen");if(e.corners!=""&&a.fn.corner!=undefined){a(d).corner(e.corners)}if(a("div.jGrowl-notification:parent",b.element).size()>1&&a("div.jGrowl-closer",b.element).size()==0&&this.defaults.closer!=false){a(this.defaults.closerTemplate).addClass("jGrowl-closer ui-state-highlight ui-corner-all").addClass(this.defaults.theme).appendTo(b.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){a(this).siblings().trigger("jGrowl.beforeClose");if(a.isFunction(b.defaults.closer)){b.defaults.closer.apply(a(this).parent()[0],[a(this).parent()[0]])}})}},update:function(){a(this.element).find("div.jGrowl-notification:parent").each(function(){if(a(this).data("jGrowl")!=undefined&&a(this).data("jGrowl").created!=undefined&&(a(this).data("jGrowl").created.getTime()+parseInt(a(this).data("jGrowl").life))<(new Date()).getTime()&&a(this).data("jGrowl").sticky!=true&&(a(this).data("jGrowl.pause")==undefined||a(this).data("jGrowl.pause")!=true)){a(this).trigger("jGrowl.beforeClose")}});if(this.notifications.length>0&&(this.defaults.pool==0||a(this.element).find("div.jGrowl-notification:parent").size()<this.defaults.pool)){this.render(this.notifications.shift())}if(a(this.element).find("div.jGrowl-notification:parent").size()<2){a(this.element).find("div.jGrowl-closer").animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){a(this).remove()})}},startup:function(b){this.element=a(b).addClass("jGrowl").append('<div class="jGrowl-notification"></div>');this.interval=setInterval(function(){a(b).data("jGrowl.instance").update()},parseInt(this.defaults.check));if(a.browser.msie&&parseInt(a.browser.version)<7&&!window.XMLHttpRequest){a(this.element).addClass("ie6")}},shutdown:function(){a(this.element).removeClass("jGrowl").find("div.jGrowl-notification").remove();clearInterval(this.interval)},close:function(){a(this.element).find("div.jGrowl-notification").each(function(){a(this).trigger("jGrowl.beforeClose")})}});a.jGrowl.defaults=a.fn.jGrowl.prototype.defaults})(jQuery);if(window.M&&typeof window.M.define=="function"){window.M.define("jq-jgrowl",function(){return jQuery})}M.closure(function(e){var j=e("ResourceKeeper"),t=j.isSupport?new j("new_msg_loop"):null,s=e("Storage"),b=1000,r=10000,u=40000,d=120000;var v=(function(){if(j.isSupport){return $.proxy(t.keep,t)}else{return function(){return M.windowFocused}}}());var k=function(){if(j.isSupport){t.forceKeep()}};if("addEventListener" in window){window.addEventListener("focus",k,false)}else{if("attachEvent" in document){document.attachEvent("onfocusin",k)}}$(function(){if(window.Env&&window.Env.UID>0||window.__mfw_uid>0){setTimeout(n,b)}else{setTimeout(l,r)}$("body").delegate(".jGrowl-closer","click",function(x){$.getJSON("/ajax/ajax_msg.php",{a:"closetip"});s.setItem("jgrowl_close_time",+new Date())});M.Event.on("update msg",function(){setTimeout(function(){w();s.setItem("update_msg",+new Date())},1)});s.on("update_msg",function(x){w()});function w(){if(window.Env&&window.Env.UID>0||window.__mfw_uid>0){p("msgdisplay")}else{p("nologinfeed")}}});function n(){setInterval(function(){v()&&p("msgdisplay")},u)}function l(){var x,w=1;v()&&p("nologinfeed");x=setInterval(function(){v()&&p("nologinfeed");w++;if(w==3){clearInterval(x)}},d)}function p(w){$.get("/ajax/ajax_msg.php?a="+w,function(x){if(x){o(x)}},"json")}function o(w){g();M.Event.fire("get new msg",w);if(w.msg){m()}if(w.tips&&!i()){a(w)}}e("jq-jgrowl");function a(w){var x=w.tips.split(w.split_char);M.forEach(x,function(z,y){if(z){setTimeout(function(){$.jGrowl(z,{header:"新鲜事：",closer:false,life:20000})},2000*y+10)}})}function i(){var x=s.getItem("jgrowl_close_time"),w=+new Date();if(x&&w-x<24*60*60*1000){return true}return false}var c,f=0,h=1000,q=document.title;function m(){g();c=setInterval(function(){if(v()){f++;document.title=f%2===0?"【　　　】 - "+q:"【新消息】 - "+q}else{document.title=q}},h)}function g(){clearInterval(c);document.title=q}});M.define("FrequencySystemVerify",function(f,e,g){var b=f("dialog/Dialog"),h=f("dialog/Layer"),d=f("FrequencyVerifyControl");var a='<div class="popYzm" style="z-index:inherit;position: relative;width:350px;height: 250px"><div class="protectedYZM" style="border: none;box-shadow: none;padding:25px 15px;"><p>亲爱的蜂蜂，你操作的速度有点像机器人<br>来证明下自己吧~</p><div class="YZMInput"><input class="_j_fre_text" type="text" placeHolder="验证码"></div><div class="YZMInput"><img src="http://images.mafengwo.net/images/home_new2015/verify.gif" width="150px" height="40px"><label><a href="javascript:void(0);" class="_j_change_img">看不清，换一张</a></label></div><div class="YZMSubmit"><a href="javascript:void(0);" class="_j_fre_confirm" title="确定">确定</a><span class="n-error">错误次数过多，请稍候尝试</span></div></div></div>';function c(i){this.app=i.app;this.init()}c.prototype={init:function(){var i=new b({content:a});if(h.getActive()){i.getLayer().setZIndex(h.getActive().getZIndex()+1)}i.show();var j=i.getPanel().find(".popYzm");new d({container:j,app:this.app,successHandler:$.proxy(function(){M.Event.fire("frequency:system:verify:success");i.close()},this)})}};g.exports=c});M.closure(function(d){var b=d("dialog/Dialog"),f=d("dialog/alert"),c=d("FrequencySystemVerify");window.show_login=a;$.ajaxSetup({dataFilter:function(i,h){try{var k=$.parseJSON(i);if(k&&k.unsafe==1){window.location.href="http://www.mafengwo.cn";return"{}"}if(k&&k.error&&k.error.msg=="login:required"){M.Event.fire("login:required");return"{}"}if(k&&k.error&&k.error.msg=="mobilebind:required"){f.pop({title:"依《网络安全法》要求，你需要在发布内容之前绑定手机号~",assureWords:"去绑定",hideCloser:true},function(m){location.href=window.Env.P_HTTP+"/setting/security/mobile/"});return{}}if(k&&k.resource&&k.resource.onload&&k.resource.onload.length){if(k.resource.onload[0]=='K.fire("login:required");'){M.Event.fire("login:required");return"{}"}}if(k&&k.error){var g=0;var l=0;if(typeof(k.error.errno)!=="undefined"){g=k.error.errno;l=k.error.error}else{if(typeof(k.error.code)!=="undefined"){g=k.error.code;l=k.error.msg}}if(g===10000){M.Event.fire("frequency:verify",l);return"{}"}}}catch(j){}return i},error:function(g){if(g.status==401){if(g.responseJSON&&g.responseJSON.data&&g.responseJSON.data.auth_type=="login"){M.Event.fire("login:required")}}}});var e=null;function a(){if($.browser.msie&&parseInt($.browser.version,10)<9){document.location.href=(window.Env&&window.Env.P_HTTP)||"https://passport.mafengwo.cn";return}if(!e){e=new b({PANEL_CLASS:"login_pop",content:'<iframe frameborder="no" border="0" scrolling="no" width="580" height="292" allowtransparency="true"></iframe>',background:"#aaa",bgOpacity:0.6,reposition:true,impl:"logindialog"})}e.show();if(!e.getPanel().find("iframe").attr("src")){M.Event(e).once("aftershow",function(){var g=window.Env.P_HTTP||"https://passport.mafengwo.cn";e.getPanel().find("iframe").attr("src",g+"/login-popup.html")})}}M.Event.on("login:required",a);M.Event.on("frequency:verify",function(g){new c({app:g})});if(M.Event.isFired("login:required")){a()}});M.define("QRCode",function(b,a,c){c.exports={gen:function(e,d){var d={text:e,size:d.size||200,eclevel:d.evlevel||"H",logo:d.logo||"",__stk__:window.Env.CSTK};return"http://"+window.Env.WWW_HOST+"/qrcode.php?"+$.param(d)}}});M.closure(function(b){var l=b("ScrollObserver"),m=b("Storage"),d=window.Env||{},f=$("#_j_mfwtoolbar"),h=f.height(),a=$(window).height(),k=$(document).height(),g=$("#footer"),e=g.outerHeight();$("body").css("position","relative");$(window).resize(function(){a=$(window).height();k=$(document).height()});setInterval(function(){var n=$(document).height();if(n!=k){k=n;$(window).trigger("scroll")}},2000);if(!d.hideToolbar){if(!d.showToolbarDownArrow){f.children(".toolbar-item-down").remove()}else{f.children(".toolbar-item-down").show()}f.show();c();l.addObserver(c);f.on("click","._j_gotop",i);f.on("click","._j_gobottom",j);f.children(".toolbar-item-code").mouseenter(function(){$(this).addClass("hover")});f.children(".toolbar-item-code").mouseleave(function(){$(this).removeClass("hover")})}function c(){var n=$(window).scrollTop();if(n>500){f.children(".toolbar-item-top").show()}else{f.children(".toolbar-item-top").hide()}if(g.length){if(n+a>g.offset().top){f.css({position:"absolute",bottom:e+20})}else{f.css({position:"",bottom:""})}}}function i(){$("html, body").animate({scrollTop:0},500,function(){M.Event.fire("scroll to top")})}function j(){$("html, body").animate({scrollTop:k-a},500,function(){M.Event.fire("scroll to bottom")})}});(function(){var a=document.createElement("script"),b=window.Env&&window.Env.CNZZID||30065558;a.type="text/javascript";a.async=true;a.charset="utf-8";a.src=document.location.protocol+"//w.cnzz.com/c.php?id="+b+"&async=1";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,c)})();