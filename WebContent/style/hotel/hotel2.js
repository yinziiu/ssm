M.define("/js/Dropdown",function(c,b,d){function a(e){this.$nav=typeof e.nav==="string"?$(e.nav):e.nav;this.$panel=typeof e.panel==="string"?$(e.panel):e.panel;this.showCallback=e.showCallback;this.hideCallback=e.hideCallback;this.delay=e.delay||0;this.event=e.event||"mouseenterleave";this._isShow=false;this.init()}a.prototype={init:function(){if(this.event==="mouseenterleave"){this.$nav.on("mouseenter.dropdown",M.bind(function(e){this.show()},this)).on("mouseleave.dropdown",M.bind(function(e){if($(e.relatedTarget).closest(this.$panel).length===0){this.hide(true)}},this));this.$panel.on("mouseenter.dropdown",M.bind(function(e){this.show()},this)).on("mouseleave.dropdown",M.bind(function(e){if($(e.relatedTarget).closest(this.$nav).length===0){this.hide(false)}},this))}if(this.event==="click"){this.$nav.on("click.dropdown",M.bind(function(e){this.show()},this));$(document).on("click.dropdown",M.bind(function(e){if($(e.target).closest(this.$nav).length===0&&$(e.target).closest(this.$panel).length===0){this.hide(false)}},this))}},show:function(){this.$panel.show();this._isShow=true;if(M.isFunction(this.showCallback)){this.showCallback.call(this,this.$nav,this.$panel)}},hide:function(e){this._isShow=false;if(e&&this.delay>0){setTimeout(M.bind(function(){if(!this._isShow){this.$panel.hide();if(M.isFunction(this.hideCallback)){this.hideCallback.call(this,this.$nav,this.$panel)}}},this),this.delay)}else{this.$panel.hide();if(M.isFunction(this.hideCallback)){this.hideCallback.call(this,this.$nav,this.$panel)}}},destory:function(){if(this.event==="mouseenterleave"){this.$nav.off("mouseenter.dropdown").off("mouseleave.dropdown");this.$panel.off("mouseenter.dropdown").off("mouseleave.dropdown")}if(this.event==="click"){this.$nav.off("click.dropdown")}this.$panel.hide()}};d.exports=a});M.define("/js/pageletcommon/pageHeadUserInfoWWWNormal",function(c){var a=c("/js/Dropdown"),b=window.Env||{};return{events:{},init:function(){var k=$("#head-btn-daka");$(function(){$(".new_daka_tips").addClass("on")});$(".ndt_close").on("click",function(){$(this).parent().hide()});M.Event.on("afterDaka",l);function l(q){if(q&&q.dakaFlag){k.closest(".head-daka").addClass("daka-complete")}}var e=i("dakaday");if(e!==null){$(".head-btn-daka").attr("data-day",e)}function i(q){var s=new RegExp("(^|&)"+q+"=([^&]*)(&|$)");var t=window.location.search.substr(1).match(s);if(t!==null){return unescape(t[2])}return null}var g=new a({nav:"#_j_head_user",panel:"#_j_user_panel",showCallback:function(q,r){q.find(".drop-trigger").addClass("drop-trigger-active")},hideCallback:function(q,r){q.find(".drop-trigger").removeClass("drop-trigger-active")},delay:500});var d=0,p=$("#_j_head_msg"),o=$("#_j_msg_panel"),n=p.find(".head-msg-new"),j=$("#_j_msg_float_panel");var f=new a({nav:p.selector,panel:o.selector,showCallback:function(q,r){q.find(".drop-trigger").addClass("drop-trigger-active")},hideCallback:function(q,r){q.find(".drop-trigger").removeClass("drop-trigger-active")},delay:200});M.Event.on("get new msg",function(q){if(q.msg||d>0){o.find("ul").html(q.menu_index);h()}});o.on("click","a",function(q){M.Event.fire("update msg")});j.on("click","ul a",function(q){M.Event.fire("update msg")});j.on("click",".close-newmsg",function(q){m()});function m(){n.hide();j.hide();$.ajax({url:"http://"+b.WWW_HOST+"/ajax/ajax_msg.php",dataType:"jsonp",data:{a:"ignore",from:"1"},success:function(q){M.Event.fire("update msg")}})}window.close_msg_tips=m;function h(){var q="";d=0;o.find(".num").each(function(r,t){var s=$(t);d+=Number(s.html());q+="<li>"+s.closest("li").html()+"</li>"});if(d>0){n.html((d>99?"99+":d)).show();j.find("ul").html(q).end().show()}else{n.hide();j.hide()}}h()}}});
/*!
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright 2011, Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(i,f){var t=i.fn.domManip,h="_tmplitem",u=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,p={},e={},y,x={key:0,data:{}},w=0,q=0,g=[];function k(B,A,D,E){var C={data:E||(E===0||E===false)?E:(A?A.data:{}),_wrap:A?A._wrap:null,tmpl:null,parent:A||null,nodes:[],calls:c,nest:b,wrap:n,html:r,update:z};if(B){i.extend(C,B,{nodes:[],parent:A})}if(D){C.tmpl=D;C._ctnt=C._ctnt||C.tmpl(i,C);C.key=++w;(g.length?e:p)[w]=C}return C}i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(A,B){i.fn[A]=function(C){var F=[],I=i(C),E,G,D,J,H=this.length===1&&this[0].parentNode;y=p||{};if(H&&H.nodeType===11&&H.childNodes.length===1&&I.length===1){I[B](this[0]);F=this}else{for(G=0,D=I.length;G<D;G++){q=G;E=(G>0?this.clone(true):this).get();i(I[G])[B](E);F=F.concat(E)}q=0;F=this.pushStack(F,A,I.selector)}J=y;y=null;i.tmpl.complete(J);return F}});i.fn.extend({tmpl:function(C,B,A){return i.tmpl(this[0],C,B,A)},tmplItem:function(){return i.tmplItem(this[0])},template:function(A){return i.template(A,this[0])},domManip:function(E,H,G,I){if(E[0]&&i.isArray(E[0])){var B=i.makeArray(arguments),A=E[0],F=A.length,C=0,D;while(C<F&&!(D=i.data(A[C++],"tmplItem"))){}if(D&&q){B[2]=function(J){i.tmpl.afterManip(this,J,G)}}t.apply(this,B)}else{t.apply(this,arguments)}q=0;if(!y){i.tmpl.complete(p)}return this}});i.extend({tmpl:function(C,F,E,B){var D,A=!B;if(A){B=x;C=i.template[C]||i.template(null,C);e={}}else{if(!C){C=B.tmpl;p[B.key]=B;B.nodes=[];if(B.wrapped){s(B,B.wrapped)}return i(m(B,null,B.tmpl(i,B)))}}if(!C){return[]}if(typeof F==="function"){F=F.call(B||{})}if(E&&E.wrapped){s(E,E.wrapped)}D=i.isArray(F)?i.map(F,function(G){return G?k(E,B,C,G):null}):[k(E,B,C,F)];return A?i(m(B,null,D)):D},tmplItem:function(B){var A;if(B instanceof i){B=B[0]}while(B&&B.nodeType===1&&!(A=i.data(B,"tmplItem"))&&(B=B.parentNode)){}return A||x},template:function(B,A){if(A){if(typeof A==="string"){A=l(A)}else{if(A instanceof i){A=A[0]||{}}}if(A.nodeType){A=i.data(A,"tmpl")||i.data(A,"tmpl",l(A.innerHTML))}return typeof B==="string"?(i.template[B]=A):A}return B?(typeof B!=="string"?i.template(null,B):(i.template[B]||i.template(null,u.test(B)?B:i(B)))):null},encode:function(A){return(""+A).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});i.extend(i.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(A){p={}},afterManip:function v(C,A,D){var B=A.nodeType===11?i.makeArray(A.childNodes):A.nodeType===1?[A]:[];D.call(C,A);o(B);q++}});function m(A,E,C){var D,B=C?i.map(C,function(F){return(typeof F==="string")?(A.key?F.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+h+'="'+A.key+'" $2'):F):m(F,A,F._ctnt)}):A;if(E){return B}B=B.join("");B.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(G,H,F,I){D=i(F).get();o(D);if(H){D=a(H).concat(D)}if(I){D=D.concat(a(I))}});return D?D:a(B)}function a(B){var A=document.createElement("div");A.innerHTML=B;return i.makeArray(A.childNodes)}function l(A){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+i.trim(A).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(I,C,G,D,E,J,F){var N=i.tmpl.tag[G],B,H,K;if(!N){throw"Unknown template tag: "+G}B=N._default||[];if(J&&!/\w$/.test(E)){E+=J;J=""}if(E){E=j(E);F=F?(","+j(F)+")"):(J?")":"");H=J?(E.indexOf(".")>-1?E+j(J):("("+E+").call($item"+F)):E;K=J?H:"(typeof("+E+")==='function'?("+E+").call($item):("+E+"))"}else{K=H=B.$1||"null"}D=j(D);return"');"+N[C?"close":"open"].split("$notnull_1").join(E?"typeof("+E+")!=='undefined' && ("+E+")!=null":"true").split("$1a").join(K).split("$1").join(H).split("$2").join(D||B.$2||"")+"__.push('"})+"');}return __;")}function s(B,A){B._wrap=m(B,true,i.isArray(A)?A:[u.test(A)?A:i(A).html()]).join("")}function j(A){return A?A.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function d(A){var B=document.createElement("div");B.appendChild(A.cloneNode(true));return B.innerHTML}function o(G){var I="_"+q,B,A,E={},F,D,C;for(F=0,D=G.length;F<D;F++){if((B=G[F]).nodeType!==1){continue}A=B.getElementsByTagName("*");for(C=A.length-1;C>=0;C--){H(A[C])}H(B)}function H(Q){var N,P=Q,O,J,K;if((K=Q.getAttribute(h))){while(P.parentNode&&(P=P.parentNode).nodeType===1&&!(N=P.getAttribute(h))){}if(N!==K){P=P.parentNode?(P.nodeType===11?0:(P.getAttribute(h)||0)):0;if(!(J=p[K])){J=e[K];J=k(J,p[P]||e[P]);J.key=++w;p[w]=J}if(q){R(K)}}Q.removeAttribute(h)}else{if(q&&(J=i.data(Q,"tmplItem"))){R(J.key);p[J.key]=J;P=i.data(Q.parentNode,"tmplItem");P=P?P.key:0}}if(J){O=J;while(O&&O.key!=P){O.nodes.push(Q);O=O.parent}delete J._ctnt;delete J._wrap;i.data(Q,"tmplItem",J)}function R(S){S=S+I;J=E[S]=(E[S]||k(J,p[J.parent.key+I]||J.parent))}}}function c(C,A,D,B){if(!C){return g.pop()}g.push({_:C,tmpl:A,item:this,data:D,options:B})}function b(A,C,B){return i.tmpl(i.template(A),C,B,this)}function n(C,A){var B=C.options||{};B.wrapped=A;return i.tmpl(i.template(C.tmpl),C.data,B,C.item)}function r(B,C){var A=this._wrap;return i.map(i(i.isArray(A)?A.join(""):A).filter(B||"*"),function(D){return C?D.innerText||D.textContent:D.outerHTML||d(D)})}function z(){var A=this.nodes;i.tmpl(null,null,null,this).insertBefore(A[0]);i(A).remove()}if(window.M&&typeof M.define=="function"){M.define("jq-tmpl",function(){return i})}})(jQuery);M.define("InputListener",function(c,b,d){var a={listen:function(f,e){f=$(f);f.each($.proxy(function(g,h){h=$(h);if(!h.is("input")&&!h.is("textarea")){throw new Error("input listener only apply to input or textarea")}this.initListen(h,e)},this))},unlisten:function(e){e=$(e);e.each($.proxy(function(h,k){k=$(k);if(!k.is("input")&&!k.is("textarea")){throw new Error("input listener only apply to input or textarea")}if(arguments.length==1){k.unbind("focus",this.getStartListenFunc());k.unbind("blur",this.getStopListenFunc());k.removeData("__input_listener_handlers")}else{if(typeof arguments[1]=="function"){var j=arguments[1],g=k.data("__input_listener_listeninterval");for(var h=0,f=g.length;h<f;h++){if(g[h]==j){g.splice(h,1);h--}}}}},this))},initListen:function(f,e){f.data("__input_listener_currentval",f.val());if(!f.data("__input_listener_handlers")){this.bindListenEvent(f)}this.addListenHandler(f,e);if(f.is(":focus")){f.blur();f.focus()}},bindListenEvent:function(e){e.data("__input_listener_handlers",[]);e.focus(this.getStartListenFunc());e.blur(this.getStopListenFunc())},getStartListenFunc:function(){if(!this.bindStartListenFunc){this.bindStartListenFunc=$.proxy(this.startListen,this)}return this.bindStartListenFunc},getStopListenFunc:function(){if(!this.bindStopListenFunc){this.bindStopListenFunc=$.proxy(this.stopListen,this)}return this.bindStopListenFunc},startListen:function(e){var f=$(e.target);f.data("__input_listener_currentval",f.val());f.data("__input_listener_listeninterval",setInterval($.proxy(function(){var h=f.data("__input_listener_currentval"),g=f.val();if(h!=g){f.data("__input_listener_currentval",g);this.triggerListenHandler(f)}},this),100))},stopListen:function(e){var f=$(e.target);clearInterval(f.data("__input_listener_listeninterval"))},addListenHandler:function(f,e){if(typeof e=="function"){f.data("__input_listener_handlers").push(e)}},triggerListenHandler:function(h){var f=h.data("__input_listener_handlers");for(var g=0,e=f.length;g<e;g++){f[g].call(null,{target:h.get(0)})}}};return a});M.define("SuggestionXHR",function(b,a,c){function d(e){this.URL=null;this.delay=200;this.dataType="text";$.extend(this,e);this.delayTimer=null;this.xhr=null;this.cache={};this.init()}d.prototype={init:function(){if(!this.URL){throw new Error("no url for suggestion")}},getSuggestion:function(g,h){var f=this.getQuery(g),e=this.cache[f];h=typeof h==="function"?h:$.noop;this.stop();if(e){h(e)}else{this.getXHRData(f,h)}},stop:function(){clearTimeout(this.delayTimer);if(this.xhr&&this.xhr.readyState!==4){this.xhr.abort()}},getQuery:function(h){var g="";if(typeof h=="string"){g=encodeURIComponent(h)}else{if(h&&typeof h=="object"){var e=[];for(var f in h){if(h.hasOwnProperty(f)){e.push(f+"="+encodeURIComponent(h[f]))}}g=e.join("&")}}return g},getXHRData:function(e,h){var f=this.xhr,g={url:this.URL,data:e,dataType:this.dataType,success:M.bind(function(i){h(i);this.cache[e]=i},this)};this.delayTimer=setTimeout(M.bind(function(){this.xhr=$.ajax(g)},this),this.delay)}};return d});M.define("DropList",function(c,b,d){var a=M.Event;function e(f){this.trigger=null;this.container=null;this.itemSelector="._j_listitem";this.itemHoverClass="on";this.firstItemHover=false;$.extend(this,f);this.trigger=$(this.trigger);this.container=$(this.container);this.mouseon=false;this.visible=false;this.init()}M.mix(e.prototype,{createContainer:$.noop,updateList:$.noop,init:function(){if(!this.trigger.length){M.error("no trigger for drop list")}if(!this.container.length){this.container=this.createContainer()}if(!this.container.length){M.error("no container for drop list")}this.bindEvents()},bindEvents:function(){this.trigger.on("keydown",$.proxy(function(g){var h=g.keyCode;if(this.visible&&h==13){var f=this.getFocusItem();if(f.length){this.selectItem(f);g.preventDefault()}}else{if(this.visible&&h==38){this.moveFocus(-1)}else{if(this.visible&&h==40){this.moveFocus(1)}}}},this));this.container.on("mouseenter",this.itemSelector,$.proxy(this.moveFocus,this)).on("click",this.itemSelector,$.proxy(this.clickItem,this)).on("mouseenter",$.proxy(this.mouseOverCnt,this)).on("mouseleave",$.proxy(this.mouseOutCnt,this))},show:function(g){this.updateList(g);this.container.show();if(this.firstItemHover){var f=this.container.find(this.itemSelector);if(f.length){this.moveFocus(1)}}this.visible=true},hide:function(){this.container.hide();this.visible=false},clickItem:function(g){var f=this.getFocusItem();this.selectItem(f);g.preventDefault()},selectItem:function(f){a(this).fire("itemselected",{item:f})},moveFocus:function(i){var h=this.container.find(this.itemSelector),j=this.getFocusItem(),g=j,f;if(i===-1){if(j.length){f=h.index(j)-1}if(!j.length||f==-1){g=h.last()}else{g=h.eq(f)}}else{if(i===1){if(j.length){f=h.index(j)+1}if(!j.length||f==h.length){g=h.first()}else{g=h.eq(f)}}else{if(i.currentTarget){g=$(i.currentTarget)}}}j.removeClass(this.itemHoverClass);g.addClass(this.itemHoverClass);a(this).fire("itemfocused",{prevItem:j,focusItem:g})},getFocusItem:function(){var f=this.container.find(this.itemSelector);return f.filter("."+this.itemHoverClass)},mouseOverCnt:function(){this.mouseon=true},mouseOutCnt:function(){this.mouseon=false}});return e});M.define("Suggestion",function(c){c("jq-tmpl");var a=c("InputListener");var b='{{each(i, item) list}}<li class="${listItemClass}" data-value="${item.value}">${item.text}</li>{{/each}}';function d(e){e.suggestionURL=e.url||$(e.input).data("suggestionurl");this.dropListClass="droplist";this.listItemSelector="._j_listitem";this.listItemHoverClass="on";this.listFirstItemHover=false;this.keyParamName="key";this.dataType="json";this.suggestionParams={};this.listContainer=null;M.mix(this,e);this.input=$(this.input);this.listTmpl=this.listTmpl||b;this.actOnList=false;this.init()}M.mix(d.prototype,{init:function(){a.listen(this.input,$.proxy(this.inputChange,this));this.input.blur($.proxy(function(f){var e=$(f.currentTarget);if(e.data("droplist")){setTimeout($.proxy(function(){if(!this.actOnList&&e.data("droplist")){e.data("droplist").hide()}this.actOnList=false},this),200)}},this));this.input.keyup($.proxy(function(f){var e=$(f.currentTarget);if(f.keyCode==40&&(!e.data("droplist")||!e.data("droplist").visible)){this.inputChange(f)}},this))},inputChange:function(i){var f=$(i.target),k=$.trim(f.val()),j=c("SuggestionXHR"),h=c("DropList");var g=f.data("droplist");if(!g){f.data("droplist",g=new h({trigger:f,itemSelector:this.listItemSelector,itemHoverClass:this.listItemHoverClass,firstItemHover:this.listFirstItemHover,container:this.listContainer,createContainer:$.proxy(function(){var l=this.createListContainer(f);this.listContainer=l;return l},this),updateList:$.proxy(this.updateList,this)}));M.Event(g).on("itemselected",$.proxy(function(l){this.dropItemSelected(f,l.item)},this));M.Event(g).on("itemfocused",$.proxy(function(l){M.Event(this).fire("itemfocused",l)},this))}g.hide=function(){setTimeout($.proxy(function(){if(M.windowFocused){this.container.hide();this.visible=false}},this),1)};var e=f.data("suggestion");if(!e){f.data("suggestion",e=new j({URL:this.suggestionURL,dataType:this.dataType}))}if(!k.length){e.stop();g.hide();M.Event(this).fire("after hide list")}else{this.suggestionParams[this.keyParamName]=k;M.Event(this).fire("before suggestion xhr");e.getSuggestion(this.suggestionParams,$.proxy(function(m){M.Event(this).fire("before show list");var l=this.handleSuggest(m);if(l){f.data("droplist").show(l)}},this))}},handleSuggest:function(f){var e="";if(this.dataType=="json"){e=$.tmpl(this.listTmpl,f)}return e},createListContainer:function(f){var g=$("<ul />"),e=f.position();g.css({display:"none",position:"absolute",left:e.left,top:e.top+f.outerHeight()}).addClass(this.dropListClass);g.insertAfter(f);return g},updateList:function(e){this.listContainer.html(e)},hideDropList:function(){this.input.data("droplist")&&this.input.data("droplist").hide()},dropItemSelected:function(e,f){a.unlisten(e);M.Event(this).fire("itemselected",{item:f,input:e});a.listen(e,$.proxy(this.inputChange,this))}});return d});M.define("MesSearchEvent",function(b,a,c){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(f,j){var l=e,h=[],g;j=j||l.length;if(f){for(g=0;g<f;g++){h[g]=l[0|Math.random()*j]}}else{var k;h[8]=h[13]=h[18]=h[23]="-";h[14]="4";for(g=0;g<36;g++){if(!h[g]){k=0|Math.random()*16;h[g]=l[(g==19)?(k&3)|8:k]}}}return h.join("")};Math.uuidFast=function(){var k=e,h=new Array(36),g=0,j;for(var f=0;f<36;f++){if(f==8||f==13||f==18||f==23){h[f]="-"}else{if(f==14){h[f]="4"}else{if(g<=2){g=33554432+(Math.random()*16777216)|0}j=g&15;g=g>>4;h[f]=k[(f==19)?(j&3)|8:j]}}}return h.join("")};Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){var g=Math.random()*16|0,f=h=="x"?g:(g&3|8);return f.toString(16)})};var d={uuid:function(){return Math.uuid()},search:function(f){var g=Math.uuid();f.id=g;!!mfwPageEvent&&mfwPageEvent("se","v2_search",f);return g},searchCache:function(f){var g=Math.uuid();f.id=g;!!mfwPageEvent&&mfwPageEvent("se","v2_search_cache",f);return g},resultClick:function(f){!!mfwPageEvent&&mfwPageEvent("se","v2_result_click",f);return f.id}};c.exports=d});M.define("/js/SiteSearch",function(e){var d="1.0.0",h=e("Suggestion"),f=e("MesSearchEvent"),g=M.cssSupport("transition"),b=M.cssSupport("transform"),c=window.Env||{};var a=function(C){var E=$("#"+C.input+""),U=!!C.submit?$("#"+C.submit+""):null,t=C.additionalClass?C.additionalClass:"",K=!!C.isRelevant,s=C.maxCount||0,z=C.hideOnScroll||false,n=false,J=false,i="",y="",l="",p="";if(C.input==="_j_index_search_input_all"){var H=[];if(E.val()===""&&H&&H.length){var T=Math.floor(Math.random()*H.length),I=H[T];E.val(I.name).data("url",I.url)}E.on("focus",function(W){if(E.data("url")){E.val("").data("url","")}})}if(c.is_async_site_search){n=true}var Q=new h({url:(c.WWW_HOST?window.location.protocol+"//"+c.WWW_HOST:"")+"/search/ss.php",suggestionParams:{isHeader:Number(K)},input:E,listItemHoverClass:"active",listFirstItemHover:false,dataType:"jsonp",createListContainer:function(){var W=$('<div class="m-search-suggest '+t+' hide"><ul class="mss-list"></ul></div>').appendTo("body");W.on("mouseenter",".mss-place .mss-title, .mss-place .mss-nav a",function(Y){var X=$(Y.currentTarget),Z=X.closest(".mss-place");Z.find(".mss-title").removeClass("active").removeClass("frozen").end().find(".mss-nav a").removeClass("active").end();X.addClass("active")}).on("mouseleave",".mss-place .mss-title, .mss-place .mss-nav a",function(Y){var X=$(Y.currentTarget);X.removeClass("active")});return W},handleSuggest:function(aC){i=aC.keyword;J=!!aC.is_hit;l="http://"+aC.www_host;var ax=aC.keyword_cut,az=aC.show_types,X=aC.hide_types;var ar=$("<ul>");var ab=aC.first_poi;if(!!ab){var am=ab,ak=$('<li class="mss-item _j_listitem" data-type="poi">').appendTo(ar),ap=$('<div class="mss-title">').appendTo(ak);ak.attr("data-url",am.url);ap.append('<span class="mss-fr">'+(!!am.mddname?am.mddname:"")+am.typename+"</span>");ap.append('<span class="mss-cn">'+am.dis_name+"</span>")}var ah=aC.article_info;if(ah&&ah.result){for(var at=0;at<ah.result.length;at++){var ag=ah.result[at],ak=$('<li class="mss-item _j_listitem" data-type="article_promoted">').appendTo(ar),ap=$('<div class="mss-title">').appendTo(ak);ak.attr("data-url",ag.link);ap.html(ag.name_display)}}var al=aC.mdd_info;if(al&&al.result){for(var at=0;at<al.result.length;at++){var aa=al.result[at],ak=$('<li class="mss-item _j_listitem" data-type="mdd">').appendTo(ar),ap=$('<div class="mss-title">').appendTo(ak);ak.attr("data-url",aa.url);if(!!aa.parent){ap.append('<span class="mss-fr">'+aa.parent+"</span>")}ap.append('<span class="mss-cn">'+aa.dis_name+"</span>");ap.append('<span class="mss-gl"> '+aa.infoname+"</span>")}}var ao=aC.hotel_info;if(ao&&ao.result&&!K){for(var at=0;at<ao.result.length;at++){var aA=ao.result[at],ak=$('<li class="mss-item _j_listitem" data-type="hotel_promoted">').appendTo(ar),ap=$('<div class="mss-title">').appendTo(ak);ak.attr("data-url",aA.url);ap.append('<span class="mss-fr">'+aA.typename+"</span>");ap.append('<span class="mss-cn">'+aA.title+"</span>");ap.append('<span class="mss-gl"> '+aA.infoname+"</span>")}}var ae=aC.gl_info;if(ae&&ae.result){for(var at=0;at<ae.result.length;at++){var aq=ae.result[at],ak=$('<li class="mss-item _j_listitem" data-type="sales_gonglve">').appendTo(ar),ap=$('<div class="mss-title">').appendTo(ak);ak.attr("data-url",aq.url);ap.append('<span class="mss-fr">'+aq.typename+"</span>");ap.append('<span class="mss-cn">'+aq.title+"</span>")}}var Z=aC.sales_info;if(Z&&Z.result&&!K){for(var at=0;at<Z.result.length;at++){var W=Z.result[at],ak=$('<li class="mss-item _j_listitem" data-type="sales_promoted">').appendTo(ar),ap=$('<div class="mss-title">').appendTo(ak);ak.attr("data-url",W.url);ap.append('<span class="mss-fr">'+W.typename+"</span>");ap.append('<span class="mss-cn">'+W.title+"</span>");ap.append('<span class="mss-gl"> '+W.infoname+"</span>")}}var af=aC.route_info;if(af&&af.result&&!K){for(var at=0;at<af.result.length;at++){var ay=af.result[at],ak=$('<li class="mss-item _j_listitem" data-type="route_promoted">').appendTo(ar),ap=$('<div class="mss-title">').appendTo(ak);ak.attr("data-url",ay.url);ap.append('<span class="mss-fr">'+ay.typename+"</span>");ap.append('<span class="mss-cn">'+ay.title+"</span>");ap.append('<span class="mss-gl"> '+ay.infoname+"</span>")}}var au=aC.qa_info;if(au&&au.result){for(var at=0;at<au.result.length;at++){var ai=au.result[at],ak=$('<li class="mss-item _j_listitem" data-type="wenda">').appendTo(ar),ap=$('<div class="mss-title">').appendTo(ak);ak.attr("data-url",ai.url);ap.append('<span class="mss-fr">'+ai.typename+"</span>");ap.append('<span class="mss-cn">'+ai.title+"</span>")}}var ad=aC.poi_info,aw=!K;if(M.isArray(az)&&M.indexOf(az,"poi")!==-1){aw=true}if(ad&&ad.result&&aw){for(var at=0;at<ad.result.length;at++){var am=ad.result[at],Y="hotel"===am.stype?"hotel":"poi",ak=$('<li class="mss-item _j_listitem" data-type="'+Y+'">').appendTo(ar),ap=$('<div class="mss-title">').appendTo(ak);ak.attr("data-url",am.url);ap.append('<span class="mss-fr">'+(!!am.mddname?am.mddname:"")+am.typename+"</span>");ap.append('<span class="mss-cn" style="color:#999;">'+am.dis_name+"</span>")}}var aj=aC.sekey_info,av=K;if(M.isArray(X)&&M.indexOf(X,"sekey")!==-1){av=false}if(aj&&aj.result&&av){for(var at=0;at<aj.result.length;at++){if(at>4){break}var aB=aj.result[at],ak=$('<li class="mss-item _j_listitem" data-type="sekey">').appendTo(ar);ak.attr("data-url",aB.url);ak.append('<div class="mss-title">'+aB.name+"</div>")}}var ac=aC.ginfo_num;if(!!ac){var ak=$('<li class="mss-item _j_listitem" data-type="info">').appendTo(ar);ak.append('<div class="mss-title">搜“<span class="mss-key">'+ax+'</span>”相关游记<span class="mss-num">'+ac+"篇</span></div>")}var an=aC.user_num;if(!!ac){var ak=$('<li class="mss-item _j_listitem" data-type="user">').appendTo(ar);ak.append('<div class="mss-title">搜“<span class="mss-key">'+ax+"</span>”相关用户</div>")}if(s>0){ar.find("._j_listitem").each(function(aD,aE){if(aD>s){$(aE).remove()}})}return ar.html()},updateList:function(W){this.listContainer.find(".mss-list").html(W);if(K){this.listContainer.find(".mss-list").addClass("shrink-list")}if(J){Q.input.data("droplist").moveFocus(1)}}});if(n){var A=e("InputListener"),w=e("SuggestionXHR"),D=new w({URL:(c.WWW_HOST?"http://"+c.WWW_HOST:"")+"/search/s.php",dataType:"json"}),v=$("#_j_mfw_search_main"),V=E.closest(".search-wrapper"),N=$('<div class="search-keyword-tip"></div>').appendTo(V),B=C.input==="_j_index_search_input_all",G=false,u,q,O,k,r;A.listen(E,function(X){var W=$(X.target),Y=$.trim(W.val());if(!G&&Y){G=true}N.hide()});M.Event(Q).on("before suggestion xhr",function(){var W=Q.suggestionParams[Q.keyParamName];if(W&&W!==y){D.getSuggestion({q:W,gall:1},$.proxy(function(Y){var ac=$.trim(E.val());if(!ac){return false}if(!Y||!Y.keyword||(!Y.result&&!Y.unmatch)){return false}if(Y.unmatch===1){N.hide()}else{y=W;if(V[0]){var Z=Y.keyword.length,X=Y.keyword.replace(/[A-Za-z0-9\s]/g,"").length,ab=Z-X;setTimeout(function(){N.html(Y.keyword).css("left",32+X*14+ab*7).show()},1)}v.html($(Y.result).css("minHeight",0).html());if(g&&b){v.find("> .wid").addClass("anim-climb");setTimeout(function(){v.find("> .wid").removeClass("anim-climb")},1)}var aa=c.search_type||"all";c.search_seid=R(W,aa);c.search_keyword=W;c.is_search_cache=true;c.is_search_updated=true}},Q))}})}M.Event(Q).on("before suggestion xhr",function(){S(E,Q.listContainer)});M.Event(Q).on("before show list",function(){Q.listContainer.find(".mss-list").show()});M.Event(Q).on("itemfocused",function(X){var W=X.prevItem,Y=X.focusItem,Z=Q.listContainer;if(1<Z.find(".mss-place").length){if(Y.hasClass("mss-place")){Z.find(".mss-place").removeClass("frozen")}if(!Y.hasClass("mss-place")&&!!W&&W.hasClass("mss-place")){Z.find(".mss-place").removeClass("frozen");W.addClass("frozen")}}if(Y.hasClass("mss-place")){Y.find(".mss-title").addClass("frozen")}});M.Event(Q).on("itemselected",function(Y){var aa=Y.item;if(aa.length){var Z=aa.data("type"),X=aa.data("url"),ac=E.attr("id")==="_j_head_search_input"?"header":"default";if(Z==="flight_hotel"||Z==="flight"||Z==="local"){Z="sales"}p=m(i,"all",ac,"suggest");if("info"===Z||"user"===Z){var ab=m(i,Z,ac,"suggest");location.href=l+"/search/s.php?q="+encodeURIComponent(i)+"&t="+Z+"&seid="+ab}else{var X=aa.data("url"),W=Q.listContainer.find(".mss-item").index(aa.closest(".mss-item"))+1;P(X,W,Z);location.href=aa.data("url")}}else{if(i!==""){location.href=l+"/search/s.php?q="+encodeURIComponent(i)}}});var x=E.closest(".head-search-wrapper");if(x[0]){E.on("focus",function(W){setTimeout(function(){x.addClass("head-search-focus")},1)}).on("blur",function(W){setTimeout(function(){if(M.windowFocused){x.removeClass("head-search-focus")}},1)})}if(U&&U[0]){U.on("click",function(Y){var X=$.trim(E.val());if(E.data("url")){if(E.data("url").indexOf("http")!==-1){location.href=E.data("url")}else{location.href=(c.WWW_HOST?"http://"+c.WWW_HOST:"")+E.data("url")}return true}if(X!==""){if(Q.listContainer){Q.listContainer.hide()}var aa=E.attr("id")==="_j_head_search_input"?"header":"default",ab=c.search_type||"all",Z=m(X,ab,aa,"form"),W=l+"/search/s.php?q="+encodeURIComponent(X);if(c.search_type&&location.pathname==="/search/s.php"){W+="&t="+c.search_type}W+="&seid="+Z;location.href=W}})}if(E&&E[0]){E.on("keydown",function(Y){if(Y.keyCode==13){var ab=Q.input.data("droplist");if(ab&&ab.getFocusItem().length){return true}var X=$.trim(E.val());if(X!==""){if(Q.listContainer){Q.listContainer.hide()}var aa=E.attr("id")==="_j_head_search_input"?"header":"default",ac=c.search_type||"all",Z=m(X,ac,aa,"form"),W=l+"/search/s.php?q="+encodeURIComponent(X);if(c.search_type&&location.pathname==="/search/s.php"){W+="&t="+c.search_type}W+="&seid="+Z;location.href=W}}})}$(window).resize(function(){if(Q.listContainer&&Q.listContainer.length&&Q.listContainer.is(":visible")){S(E,Q.listContainer)}});$(window).on("scroll",function(W){if(z){Q.hideDropList()}});function S(W,Y){var X=W.offset();Y.css({left:X.left+(C.input==="_j_index_search_input_all"?0:1),top:X.top+E.outerHeight()-2})}function m(W,aa,Z,Y){var X={keyword:W,content_category:aa,searchbox_category:"main_search",searchbox_position:Z,search_type:Y,version:d};return f.search(X)}function R(W,Y){var X={keyword:W,content_category:Y,version:d};return f.searchCache(X)}function P(Z,X,Y){var W={id:p,keyword:i,click_url:Z,index:X,content_category:Y,search_type:"suggest",version:d};return f.resultClick(W)}function F(X,ab){var Y=[],ad=X.split("|");ab=j(ab);for(var aa=0;aa<ad.length;aa++){var Z=$.trim(ad[aa]);if(Z=="search://"){var W=Y.length;Y[W]=ad[aa++];Y[W+1]=ad[aa++];Y[W+2]=ad[aa++];Y[W+3]=ad[aa++];Y[W+4]=ad[aa++];Y[W+5]=ad[aa];continue}if(Z){try{Z=Z.replace(new RegExp(ab,"ig"),function(ae){return'<span class="highlight">'+ae+"</span>"})}catch(ac){Z=Z.replace(ab,function(ae){return'<span class="highlight">'+ae+"</span>"})}Y[Y.length]=Z}}return Y}var o=$("<div/>");function j(W){return o.text(W).html()}};return a});M.closure(function(c){var r=$("#header");if(!r.length){return false}var o=c("/js/Dropdown");var n=c("/js/SiteSearch");new n({input:"_j_head_search_input",submit:"_j_head_search_link",isRelevant:true});$("#_j_nav_sales").find("[data-sales-nav]").on("click",function(){var t=$(this).data("salesNav");mfwPageEvent("sales","index_sales_nav",{name:t})});if(!window.showBarFlag){$("._j_sales_nav_show").off("hover")}else{var b=0,p=0;$("._j_sales_nav_show").hover(function(){clearTimeout(b);p=setTimeout(function(){$("._j_sales_nav_show").addClass("head-nav-hover");$("._j_sales_top").fadeIn(300)},200)},function(){clearTimeout(p);b=setTimeout(function(){$("._j_sales_nav_show").removeClass("head-nav-hover");$("._j_sales_top").fadeOut(300)},200)})}var m=0,f=0;$("._j_shequ_nav_show").hover(function(){clearTimeout(m);f=setTimeout(function(){$("._j_shequ_nav_show").addClass("head-nav-hover");$("._j_shequ_top").fadeIn(300)},200)},function(){clearTimeout(f);m=setTimeout(function(){$("._j_shequ_nav_show").removeClass("head-nav-hover");$("._j_shequ_top").fadeOut(300)},200)});var q=$("#_j_community_panel"),i=q.find(".panel-image").length,j=Math.floor(Math.random()*i);if(j===i){j--}q.find(".panel-image").eq(j).show();$("#_j_showlogin").click(function(t){if(window.location.host===Env.WWW_HOST){t.preventDefault()}M.Event.fire("login:required")});var g=window.location.hostname,k=window.location.pathname+window.location.search,a=$("#_j_head_nav");if(g.indexOf("www")===0){if(k===""||k==="/"){a.children("li:eq(0)").addClass("head-nav-active")}var h=new RegExp("^/(mdd|photo/mdd|poi|photo/poi|travel-scenic-spot|jd|cy|gw|yl|yj|xc|baike)/|sFrom=mdd.*|sFrom=smdd.*","i");if(h.test(k)){a.children("li:eq(1)").addClass("head-nav-active")}var e=new RegExp("^/gonglve/.*","i");if(e.test(k)){a.children("li:eq(2)").addClass("head-nav-active")}var d=window.Env&&window.Env.sales_title_tag;if(d){if(d==="flight_hotel"){a.children("li:eq(3)").find("ul>li:eq(0)>a").addClass("on")}else{if(d==="visa"){a.children("li:eq(3)").find("ul>li:eq(2)>a").addClass("on")}else{if(d==="localdeals"){a.children("li:eq(3)").find("ul>li:eq(1)>a").addClass("on")}else{if(d==="insurance"){a.children("li:eq(3)").find("ul>li:eq(4)>a").addClass("on")}}}}a.find("li:eq(3)").addClass("head-nav-active")}if(/^\/insurance\//i.test(k)){a.find("li:eq(3)").addClass("head-nav-active")}var s=new RegExp("^/hotel/(?!.*sFrom=mdd).*","ig");if(s.test(k)){a.children("li:eq(4)").addClass("head-nav-active");a.children("li:eq(4)").find(".head-act616").remove()}var l=new RegExp("^/(wenda|qa|mall|together|group|i|traveller|rudder|paimai|club|postal|school|photo_pk|focus)/(?!.*sFrom=mdd|s.php*).*","i");if(l.test(k)){a.children("li:eq(5)").addClass("head-nav-active")}}});(function(a){a.jGrowl=function(b,c){if(a("#jGrowl").size()==0){a('<div id="jGrowl"></div>').addClass((c&&c.position)?c.position:a.jGrowl.defaults.position).appendTo("body")}a("#jGrowl").jGrowl(b,c)};a.fn.jGrowl=function(b,d){if(a.isFunction(this.each)){var c=arguments;return this.each(function(){var e=this;if(a(this).data("jGrowl.instance")==undefined){a(this).data("jGrowl.instance",a.extend(new a.fn.jGrowl(),{notifications:[],element:null,interval:null}));a(this).data("jGrowl.instance").startup(this)}if(a.isFunction(a(this).data("jGrowl.instance")[b])){a(this).data("jGrowl.instance")[b].apply(a(this).data("jGrowl.instance"),a.makeArray(c).slice(1))}else{a(this).data("jGrowl.instance").create(b,d)}})}};a.extend(a.fn.jGrowl.prototype,{defaults:{pool:0,header:"",group:"",sticky:false,position:"top-right",glue:"after",theme:"default",themeState:"highlight",corners:"10px",check:250,life:3000,closeDuration:"normal",openDuration:"normal",easing:"swing",closer:true,closeTemplate:"&times;",closerTemplate:"<div>[ 关闭 ]</div>",log:function(c,b,d){},beforeOpen:function(c,b,d){},afterOpen:function(c,b,d){},open:function(c,b,d){},beforeClose:function(c,b,d){},close:function(c,b,d){},animateOpen:{opacity:"show"},animateClose:{opacity:"hide"}},notifications:[],element:null,interval:null,create:function(b,c){var c=a.extend({},this.defaults,c);if(typeof c.speed!=="undefined"){c.openDuration=c.speed;c.closeDuration=c.speed}this.notifications.push({message:b,options:c});c.log.apply(this.element,[this.element,b,c])},render:function(d){var b=this;var c=d.message;var e=d.options;var d=a('<div class="jGrowl-notification '+e.themeState+" ui-corner-all"+((e.group!=undefined&&e.group!="")?" "+e.group:"")+'"><div class="jGrowl-close">'+e.closeTemplate+'</div><div class="jGrowl-header">'+e.header+'</div><div class="jGrowl-message">'+c+"</div></div>").data("jGrowl",e).addClass(e.theme).children("div.jGrowl-close").bind("click.jGrowl",function(){a(this).parent().trigger("jGrowl.close")}).parent();a(d).bind("mouseover.jGrowl",function(){a("div.jGrowl-notification",b.element).data("jGrowl.pause",true)}).bind("mouseout.jGrowl",function(){a("div.jGrowl-notification",b.element).data("jGrowl.pause",false)}).bind("jGrowl.beforeOpen",function(){if(e.beforeOpen.apply(d,[d,c,e,b.element])!=false){a(this).trigger("jGrowl.open")}}).bind("jGrowl.open",function(){if(e.open.apply(d,[d,c,e,b.element])!=false){if(e.glue=="after"){a("div.jGrowl-notification:last",b.element).after(d)}else{a("div.jGrowl-notification:first",b.element).before(d)}a(this).animate(e.animateOpen,e.openDuration,e.easing,function(){if(a.browser.msie&&(parseInt(a(this).css("opacity"),10)===1||parseInt(a(this).css("opacity"),10)===0)){this.style.removeAttribute("filter")}a(this).data("jGrowl").created=new Date();a(this).trigger("jGrowl.afterOpen")})}}).bind("jGrowl.afterOpen",function(){e.afterOpen.apply(d,[d,c,e,b.element])}).bind("jGrowl.beforeClose",function(){if(e.beforeClose.apply(d,[d,c,e,b.element])!=false){a(this).trigger("jGrowl.close")}}).bind("jGrowl.close",function(){a(this).data("jGrowl.pause",true);a(this).animate(e.animateClose,e.closeDuration,e.easing,function(){a(this).remove();var f=e.close.apply(d,[d,c,e,b.element]);if(a.isFunction(f)){f.apply(d,[d,c,e,b.element])}})}).trigger("jGrowl.beforeOpen");if(e.corners!=""&&a.fn.corner!=undefined){a(d).corner(e.corners)}if(a("div.jGrowl-notification:parent",b.element).size()>1&&a("div.jGrowl-closer",b.element).size()==0&&this.defaults.closer!=false){a(this.defaults.closerTemplate).addClass("jGrowl-closer ui-state-highlight ui-corner-all").addClass(this.defaults.theme).appendTo(b.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){a(this).siblings().trigger("jGrowl.beforeClose");if(a.isFunction(b.defaults.closer)){b.defaults.closer.apply(a(this).parent()[0],[a(this).parent()[0]])}})}},update:function(){a(this.element).find("div.jGrowl-notification:parent").each(function(){if(a(this).data("jGrowl")!=undefined&&a(this).data("jGrowl").created!=undefined&&(a(this).data("jGrowl").created.getTime()+parseInt(a(this).data("jGrowl").life))<(new Date()).getTime()&&a(this).data("jGrowl").sticky!=true&&(a(this).data("jGrowl.pause")==undefined||a(this).data("jGrowl.pause")!=true)){a(this).trigger("jGrowl.beforeClose")}});if(this.notifications.length>0&&(this.defaults.pool==0||a(this.element).find("div.jGrowl-notification:parent").size()<this.defaults.pool)){this.render(this.notifications.shift())}if(a(this.element).find("div.jGrowl-notification:parent").size()<2){a(this.element).find("div.jGrowl-closer").animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){a(this).remove()})}},startup:function(b){this.element=a(b).addClass("jGrowl").append('<div class="jGrowl-notification"></div>');this.interval=setInterval(function(){a(b).data("jGrowl.instance").update()},parseInt(this.defaults.check));if(a.browser.msie&&parseInt(a.browser.version)<7&&!window.XMLHttpRequest){a(this.element).addClass("ie6")}},shutdown:function(){a(this.element).removeClass("jGrowl").find("div.jGrowl-notification").remove();clearInterval(this.interval)},close:function(){a(this.element).find("div.jGrowl-notification").each(function(){a(this).trigger("jGrowl.beforeClose")})}});a.jGrowl.defaults=a.fn.jGrowl.prototype.defaults})(jQuery);if(window.M&&typeof window.M.define=="function"){window.M.define("jq-jgrowl",function(){return jQuery})}(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-util",function(d,c,e){e.exports=a(b)})}else{b.mfwmap={};b.mfwmap.util=a(b)}}(window,function(b){function c(l,m){if(m<72.004||m>137.8347||l<0.8293||l>55.8271){return{lat:0,lng:0}}var j=6378245,d=0.006693421622965943,k=m-105,g=l-35;var f=-100+2*k+3*g+0.2*g*g+0.1*k*g+0.2*Math.sqrt(Math.abs(k));f+=(20*Math.sin(6*k*Math.PI)+20*Math.sin(2*k*Math.PI))*2/3;f+=(20*Math.sin(g*Math.PI)+40*Math.sin(g/3*Math.PI))*2/3;f+=(160*Math.sin(g/12*Math.PI)+320*Math.sin(g*Math.PI/30))*2/3;var h=300+k+2*g+0.1*k*k+0.1*k*g+0.1*Math.sqrt(Math.abs(k));h+=(20*Math.sin(6*k*Math.PI)+20*Math.sin(2*k*Math.PI))*2/3;h+=(20*Math.sin(k*Math.PI)+40*Math.sin(k/3*Math.PI))*2/3;h+=(150*Math.sin(k/12*Math.PI)+300*Math.sin(k/30*Math.PI))*2/3;var e=l/180*Math.PI,i=Math.sin(e);i=1-d*i*i;f=(f*180)/((j*(1-d))/(i*Math.sqrt(i))*Math.PI);h=(h*180)/(j/Math.sqrt(i)*Math.cos(e)*Math.PI);return{lat:f,lng:h}}var a={decodePath:function(f){var h=f?f.length:f,l=Array(Math.floor(f.length/2)),g=0,i=0,k=0;for(var j=0;g<h;++j){var m=1,d=0,e;do{e=f.charCodeAt(g++)-63-1;m+=e<<d;d+=5}while(31<=e);i+=m&1?~(m>>1):m>>1;m=1;d=0;do{e=f.charCodeAt(g++)-63-1;m+=e<<d;d+=5}while(31<=e);k+=m&1?~(m>>1):m>>1;l[j]={lat:0.00001*i,lng:0.00001*k}}l.length=j;return l},extend:function(f,d){var e=function(){};e.prototype=d.prototype;f.prototype=new e();f.prototype.constructor=f;f.__super__=d.prototype},clone:function(g){if(null==g||"object"!=typeof g){return g}if(g instanceof Date){var h=new Date();h.setTime(g.getTime());return h}if(g instanceof Array){var h=[];for(var f=0,e=g.length;f<e;f++){h[f]=a.clone(g[f])}return h}if(g instanceof Object){var h={};for(var d in g){h[d]=a.clone(g[d])}return h}throw new Error("Unable to copy obj! Its type isn't supported.")},bind:function(e,d){if(!!Function.prototype.bind){return Function.prototype.bind.apply(e,[d].concat(Array.prototype.slice.call(arguments,2)))}else{if(typeof e!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var i=Array.prototype.slice.call(arguments,2),h=e,f=function(){},g=function(){return h.apply(e instanceof f&&d?e:d||b,i.concat(Array.prototype.slice.call(arguments)))};f.prototype=e.prototype;g.prototype=new f();return g}},includes:function(j,g){if(!!Array.prototype.includes){return Array.prototype.includes.call(j,g)}else{var h=Object(j);var d=parseInt(h.length)||0;if(d===0){return false}var i=parseInt(arguments[2])||0;var e;if(i>=0){e=i}else{e=d+i;if(e<0){e=0}}var f;while(e<d){f=h[e];if(g===f||(g!==g&&f!==f)){return true}e++}return false}},pick:function(g,f){var h={};for(var e=0;e<f.length;e++){var d=f[e];if(d in g){h[d]=g[d]}}return h},mapping:function(f,e){if(typeof f==="string"){if(!!e[f]){return e[f]}else{return f}}if(typeof f==="object"&&f!==null){var g={};for(var d in f){if(!!e[d]){g[e[d]]=f[d]}else{g[d]=f[d]}}return g}},uuid:function(d,g){var j="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");var f=[],e;g=g||j.length;if(d){for(e=0;e<d;e++){f[e]=j[0|Math.random()*g]}}else{var h;f[8]=f[13]=f[18]=f[23]="-";f[14]="4";for(e=0;e<36;e++){if(!f[e]){h=0|Math.random()*16;f[e]=j[(e==19)?(h&3)|8:h]}}}return f.join("")},debounce:function(f,h,e){var k,j,d,i,l;var g=function(){var m=(new Date().getTime())-i;if(m<h){k=setTimeout(g,h-m)}else{k=null;if(!e){l=f.apply(d,j);d=j=null}}};return function(){d=this;j=arguments;i=(new Date().getTime());var m=e&&!k;if(!k){k=setTimeout(g,h)}if(m){l=f.apply(d,j);d=j=null}return l}},wgs2gcj:function(f,d){var e=c(f,d);return{lat:f+e.lat,lng:d+e.lng}},gcj2wgs:function(f,d){var e=c(f,d);return{lat:f-e.lat,lng:d-e.lng}}};return a}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-event",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util");f.exports=a(b,c)})}else{b.mfwmap.event=a(b,b.mfwmap.util)}}(window,function(d,a){var c={};var e=c.EventListener=function(g,f){this.event=g;this._eventListener=f};var b=["click","dblclick","mouseover","mouseout"];c.eventFunc={addListener:function(h,g,f){if(!a.includes(h,g)){throw new ReferenceError("unsupport event: "+g)}if(a.includes(b,g)){return this._addMouseListener(g,f)}return this._addListener(g,f)},addListenerOnce:function(h,g,f){if(!a.includes(h,g)){throw new ReferenceError("unsupport event: "+g)}if(a.includes(b,g)){return this._addMouseListenerOnce(g,f)}return this._addListenerOnce(g,f)},removeListener:function(f){if(!f instanceof e){throw new TypeError(f+" is not an instance of mfwmap.EventListener")}this._removeListener(f)},trigger:function(g,f,h){if(!a.includes(g,f)){throw new ReferenceError("unsupport event: "+f)}return this._trigger(f,h)}};return c}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-runtime-google",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util"),g=e("/js/hotel/mfwmap/mfwmap-event");f.exports=a(b,c,g)})}else{b.mfwmap.googleRuntime=a(b,b.mfwmap.util,b.mfwmap.event)}}(window,function(p,a,s){var w={util:a,event:s};var e=false,u=$.Deferred(),c=10000;p.initGoogleMap=function(){u.resolve()};function t(C){var B=document.getElementsByTagName("head")[0],A=B.insertBefore,y=B.appendChild;B.insertBefore=function(E,D){if(E.href&&E.href.indexOf(location.protocol+"//fonts.googleapis.com/css?family=Roboto")===0){return}A.call(B,E,D)};B.appendChild=function(D){if(D.href&&D.href.indexOf(location.protocol+"//fonts.googleapis.com/css?family=Roboto")===0){return}y.call(B,D)};var z=document.createElement("script");z.type="text/javascript";z.src=location.protocol+"//maps.google.cn/maps/api/js?language=zh-CN&libraries=geometry&callback=initGoogleMap&key="+((window.Env&&window.Env.GOOGLE_MAP_KEY)||"AIzaSyD-Su0x_rPy1xehlMBcMyTqWkU49Bk53nQ");if("onerror" in z){z.onerror=function(D){u.reject()}}document.body.appendChild(z);setTimeout(function(){try{if(u.state()==="pending"){u.reject()}}catch(D){u.reject()}},C)}var h={hasInited:e,init:function(z){if(!e){e=true;var y=Number(z)>0?Number(z):c;t(y)}},getInitPromise:function(){return u.promise()}};var g=h.implement={};var i={_addListener:function(A,z){var y=google.maps.event.addListener(this._inst,A,z);return new w.event.EventListener(A,y)},_addListenerOnce:function(A,z){var y=google.maps.event.addListenerOnce(this._inst,A,z);return new w.event.EventListener(A,y)},_addMouseListener:function(B,A){var z=this._inst;var y=google.maps.event.addListener(this._inst,B,function(C){A.call(z,C,{lat:C.latLng.lat(),lng:C.latLng.lng()})});return new w.event.EventListener(B,y)},_addMouseListenerOnce:function(B,A){var z=this._inst;var y=google.maps.event.addListenerOnce(this._inst,B,function(C){A.call(z,C,{lat:C.latLng.lat(),lng:C.latLng.lng()})});return new w.event.EventListener(B,y)},_removeListener:function(y){google.maps.event.removeListener(y._eventListener);return this},_trigger:function(y,z){google.maps.event.trigger(this._inst,y,z);return this}};function o(){var y=[{featureType:"water",stylers:[{saturation:44},{lightness:10},{hue:"#0099ff"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",stylers:[{weight:0.4}]},{featureType:"transit.line",stylers:[{weight:0.3}]},{featureType:"landscape",stylers:[{saturation:-80},{lightness:40}]},{featureType:"poi.park",elementType:"geometry",stylers:[{saturation:-26},{lightness:20}]}];return y}var l=navigator.userAgent.toLowerCase().match(/msie [\d.]+/),d=l?parseFloat(l[0].substr(5)):false,j=d&&d<=9;function r(y){if(j){google.maps.event.addListenerOnce(y,"idle",function(){setTimeout(function(){var z=$(".gm-style > .gmnoprint:first",$(y.getDiv()));if(z[0]){z[0].style.width=null}},200)})}}function m(y){google.maps.event.addListenerOnce(y,"idle",function(){$("body").children().each(function(A,C){var D=$(C),B=parseFloat(D.css("fontSize")),z=D.css("fontFamily");if(B>64&&z&&z.toLowerCase().indexOf("roboto")!==-1){D.hide()}})})}g.map={initialize:function(z){z=$.extend(true,{},{control:{mapType:{visible:true,position:google.maps.ControlPosition.RIGHT_BOTTOM},zoom:{visible:true,position:google.maps.ControlPosition.LEFT_TOP}}},z);var y={mapTypeId:google.maps.MapTypeId.ROADMAP,center:new google.maps.LatLng(z.lat,z.lng),zoom:z.zoom,styles:o(),panControl:false,streetViewControl:false,scaleControl:true,mapTypeControl:z.control.mapType.visible,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE],position:z.control.mapType.position},zoomControl:z.control.zoom.visible,zoomControlOptions:{position:z.control.zoom.position},draggable:z.draggable,scrollwheel:z.scrollwheel,disableDoubleClickZoom:z.disableDoubleClickZoom};this._inst=new google.maps.Map(z.element,y);r(this._inst);m(this._inst)},setCenter:function(z,y){this._inst.setCenter(new google.maps.LatLng(z,y));return this},getCenter:function(){var y=this._inst.getCenter();return{lat:y.lat(),lng:y.lng()}},setZoom:function(y){this._inst.setZoom(y);return this},getZoom:function(){return this._inst.getZoom()},panTo:function(z,y){this._inst.panTo(new google.maps.LatLng(z,y));return this},panBy:function(z,A){this._inst.panBy(z,A);return this},fitBounds:function(y){this._inst.fitBounds(y._inst);return this},computeDistanceBetween:function(B,A){var z=new google.maps.LatLng(B.lat,B.lng),y=new google.maps.LatLng(A.lat,A.lng);return google.maps.geometry.spherical.computeDistanceBetween(z,y)}};g.map=$.extend({},i,g.map);g.latLngBounds={initialize:function(z){if(!!z.latLngBounds){this._inst=z.latLngBounds}else{var y,A;if(!!z.northEast){y=new google.maps.LatLng(z.northEast.lat,z.northEast.lng)}if(!!z.southWest){A=new google.maps.LatLng(z.southWest.lat,z.southWest.lng)}this._inst=new google.maps.LatLngBounds(y,A)}},getCenter:function(){var y=this._inst.getCenter();return{lat:y.lat(),lng:y.lng()}},getNorthEast:function(){var y=this._inst.getNorthEast();return{lat:y.lat(),lng:y.lng()}},getSouthWest:function(){var y=this._inst.getSouthWest();return{lat:y.lat(),lng:y.lng()}},extend:function(z,y){this._inst.extend(new google.maps.LatLng(z,y));return this},contains:function(z,y){return this._inst.contains(new google.maps.LatLng(z,y))}};var q=["title","zIndex","opacity","clickable","draggable","icon"];g.marker={initialize:function(z){var y=$.extend({},a.pick(z,q),{map:this.map._inst,position:new google.maps.LatLng(z.lat,z.lng)});var A=y.icon;if(!!A){this.icon=A;if(typeof A==="object"){y.icon={url:A.url,size:new google.maps.Size(A.size[0],A.size[1]),origin:!!A.origin?new google.maps.Point(A.origin[0],A.origin[1]):undefined,anchor:!!A.anchor?new google.maps.Point(A.anchor[0],A.anchor[1]):undefined}}}this._inst=new google.maps.Marker(y)},getMap:function(){return this.map},setPosition:function(z,y){this._inst.setPosition(new google.maps.LatLng({lat:z,lng:y}));return this},getPosition:function(){var y=this._inst.getPosition();return{lat:y.lat(),lng:y.lng()}},setIcon:function(z){if(typeof z==="string"){this.icon=z;this._inst.setIcon(z)}if(typeof z==="object"){if(typeof this.icon!=="object"){this.icon=z}else{$.extend(this.icon,z)}var y={};y.url=this.icon.url;if(!!this.icon.size){y.size=new google.maps.Size(this.icon.size[0],this.icon.size[1])}if(!!this.icon.origin){y.origin=new google.maps.Point(this.icon.origin[0],this.icon.origin[1])}if(!!this.icon.anchor){y.anchor=new google.maps.Point(this.icon.anchor[0],this.icon.anchor[1])}this._inst.setIcon(y)}return this},getIcon:function(){return this.icon},setZIndex:function(y){this._inst.setZIndex(y);return this},getZIndex:function(){return this._inst.getZIndex()},show:function(){this._inst.setVisible(true);return this},hide:function(){this._inst.setVisible(false);return this},remove:function(){this._inst.setMap(null)}};g.marker=$.extend({},i,g.marker);var n=["content","maxWidth","pixelOffset","disableAutoPan","zIndex"];g.infoWindow={initialize:function(z){var y=z.pixelOffset;if(!!y){z.pixelOffset=new google.maps.Size(y[0],y[1])}var A=$.extend({},a.pick(z,n),{map:this.map._inst,position:new google.maps.LatLng(z.lat,z.lng)})},remove:function(){this._inst.setMap(null)}};g.infoWindow=$.extend({},i,g.infoWindow);var f=["strokeColor","strokeOpacity","strokeWeight","clickable"];g.polyline={initialize:function(A){var D=A.paths,C=[];for(var B=0;B<D.length;B++){var y=D[B];C.push(new google.maps.LatLng(y.lat,y.lng))}var z=$.extend({},a.pick(A,f),{map:this.map._inst,path:C});this._inst=new google.maps.Polyline(z)},getMap:function(){return this.map},getPath:function(){var z=this._inst.getPath().getArray(),A=[];for(var y=0;y<z.length;y++){A.push({lat:z[y].lat(),lng:z[y].lng()})}return A},setOptions:function(z){var y=a.pick(z,f);this._inst.setOptions(y);return this},show:function(){this._inst.setVisible(true);return this},hide:function(){this._inst.setVisible(false);return this},remove:function(){this._inst.setMap(null)}};g.polyline=$.extend({},i,g.polyline);var x=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","clickable"];g.circle={initialize:function(y){var z=$.extend({},a.pick(y,x),{map:this.map._inst,center:new google.maps.LatLng(y.lat,y.lng),radius:y.radius});this._inst=new google.maps.Circle(z)},getMap:function(){return this.map},getCenter:function(){var y=this._inst.getCenter();return{lat:y.lat(),lng:y.lng()}},setRadius:function(y){this._inst.setRadius(y);return this},getRadius:function(){return this._inst.getRadius()},setOptions:function(y){var z=a.pick(y,x);this._inst.setOptions(z);return this},show:function(){this._inst.setVisible(true);return this},hide:function(){this._inst.setVisible(false);return this},remove:function(){this._inst.setMap(null)}};g.circle=$.extend({},i,g.circle);var k=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","clickable","zIndex"];g.polygon={initialize:function(A){var D=A.paths,C=[];for(var B=0;B<D.length;B++){var y=D[B];C.push(new google.maps.LatLng(y.lat,y.lng))}var z=$.extend({},a.pick(A,k),{map:this.map._inst,paths:C});this._inst=new google.maps.Polygon(z)},getMap:function(){return this.map},getPath:function(){var z=this._inst.getPath().getArray(),A=[];for(var y=0;y<z.length;y++){A.push({lat:z[y].lat(),lng:z[y].lng()})}return A},setOptions:function(z){var y=a.pick(z,k);this._inst.setOptions(y);return this},show:function(){this._inst.setVisible(true);return this},hide:function(){this._inst.setVisible(false);return this},remove:function(){this._inst.setMap(null)}};g.polygon=$.extend({},i,g.polygon);var v={};u.then(function(){var y=function(z){this.map=z.map._inst;this.lat=z.lat;this.lng=z.lng;this.type="marker";this.$node=null;this.position=null;this.initialize(z);this.createNode();this.setMap(this.map)};a.extend(y,google.maps.OverlayView);y.prototype.onAdd=function(){this.$node.css("position","absolute");var z;switch(this.type){case"marker":z=this.getPanes().overlayMouseTarget;break;case"infoWindow":z=this.getPanes().floatPane;break;default:}z.appendChild(this.$node[0])};y.prototype.draw=function(){var z=new google.maps.LatLng(this.lat,this.lng),A=this.getProjection().fromLatLngToDivPixel(z);this.renderNode(A);this.$node.css({left:this.position.x,top:this.position.y})};y.prototype.onRemove=function(){this.destoryNode()};y.prototype.getPosition=function(){return{lat:this.lat,lng:this.lng}};v._base=y});var b=h.addOverlayView=function(A,z){var y=function(B){y.__super__.constructor.call(this,B)};a.extend(y,v._base);$.extend(y.prototype,z);v[A]=y};g.overlayView={initialize:function(y){this._inst=new v[this._cid](y)},getMap:function(){return this.map},getPosition:function(){return this._inst.getPosition()},reset:function(){if(this._inst.$node.is(":visible")){this._inst.draw()}return this},remove:function(){this._inst.setMap(null)}};g.overlayView=$.extend({},i,g.overlayView);g.geocoder={initialize:function(y){this._inst=new google.maps.Geocoder()},geocode:function(y,z){this._inst.geocode({address:y.address},function(F,B){var A=[],C={results:F,status:B};if(B==google.maps.GeocoderStatus.OK){if(M.isArray(F)){for(var E=0;E<F.length;E++){var G=F[E],D={formattedAddress:G.formatted_address};if(G.geometry&&G.geometry.location&&M.isFunction(G.geometry.location.lat)&&M.isFunction(G.geometry.location.lng)){D.location={lat:G.geometry.location.lat(),lng:G.geometry.location.lng()}}A.push(D)}}}else{}z.call(null,A,C)})}};return h}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-runtime-amap",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util"),g=e("/js/hotel/mfwmap/mfwmap-event");f.exports=a(b,c,g)})}else{b.mfwmap.amapRuntime=a(b,b.mfwmap.util,b.mfwmap.event)}}(window,function(o,a,r){var u={util:a,event:r};var d=false,t=$.Deferred(),b=4000;o.initAMap=function(){t.resolve()};function s(x){var w=document.createElement("script");w.type="text/javascript";w.src=location.protocol+"//webapi.amap.com/maps?v=1.3&key=b2cf7b957c24323add8c497ed3512e15&callback=initAMap";if("onerror" in w){w.onerror=function(y){t.reject()}}document.body.appendChild(w);setTimeout(function(){try{if(t.state()==="pending"){t.reject()}}catch(y){t.reject()}},x)}var c={hasInited:d,init:function(x){if(!d){d=true;var w=Number(x)>0?Number(x):b;s(w)}},getInitPromise:function(){return t.promise()},controlPosition:{TOP_LEFT:1,TOP_RIGHT:3,BOTTOM_LEFT:10,BOTTOM_RIGHT:12}};var h=c.implement={};var j={zoom_changed:"zoomchange"};var i={_addListener:function(z,y){var x=a.mapping(z,j);var w=AMap.event.addListener(this._inst,x,y);return new u.event.EventListener(z,w)},_addListenerOnce:function(z,y){var x=a.mapping(z,j);var w=AMap.event.addListenerOnce(this._inst,x,y);return new u.event.EventListener(z,w)},_addMouseListener:function(A,z){var x=a.mapping(A,j);var y=this._inst;var w=AMap.event.addListener(y,x,function(B){z.call(y,B)});return new u.event.EventListener(A,w)},_addMouseListenerOnce:function(A,z){var x=a.mapping(A,j);var y=this._inst;var w=AMap.event.addListenerOnce(y,x,function(B){z.call(y,B)});return new u.event.EventListener(A,w)},_removeListener:function(w){AMap.event.removeListener(w._eventListener);return this},_trigger:function(x,y){var w=a.mapping(x,j);AMap.event.trigger(this._inst,w,y);return this}};h.map={initialize:function(x){x=$.extend(true,{},{control:{mapType:{visible:true},zoom:{visible:true,amapRuler:true,amapOffset:[10,10],amapLiteStyle:false}}},x);var w={view:new AMap.View2D({center:new AMap.LngLat(x.lng,x.lat),zoom:x.zoom}),mapStyle:"normal",dragEnable:x.draggable,scrollWheel:x.scrollwheel,doubleClickZoom:!x.disableDoubleClickZoom};x.element.id=x.element.id||"_j_map_container_"+a.uuid(8,16);this._inst=new AMap.Map(x.element.id,w);var y=this._inst;y.plugin(["AMap.Scale","AMap.ToolBar"],function(){var C=new AMap.Scale();y.addControl(C);var B=x.control.zoom,z;switch(B.position){case c.controlPosition.TOP_LEFT:z="LT";break;case c.controlPosition.TOP_RIGHT:z="RT";break;case c.controlPosition.BOTTOM_LEFT:z="BL";break;case c.controlPosition.BOTTOM_RIGHT:z="BR";break;default:z="LT"}var A=new AMap.ToolBar({position:z,offset:new AMap.Pixel(B.amapOffset[0],B.amapOffset[1]),ruler:B.amapRuler,direction:false,autoPosition:false,liteStyle:B.amapLiteStyle});if(B.visible){y.addControl(A)}})},setCenter:function(x,w){this._inst.setCenter(new AMap.LngLat(w,x));return this},getCenter:function(){var w=this._inst.getCenter();return{lat:w.getLat(),lng:w.getLng()}},setZoom:function(w){this._inst.setZoom(w);return this},getZoom:function(){return this._inst.getZoom()},panTo:function(x,w){this._inst.panTo(new AMap.LngLat(w,x));return this},panBy:function(w,z){this._inst.panBy(-w,-z);return this},fitBounds:function(w){this._inst.setBounds(w._inst);return this}};h.map=$.extend({},i,h.map);h.latLngBounds={initialize:function(x){if(!!x.northEast&&!!x.southWest){var y=new AMap.LngLat(x.southWest.lng,x.southWest.lat),w=new AMap.LngLat(x.northEast.lng,x.northEast.lat);this._inst=new AMap.Bounds(y,w)}},getCenter:function(){if(!!this._inst){var w=this._inst.getCenter();return{lat:w.getLat(),lng:w.getLng()}}return false},getNorthEast:function(){if(!!this._inst){var w=this._inst.getNorthEast();return{lat:w.getLat(),lng:w.getLng()}}return null},getSouthWest:function(){if(!!this._inst){var w=this._inst.getSouthWest();return{lat:w.getLat(),lng:w.getLng()}}return null},extend:function(B,E){var A,z,C,F;if(!!this._inst){var x=this._inst.getSouthWest().getLng(),H=this._inst.getNorthEast().getLng(),D=this._inst.getNorthEast().getLat(),G=this._inst.getSouthWest().getLat();A=x<=E?x:E;z=H>=E?H:E;C=D>=B?D:B;F=G<=B?G:B}else{A=z=E;C=F=B}var w=new AMap.LngLat(A,F),y=new AMap.LngLat(z,C);this._inst=new AMap.Bounds(w,y);return this},contains:function(x,w){if(!!this._inst){return this._inst.contains(new AMap.LngLat(w,x))}return false}};var p=["title","zIndex","clickable","draggable","icon","offset","content"],m={};h.marker={initialize:function(x){var y=x.icon,z=x.content,A;if(!!y){this.icon=y;if(typeof y==="object"){x.icon=new AMap.Icon({image:y.url,size:new AMap.Size(y.size[0],y.size[1]),imageOffset:!!y.origin?new AMap.Pixel(-y.origin[0],-y.origin[1]):undefined})}}if(!!z){this.content=z}if(!!x.offset){A=new AMap.Pixel(-x.offset[0],-x.offset[1])}var w=$.extend({},a.mapping(a.pick(x,p),m),{map:this.map._inst,position:new AMap.LngLat(x.lng,x.lat),offset:A});this._inst=new AMap.Marker(w)},getMap:function(){return this.map},setPosition:function(x,w){this._inst.setPosition(new AMap.LngLat(w,x));return this},getPosition:function(){var w=this._inst.getPosition();return{lat:w.getLat(),lng:w.getLng()}},setIcon:function(x){if(typeof x==="string"){this.icon=x;this._inst.setIcon(x)}if(typeof x==="object"){if(typeof this.icon!=="object"){this.icon=x}else{$.extend(this.icon,x)}var w={};w.image=this.icon.url;if(!!this.icon.size){w.size=new AMap.Size(this.icon.size[0],this.icon.size[1])}if(!!this.icon.origin){w.imageOffset=new AMap.Pixel(-this.icon.origin[0],-this.icon.origin[1])}this._inst.setIcon(new AMap.Icon(w))}return this},getIcon:function(){return this.icon},setOffset:function(w,z){this._inst.setOffset(new AMap.Pixel(-w,-z));return this},getOffset:function(){var w=this._inst.getOffset();return{x:-w.getX(),y:-w.getY()}},setZIndex:function(w){this._inst.setzIndex(w+100);return this},getZIndex:function(){return this._inst.getzIndex()-100},setContent:function(w){this.content=w;this._inst.setContent(w);return this},getContent:function(){return this.content},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.marker=$.extend({},i,h.marker);var n=["content","pixelOffset","disableAutoPan"],e={pixelOffset:"offset",disableAutoPan:"autoMove"};h.infoWindow={initialize:function(x){if("disableAutoPan" in x){x.disableAutoPan=!x.disableAutoPan}var w=x.pixelOffset;if(!!w){x.pixelOffset=new AMap.Pixel(w[0],w[1])}var y=$.extend({},a.mapping(a.pick(x,n),e),{map:this.map._inst,position:new AMap.LngLat(x.lng,x.lat),isCustom:true});this._inst=new AMap.InfoWindow(y);this._inst.open()},getMap:function(){return this.map},getPosition:function(){var w=this._inst.getPosition();return{lat:w.getLat(),lng:w.getLng()}},setContent:function(w){this._inst.setContent(w);return this},getContent:function(){return this._inst.getContent()},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.infoWindow=$.extend({},i,h.infoWindow);var g=["strokeColor","strokeOpacity","strokeWeight"],l={};h.polyline={initialize:function(y){var B=y.paths,A=[];for(var z=0;z<B.length;z++){var w=B[z];A.push(new AMap.LngLat(w.lng,w.lat))}var x=$.extend({},a.mapping(a.pick(y,g),l),{map:this.map._inst,path:A});this._inst=new AMap.Polyline(x)},getMap:function(){return this.map},getPath:function(){var x=this._inst.getPath(),y=[];for(var w=0;w<x.length;w++){y.push({lat:x[w].getLat(),lng:x[w].getLng()})}return y},setOptions:function(x){var w=a.mapping(a.pick(x,g),l);this._inst.setOptions(w);return this},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.polyline=$.extend({},i,h.polyline);var v=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity"],f={};h.circle={initialize:function(w){var x=$.extend({},a.mapping(a.pick(w,v),f),{map:this.map._inst,center:new AMap.LngLat(w.lng,w.lat),radius:w.radius});this._inst=new AMap.Circle(x)},getMap:function(){return this.map},getCenter:function(){var w=this._inst.getCenter();return{lat:w.getLat(),lng:w.getLng()}},setRadius:function(w){this._inst.setRadius(w);return this},getRadius:function(){return this._inst.getRadius()},setOptions:function(w){var x=a.mapping(a.pick(w,v),f);this._inst.setOptions(x);return this},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.circle=$.extend({},i,h.circle);var k=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","zIndex"],q={};h.polygon={initialize:function(y){var B=y.paths,A=[];for(var z=0;z<B.length;z++){var w=B[z];A.push(new AMap.LngLat(w.lng,w.lat))}var x=$.extend({},a.mapping(a.pick(y,k),q),{map:this.map._inst,path:A});this._inst=new AMap.Polygon(x)},getMap:function(){return this.map},getPath:function(){var x=this._inst.getPath(),y=[];for(var w=0;w<x.length;w++){y.push({lat:x[w].getLat(),lng:x[w].getLng()})}return y},setOptions:function(x){var w=a.mapping(a.pick(x,k),q);this._inst.setOptions(w);return this},show:function(){this._inst.show();return this},hide:function(){this._inst.hide();return this},remove:function(){this._inst.setMap(null)}};h.polygon=$.extend({},i,h.polygon);h.overlayView={};h.geocoder={initialize:function(w){},geocode:function(w,x){AMap.service("AMap.Geocoder",function(){var y=new AMap.Geocoder();y.getLocation(w.address,function(B,z){var A=[],C={result:z,status:B};if(B==="complete"&&z.info==="OK"){if(M.isArray(z.geocodes)){for(var E=0;E<z.geocodes.length;E++){var F=z.geocodes[E],D={formattedAddress:F.formattedAddress};if(F.location){D.location={lat:F.location.lat,lng:F.location.lng}}A.push(D)}}}else{}x.call(null,A,C)})})}};return c}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap-runtime-leaflet",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util"),g=e("/js/hotel/mfwmap/mfwmap-event");f.exports=a(b,c,g)})}else{b.mfwmap.leafletRuntime=a(b,b.mfwmap.util,b.mfwmap.event)}}(window,function(m,a,p){var u={util:a,event:p};var d=false,s=$.Deferred(),c=4000;function q(w){if(!!m.M){m.M.fetchCSSJS(["/css/plugins/leaflet/leaflet.css","/js/plugins/leaflet.js"],function(){L.Icon.Default.imagePath="http://images.mafengwo.net/images/plugins/leaflet/";s.resolve()})}else{if(!!window.L){s.resolve()}}setTimeout(function(){try{if(s.state()==="pending"){s.reject()}}catch(x){s.reject()}},w)}var r={hasInited:d,init:function(x){if(!d){d=true;var w=Number(x)>0?Number(x):c;q(w)}},getInitPromise:function(){return s.promise()},controlPosition:{TOP_LEFT:1,TOP_RIGHT:3,BOTTOM_LEFT:10,BOTTOM_RIGHT:12}};var g=r.implement={};var i={zoom_changed:"zoomend"};var h={_addListener:function(y,x){var w=a.mapping(y,i);this._inst.addEventListener(w,x);return new u.event.EventListener(y,{event:y,handler:x})},_addListenerOnce:function(y,x){var w=a.mapping(y,i);this._inst.addOneTimeEventListener(w,x);return new u.event.EventListener(y,{event:y,handler:x})},_addMouseListener:function(A,z){var x=a.mapping(A,i);var y=this._inst,w=function(B){z.call(y,B,{lat:B.latlng.lat,lng:B.latlng.lng})};this._inst.addEventListener(x,w);return new u.event.EventListener(A,{event:A,handler:w})},_addMouseListenerOnce:function(A,z){var x=a.mapping(A,i);var y=this._inst,w=function(B){z.call(y,B,{lat:B.latlng.lat,lng:B.latlng.lng})};this._inst.addOneTimeEventListener(x,w);return new u.event.EventListener(A,{event:A,handler:w})},_removeListener:function(w){this._inst.removeEventListener(w.event,w.handler);return this},_trigger:function(w,x){this._inst.fireEvent(w,x);return this}};var l=["draggable","scrollwheel","disableDoubleClickZoom"],n={draggable:"dragging",scrollwheel:"scrollWheelZoom",disableDoubleClickZoom:"doubleClickZoom"};g.map={initialize:function(z){this._view={center:null,zoom:null};this._setView=a.debounce(a.bind(function(){var C=this._view.center,D=this._view.zoom;if(!!C&&!!D){this._inst.setView(L.latLng(C.lat,C.lng),D)}else{if(!!C){this._inst.panTo(L.latLng(C.lat,C.lng))}if(!!D){this._inst.setZoom(D)}}C=null;D=null},this),1);z=$.extend(true,{},{control:{mapType:{visible:true},zoom:{visible:true,position:r.controlPosition.TOP_LEFT}}},z);var y=a.mapping(a.pick(z,l),n);y.doubleClickZoom=!y.doubleClickZoom;y.zoomControl=false;this._inst=L.map(z.element,y).setView([z.lat,z.lng],z.zoom);var B="https://maps.google.cn/maps/vt/pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m3!1e0!2sm!3i258145710!5m1!5f2!3m2!2szh-CN!3sCN",x="Map data &copy;Google";L.tileLayer(B,{maxZoom:18,attribution:x}).addTo(this._inst);var A=z.control.zoom,w;switch(A.position){case r.controlPosition.TOP_LEFT:w="topleft";break;case r.controlPosition.TOP_RIGHT:w="topright";break;case r.controlPosition.BOTTOM_LEFT:w="bottomleft";break;case r.controlPosition.BOTTOM_RIGHT:w="bottomright";break;default:w="topleft"}if(A.visible){L.control.zoom({position:w}).addTo(this._inst)}L.control.scale({imperial:false}).addTo(this._inst);this._inst.attributionControl.setPrefix(false)},setCenter:function(x,w){this._view.center={lat:x,lng:w};this._setView.call(this);return this},getCenter:function(){var w=this._inst.getCenter();return{lat:w.lat,lng:w.lng}},setZoom:function(w){this._inst.setZoom(w);return this},getZoom:function(){return this._inst.getZoom()},panTo:function(x,w){this._inst.panTo(L.latLng(x,w));return this},panBy:function(w,z){this._inst.panBy(L.point(w,z));return this},fitBounds:function(w){this._inst.fitBounds(w._inst);return this},computeDistanceBetween:function(z,y){var x=L.latLng(z.lat,z.lng),w=L.latLng(y.lat,y.lng);return x.distanceTo(w)}};g.map=$.extend({},h,g.map);g.latLngBounds={initialize:function(x){if(!!x.latLngBounds){this._inst=x.latLngBounds}else{if(!!x.northEast&&!!x.southWest){var y=L.latLng(x.southWest.lat,x.southWest.lng),w=L.latLng(x.northEast.lat,x.northEast.lng);this._inst=L.latLngBounds(y,w)}else{this._inst=L.latLngBounds([])}}},getCenter:function(){if(!!this._inst){var w=this._inst.getCenter();return{lat:w.lat,lng:w.lng}}return false},getNorthEast:function(){if(!!this._inst){var w=this._inst.getNorthEast();return{lat:w.lat,lng:w.lng}}return null},getSouthWest:function(){if(!!this._inst){var w=this._inst.getSouthWest();return{lat:w.lat,lng:w.lng}}return null},extend:function(x,w){this._inst.extend(L.latLng(x,w));return this},contains:function(x,w){return this._inst.contains(L.latLng(x,w))}};var f=["strokeColor","strokeOpacity","strokeWeight","clickable"],k={strokeColor:"color",strokeOpacity:"opacity",strokeWeight:"weight"};g.polyline={initialize:function(y){var B=y.paths,A=[];for(var z=0;z<B.length;z++){var w=B[z];A.push(L.latLng(w.lat,w.lng))}var x=a.mapping(a.pick(y,f),k);this._inst=L.polyline(A,x).addTo(this.map._inst)},getMap:function(){return this.map},getPath:function(){var x=this._inst.getLatLngs(),y=[];for(var w=0;w<x.length;w++){y.push({lat:x[w].lat,lng:x[w].lng})}return y},setOptions:function(x){var w=a.mapping(a.pick(x,f),k);this._inst.setStyle(w);return this},show:function(){this._inst.addTo(this.map._inst);return this},hide:function(){this.remove();return this},remove:function(){this.map._inst.removeLayer(this._inst)}};g.polyline=$.extend({},h,g.polyline);var v=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","clickable"],e={strokeColor:"color",strokeOpacity:"opacity",strokeWeight:"weight"};g.circle={initialize:function(w){var x=a.mapping(a.pick(w,v),e);this._inst=L.circle(L.latLng(w.lat,w.lng),w.radius,x).addTo(this.map._inst)},getMap:function(){return this.map},getCenter:function(){var w=this._inst.getCenter();return{lat:w.lat,lng:w.lng}},setRadius:function(w){this._inst.setRadius(w);return this},getRadius:function(){return this._inst.getRadius()},setOptions:function(w){var x=a.mapping(a.pick(w,v),e);this._inst.setStyle(x);return this},show:function(){this._inst.addTo(this.map._inst);return this},hide:function(){this.remove();return this},remove:function(){this.map._inst.removeLayer(this._inst)}};g.circle=$.extend({},h,g.circle);var j=["strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","clickable"],o={strokeColor:"color",strokeOpacity:"opacity",strokeWeight:"weight"};g.polygon={initialize:function(y){var B=y.paths,A=[];for(var z=0;z<B.length;z++){var w=B[z];A.push(L.latLng(w.lat,w.lng))}var x=a.mapping(a.pick(y,j),o);this._inst=L.polygon(A,x).addTo(this.map._inst)},getMap:function(){return this.map},getPath:function(){var x=this._inst.getLatLngs(),y=[];for(var w=0;w<x.length;w++){y.push({lat:x[w].lat,lng:x[w].lng})}return y},setOptions:function(x){var w=a.mapping(a.pick(x,j),o);this._inst.setStyle(w);return this},show:function(){this._inst.addTo(this.map._inst);return this},hide:function(){this.remove();return this},remove:function(){this.map._inst.removeLayer(this._inst)}};g.polygon=$.extend({},h,g.polygon);var t={};var b=r.addOverlayView=function(y,x){var w=L.Class.extend({initialize:function(z){this.map=z.map._inst;this.lat=z.lat;this.lng=z.lng;this.type="marker";this.$node=null;this.position=null;this._initialize(z);this.createNode()},onAdd:function(z){var A;switch(this.type){case"marker":A=z.getPanes().markerPane;break;case"infoWindow":A=z.getPanes().popupPane;this.$node.css("position","absolute");break;default:}A.appendChild(this.$node[0]);z.on("viewreset",this._reset,this);this._reset()},onRemove:function(z){var A;switch(this.type){case"marker":A=z.getPanes().markerPane;break;case"infoWindow":A=z.getPanes().popupPane;break;default:}A.removeChild(this.$node[0]);z.off("viewreset",this._reset,this)},_reset:function(){var z=this.map.latLngToLayerPoint(L.latLng(this.lat,this.lng));this.renderNode(z);L.DomUtil.setPosition(this.$node[0],this.position)}});x._initialize=x.initialize;delete x.initialize;$.extend(w.prototype,x);t[y]=w};g.overlayView={initialize:function(w){this._inst=new t[this._cid](w);this.map._inst.addLayer(this._inst)},getMap:function(){return this.map},getPosition:function(){return{lat:this._inst.lat,lng:this._inst.lng}},reset:function(){if(this._inst.$node.is(":visible")){this._inst._reset()}return this},remove:function(){this.map._inst.removeLayer(this._inst)}};g.overlayView=$.extend({},h,g.overlayView);g.geocoder={};return r}));(function(b,a){if(!!b.M&&!!b.M.define){M.define("/js/hotel/mfwmap/mfwmap",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap-util"),h=e("/js/hotel/mfwmap/mfwmap-event"),j=e("/js/hotel/mfwmap/mfwmap-runtime-google"),i=e("/js/hotel/mfwmap/mfwmap-runtime-amap"),g=e("/js/hotel/mfwmap/mfwmap-runtime-leaflet");f.exports=a(b,c,h,j,i,g)})}else{b.mfwmap=a(b,b.mfwmap.util,b.mfwmap.event,b.mfwmap.googleRuntime,b.mfwmap.amapRuntime,b.mfwmap.leafletRuntime)}}(window,function(s,c,t,m,h,v){var u={google:m,amap:h,leaflet:v};var x={createMap:function(D){var A=$.Deferred(),F=null,C=c.clone(D.runtimes),B=D.channelType||"unknown",z=D.pageType||"unknown",E=function(){var H=C.shift();if(H==="google"&&B!=="hotel"&&!(B==="poi"&&(z==="add"||z==="edit"))){E();return false}if(!!H){var G=u[H].getInitPromise();u[H].init();G.then(function(){D.mapType=H;F=new j(D);if("google"===H){google.maps.event.addListenerOnce(F._inst,"idle",function(){A.resolve(F)})}else{A.resolve(F)}var I=H==="leaflet"?"osm":H;!!window.mfwPageEvent&&window.mfwPageEvent("default","map",{map_type:I,channel_type:B,page_type:z});!!window.mfwPageEvent&&window.mfwPageEvent("hotel","mfwmap",{runtimes:D.runtimes,map_type:H,channel_type:B,page_type:z,is_success:1})},function(I){E()})}else{A.reject(new Error("create mfwmap failed!"));!!window.mfwPageEvent&&window.mfwPageEvent("hotel","mfwmap",{runtimes:D.runtimes,channel_type:B,page_type:z,is_success:0})}};E();return A.promise()},controlPosition:{TOP:2,TOP_CENTER:2,TOP_LEFT:1,TOP_RIGHT:3,LEFT:5,LEFT_BOTTOM:6,LEFT_CENTER:4,LEFT_TOP:5,RIGHT:7,RIGHT_BOTTOM:9,RIGHT_CENTER:8,RIGHT_TOP:7,BOTTOM:11,BOTTOM_CENTER:11,BOTTOM_LEFT:10,BOTTOM_RIGHT:12,CENTER:13},isWGS84:function(z){if(z==="leaflet"){return true}return false},isSupportOverlayView:function(z){if(c.includes(["google","leaflet"],z)){return true}return false},util:c};var j=function(z){z=$.extend({},j.DEFAULT,z);this.runtimes=z.runtimes;this.mapType=z.mapType;this.inject();this.initialize(z)};j.DEFAULT={draggable:true,scrollwheel:true,disableDoubleClickZoom:false};var e=["click","dblclick","mouseover","mouseout","drag","dragstart","dragend","zoom_changed","resize"];j.prototype.inject=function(){for(var z in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],z)){this[z]=c.bind(t.eventFunc[z],this,e)}else{this[z]=c.bind(t.eventFunc[z],this)}}var A=u[this.mapType].implement.map;for(var z in A){this[z]=c.bind(A[z],this)}};j.prototype.getBounds=function(){return new o({map:this,latLngBounds:this._inst.getBounds()})};var o=x.LatLngBounds=function(z){this.map=z.map;this.inject();this.initialize(z)};o.prototype.inject=function(){var A=u[this.map.mapType].implement.latLngBounds;for(var z in A){this[z]=c.bind(A[z],this)}};var k=x.Marker=function(z){z=$.extend({},k.DEFAULT,z);this.map=z.map;this.icon=null;this.content="";this.inject();this.initialize(z)};k.DEFAULT={title:"",opacity:1,clickable:true,draggable:false};var f=["click","dblclick","mouseover","mouseout","drag","dragstart","dragend"];k.prototype.inject=function(){for(var z in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],z)){this[z]=c.bind(t.eventFunc[z],this,f)}else{this[z]=c.bind(t.eventFunc[z],this)}}var A=u[this.map.mapType].implement.marker;for(var z in A){this[z]=c.bind(A[z],this)}};var l=x.InfoWindow=function(z){z=$.extend({},l.DEFAULT,z);this.map=z.map;this.icon=null;this.inject();this.initialize(z)};l.DEFAULT={};var a=["click","dblclick","mouseover","mouseout"];l.prototype.inject=function(){for(var z in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],z)){this[z]=c.bind(t.eventFunc[z],this,a)}else{this[z]=c.bind(t.eventFunc[z],this)}}var A=u[this.map.mapType].implement.infoWindow;for(var z in A){this[z]=c.bind(A[z],this)}};var q=x.Polyline=function(z){z=$.extend({},q.DEFAULT,z);this.map=z.map;this.inject();this.initialize(z)};q.DEFAULT={strokeColor:"#0a89e4",strokeOpacity:1,strokeWeight:2,clickable:true};var g=["click","dblclick","mouseover","mouseout"];q.prototype.inject=function(){for(var z in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],z)){this[z]=c.bind(t.eventFunc[z],this,g)}else{this[z]=c.bind(t.eventFunc[z],this)}}var A=u[this.map.mapType].implement.polyline;for(var z in A){this[z]=c.bind(A[z],this)}};var r=x.Circle=function(z){z=$.extend({},r.DEFAULT,z);this.map=z.map;this.inject();this.initialize(z)};r.DEFAULT={strokeColor:"#29b5EF",strokeOpacity:1,strokeWeight:1,fillColor:"#0a89e4",fillOpacity:0,clickable:true};var w=["click","dblclick","mouseover","mouseout"];r.prototype.inject=function(){for(var z in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],z)){this[z]=c.bind(t.eventFunc[z],this,w)}else{this[z]=c.bind(t.eventFunc[z],this)}}var A=u[this.map.mapType].implement.circle;for(var z in A){this[z]=c.bind(A[z],this)}};r.prototype.getBounds=function(){return new o({map:this.map,latLngBounds:this._inst.getBounds()})};var b=x.Polygon=function(z){z=$.extend({},b.DEFAULT,z);this.map=z.map;this.inject();this.initialize(z)};b.DEFAULT={strokeColor:"#0a89e4",strokeOpacity:1,strokeWeight:2,fillColor:"#0a89e4",fillOpacity:0,clickable:true};var p=["click","dblclick","mouseover","mouseout"];b.prototype.inject=function(){for(var z in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],z)){this[z]=c.bind(t.eventFunc[z],this,p)}else{this[z]=c.bind(t.eventFunc[z],this)}}var A=u[this.map.mapType].implement.polygon;for(var z in A){this[z]=c.bind(A[z],this)}};var y=x.OverlayView=function(z){this.map=z.map;this.inject();!!this.initialize&&this.initialize(z)};var i=["click","dblclick","mouseover","mouseout"];y.prototype.inject=function(){for(var z in t.eventFunc){if(c.includes(["addListener","addListenerOnce","trigger"],z)){this[z]=c.bind(t.eventFunc[z],this,i)}else{this[z]=c.bind(t.eventFunc[z],this)}}var A=u[this.map.mapType].implement.overlayView;for(var z in A){this[z]=c.bind(A[z],this)}};var d=["initialize","createNode","renderNode","destoryNode"];y.implement=function(A){var z=this,C=c.uuid(),B=function(){this._cid=C;return z.apply(this,arguments)};u.google.getInitPromise().then(function(){u.google.addOverlayView(C,A)});u.leaflet.getInitPromise().then(function(){u.leaflet.addOverlayView(C,A)});c.extend(B,z);return B};var n=x.Geocoder=function(z){this.map=z.map;this.inject();this.initialize(z)};n.prototype.inject=function(){var A=u[this.map.mapType].implement.geocoder;for(var z in A){this[z]=c.bind(A[z],this)}};return x}));(function(b,a){if(!!b.M){M.define("/js/hotel/mfwmap/mfwmap-overlays",function(e,d,f){var c=e("/js/hotel/mfwmap/mfwmap");f.exports=a(b,c)})}else{b.mfwmap.overlays=a(b,b.mfwmap)}}(window,function(a,K){var o={},e={mouseover:"mouseenter",mouseout:"mouseleave"};var D=function(U){this.isSupportOverlayView=K.isSupportOverlayView(U.map.mapType);this._impl=null};D.prototype.remove=function(){this._impl.remove()};D.prototype.addListener=function(W){if(this.isSupportOverlayView){var U=this._impl._inst.$node,V=[];if(W in e){W=e[W]}V.push(W);V=V.concat(Array.prototype.slice.call(arguments,1));U.on.apply(U,V)}else{if(arguments.length===2){this._impl.addListener.apply(this._impl,arguments)}}};D.prototype.trigger=function(W){if(this.isSupportOverlayView){var U=this._impl._inst.$node,V=[];if(W in e){W=e[W]}V.push(W);V=V.concat(Array.prototype.slice.call(arguments,1));U.trigger.apply(U,V)}else{this._impl.trigger.apply(this._impl,arguments)}};var J=function(U){J.__super__.constructor.call(this,U);this.id=null;this.isFocus=false;this.isBigger=U.isBigger||false;this.biggerLightOrigin=null;this.smallerLightOrigin=null;this.biggerNormalOrigin=null;this.smallerNormalOrigin=null};K.util.extend(J,D);J.prototype.getId=function(){return this.id};J.prototype.show=function(){if(this.isSupportOverlayView){this._impl._inst.$node.show()}else{this._impl.show()}};J.prototype.hide=function(){if(this.isSupportOverlayView){this._impl._inst.$node.hide()}else{this._impl.hide()}};J.prototype.getFocus=function(){this.isFocus=true;if(this.isSupportOverlayView){this._impl._inst.isFocus=true;this._impl._inst.$node.addClass("on").addClass("focus").css("z-index",50);this._impl.reset()}else{this._impl.setIcon({origin:this.biggerLightOrigin});this._impl.setZIndex(50)}};J.prototype.getBlur=function(){this.isFocus=false;if(this.isSupportOverlayView){this._impl._inst.isFocus=false;this._impl._inst.$node.removeClass("focus").css("z-index",40);if(!this._impl._inst.isBigger){this._impl._inst.$node.removeClass("on").css("z-index",0)}this._impl.reset()}else{if(this.isBigger){this._impl.setIcon({origin:this.biggerNormalOrigin})}else{this._impl.setIcon({origin:this.smallerNormalOrigin})}this._impl.setZIndex(0)}};J.prototype.getBigger=function(){this.isBigger=true;if(this.isSupportOverlayView){this._impl._inst.isBigger=true;this._impl._inst.$node.addClass("on").css("z-index",40);this._impl.reset()}else{this._impl.setIcon({origin:this.biggerNormalOrigin});this._impl.setZIndex(40)}};J.prototype.getSmaller=function(){this.isBigger=false;if(this.isSupportOverlayView){this._impl._inst.isBigger=false;this._impl._inst.$node.removeClass("on").css("z-index",0);this._impl.reset()}else{this._impl.setIcon({origin:this.smallerNormalOrigin});this._impl.setZIndex(0)}};J.prototype.getHighlight=function(){if(!this.isSupportOverlayView){if(this.isBigger){this._impl.setIcon({origin:this.biggerLightOrigin})}else{this._impl.setIcon({origin:this.smallerLightOrigin})}}};J.prototype.getNormallight=function(){if(!this.isSupportOverlayView&&!this.isFocus){if(this.isBigger){this._impl.setIcon({origin:this.biggerNormalOrigin})}else{this._impl.setIcon({origin:this.smallerNormalOrigin})}}};J.prototype.setZIndex=function(U){if(!this.isSupportOverlayView){this._impl.setZIndex(U)}};J.prototype.setContent=function(V,U){if(!this.isSupportOverlayView){this._impl.setContent(V)}};J.prototype.getContent=function(U){if(!this.isSupportOverlayView){return this._impl.getContent()}};var p=o.PoiMiniInfoWindow=function(U){p.__super__.constructor.call(this,U);U.content=p.tmpl(U);if(this.isSupportOverlayView){this._impl=new A(U)}else{var V=U.offset||[0,0];this._impl=new K.InfoWindow({map:U.map,lat:U.lat,lng:U.lng,content:U.content,pixelOffset:[0+V[0],-15+V[1]],disableAutoPan:true})}};p.tmpl=function(W){var V=W.name,U=$('<div class="m-popHover _j_map_overlay _j_poi_mini_info_window"><a class="title" href="javascript:;">'+V+'</a><span class="icon-arr"><i></i></span></div>');var X=$("<div>").html(U);return X.html()};K.util.extend(p,D);var A=K.OverlayView.implement({initialize:function(U){this.type="infoWindow";this.content=U.content;this.offset=U.offset||[0,0]},createNode:function(){this.$node=$(this.content)},renderNode:function(U){this.position={x:U.x-this.$node.width()/2+this.offset[0],y:U.y-this.$node.height()-20+this.offset[1]}},destoryNode:function(){this.$node.remove()}});var u=o.PoiBlackMiniInfoWindow=function(U){u.__super__.constructor.call(this,U);U.content=u.tmpl(U);if(this.isSupportOverlayView){this._impl=new d(U)}else{var V=U.offset||[0,0];this._impl=new K.InfoWindow({map:U.map,lat:U.lat,lng:U.lng,content:U.content,pixelOffset:[0+V[0],-15+V[1]],disableAutoPan:true})}};u.tmpl=function(V){var W=V.content,U=$('<div class="m-pop-poi-black _j_map_overlay _j_poi_black_mini_info_window"><a href="javascript:;">'+W+"</a><i></i></div>");var X=$("<div>").html(U);return X.html()};K.util.extend(u,D);var d=K.OverlayView.implement({initialize:function(U){this.type="infoWindow";this.content=U.content;this.offset=U.offset||[0,0]},createNode:function(){this.$node=$(this.content)},renderNode:function(U){this.position={x:U.x-this.$node.width()/2+this.offset[0],y:U.y-this.$node.height()-10+this.offset[1]}},destoryNode:function(){this.$node.remove()}});var v=o.HotelMarker=function(U){v.__super__.constructor.call(this,U);this.id=U.id;this.isMiddle=U.isMiddle||false;this.biggerLightOrigin=[25,90];this.smallerLightOrigin=[50,90];this.biggerNormalOrigin=[0,90];this.smallerNormalOrigin=[50,90];if(this.isSupportOverlayView){this._impl=new T(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,title:U.title,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:this.isBigger?[20,30]:[7,7],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin},offset:this.isBigger?[10,30]:[4,4]})}};K.util.extend(v,J);v.prototype.getFocus=function(){this.isFocus=true;if(this.isSupportOverlayView){this._impl._inst.isFocus=true;if(this.isMiddle){this._impl._inst.$node.removeClass("mark-round16").addClass("mark-hotel").find(".m-icon").css("display","block")}this._impl._inst.$node.addClass("on").addClass("focus").css("z-index",50);this._impl.reset()}else{this._impl.setIcon({origin:this.biggerLightOrigin});this._impl.setZIndex(50)}};v.prototype.getBlur=function(){this.isFocus=false;if(this.isSupportOverlayView){this._impl._inst.isFocus=false;this._impl._inst.$node.removeClass("focus").css("z-index",40);if(!this._impl._inst.isBigger){this._impl._inst.$node.removeClass("on").css("z-index",0)}if(this._impl._inst.isMiddle){this._impl._inst.$node.removeClass("mark-hotel").find(".m-icon").hide().end().addClass("mark-round16").css("z-index",40)}this._impl.reset()}else{if(this.isBigger){this._impl.setIcon({origin:this.biggerNormalOrigin})}else{this._impl.setIcon({origin:this.smallerNormalOrigin})}this._impl.setZIndex(0)}};v.prototype.getBigger=function(){this.isBigger=true;if(this.isSupportOverlayView){this._impl._inst.isBigger=true;if(this.isMiddle){this.isMiddle=false;this._impl._inst.isMiddle=false;this._impl._inst.$node.removeClass("mark-round16").addClass("mark-hotel").find(".m-icon").css("display","block")}this._impl._inst.$node.addClass("on").css("z-index",40);this._impl.reset()}else{this._impl.setIcon({origin:this.biggerNormalOrigin});this._impl.setZIndex(40)}};v.prototype.getSmaller=function(){this.isBigger=false;if(this.isSupportOverlayView){this._impl._inst.isBigger=false;if(this.isMiddle){this.isMiddle=false;this._impl._inst.isMiddle=false;this._impl._inst.$node.removeClass("mark-round16").addClass("mark-hotel").find(".m-icon").css("display","block")}this._impl._inst.$node.removeClass("on").css("z-index",0);this._impl.reset()}else{this._impl.setIcon({origin:this.smallerNormalOrigin});this._impl.setZIndex(0)}};v.prototype.getMiddle=function(){this.isBigger=false;this.isMiddle=true;if(this.isSupportOverlayView){this._impl._inst.isBigger=false;this._impl._inst.isMiddle=true;this._impl._inst.$node.removeClass("mark-hotel").removeClass("on").css("z-index",0).find(".m-icon").hide().end().addClass("mark-round16").css("z-index",40);this._impl.reset()}};var T=K.OverlayView.implement({initialize:function(U){this.id=U.id;this.isFocus=false;this.isBigger=U.isBigger||false;this.isMiddle=U.isMiddle||false},createNode:function(){if(this.isMiddle){this.$node=$('<div class="map-mark mark-round16 _j_map_overlay _j_hotel_marker"><span class="m-icon clickstat" data-cs-p="酒店map标记" data-cs-d="酒店map标记" style="display:none;"></span></div>')}else{this.$node=$('<div class="map-mark mark-hotel '+(this.isBigger?"on":"")+' _j_map_overlay _j_hotel_marker"><span class="m-icon clickstat" data-cs-p="酒店map标记" data-cs-d="酒店map标记"></span></div>')}},renderNode:function(U){if(this.isFocus||this.isBigger){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()+3}}else{this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()/2}}},destoryNode:function(){this.$node.remove()}});var H=o.HotelPointMarker=function(U){H.__super__.constructor.call(this,U);this.id=U.id;this.biggerNormalOrigin=[0,172];this.smallerNormalOrigin=[0,172];if(this.isSupportOverlayView){this._impl=new f(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,title:U.title,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:[26,26],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin}})}};K.util.extend(H,J);var f=K.OverlayView.implement({initialize:function(U){this.id=U.id},createNode:function(){this.$node=$('<div class="map-mark mark-hotel _j_map_overlay _j_hotel_marker"><span class="m-icon-point"></span></div>').css("z-index",35)},renderNode:function(U){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()}},destoryNode:function(){this.$node.remove()}});var r=o.HotelInfoWindow=function(U){r.__super__.constructor.call(this,U);this.id=U.id;U.content=r.tmpl(U);if(this.isSupportOverlayView){this._impl=new N(U)}else{var V=U.offset||[0,0];this._impl=new K.InfoWindow({map:U.map,lat:U.lat,lng:U.lng,content:U.content,pixelOffset:[0+V[0],-15+V[1]],disableAutoPan:true})}};r.tmpl=function(V){var ad=V.id,U=V.cname,ai=V.imgW160H125,ag=V.defaultImg,am=V.star,ac=V.starStr,W=V.isBest,ak=V.bookingPreferred,Y=V.numComment,Z=V.numGinfo,ae=V.isAirbnb,X=V.airbnbInfo,af=V.price,ao=V.bookingInfo,aj=V.searchParam,ab=V.dateParam,al=$('<div class="m-pop _j_map_overlay _j_hotel_info_window" data-cs-p="酒店map信息窗" data-cs-d="酒店map信息窗"></div>');al.append('<span class="close"><a class="btn-close" href="javascript:;"><i></i></a></span>').append('<div class="pop-desc"></div>').append('<span class="icon-arr"><i></i></span>');var aa=$(".pop-desc",al);aa.append('<a class="image" href="/hotel/'+ad+".html"+(!!aj?"?"+aj:"")+(!!ab?"#"+ab:"")+'" target="_blank"><img src="'+ag+'" data-image="'+ai+'"></a>').append('<h3 class="overflow_ellipsis"><a href="/hotel/'+ad+".html"+(!!aj?"?"+aj:"")+(!!ab?"#"+ab:"")+'" target="_blank">'+U+"</a></h3>");if(!ae){aa.append('<p><a class="num-comment" href="/hotel/'+ad+".html"+(!!aj?"?"+aj:"")+"#anchor=comment"+(!!ab?"&"+ab:"")+'" target="_blank">蜂蜂评价<em>'+Y+'</em></a><a class="num-post" href="/hotel/'+ad+".html"+(!!aj?"?"+aj:"")+"#anchor=comment"+(!!ab?"&"+ab:"")+'" target="_blank">游记<em>'+Z+"</em></a></p>");var an=$('<p class="hotel-icons">');an.append('<span class="hotel-star">'+ac+"</span>");if(!!W){an.append('<i class="icon-bird"></i>')}if(!!ak){an.append('<i class="icon-hand"></i>')}aa.append(an)}if(ae){aa.append('<p><a class="num-comment" href="/hotel/'+ad+".html"+(!!aj?"?"+aj:"")+"#anchor=comment"+(!!ab?"&"+ab:"")+'" target="_blank">airbnb评价<em>'+X.base.reviews_count+"</em></a></p>").append('<p class="p-airbnb"><span>'+X.base.room_type+"</span><span>"+X.base.person_capacity+"位房客</span></p>")}aa.append('<hr><a class="hm-btn" href="/hotel/'+ad+".html"+(!!aj?"?"+aj:"")+(!!ab?"#"+ab:"")+'" target="_blank"'+(ae&&ao&&ao.airbnb?'data-url="'+ao.airbnb.url+'"':"")+'>预订</a><span class="price">¥ <span>'+af+"</span>");var ah=$("<div>").html(al);return ah.html()};K.util.extend(r,D);r.prototype.getId=function(){return this.id};r.prototype.updatePrice=function(W){if(this.isSupportOverlayView){this._impl._inst.$node.find(".price span").html(W)}else{var V=this._impl.getContent(),U=$(V);U.find(".price span").html(W);var X=$("<div>").html(U);this._impl.setContent(X.html())}};var N=K.OverlayView.implement({initialize:function(U){this.type="infoWindow";this.content=U.content},createNode:function(){this.$node=$(this.content)},renderNode:function(W){this.position={x:W.x-this.$node.width()/2,y:W.y-this.$node.height()-45};this.$node.css("zIndex",10);var V=this.$node.find(".image img"),U=V.data("image");if(!!U){$("<img>").bind("load",function(X){V.attr("src",U)}).attr("src",U)}},destoryNode:function(){this.$node.remove()}});var h=o.HotelMiniInfoWindow=function(U){h.__super__.constructor.call(this,U);this.id=U.id;U.content=h.tmpl(U);if(this.isSupportOverlayView){this._impl=new I(U)}else{var V=U.offset||[0,0];this._impl=new K.InfoWindow({map:U.map,lat:U.lat,lng:U.lng,content:U.content,pixelOffset:[0+V[0],-15+V[1]],disableAutoPan:true})}};h.tmpl=function(W){var Z=W.id,V=W.name,X=W.price,U=$('<div class="m-popHover _j_map_overlay _j_hotel_mini_info_window" data-cs-p="酒店map气泡" data-cs-d="酒店map气泡"><a class="title" href="javascript:;">'+V+"</a>"+(!!X&&X>0?'<span class="price">￥<span>'+X+"</span></span>":"")+'<span class="icon-arr"><i></i></span></div>');var Y=$("<div>").html(U);return Y.html()};K.util.extend(h,D);h.prototype.getId=function(U){return this.id};h.prototype.updatePrice=function(W){if(this.isSupportOverlayView){this._impl._inst.$node.find(".price span").html(W)}else{var V=this._impl.getContent(),U=$(V);U.find(".price span").html(W);var X=$("<div>").html(U);this._impl.setContent(X.html())}};var I=K.OverlayView.implement({initialize:function(U){this.type="infoWindow";this.content=U.content;this.offset=U.offset||[0,0]},createNode:function(){this.$node=$(this.content)},renderNode:function(U){this.position={x:U.x-this.$node.width()/2+this.offset[0],y:U.y-this.$node.height()-20+this.offset[1]}},destoryNode:function(){this.$node.remove()}});var m=o.StationMarker=function(U){m.__super__.constructor.call(this,U);this.id=U.id;this.isHot=U.isHot;this.biggerLightOrigin=[25,180];this.smallerLightOrigin=[50,180];this.biggerNormalOrigin=[0,180];this.smallerNormalOrigin=[50,180];if(this.isSupportOverlayView){this._impl=new E(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:this.isBigger?[20,30]:[7,7],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin},offset:this.isBigger?[10,30]:[4,4]})}};K.util.extend(m,J);var E=K.OverlayView.implement({initialize:function(U){this.id=U.id;this.isHot=U.isHot;this.isFocus=false;this.isBigger=U.isBigger||false},createNode:function(){this.$node=$('<div class="map-mark mark-metro '+(this.isBigger?"on":"")+' _j_map_overlay _j_station_marker"><span class="m-icon clickstat" data-cs-p="车站map标记" data-cs-d="车站map标记"></span></div>')},renderNode:function(U){if(this.isFocus||this.isBigger){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()+3}}else{this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()/2}}},destoryNode:function(){this.$node.remove()}});var B=o.StationMiniInfoWindow=function(U){B.__super__.constructor.call(this,U);U.content=B.tmpl(U);if(this.isSupportOverlayView){this._impl=new F(U)}else{var V=U.offset||[0,0];this._impl=new K.InfoWindow({map:U.map,lat:U.lat,lng:U.lng,content:U.content,pixelOffset:[0+V[0],-15+V[1]],disableAutoPan:true})}};B.tmpl=function(X){var W=X.name,ab=!!X.isTransfer,U=X.lines,V=$('<div class="m-popHover _j_map_overlay _j_station_mini_info_window" data-cs-p="车站map气泡" data-cs-d="车站map气泡"><a class="title" href="javascript:;">'+W+(ab?'<i class="i-transfer"></i>':"")+'</a><span class="icon-arr"><i></i></span></div>');if(!!U&&U.length>0){var aa=$('<div class="transfer-metro">').insertBefore(V.find(".icon-arr"));for(var Y=0;Y<U.length;Y++){aa.append("<span>"+U[Y]+"</span>")}}var Z=$("<div>").html(V);return Z.html()};K.util.extend(B,D);var F=K.OverlayView.implement({initialize:function(U){this.type="infoWindow";this.content=U.content;this.offset=U.offset||[0,0]},createNode:function(){this.$node=$(this.content)},renderNode:function(U){this.position={x:U.x-this.$node.width()/2+this.offset[0],y:U.y-this.$node.height()-20+this.offset[1]}},destoryNode:function(){this.$node.remove()}});var g=o.AirportMarker=function(U){g.__super__.constructor.call(this,U);this.id=U.id;this.biggerLightOrigin=[25,150];this.smallerLightOrigin=[50,150];this.biggerNormalOrigin=[0,150];this.smallerNormalOrigin=[50,150];if(this.isSupportOverlayView){this._impl=new l(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:this.isBigger?[20,30]:[7,7],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin},offset:this.isBigger?[10,30]:[4,4]})}};K.util.extend(g,J);var l=K.OverlayView.implement({initialize:function(U){this.id=U.id;this.isFocus=false;this.isBigger=U.isBigger||false},createNode:function(){this.$node=$('<div class="map-mark mark-airport '+(this.isBigger?"on":"")+' _j_map_overlay _j_airport_marker"><span class="m-icon clickstat" data-cs-p="机场map标记" data-cs-d="机场map标记"></span></div>')},renderNode:function(U){if(this.isFocus||this.isBigger){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()}}else{this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()/2}}},destoryNode:function(){this.$node.remove()}});var i=o.RailwayStationMarker=function(U){i.__super__.constructor.call(this,U);this.id=U.id;this.biggerLightOrigin=[25,120];this.smallerLightOrigin=[50,120];this.biggerNormalOrigin=[0,120];this.smallerNormalOrigin=[50,120];if(this.isSupportOverlayView){this._impl=new P(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:this.isBigger?[20,30]:[7,7],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin},offset:this.isBigger?[10,30]:[4,4]})}};K.util.extend(i,J);var P=K.OverlayView.implement({initialize:function(U){this.id=U.id;this.isFocus=false;this.isBigger=U.isBigger||false},createNode:function(){this.$node=$('<div class="map-mark mark-train '+(this.isBigger?"on":"")+' _j_map_overlay _j_railwaystation_marker"><span class="m-icon clickstat" data-cs-p="火车站map标记" data-cs-d="火车站map标记"></span></div>')},renderNode:function(U){if(this.isFocus||this.isBigger){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()}}else{this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()/2}}},destoryNode:function(){this.$node.remove()}});var C=o.ScenicMarker=function(U){C.__super__.constructor.call(this,U);this.id=U.id;this.biggerLightOrigin=[25,0];this.smallerLightOrigin=[50,0];this.biggerNormalOrigin=[0,0];this.smallerNormalOrigin=[50,0];if(this.isSupportOverlayView){this._impl=new s(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:this.isBigger?[20,30]:[7,7],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin},offset:this.isBigger?[10,30]:[4,4]})}};K.util.extend(C,J);var s=K.OverlayView.implement({initialize:function(U){this.id=U.id;this.isFocus=false;this.isBigger=U.isBigger||false},createNode:function(){this.$node=$('<div class="map-mark mark-scenic '+(this.isBigger?"on":"")+' _j_map_overlay _j_scenic_marker"><span class="m-icon clickstat" data-cs-p="景点map标记" data-cs-d="景点map标记"></span></div>')},renderNode:function(U){if(this.isFocus||this.isBigger){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()+3}}else{this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()/2}}},destoryNode:function(){this.$node.remove()}});var k=o.FoodMarker=function(U){k.__super__.constructor.call(this,U);this.id=U.id;this.biggerLightOrigin=[25,60];this.smallerLightOrigin=[50,60];this.biggerNormalOrigin=[0,60];this.smallerNormalOrigin=[50,60];if(this.isSupportOverlayView){this._impl=new R(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:this.isBigger?[20,30]:[7,7],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin},offset:this.isBigger?[10,30]:[4,4]})}};K.util.extend(k,J);var R=K.OverlayView.implement({initialize:function(U){this.id=U.id;this.isFocus=false;this.isBigger=U.isBigger||false},createNode:function(){this.$node=$('<div class="map-mark mark-food '+(this.isBigger?"on":"")+' _j_map_overlay _j_food_marker"><span class="m-icon clickstat"></span></div>')},renderNode:function(U){if(this.isFocus||this.isBigger){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()+3}}else{this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()/2}}},destoryNode:function(){this.$node.remove()}});var t=o.ShoppingMarker=function(U){t.__super__.constructor.call(this,U);this.id=U.id;this.biggerLightOrigin=[25,30];this.smallerLightOrigin=[50,30];this.biggerNormalOrigin=[0,30];this.smallerNormalOrigin=[50,30];if(this.isSupportOverlayView){this._impl=new O(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:this.isBigger?[20,30]:[7,7],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin},offset:this.isBigger?[10,30]:[4,4]})}};K.util.extend(t,J);var O=K.OverlayView.implement({initialize:function(U){this.id=U.id;this.isFocus=false;this.isBigger=U.isBigger||false},createNode:function(){this.$node=$('<div class="map-mark mark-shopping '+(this.isBigger?"on":"")+' _j_map_overlay _j_shopping_marker"><span class="m-icon clickstat"></span></div>')},renderNode:function(U){if(this.isFocus||this.isBigger){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()+3}}else{this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()/2}}},destoryNode:function(){this.$node.remove()}});var n=o.MddMarker=function(U){n.__super__.constructor.call(this,U);this.id=U.id;if(this.isSupportOverlayView){this._impl=new c(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,icon:{url:"http://css.mafengwo.net/images/maps-nearbyHotel.png",size:[40,42],origin:[0,90]}})}};K.util.extend(n,D);var c=K.OverlayView.implement({initialize:function(U){this.id=U.id},createNode:function(){this.$node=$('<div class="m-mapNearby _j_map_overlay _j_mdd_marker"><div class="micon-nearby clickstat" data-cs-p="目的地map标记" data-cs-d="目的地map标记"></div></div>')},renderNode:function(U){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()}},destoryNode:function(){this.$node.remove()}});var q=o.MddMiniInfoWindow=function(U){q.__super__.constructor.call(this,U);this.id=U.id;U.content=q.tmpl(U);if(this.isSupportOverlayView){this._impl=new j(U)}else{this._impl=new K.InfoWindow({map:U.map,lat:U.lat,lng:U.lng,content:U.content,pixelOffset:[0,-15],disableAutoPan:true})}};q.tmpl=function(Y){var ab=Y.id,X=Y.cname,aa=Y.numHotel,W=Y.defaultImg,V=Y.img||Y.defaultImg,U=$('<div class="_j_map_overlay _j_mdd_mini_info_window" style="position:relative;" data-cs-p="目的地map气泡" data-cs-d="目的地map气泡"><div class="mpop-nearby"><a href="/hotel/list_map.php?mddid='+ab+'"><span class="image"><img src="'+W+'" data-image="'+V+'" height="65" width="95"></span><h3 class="overflow_ellipsis">'+X+'</h3><p class="overflow_ellipsis">本区域有<em>'+aa+"</em>家酒店</p></a></div></div>");var Z=$("<div>").html(U);return Z.html()};K.util.extend(q,D);q.prototype.getId=function(U){return this.id};var j=K.OverlayView.implement({initialize:function(U){this.type="infoWindow";this.content=U.content},createNode:function(){this.$node=$(this.content)},renderNode:function(W){this.position={x:W.x-this.$node.width()/2-20,y:W.y-this.$node.height()+15};var V=this.$node.find(".image img"),U=V.data("image");if(!!U){$("<img>").bind("load",function(X){V.attr("src",U)}).attr("src",U)}},destoryNode:function(){this.$node.remove()}});var z=o.AreaInfoWindow=function(U){z.__super__.constructor.call(this,U);U.content=z.tmpl(U);if(this.isSupportOverlayView){this._impl=new S(U)}else{this._impl=new K.InfoWindow({map:U.map,lat:U.lat,lng:U.lng,content:U.content,disableAutoPan:true})}};z.tmpl=function(W){var V=W.name;if(W.isComplex){var Y=Number(W.orderPercent),U=$('<div class="info-window-area _j_map_overlay _j_area_info_window"></div>');U.append("<strong>"+V+"</strong>");if(Y>0){U.append("<span><em>"+Y+"%</em>的人住在这里</span>");if(Y>20){U.append('<i class="i-hot"></i>')}}}else{U=$('<div class="m-area-info-window _j_map_overlay _j_area_info_window">'+V+"</div>")}var X=$("<div>").html(U);return X.html()};K.util.extend(z,D);var S=K.OverlayView.implement({initialize:function(U){this.type="infoWindow";this.content=U.content},createNode:function(){this.$node=$(this.content)},renderNode:function(U){this.position={x:U.x-this.$node.width()/2,y:U.y};this.$node.css("cursor","default")},destoryNode:function(){this.$node.remove()}});var G=o.MddRoutePoiMarker=function(U){G.__super__.constructor.call(this,U);this.id=U.id;this.biggerLightOrigin=[1,314];this.smallerLightOrigin=[1,314];this.biggerNormalOrigin=[1,314];this.smallerNormalOrigin=[1,314];if(this.isSupportOverlayView){this._impl=new x(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:this.isBigger?[12,12]:[12,12],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin},offset:this.isBigger?[6,6]:[6,6]})}};K.util.extend(G,J);var x=K.OverlayView.implement({initialize:function(U){this.id=U.id;this.isFocus=false;this.isBigger=U.isBigger||false},createNode:function(){this.$node=$('<div class="map-mark mark-route _j_map_overlay _j_mdd_route_poi_marker"><span class="m-icon clickstat"></span></div>')},renderNode:function(U){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()/2}},destoryNode:function(){this.$node.remove()}});var Q=o.CustomMarker=function(U){Q.__super__.constructor.call(this,U);this.id=U.id;this.biggerLightOrigin=[25,0];this.smallerLightOrigin=[50,0];this.biggerNormalOrigin=[0,0];this.smallerNormalOrigin=[50,0];if(this.isSupportOverlayView){this._impl=new b(U)}else{this._impl=new K.Marker({map:U.map,lat:U.lat,lng:U.lng,icon:{url:"http://css.mafengwo.net/images/hotel/hotel-maps-icon6.png",size:this.isBigger?[20,30]:[7,7],origin:this.isBigger?this.biggerNormalOrigin:this.smallerNormalOrigin},content:U.content,offset:U.offset||[0,0]})}};K.util.extend(Q,J);var b=K.OverlayView.implement({initialize:function(U){this.id=U.id;this.isFocus=false;this.isBigger=U.isBigger||false;this.content=U.content||'<div class="map-mark mark-scenic _j_map_overlay _j_scenic_marker"><span class="m-icon clickstat" data-cs-p="景点map标记" data-cs-d="景点map标记"></span></div>'},createNode:function(){this.$node=$(this.content)},renderNode:function(U){this.position={x:U.x-this.$node.width()/2,y:U.y-this.$node.height()}},destoryNode:function(){this.$node.remove()}});Q.prototype.getFocus=function(U){this.isFocus=true;if(this.isSupportOverlayView){this._impl._inst.isFocus=true;this._impl._inst.$node.addClass(U)}};Q.prototype.getBlur=function(U){this.isFocus=false;if(this.isSupportOverlayView){this._impl._inst.isFocus=false;this._impl._inst.$node.removeClass(U)}else{}};var y=o.CustomMiniInfoWindow=function(U){y.__super__.constructor.call(this,U);U.content=y.tmpl(U);if(this.isSupportOverlayView){this._impl=new w(U)}else{var V=U.offset||[0,0];this._impl=new K.InfoWindow({map:U.map,lat:U.lat,lng:U.lng,content:U.content,pixelOffset:[-V[0],-V[1]],disableAutoPan:typeof(U.disableAutoPan)==="undefined"?true:U.disableAutoPan})}};y.tmpl=function(V){var W=V.content,U=$(W);var X=$("<div>").html(U);return X.html()};K.util.extend(y,D);var w=K.OverlayView.implement({initialize:function(U){this.type="infoWindow";this.content=U.content;this.offset=U.offset||[0,0]},createNode:function(){this.$node=$(this.content)},renderNode:function(U){this.position={x:U.x-this.$node.outerWidth()/2-this.offset[0],y:U.y-this.$node.outerHeight()-this.offset[1]}},destoryNode:function(){this.$node.remove()}});return o}));M.define("/js/hotel/module/ListTips",function(c,b,d){var a={addListVisitor:function(e){$.get("/hotel/ajax.php?sAction=addListVisitor&iPoiId="+e)},getListVisitorCount:function(e){return $.ajax({type:"GET",url:"/hotel/ajax.php?sAction=getListVisitorCount&iPoiId="+e,dataType:"json"})},getMddOrderCount:function(e){return $.ajax({type:"GET",url:"/hotel/ajax.php?sAction=getMddOrderCount&iPoiId="+e,dataType:"json"})}};d.exports=a});M.define("Storage",function(e,g,b){var n=document;var d=c();var f={_element:null,_expires:null,_file:document.location.hostname,init:function(){if(!this._element){try{this._element=n.createElement("input");this._element.type="hidden";this._element.addBehavior("#default#userData");n.body.appendChild(this._element);this.setItem("__detectUserDataStorage",1);this.removeItem("__detectUserDataStorage");return{setItem:this.setItem,getItem:this.getItem,removeItem:this.removeItem}}catch(p){M.error(p)}}return true},setItem:function(s,t,q){var p=j(q);this._element.expires=p.toUTCString();this._element.load(this._file);var r=a(this._element.getAttribute(s)),u=i(t,+p);this._element.setAttribute(s,u);this._element.save(this._file);k({key:s,newValue:u,oldValue:r,url:window.location.href})},getItem:function(p){this._element.load(this._file);var q=a(this._element.getAttribute(p));return q&&q.value},removeItem:function(p){this._element.load(this._file);this._element.removeAttribute(p);this._element.save(this._file)}};var l={setItem:function(r,s,q){if(!d){return}var p=j(q);localStorage.setItem(r,i(s,+p))},getItem:function(p){if(!d){return}var r=+new Date(),q=a(localStorage.getItem(p));if(q){if(r>q.timestamp){localStorage.removeItem(p);q=null}else{q=q.value}}return q},removeItem:function(p){if(!d){return}localStorage.removeItem(p)}};var h={},m={on:function(q,r){var p=h[q]||(h[q]=[]);p.push(r)},off:function(q,r){var p=h[q];if(!!p){if(!!r){M.forEach(p,function(t,s){if(t==r){p.splice(s,1)}})}else{p=[]}}return this}};M.mix(f,m);M.mix(l,m);if(window.addEventListener){window.addEventListener("storage",k,false)}else{if(window.attachEvent){window.attachEvent("onstorage",k)}}function k(u){if(!u){u=window.event}var p=M.mix({},u),w=u.newValue&&a(u.newValue),q=u.oldValue&&a(u.oldValue),v=+new Date();p.newValue=w&&w.value;if(!!q&&v<q.timestamp){p.oldValue=q.value}else{p.oldValue=null}var t=u.key,s=h[t],r=0;if(!t||!s||0===s.length){return}while(r<s.length){s[r++].call(window,p)}}function j(p){if(Object.prototype.toString.call(p)!="[object Date]"){var q=typeof p==="number"&&p>0?p:86400;p=new Date();p.setTime(+p+q*1000)}return p}function i(q,p){var r={value:q,timestamp:p};return JSON.stringify(r)}function a(p){if(p){try{p=JSON.parse(p);if(!("value" in p)||!("timestamp" in p)){p={value:p,timestamp:+j()}}}catch(q){p={value:p,timestamp:+j()}}}return p}function c(){if(window.localStorage){try{localStorage.setItem("__detectLocalStorage",1);localStorage.removeItem("__detectLocalStorage");return true}catch(p){return false}}return false}var o=window.localStorage?l:f.init();b.exports=M.mix(o,{isAvailable:c,isSupport:window.localStorage?d:("setItem" in o)})});M.define("/js/hotel/module/Log",function(c,b,d){var a={getType:function(e){switch(e){case"date":return"日期";case"guests":return"人数";case"hasBookingRooms":return"全部/空房";case"price":return"价格";case"area":return"区域";case"areaId":return"区域";case"poi":return"景点";case"poiId":return"景点";case"distance":return"距离";case"subway":return"地铁";case"hasSubway":return"地铁";case"feature":return"特色类型";case"type":return"住宿类型";case"star":return"星级";case"brand":return"品牌";case"facility":return"设施";case"airbnbRoom":return"airbnb整套/合住";case"airbnbBedroom":return"airbnb卧室数量";case"airbnbFacility":return"airbnb设施";case"airbnbPropertyType":return"airbnb住宿类型";case"addedTags":return"其他tag";case"keyword":return"关键字";case"hasFaved":return"收藏";case"nonResult":return"无结果-重置条件";case"sort":return"排序";default:return e}},searchLog:function(e){!!mfwPageEvent&&mfwPageEvent("hotel","search",{keyword:e.keyword,search_type:e.search_type})},searchResultLog:function(e){!!mfwPageEvent&&mfwPageEvent("hotel","search_result",{keyword:e.keyword,search_type:e.search_type,index:e.index,content_type:e.content_type})},favLog:function(e){!!mfwPageEvent&&mfwPageEvent("hotel","fav",{opt_type:e.opt_type,page_type:e.page_type,poi_id:e.poi_id})},listFilterLog:function(e){!!mfwPageEvent&&mfwPageEvent("hotel","list_filter",{type:this.getType(e.type),value:e.type==="nonResult"?this.getType(e.value):e.value,mddid:e.mddid,entrance_type:e.entrance_type})},listDataLog:function(e){!!mfwPageEvent&&mfwPageEvent("hotel","list_data",{type:e.type,value:e.value,load_time:e.load_time,hour_period:e.hour_period,resend_count:e.resend_count,failed_type:e.failed_type})}};d.exports=a});M.define("/js/hotel/module/Search",function(d,b,e){var g=d("Suggestion"),a=d("/js/hotel/module/Log");var f={common:"/hotel/ajax.php?sAction=getSuggestListV2",tomap:"/hotel/ajax.php?sAction=getSuggestList",onmap:"/hotel/ajax.php?sAction=getMapSuggestList",airbnb:"/hotel/index/airbnb_mdd_suggest"};var c=function(h){h=$.extend({},c.DEFAULT,h);var i=this;this.type=h.type;this.isBlank=h.isBlank;this._defaultSearch=h.defaultSearch;this.$input=$("#"+h.input);this.$listContainer=$("#"+h.listContainer);this.suggestion=new g({url:f[h.type],keyParamName:"keyword",suggestionParams:"onmap"===h.type?{mddid:h.mddid}:{},input:this.$input,listContainer:this.$listContainer,handleSuggest:M.bind(function(k){var o=i.generateListHtml(k.place,"place"),q=("tomap"===i.type)?"":i.generateListHtml(k.airport,"airport"),p=("tomap"===i.type)?"":i.generateListHtml(k.railway_station,"railway_station"),n=i.generateListHtml(k.station,"station"),j=("tomap"===i.type)?"":i.generateListHtml(k.scenic,"scenic"),m=i.generateListHtml(k.hotel,"hotel"),l=o+q+p+n+j+m;if(k.first_type==="detail"){l=m+o+q+p+n+j}if(l){l+='<div class="all"><a class="_j_listitem _j_listitem_default" href="javascript:;">显示全部搜索结果&gt;</a></div>'}return l},this),updateList:function(j){this.listContainer.html(j)}});M.Event(this.suggestion).on("itemselected",_.bind(function(l){var n=l.item;if(n.length){var j=$.trim(this.$input.val()),k=this.$listContainer.find("._j_listitem").index(n)+1,m=n.data("type");if("onmap"!==h.type){if(j&&!n.hasClass("_j_listitem_default")){a.searchResultLog({keyword:j,search_type:"suggest",index:k,content_type:m})}j&&a.searchLog({keyword:j,search_type:"suggest"})}M.Event(this).fire("itemselected",{item:n});if(n.hasClass("_j_listitem_default")){i.defaultSearch(true)}else{if("onmap"!==h.type){location.href=n.attr("href")}}}},this));this.$input.on("keydown",function(j){if(j.keyCode===13){i.defaultSearch()}})};c.DEFAULT={type:"common",isBlank:false,defaultSearch:function(i,h){var j="/hotel/s.php?keyword="+i;if(!!h){j+="&disautomatch=1"}window.location.href=j}};c.prototype.generateListHtml=function(r,m){var B=[];$.each(r||[],function(i,D){B.push(D)});if(B.length===0){return""}var v=$("<div>"),u=$('<dl class="clearfix">').appendTo(v),A={hotel:"icon-hotel",place:"icon-place",station:"icon-metro",railway_station:"icon-train",airport:"icon-airport",scenic:"icon-scenic"},h=A[m]||"";u.append('<dt><i class="'+h+'"></i></dt>');for(var w=0;w<B.length;w++){var t=B[w]["id"],C=B[w]["name"],k=B[w]["cname_for_display"],p=B[w]["ename_for_display"],q=B[w]["parent_str"],s=B[w]["type"],y=B[w]["sub_type"],o=("hotel"==m)?"":B[w]["hotel_num"]+"家酒店",n,x,j=$("<dd>"),l=$('<a class="_j_listitem">');if(m=="hotel"){n="/hotel/"+t+".html";x="hotel";if("tomap"===this.type){n="/hotel/list_map.php?poiid="+t}if("onmap"===this.type){n="javascript:;";l.attr("data-type","hotel").attr("data-id",t)}}else{if(s=="mdd"){n="/hotel/"+t+"/";x="mdd";if("tomap"===this.type){n="/hotel/list_map.php?mddid="+t}if("onmap"===this.type){n="javascript:;";l.attr("data-type","mdd").attr("data-id",t)}if("airbnb"===this.type){n+="#tag=19646"}}else{if(s=="district"){n="/hotel/area_"+t+".html";x="area";if("tomap"===this.type){continue}if("onmap"===this.type){n="javascript:;";l.attr("data-type","area").attr("data-id",t)}}else{if(s=="region"){if($.inArray(this.type,["common","onmap"])===-1){continue}n="/hotel/region_"+t+".html";x="region";if("onmap"===this.type){n="javascript:;";l.attr("data-type","region").attr("data-keyword",encodeURIComponent(B[w]["cname"])).attr("data-lat",B[w].lat).attr("data-lng",B[w].lng).attr("data-distance",B[w].distance).attr("data-id",t)}}else{if(s=="traffic"){n="/hotel/jd"+t+".html";x=y;if("onmap"===this.type&&y==="station"){n="javascript:;";l.attr("data-type","station").attr("data-id",t)}}else{n="/hotel/jd"+t+".html";x="scenic";if("onmap"===this.type){n="javascript:;";l.attr("data-type","poi").attr("data-id",t)}}}}}}l.attr("href",n).attr("data-name",C);if(this.type!=="onmap"){l.attr("data-type",x)}if(w===0){j.addClass("first")}if(this.isBlank){l.attr("target","_blank")}var z=$.trim(this.$input.val());if("onmap"===this.type&&z.length>0){k=k.replace(new RegExp("("+z+"{1})","gi"),"<b>$1</b>");p=p.replace(new RegExp("("+z+"{1})","gi"),"<b>$1</b>")}l.append('<p class="txt-tit '+(m=="hotel"?"full-tit":"")+'"><span class="nums">'+o+"</span><strong>"+k+"</strong> "+p+"</p>");l.append('<p class="txt-con">'+q+"</p>");u.append(j.append(l))}if(u.find("dd").length===0){return""}return v.html()};c.prototype.defaultSearch=function(i){var h=$.trim(this.$input.val());if(h.length>0){if("onmap"!==this.type){a.searchLog({keyword:h,search_type:"search"})}this._defaultSearch.call(this,h,i)}};e.exports=c});M.define("/js/hotel/module/ModuleProvider",function(b,a,c){c.exports=function(f){var e=f.split(".");var h=window;for(var g=0,d=e.length;g<d;g++){if(!h[e[g]]){h=h[e[g]]={}}else{h=h[e[g]]}}return h}});M.define("/js/hotel/module/Captcha",function(d,c,e){var b=d("/js/hotel/module/ModuleProvider");function a(f){this.container=$(f);this.init()}a.prototype.init=function(){this.renderDom();this.bindEvent()};a.prototype.renderDom=function(){var f='<div class="captcha-wrapper"><div class="ui-input"><input type="text" maxlength="4" id="captcha-input" placeholder="请输入验证码"></div><div id="captcha-container" class="captcha-container"><img src="/hotel/captcha/index" id="captcha-img" /><div class="k-spinner" id="captcha-spinner"><div class="k-bubble-1"></div><div class="k-bubble-2"></div></div></div></div>';this.container.html(f);this.captchaContainer=this.container.find("#captcha-container");this.captchaImg=this.container.find("#captcha-img");this.captchaInput=this.container.find("#captcha-input");this.captchaInputParent=this.captchaInput.parent(".ui-input");this.captchaSpinner=this.container.find("#captcha-spinner")};a.prototype.bindEvent=function(){var f=this;var g=false;this.captchaContainer.on("click",function(){if(g){return}f.captchaSpinner.show();g=true;f.captchaImg.removeAttr("src");setTimeout(function(){f.captchaImg.attr("src","/hotel/captcha/index");setTimeout(function(){f.captchaSpinner.hide();g=false},400)},16)});this.captchaInput.on("focus",function(){if(f.captchaInputParent.hasClass("ui-input-error")){f.captchaInputParent.removeClass("ui-input-error")}if(f.captchaInputParent.hasClass("ui-input-success")){f.captchaInputParent.removeClass("ui-input-success")}f.captchaInputParent.addClass("ui-input-focus")});this.captchaInput.on("blur",function(){f.captchaInputParent.removeClass("ui-input-focus");var h=f.getCaptchaInputValue();if(!h||h.length<4){f.captchaInputParent.addClass("ui-input-error");return}f.captchaInputParent.addClass("ui-input-success")})};a.prototype.getCaptchaInputValue=function(){return this.captchaInput.val()};a.prototype.hasSuccess=function(){return this.captchaInputParent.hasClass("ui-input-success")};a.prototype.autoFocus=function(){return this.captchaInput.focus()};a.prototype.checkedCaptcha=function(f){if(this.hasSuccess()){return $.ajax({url:"/hotel/captcha/check",data:{ccode:this.getCaptchaInputValue()},dataType:"json",context:this})}else{this.autoFocus();f.setTips("请填写验证码!");return false}};b("__MFW_MODULE__.hotel").Captcha=a;e.exports=a});M.define("/js/hotel/module/Dialog",function(d,c,e){var b=d("/js/hotel/module/ModuleProvider");function a(g,f){this.isConfirm=g||false;this.isRemoveMaskBtnClick=f||false;this.init()}a.prototype.init=function(){this.createDom();this.bindEvent()};a.prototype.createDom=function(){this.$element=$('<div class="dialog-container"><div class="dialog-container-inner"><div class="dialog-content"></div><div class="dialog-tips"></div><div class="dialog-confirm-btn">'+(!this.isConfirm?"提交":"确定")+"</div></div></div>");this.$maskElem=$('<div class="dialog-mask"></div>');this.$content=this.$element.find(".dialog-content");this.$confirmBtn=this.$element.find(".dialog-confirm-btn");this.$confirmTips=this.$element.find(".dialog-tips");this.$body=$("body");this.$body.append(this.$element);this.$body.append(this.$maskElem)};a.prototype.bindEvent=function(){this.$confirmBtn.on("click",this.handleConfirmBtnClick.bind(this));!this.isRemoveMaskBtnClick&&this.isConfirm&&this.$maskElem.on("click",this.handleMaskBtnClick.bind(this))};a.prototype.setConfirmBtnName=function(f){this.$confirmBtn.html(f)};a.prototype.handleConfirmBtnClick=function(){this.isConfirm&&this.hide();M.Event(this).fire("confirmBtnClick")};a.prototype.handleMaskBtnClick=function(){this.hide()};a.prototype.hide=function(){this.$element.removeClass("dialog-container-show");this.$maskElem.removeClass("dialog-mask-show")};a.prototype.show=function(){this.$element.addClass("dialog-container-show");this.$maskElem.addClass("dialog-mask-show")};a.prototype.setContent=function(f){this.$content.html(f)};a.prototype.setTips=function(f){this.$confirmTips.html(f);this.tipsShow()};a.prototype.tipsShow=function(){this.$confirmTips.show()};a.prototype.tipsHide=function(){this.$confirmTips.hide()};a.prototype.getContentElem=function(){return this.$content};b("__MFW_MODULE__.hotel").Dialog=a;e.exports=a});M.define("/js/hotel/module/Hash",function(b,a,c){var d={set:function(o,h){var m=location.hash.length>0?location.hash.substring(1):"",k=m.length?m.split("&"):[],j={};for(var n=0;n<k.length;n++){var p=k[n].split("="),f=decodeURIComponent(p[0]),l=p.length===2?decodeURIComponent(p[1]):undefined;if(!!f.length){j[f]=l}}if(M.isObject(o)){for(var e in o){var l=o[e];if(null===l||undefined===l||""===l){delete j[e]}else{j[e]=String(l)}}}else{if(null===h||undefined===h||""===h){delete j[o]}else{j[o]=String(h)}}var g=[];for(var n in j){g.push(n+"="+encodeURIComponent(j[n]))}location.hash=g.join("&");return this},get:function(h){var k=location.hash.length>0?location.hash.substring(1):"",e=k.length?k.split("&"):[],m={};for(var g=0;g<e.length;g++){var j=e[g].split("="),f=decodeURIComponent(j[0]),l=j.length===2?decodeURIComponent(j[1]):undefined;if(!!f.length){m[f]=l}}return m[h]},has:function(h){var k=location.hash.length>0?location.hash.substring(1):"",e=k.length?k.split("&"):[],m={};for(var g=0;g<e.length;g++){var j=e[g].split("="),f=decodeURIComponent(j[0]),l=j.length===2?decodeURIComponent(j[1]):undefined;if(!!f.length){m[f]=l}}return h in m}};c.exports=d});var XDate=(function(Y,D,af,s){var O=0;var h=1;var n=2;var l=3;var t=4;var ab=5;var d=6;var ai=7;var G=8;var C=9;var ac=86400000;var U="yyyy-MM-dd'T'HH:mm:ss(.fff)";var u=U+"zzz";var i=["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds","Day","Year"];var m=["Years","Months","Days"];var x=[12,31,24,60,60,1000,1];var z=new RegExp("(([a-zA-Z])\\2*)|(\\((('.*?'|\\(.*?\\)|.)*?)\\))|('(.*?)')");var b=Y.UTC;var B=Y.prototype.toUTCString;var r=T.prototype;r.length=1;r.splice=af.prototype.splice;function T(){return ae((this instanceof T)?this:new T(),arguments)}function ae(ao,an){var al=an.length;var am;if(S(an[al-1])){am=an[--al];an=w(an,0,al)}if(!al){ao[0]=new Y()}else{if(al==1){var ak=an[0];if(ak instanceof Y||ah(ak)){ao[0]=new Y(+ak)}else{if(ak instanceof T){ao[0]=E(ak)}else{if(k(ak)){ao[0]=new Y(0);ao=y(ak,am||false,ao)}}}}else{ao[0]=new Y(b.apply(Y,an));if(!am){ao[0]=e(ao[0])}}}if(S(am)){q(ao,am)}return ao}r.getUTCMode=ag(X);function X(ak){return ak[0].toString===B}r.setUTCMode=ag(q);function q(al,ak,am){if(ak){if(!X(al)){if(am){al[0]=j(al[0])}al[0].toString=B}}else{if(X(al)){if(am){al[0]=e(al[0])}else{al[0]=new Y(+al[0])}}}return al}r.getTimezoneOffset=function(){if(X(this)){return 0}else{return this[0].getTimezoneOffset()}};ad(i,function(al,ak){r["get"+al]=function(){return Q(this[0],X(this),ak)};if(ak!=G){r["getUTC"+al]=function(){return Q(this[0],true,ak)}}if(ak!=ai){r["set"+al]=function(am){H(this,ak,am,arguments,X(this));return this};if(ak!=G){r["setUTC"+al]=function(am){H(this,ak,am,arguments,true);return this};r["add"+(m[ak]||al)]=function(an,am){f(this,ak,an,am);return this};r["diff"+(m[ak]||al)]=function(am){return I(this,am,ak)}}}});function H(ao,ar,ap,an,aq){var al=o(Q,ao[0],aq);var ak=o(J,ao[0],aq);var at;var am=false;if(an.length==2&&S(an[1])){am=an[1];an=[ap]}if(ar==h){at=(ap%12+12)%12}else{at=al(h)}ak(ar,an);if(am&&al(h)!=at){ak(h,[al(h)-1]);ak(n,[P(al(O),al(h))])}}function f(am,al,ao,ak){ao=Number(ao);var an=D.floor(ao);am["set"+i[al]](am["get"+i[al]]()+an,ak||false);if(an!=ao&&al<d){f(am,al+1,(ao-an)*x[al],ak)}}function I(ak,ar,an){ak=ak.clone().setUTCMode(true,true);ar=T(ar).setUTCMode(true,true);var am=0;if(an==O||an==h){for(var ap=d,al;ap>=an;ap--){am/=x[ap];am+=Q(ar,false,ap)-Q(ak,false,ap)}if(an==h){am+=(ar.getFullYear()-ak.getFullYear())*12}}else{if(an==n){var aq=ak.toDate().setUTCHours(0,0,0,0);var ao=ar.toDate().setUTCHours(0,0,0,0);am=D.round((ao-aq)/ac)+((ar-ao)-(ak-aq))/ac}else{am=(ar-ak)/[3600000,60000,1000,1][an-3]}}return am}r.getWeek=function(){return a(o(Q,this,false))};r.getUTCWeek=function(){return a(o(Q,this,true))};r.setWeek=function(al,ak){c(this,al,ak,false);return this};r.setUTCWeek=function(al,ak){c(this,al,ak,true);return this};r.addWeeks=function(ak){return this.addDays(Number(ak)*7)};r.diffWeeks=function(ak){return I(this,ak,n)/7};function a(ak){return K(ak(O),ak(h),ak(n))}function K(al,an,ak){var ao=new Y(b(al,an,ak));var am=V(p(al,an,ak));return D.floor(D.round((ao-am)/ac)/7)+1}function p(al,am,ak){var an=new Y(b(al,am,ak));if(an<V(al)){return al-1}else{if(an>=V(al+1)){return al+1}}return al}function V(ak){var al=new Y(b(ak,0,4));al.setUTCDate(al.getUTCDate()-(al.getUTCDay()+6)%7);return al}function c(an,aq,al,ap){var ak=o(Q,an,ap);var ao=o(J,an,ap);if(al===s){al=p(ak(O),ak(h),ak(n))}var am=V(al);if(!ap){am=e(am)}an.setTime(+am);ao(n,[ak(n)+(aq-1)*7])}T.parsers=[F];T.parse=function(ak){return +T(""+ak)};function y(ap,ak,ao){var an=T.parsers;var am=0;var al;for(;am<an.length;am++){al=an[am](ap,ak,ao);if(al){return al}}ao[0]=new Y(ap);return ao}function F(ao,al,am){var ak=ao.match(/^(\d{4})(-(\d{2})(-(\d{2})([T ](\d{2}):(\d{2})(:(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/);if(ak){var an=new Y(b(ak[1],ak[3]?ak[3]-1:0,ak[5]||1,ak[7]||0,ak[8]||0,ak[10]||0,ak[12]?Number("0."+ak[12])*1000:0));if(ak[13]){if(ak[14]){an.setUTCMinutes(an.getUTCMinutes()+(ak[15]=="-"?1:-1)*(Number(ak[16])*60+(ak[18]?Number(ak[18]):0)))}}else{if(!al){an=e(an)}}return am.setTime(+an)}}r.toString=function(ak,al,am){if(ak===s||!W(this)){return this[0].toString()}else{return N(this,ak,al,am,X(this))}};r.toUTCString=r.toGMTString=function(ak,al,am){if(ak===s||!W(this)){return this[0].toUTCString()}else{return N(this,ak,al,am,true)}};r.toISOString=function(){return this.toUTCString(u)};T.defaultLocale="";T.locales={"":{monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],amDesignator:"AM",pmDesignator:"PM"}};T.formatters={i:U,u:u};function N(ar,an,al,ao,at){var ak=T.locales;var aq=ak[T.defaultLocale]||{};var am=o(Q,ar,at);al=(k(al)?ak[al]:al)||{};function au(av){return al[av]||aq[av]}function ap(av){if(ao){var aw=(av==ai?n:av)-1;for(;aw>=0;aw--){ao.push(am(aw))}}return am(av)}return Z(ar,an,ap,au,at)}function Z(aq,al,ao,ap,ar){var ak;var am;var an="";while(ak=al.match(z)){an+=al.substr(0,ak.index);if(ak[1]){an+=R(aq,ak[1],ao,ap,ar)}else{if(ak[3]){am=Z(aq,ak[4],ao,ap,ar);if(parseInt(am.replace(/\D/g,""),10)){an+=am}}else{an+=ak[7]||"'"}}al=al.substr(ak.index+ak[0].length)}return an+al}function R(aq,ao,am,ap,ar){var ak=ao.length;var an;var al="";while(ak>0){an=A(aq,ao.substr(0,ak),am,ap,ar);if(an!==s){al+=an;ao=ao.substr(ak);ak=ao.length}else{ak--}}return al+ao}function A(ao,am,ak,an,aq){var al=T.formatters[am];if(k(al)){return Z(ao,al,ak,an,aq)}else{if(v(al)){return al(ao,aq||false,an)}}switch(am){case"fff":return aa(ak(d),3);case"s":return ak(ab);case"ss":return aa(ak(ab));case"m":return ak(t);case"mm":return aa(ak(t));case"h":return ak(l)%12||12;case"hh":return aa(ak(l)%12||12);case"H":return ak(l);case"HH":return aa(ak(l));case"d":return ak(n);case"dd":return aa(ak(n));case"ddd":return an("dayNamesShort")[ak(ai)]||"";case"dddd":return an("dayNames")[ak(ai)]||"";case"M":return ak(h)+1;case"MM":return aa(ak(h)+1);case"MMM":return an("monthNamesShort")[ak(h)]||"";case"MMMM":return an("monthNames")[ak(h)]||"";case"yy":return(ak(O)+"").substring(2);case"yyyy":return ak(O);case"t":return aj(ak,an).substr(0,1).toLowerCase();case"tt":return aj(ak,an).toLowerCase();case"T":return aj(ak,an).substr(0,1);case"TT":return aj(ak,an);case"z":case"zz":case"zzz":return aq?"Z":g(ao,am);case"w":return a(ak);case"ww":return aa(a(ak));case"S":var ap=ak(n);if(ap>10&&ap<20){return"th"}return["st","nd","rd"][ap%10-1]||"th"}}function g(ap,ao){var aq=ap.getTimezoneOffset();var al=aq<0?"+":"-";var ak=D.floor(D.abs(aq)/60);var an=D.abs(aq)%60;var am=ak;if(ao=="zz"){am=aa(ak)}else{if(ao=="zzz"){am=aa(ak)+":"+aa(an)}}return al+am}function aj(ak,al){return ak(l)<12?al("amDesignator"):al("pmDesignator")}ad(["getTime","valueOf","toDateString","toTimeString","toLocaleString","toLocaleDateString","toLocaleTimeString","toJSON"],function(ak){r[ak]=function(){return this[0][ak]()}});r.setTime=function(ak){this[0].setTime(ak);return this};r.valid=ag(W);function W(ak){return !isNaN(+ak[0])}r.clone=function(){return new T(this)};r.clearTime=function(){return this.setHours(0,0,0,0)};r.toDate=function(){return new Y(+this[0])};T.now=function(){return +new Y()};T.today=function(){return new T().clearTime()};T.UTC=b;T.getDaysInMonth=P;function E(ak){var al=new Y(+ak[0]);if(X(ak)){al.toString=B}return al}function Q(al,am,ak){return al["get"+(am?"UTC":"")+i[ak]]()}function J(am,an,al,ak){am["set"+(an?"UTC":"")+i[al]].apply(am,ak)}function j(ak){return new Y(b(ak.getFullYear(),ak.getMonth(),ak.getDate(),ak.getHours(),ak.getMinutes(),ak.getSeconds(),ak.getMilliseconds()))}function e(ak){return new Y(ak.getUTCFullYear(),ak.getUTCMonth(),ak.getUTCDate(),ak.getUTCHours(),ak.getUTCMinutes(),ak.getUTCSeconds(),ak.getUTCMilliseconds())}function P(ak,al){return 32-new Y(b(ak,al,32)).getUTCDate()}function ag(ak){return function(){return ak.apply(s,[this].concat(w(arguments)))}}function o(al){var ak=w(arguments,1);return function(){return al.apply(s,ak.concat(w(arguments)))}}function w(al,am,ak){return af.prototype.slice.call(al,am||0,ak===s?al.length:ak)}function ad(ak,am){for(var al=0;al<ak.length;al++){am(ak[al],al)}}function k(ak){return typeof ak=="string"}function ah(ak){return typeof ak=="number"}function S(ak){return typeof ak=="boolean"}function v(ak){return typeof ak=="function"}function aa(al,ak){ak=ak||2;al+="";while(al.length<ak){al="0"+al}return al}if(typeof module!=="undefined"&&module.exports){module.exports=T}if(typeof define==="function"&&define.amd){define([],function(){return T})}else{if(window.M&&typeof window.M.define==="function"){window.M.define("xdate",function(){return T})}}return T})(Date,Math,Array);M.define("/js/hotel/module/BookingDate",function(e,c,f){var g=e("Storage"),a=e("xdate"),b=e("/js/hotel/module/ModuleProvider");var d={defaultGuests:{numberAdults:2,numberChildren:0,childrenAge:[]},getGuests:function(i){var l;try{l=g.getItem("hotel_booking_guests")}catch(k){}if(!!l&&M.is(l,"String")){l=JSON.parse(l);if(M.isObject(l)&&this.isValid(l.numberAdults,l.numberChildren,l.childrenAge)){if(!i){!!mfwPageEvent&&mfwPageEvent("hotel","booking_guests",{opt_type:0,is_cached:1})}return{numberAdults:l.numberAdults,numberChildren:l.numberChildren,childrenAge:l.childrenAge,isCached:true}}}var j=this.defaultGuests;if(!i){!!mfwPageEvent&&mfwPageEvent("hotel","booking_guests",{opt_type:0,is_cached:0})}return{numberAdults:j.numberAdults,numberChildren:j.numberChildren,childrenAge:j.childrenAge,isCached:false}},setGuests:function(l,j,n,i){try{if(i!=="fav"){g.setItem("hotel_booking_guests",JSON.stringify({numberAdults:l,numberChildren:j,childrenAge:n}),86400*7);var m=h.getDate(true);if(m.isCached){h.setDate(m.checkIn,m.checkOut)}}}catch(k){}!!mfwPageEvent&&mfwPageEvent("hotel","booking_guests",{opt_type:1,number_adults:l,number_children:j,children_age:n,page_type:i})},isValid:function(m,k,o){var n=true;if(!M.is(m,"Number")||m<1||m>7){n=false}if(!M.is(k,"Number")||k<0||k>4){n=false}if(!M.isArray(o)||k!==o.length){n=false}else{for(var l=0;l<o.length;l++){var j=o[l];if(!M.is(j,"Number")||j<0||j>17){n=false;break}}}return n}};var h={getDate:function(q){var s=Number(!!window.localStorage);var p=+new Date(),n=new Date(p),j,o,k,i;n.setHours(0,0,0,0);p=n.getTime();p-=60*60*24*1000;try{j=g.getItem("hotel_check_in");o=g.getItem("hotel_check_out")}catch(m){}if(!!j&&M.is(j,"String")){k=Date.parse(j);if(k>=p&&!!o&&M.is(o,"String")){i=Date.parse(o);if(i>k&&i-k<30*24*60*60*1000){if(!q){!!mfwPageEvent&&mfwPageEvent("hotel","booking_date",{opt_type:0,is_support_storage:s,is_cached:1})}return{checkIn:j,checkOut:o,isCached:true}}}}k=p+40*24*60*60*1000;i=k+24*60*60*1000;var l=new a(k),r=new a(i);j=l.toString("yyyy-MM-dd");o=r.toString("yyyy-MM-dd");if(!q){!!mfwPageEvent&&mfwPageEvent("hotel","booking_date",{opt_type:0,is_support_storage:s,is_cached:0})}return{checkIn:j,checkOut:o,isCached:false}},setDate:function(m,i,k){try{if(k!=="fav"){g.setItem("hotel_check_in",m,86400*7);g.setItem("hotel_check_out",i,86400*7);var o=d.getDate(true);if(o.isCached){d.setGuests(o.numberAdults,o.numberChildren,o.childrenAge)}}}catch(l){}var n=a.today().diffDays(new a(m)),j=(new a(m)).diffDays(new a(i));!!mfwPageEvent&&mfwPageEvent("hotel","booking_date",{opt_type:1,ahead_days:n,duration_days:j,check_in:m,check_out:i,page_type:k})},isValid:function(m,i){var l=+new Date(),j=new Date(l),k,n;j.setHours(0,0,0,0);l=j.getTime();l-=60*60*24*1000;if(!!m&&M.is(m,"String")){k=Date.parse(m);if(k>=l&&!!i&&M.is(i,"String")){n=Date.parse(i);if(n>k&&n-k<31*24*60*60*1000){return true}}}return false},hasRemind:function(){var i=+new Date(),j=g.getItem("hotel_date_pick_remind");if(!!j&&M.is(j,"Number")){if(i-j<24*60*60*1000){return true}}return false},setRemind:function(){try{g.setItem("hotel_date_pick_remind",+new Date(),86400*7)}catch(i){}}};b("__MFW_MODULE__.hotel").BookingDate=h;f.exports=h});M.define("/js/hotel/module/BookingGuests",function(e,c,f){var g=e("Storage"),b=e("/js/hotel/module/ModuleProvider");var a=e("xdate");var h={getDate:function(q){var s=Number(!!window.localStorage);var p=+new Date(),n=new Date(p),j,o,k,i;n.setHours(0,0,0,0);p=n.getTime();p-=60*60*24*1000;try{j=g.getItem("hotel_check_in");o=g.getItem("hotel_check_out")}catch(m){}if(!!j&&M.is(j,"String")){k=Date.parse(j);if(k>=p&&!!o&&M.is(o,"String")){i=Date.parse(o);if(i>k&&i-k<30*24*60*60*1000){if(!q){!!mfwPageEvent&&mfwPageEvent("hotel","booking_date",{opt_type:0,is_support_storage:s,is_cached:1})}return{checkIn:j,checkOut:o,isCached:true}}}}k=p+40*24*60*60*1000;i=k+24*60*60*1000;var l=new a(k),r=new a(i);j=l.toString("yyyy-MM-dd");o=r.toString("yyyy-MM-dd");if(!q){!!mfwPageEvent&&mfwPageEvent("hotel","booking_date",{opt_type:0,is_support_storage:s,is_cached:0})}return{checkIn:j,checkOut:o,isCached:false}},setDate:function(m,i,k){try{if(k!=="fav"){g.setItem("hotel_check_in",m,86400*7);g.setItem("hotel_check_out",i,86400*7);var o=d.getDate(true);if(o.isCached){d.setGuests(o.numberAdults,o.numberChildren,o.childrenAge)}}}catch(l){}var n=a.today().diffDays(new a(m)),j=(new a(m)).diffDays(new a(i));!!mfwPageEvent&&mfwPageEvent("hotel","booking_date",{opt_type:1,ahead_days:n,duration_days:j,check_in:m,check_out:i,page_type:k})},isValid:function(m,i){var l=+new Date(),j=new Date(l),k,n;j.setHours(0,0,0,0);l=j.getTime();l-=60*60*24*1000;if(!!m&&M.is(m,"String")){k=Date.parse(m);if(k>=l&&!!i&&M.is(i,"String")){n=Date.parse(i);if(n>k&&n-k<31*24*60*60*1000){return true}}}return false}};var d={defaultGuests:{numberAdults:2,numberChildren:0,childrenAge:[]},getGuests:function(i){var l;try{l=g.getItem("hotel_booking_guests")}catch(k){}if(!!l&&M.is(l,"String")){l=JSON.parse(l);if(M.isObject(l)&&this.isValid(l.numberAdults,l.numberChildren,l.childrenAge)){if(!i){!!mfwPageEvent&&mfwPageEvent("hotel","booking_guests",{opt_type:0,is_cached:1})}return{numberAdults:l.numberAdults,numberChildren:l.numberChildren,childrenAge:l.childrenAge,isCached:true}}}var j=this.defaultGuests;if(!i){!!mfwPageEvent&&mfwPageEvent("hotel","booking_guests",{opt_type:0,is_cached:0})}return{numberAdults:j.numberAdults,numberChildren:j.numberChildren,childrenAge:j.childrenAge,isCached:false}},setGuests:function(l,j,n,i){try{if(i!=="fav"){g.setItem("hotel_booking_guests",JSON.stringify({numberAdults:l,numberChildren:j,childrenAge:n}),86400*7);var m=h.getDate(true);if(m.isCached){h.setDate(m.checkIn,m.checkOut)}}}catch(k){}!!mfwPageEvent&&mfwPageEvent("hotel","booking_guests",{opt_type:1,number_adults:l,number_children:j,children_age:n,page_type:i})},isValid:function(m,k,o){var n=true;if(!M.is(m,"Number")||m<1||m>7){n=false}if(!M.is(k,"Number")||k<0||k>4){n=false}if(!M.isArray(o)||k!==o.length){n=false}else{for(var l=0;l<o.length;l++){var j=o[l];if(!M.is(j,"Number")||j<0||j>17){n=false;break}}}return n},hasRemind:function(){var i=+new Date(),j=g.getItem("hotel_guests_pick_remind");if(!!j&&M.is(j,"Number")){if(i-j<24*60*60*1000){return true}}return false},setRemind:function(){try{g.setItem("hotel_guests_pick_remind",+new Date(),86400*7)}catch(i){}}};b("__MFW_MODULE__.hotel").BookingGuests=d;f.exports=d});M.define("/js/hotel/list_mvc_model",function(e,g,c){var l=e("/js/hotel/module/Hash"),f=e("/js/hotel/module/BookingDate"),d=f.getDate(),m=e("/js/hotel/module/BookingGuests"),b=m.getGuests(),n=m.defaultGuests,h=e("/js/hotel/module/Log");var a={};function i(o){if(o<1000){return"0-1"}else{if(o>=1000&&o<2000){return"1-2"}else{if(o>=2000&&o<3000){return"2-3"}else{if(o>=3000&&o<4000){return"3-4"}else{if(o>=4000&&o<5000){return"4-5"}else{if(o>=5000){return"5+"}}}}}}}function j(){var o=(new Date()).getHours();if(o>=0&&o<3){return"0-3"}else{if(o>=3&&o<6){return"3-6"}else{if(o>=6&&o<9){return"6-9"}else{if(o>=9&&o<12){return"9-12"}else{if(o>=12&&o<15){return"12-15"}else{if(o>=15&&o<18){return"15-18"}else{if(o>=18&&o<21){return"18-21"}else{if(o>=21&&o<24){return"21-24"}}}}}}}}}var k=a.FilterModel=Backbone.Model.extend({defaults:{mode:"hotel",poiOptions:[],addedPoiId:null,typeOptions:[],starOptions:[],facilityOptions:[],brandOptions:[],airbnbRoomOptions:[],airbnbBedroomOptions:[],airbnbFacilityOptions:[],airbnbPropertyTypeOptions:[],addedTagOptions:[],areaId:-1,regionId:-1,poiId:null,positionName:"",lat:0,lng:0,distance:10000,date:{checkIn:d.checkIn,checkOut:d.checkOut},foreDate:d.isCached?{checkIn:d.checkIn,checkOut:d.checkOut}:{},isFixedDate:d.isCached,guests:b,foreGuests:b.isCached?{numberAdults:b.numberAdults,numberChildren:b.numberChildren,childrenAge:b.childrenAge}:{},isFixedGuests:b.isCached,hasBookingRooms:false,price:[0,Infinity],feature:0,type:[],star:[],facility:[],brand:[],airbnbRoom:[],airbnbBedroom:[],airbnbFacility:[],airbnbPropertyType:[],addedTags:[],hasFaved:false,keyword:"",sort:["comment","DESC"],page:1},initialize:function(o,p){this.optionsVid=0;this.dataVid=0;this.optionsXhrFailedCount=0;this.dataXhrFailedCount=0;this.hashToModel();this.setMode();this.setHasBookingRooms();this.loadOptions();this.loadData();this.on("change:brandOptions",this.checkBrand);this.on("change:poiOptions",this.checkPoi);this.on("change:feature",this.setMode);this.on("change:isFixedDate change:guests change:isFixedGuests",this.setHasBookingRooms);this.on("change:date",this.setBookingDate);this.on("change:guests",this.setBookingGuests);this.on("change:poiId",this.setDistanceSort);this.on("change:date change:guests change:hasBookingRooms change:price change:areaId change:regionId change:poiId change:distance change:feature change:type change:star change:facility change:brand change:airbnbRoom change:airbnbBedroom change:airbnbFacility change:airbnbPropertyType change:addedTags change:hasFaved change:keyword",this.loadOptions);this.on("change:date change:guests change:hasBookingRooms change:price change:areaId change:regionId change:poiId change:distance change:feature change:type change:star change:facility change:brand change:airbnbRoom change:airbnbBedroom change:airbnbFacility change:airbnbPropertyType change:addedTags change:hasFaved change:keyword change:sort",this.resetPage);this.on("change:date change:guests change:hasBookingRooms change:price change:areaId change:regionId change:poiId change:distance change:feature change:type change:star change:facility change:brand change:airbnbRoom change:airbnbBedroom change:airbnbFacility change:airbnbPropertyType change:addedTags change:hasFaved change:keyword change:sort change:page",this.loadData);this.on("change:date change:guests change:hasBookingRooms change:price change:areaId change:regionId change:poiId change:distance change:feature change:type change:star change:facility change:brand change:airbnbRoom change:airbnbBedroom change:airbnbFacility change:airbnbPropertyType change:addedTags change:hasFaved change:keyword change:sort change:page",this.modelToHash)},loadOptions:function(){if(!(arguments.length===1&&arguments[0]===true)){this.optionsVid++}var q=this.optionsVid,p=$.Deferred(),v=$.Deferred(),u=this.getParams("option"),o={star_list:"starOptions",type_list:"typeOptions",brand_list:"brandOptions",room_type_list:"airbnbRoomOptions",bedroom_list:"airbnbBedroomOptions",property_type_list:"airbnbPropertyTypeOptions"},t={type_list:"type",brand_list:"brand",room_type_list:"airbnbRoom",bedroom_list:"airbnbBedroom",property_type_list:"airbnbPropertyType"};u.option_type="tag";if(this.tagOptionsXhr&&this.tagOptionsXhr.readyState!==4){this.tagOptionsXhr.abort()}var s=(new Date()).getTime();this.tagOptionsXhr=$.ajax({url:"/rest/hotel/filterOption/",data:{filter:u,page:{mode:"random_total",no:1,num:100}},dataType:"json",timeout:10000}).done(_.bind(function(x){var y=x&&x.data&&x.data.list&&x.data.list[0];if(q!==this.optionsVid||!x||x.errno!=0||!y){this.loadOptionsFailed("data_error",q,"tag_options");return false}var w=(new Date()).getTime();h.listDataLog({type:"tag_options",load_time:i(w-s),hour_period:j(),resend_count:this.optionsXhrFailedCount});p.resolve();_.each(y,_.bind(function(D,B,E){var C=o[B],A=t[B],z=[];if(B==="facility_list"){var F=this.get("mode");if(F==="hotel"){C="facilityOptions";A="facility"}if(F==="airbnb"){C="airbnbFacilityOptions";A="airbnbFacility"}}if(C){if(B==="star_list"){D=_.map(D,function(G,H){return G});D=_.sortBy(D,function(G){return -(Number(G.id))});_.each(D,function(G,I,H){z.push({id:Number(G.id),name:G.name,count:Number(G.hotel_num)})})}else{_.each(D,function(G,I,H){if(Number(G.hotel_num)>0){z.push({id:Number(G.id),name:G.name,count:Number(G.hotel_num)})}});_.each(D,_.bind(function(G,I,H){if(Number(G.hotel_num)===0&&_.contains(this.get(A),Number(G.id))){z.push({id:Number(G.id),name:G.name,count:Number(G.hotel_num)})}},this));_.each(D,_.bind(function(G,I,H){if(Number(G.hotel_num)===0&&!_.contains(this.get(A),Number(G.id))){z.push({id:Number(G.id),name:G.name,count:Number(G.hotel_num)})}},this))}this.set(C,z)}},this))},this)).fail(_.bind(function(w,x){if(x!=="abort"){this.loadOptionsFailed(x,q,"tag_options")}},this));u.option_type="poi";u.poi_id=this.get("addedPoiId")?this.get("addedPoiId"):u.poi_id;if(this.poiOptionsXhr&&this.poiOptionsXhr.readyState!==4){this.poiOptionsXhr.abort()}var r=(new Date()).getTime();this.poiOptionsXhr=$.ajax({url:"/rest/hotel/filterOption/",data:{filter:u,page:{mode:"random_total",no:1,num:100}},dataType:"json",timeout:10000}).done(_.bind(function(x){var w=x&&x.data&&x.data.list&&x.data.list[0]&&x.data.list[0].poi_list,z=[];if(q!==this.optionsVid||!x||x.errno!=0||!w){this.loadOptionsFailed("data_error",q,"poi_options");return false}var y=(new Date()).getTime();h.listDataLog({type:"poi_options",load_time:i(y-r),hour_period:j(),resend_count:this.optionsXhrFailedCount});v.resolve();if(w){_.each(w,function(B,A,C){z.push({id:Number(B.id),name:B.name,count:Number(B.hotel_num)})})}if(this.get("positionName")){z=[]}this.set("poiOptions",z)},this)).fail(_.bind(function(w,x){if(x!=="abort"){this.loadOptionsFailed(x,q,"poi_options")}},this));$.when(p,v).done(_.bind(function(){this.optionsXhrFailedCount=0},this));return this},loadOptionsFailed:function(r,p,o){if(++this.optionsXhrFailedCount<=3){this.loadOptions(true)}else{var q=Math.pow(2,this.optionsXhrFailedCount-3)*1000;setTimeout(_.bind(function(){if(p===this.optionsVid){this.loadOptions(true)}},this),q)}h.listDataLog({type:o,load_time:0,hour_period:j(),failed_type:r});return this},loadData:function(){if("distance" in this.changed&&!this.get("poiId")&&!this.get("positionName")){return this}if(!(arguments.length===1&&arguments[0]===true)){this.dataVid++}var o=this.dataVid,q=this.getParams("data");q.sAction="getPoiList5";if(!!this.dataXhr&&this.dataXhr.readyState!==4){this.dataXhr.abort()}var p=(new Date()).getTime();this.dataXhr=$.ajax({url:"/hotel/ajax.php",data:q,dataType:"json",timeout:20000}).done(_.bind(function(s){if(o!==this.dataVid||!s||s.ret!=1){this.loadDataFailed("data_error",o);return false}var r=(new Date()).getTime();h.listDataLog({type:"hotel_list",load_time:i(r-p),hour_period:j(),resend_count:this.dataXhrFailedCount});this.dataXhrFailedCount=0;this.trigger("sync:data",s,q)},this)).fail(_.bind(function(r,s){if(s!=="abort"){this.loadDataFailed(s,o)}},this));this.trigger("request:data",this,this.dataXhr,q);return this},loadDataFailed:function(q,o){if(++this.dataXhrFailedCount<=3){this.loadData(true)}else{var p=Math.pow(2,this.dataXhrFailedCount-3)*1000;setTimeout(_.bind(function(){if(o===this.dataVid){this.loadData(true)}},this),p)}h.listDataLog({type:"hotel_list",load_time:0,hour_period:j(),failed_type:q});return this},getParams:function(u){var t=this.get("price"),r,v;if(t.length){r=t[0]?t[0]:"";v=t[1]?(t[1]===Infinity?"":t[1]):""}var w=[];if(this.get("feature")){w.push(this.get("feature"))}if(this.get("mode")==="hotel"){_.each(this.get("type"),function(y,x,z){w.push(y)});_.each(this.get("star"),function(z,x,y){w.push(z)});_.each(this.get("facility"),function(y,x,z){w.push(y)});_.each(this.get("brand"),function(z,x,y){w.push(z)})}if(this.get("mode")==="airbnb"){_.each(this.get("airbnbRoom"),function(y,x,z){w.push(y)});_.each(this.get("airbnbBedroom"),function(y,x,z){w.push(y)});_.each(this.get("airbnbFacility"),function(z,x,y){w.push(z)});_.each(this.get("airbnbPropertyType"),function(y,x,z){w.push(y)})}_.each(this.get("addedTags"),function(z,x,y){w.push(z)});var s=this.get("sort"),q=s[0]?s[0]:"comment",p=s[1]?s[1]:"DESC";var o;if(u==="option"){o={mddid:this.get("mddid"),area_id:this.get("areaId"),region_id:this.get("regionId"),poi_id:this.get("poiId"),lat:this.get("lat"),lng:this.get("lng"),distance:this.get("distance"),check_in:this.get("date").checkIn,check_out:this.get("date").checkOut,adults_num:this.get("guests").numberAdults,children_num:this.get("guests").numberChildren,children_age:this.get("guests").childrenAge.join(","),price_min:r,price_max:v,tag_ids:w.join("S"),has_booking_rooms:Number(this.get("hasBookingRooms")),keyword:this.get("keyword")}}if(u==="data"){o={iMddId:this.get("mddid"),iAreaId:this.get("areaId"),iRegionId:this.get("regionId"),iPoiId:this.get("poiId"),position_name:this.get("positionName"),nLat:this.get("lat"),nLng:this.get("lng"),iDistance:this.get("distance"),sCheckIn:this.get("date").checkIn,sCheckOut:this.get("date").checkOut,iAdultsNum:this.get("guests").numberAdults,iChildrenNum:this.get("guests").numberChildren,sChildrenAge:this.get("guests").childrenAge.join(","),iPriceMin:r,iPriceMax:v,sTags:w.join("S"),sSortType:q,sSortFlag:p,has_booking_rooms:this.get("isFixedDate")&&!this.get("isFixedGuests")?1:Number(this.get("hasBookingRooms")),has_faved:Number(this.get("hasFaved")),sKeyWord:this.get("keyword"),iPage:this.get("page")}}return o},resetPage:function(){this.set("page",1,{silent:true});return this},setMode:function(){var o=this.get("feature"),p=this.get("mode");if(o===19646&&p!=="airbnb"){this.set({type:[],star:[],facility:[],brand:[]},{silent:true});this.set("mode","airbnb")}if(o!==19646&&p!=="hotel"){this.set({airbnbRoom:[],airbnbBedroom:[],airbnbFacility:[],airbnbPropertyType:[]},{silent:true});this.set("mode","hotel")}return this},setHasBookingRooms:function(){var p=false;if(this.get("isFixedDate")&&this.get("isFixedGuests")){var o=this.get("guests");if(o.numberAdults===n.numberAdults&&o.numberChildren===n.numberChildren){p=true}}this.set("hasBookingRooms",p);return this},setBookingDate:function(){f.setDate(this.get("date").checkIn,this.get("date").checkOut,"list");return this},setBookingGuests:function(){var o=this.get("guests");m.setGuests(o.numberAdults,o.numberChildren,o.childrenAge,"list");return this},setDistanceSort:function(){if(this.get("poiId")){this.set("sort",["distance","ASC"])}else{this.set("sort",["comment","DESC"])}},checkBrand:function(){var o=_.clone(this.get("brand"));_.each(o,_.bind(function(s,p,r){var q=_.find(this.get("brandOptions"),function(t){return t.id===s});if(!q){o=_.without(o,s)}},this));this.set("brand",o)},checkPoi:function(){var p=this.get("poiId");if(p){var o=_.find(this.get("poiOptions"),function(q){return q.id===p});if(!o){this.set("poiId",null)}}},hashToModel:function(){if(l.has("checkin")&&l.has("checkout")){var H=l.get("checkin"),q=l.get("checkout");if(f.isValid(H,q)){var S={checkIn:H,checkOut:q};this.set({date:S,foreDate:S,isFixedDate:true})}}if(l.has("guests")){var D=l.get("guests");D=D.split("-");var O=Number(D[0]),C=Number(D[1]),t=D[2]?D[2].split(","):[];t=_.map(t,function(Y,X,Z){return Number(Y)});if(m.isValid(O,C,t)){var D={numberAdults:O,numberChildren:C,childrenAge:t};this.set({guests:D,foreGuests:D,isFixedGuests:true})}}if(l.has("avl")){var W=false,D=this.get("guests");if(this.get("isFixedDate")&&this.get("isFixedGuests")&&D.numberAdults===n.numberAdults&&D.numberChildren===n.numberChildren){W=!!Number(l.get("avl"))}this.set("hasBookingRooms",W)}var G=l.get("area");G&&this.set("areaId",Number(G));var U=l.get("region");U&&this.set("regionId",Number(U));var B=l.get("poi");B&&this.set("poiId",Number(B)?Number(B):null);if(B||this.get("positionName")){var s=l.get("distance");if(s&&_.contains([1000,2000,3000,4000,5000,6000,7000,8000,9000,10000],Number(s))){this.set("distance",Number(s))}}var N=l.get("price");if(N){N=N.split("-");var F=Number(N[0])||0,I=(Number(N[1])||Number(N[1])===0)?Infinity:Number(N[1]);this.set("price",[F,I])}var x=l.get("feature");x&&this.set("feature",Number(x));var r=l.get("type");r&&this.set("type",_.map(r.split(","),function(Z,X,Y){return Number(Z)}));var R=l.get("star");R&&this.set("star",_.map(R.split(","),function(Z,X,Y){return Number(Z)}));var p=l.get("facility");p&&this.set("facility",_.map(p.split(","),function(Z,X,Y){return Number(Z)}));var A=l.get("brand");A&&this.set("brand",_.map(A.split(","),function(Z,X,Y){return Number(Z)}));var y=l.get("airbnbRoom");y&&this.set("airbnbRoom",_.map(y.split(","),function(Z,X,Y){return Number(Z)}));var K=l.get("airbnbBedroom");K&&this.set("airbnbBedroom",_.map(K.split(","),function(Z,X,Y){return Number(Z)}));var o=l.get("airbnbFacility");o&&this.set("airbnbFacility",_.map(o.split(","),function(Z,X,Y){return Number(Z)}));var z=l.get("airbnbPropertyType");z&&this.set("airbnbPropertyType",_.map(z.split(","),function(Z,X,Y){return Number(Z)}));var V=l.get("addedTags");V&&this.set("addedTags",_.map(V.split(","),function(Z,X,Y){return Number(Z)}));if(l.has("fav")){this.set("hasFaved",!!Number(l.get("fav")))}var T=l.get("keyword");T&&this.set("keyword",decodeURIComponent(T));var Q=l.get("sort");if(Q){Q=Q.split("-");var w=_.contains(["comment","hot","price","distance"],Q[0])?Q[0]:"comment",P=_.contains(["ASC","DESC"],Q[1])?Q[1]:"DESC";this.set("sort",[w,P])}var v=l.get("page");if(v&&Number(v)>0){this.set("page",Number(v))}var E=window.history,J=window.document;if(E&&E.replaceState&&M.isFunction(E.replaceState)){try{E.replaceState({},J.title,location.href)}catch(u){}}},modelToHash:function(){var q={};if(this.get("isFixedDate")){q.checkin=this.get("date").checkIn;q.checkout=this.get("date").checkOut}if(this.get("isFixedGuests")){var s=this.get("guests"),r=s.childrenAge.join(",");q.guests=s.numberAdults+"-"+s.numberChildren+(r?"-"+r:"")}q.avl=Number(this.get("hasBookingRooms"));q.area=this.get("areaId")!==-1?this.get("areaId"):null;q.region=this.get("regionId")!==-1?this.get("regionId"):null;q.poi=this.get("poiId")?this.get("poiId"):null;q.distance=this.get("distance");var p=this.get("price")[0]===0?"":this.get("price")[0],o=this.get("price")[1]===Infinity?"":this.get("price")[1];q.price=p+"-"+o;q.feature=this.get("feature");q.type=this.get("type").join(",");q.star=this.get("star").join(",");q.facility=this.get("facility").join(",");q.brand=this.get("brand").join(",");q.airbnbRoom=this.get("airbnbRoom").join(",");q.airbnbBedroom=this.get("airbnbBedroom").join(",");q.airbnbFacility=this.get("airbnbFacility").join(",");q.airbnbPropertyType=this.get("airbnbPropertyType").join(",");q.addedTags=this.get("addedTags").join(",");q.fav=Number(this.get("hasFaved"));q.keyword=encodeURIComponent(this.get("keyword"));q.sort=this.get("sort")[0]+"-"+this.get("sort")[1];q.page=this.get("page");l.set(q)}});c.exports=a});
/*!

 handlebars v2.0.0

Copyright (C) 2011-2014 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/
(function(a,b){if(!!a.M&&typeof M.define==="function"){M.define("/js/corelib/handlebars-2.0.0",function(d,c,e){e.exports=b()})}if(typeof define==="function"&&define.amd){define([],b)}else{if(typeof exports==="object"){module.exports=b()}else{a.Handlebars=a.Handlebars||b()}}}(this,function(){var a=(function(){var n;function o(p){this.string=p}o.prototype.toString=function(){return""+this.string};n=o;return n})();var l=(function(x){var y={};var r=x;var z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var n=/[&<>"'`]/g;var s=/[&<>"'`]/;function A(B){return z[B]}function w(D){for(var C=1;C<arguments.length;C++){for(var B in arguments[C]){if(Object.prototype.hasOwnProperty.call(arguments[C],B)){D[B]=arguments[C][B]}}}return D}y.extend=w;var p=Object.prototype.toString;y.toString=p;var o=function(B){return typeof B==="function"};if(o(/x/)){o=function(B){return typeof B==="function"&&p.call(B)==="[object Function]"}}var o;y.isFunction=o;var v=Array.isArray||function(B){return(B&&typeof B==="object")?p.call(B)==="[object Array]":false};y.isArray=v;function u(B){if(B instanceof r){return B.toString()}else{if(B==null){return""}else{if(!B){return B+""}}}B=""+B;if(!s.test(B)){return B}return B.replace(n,A)}y.escapeExpression=u;function t(B){if(!B&&B!==0){return true}else{if(v(B)&&B.length===0){return true}else{return false}}}y.isEmpty=t;function q(B,C){return(B?B+".":"")+C}y.appendContextPath=q;return y})(a);var d=(function(){var o;var p=["description","fileName","lineNumber","message","name","number","stack"];function n(u,t){var r;if(t&&t.firstLine){r=t.firstLine;u+=" - "+r+":"+t.firstColumn}var s=Error.prototype.constructor.call(this,u);for(var q=0;q<p.length;q++){this[p[q]]=s[p[q]]}if(r){this.lineNumber=r;this.column=t.firstColumn}}n.prototype=new Error();o=n;return o})();var i=(function(y,B){var A={};var w=y;var u=B;var D="2.0.0";A.VERSION=D;var o=6;A.COMPILER_REVISION=o;var r={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};A.REVISION_CHANGES=r;var v=w.isArray,q=w.isFunction,p=w.toString,n="[object Object]";function t(F,E){this.helpers=F||{};this.partials=E||{};x(this)}A.HandlebarsEnvironment=t;t.prototype={constructor:t,logger:z,log:s,registerHelper:function(E,F){if(p.call(E)===n){if(F){throw new u("Arg not supported with multiple helpers")}w.extend(this.helpers,E)}else{this.helpers[E]=F}},unregisterHelper:function(E){delete this.helpers[E]},registerPartial:function(F,E){if(p.call(F)===n){w.extend(this.partials,F)}else{this.partials[F]=E}},unregisterPartial:function(E){delete this.partials[E]}};function x(E){E.registerHelper("helperMissing",function(){if(arguments.length===1){return undefined}else{throw new u("Missing helper: '"+arguments[arguments.length-1].name+"'")}});E.registerHelper("blockHelperMissing",function(H,G){var F=G.inverse,I=G.fn;if(H===true){return I(this)}else{if(H===false||H==null){return F(this)}else{if(v(H)){if(H.length>0){if(G.ids){G.ids=[G.name]}return E.helpers.each(H,G)}else{return F(this)}}else{if(G.data&&G.ids){var J=C(G.data);J.contextPath=w.appendContextPath(G.data.contextPath,G.name);G={data:J}}return I(H,G)}}}});E.registerHelper("each",function(F,Q){if(!Q){throw new u("Must pass iterator to #each")}var O=Q.fn,I=Q.inverse;var K=0,N="",J;var G;if(Q.data&&Q.ids){G=w.appendContextPath(Q.data.contextPath,Q.ids[0])+"."}if(q(F)){F=F.call(this)}if(Q.data){J=C(Q.data)}if(F&&typeof F==="object"){if(v(F)){for(var H=F.length;K<H;K++){if(J){J.index=K;J.first=(K===0);J.last=(K===(F.length-1));if(G){J.contextPath=G+K}}N=N+O(F[K],{data:J})}}else{for(var P in F){if(F.hasOwnProperty(P)){if(J){J.key=P;J.index=K;J.first=(K===0);if(G){J.contextPath=G+P}}N=N+O(F[P],{data:J});K++}}}}if(K===0){N=I(this)}return N});E.registerHelper("if",function(G,F){if(q(G)){G=G.call(this)}if((!F.hash.includeZero&&!G)||w.isEmpty(G)){return F.inverse(this)}else{return F.fn(this)}});E.registerHelper("unless",function(G,F){return E.helpers["if"].call(this,G,{fn:F.inverse,inverse:F.fn,hash:F.hash})});E.registerHelper("with",function(G,F){if(q(G)){G=G.call(this)}var H=F.fn;if(!w.isEmpty(G)){if(F.data&&F.ids){var I=C(F.data);I.contextPath=w.appendContextPath(F.data.contextPath,F.ids[0]);F={data:I}}return H(G,F)}else{return F.inverse(this)}});E.registerHelper("log",function(G,F){var H=F.data&&F.data.level!=null?parseInt(F.data.level,10):1;E.log(H,G)});E.registerHelper("lookup",function(G,F){return G&&G[F]})}var z={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(G,E){if(z.level<=G){var F=z.methodMap[G];if(typeof console!=="undefined"&&console[F]){console[F].call(console,E)}}}};A.logger=z;var s=z.log;A.log=s;var C=function(E){var F=w.extend({},E);F._parent=E;return F};A.createFrame=C;return A})(l,d);var g=(function(v,A,q){var y={};var u=v;var s=A;var p=q.COMPILER_REVISION;var r=q.REVISION_CHANGES;var B=q.createFrame;function o(E){var D=E&&E[0]||1,G=p;if(D!==G){if(D<G){var C=r[G],F=r[D];throw new s("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+C+") or downgrade your runtime to an older version ("+F+").")}else{throw new s("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+E[1]+").")}}}y.checkRevision=o;function x(C,G){if(!G){throw new s("No environment passed to template")}if(!C||!C.main){throw new s("Unknown template object: "+typeof C)}G.VM.checkRevision(C.compiler);var F=function(S,K,H,J,P,I,R,Q,T){if(P){J=u.extend({},J,P)}var W=G.VM.invokePartial.call(this,S,H,J,I,R,Q,T);if(W==null&&G.compile){var V={helpers:I,partials:R,data:Q,depths:T};R[H]=G.compile(S,{data:Q!==undefined,compat:C.compat},G);W=R[H](J,V)}if(W!=null){if(K){var U=W.split("\n");for(var O=0,N=U.length;O<N;O++){if(!U[O]&&O+1===N){break}U[O]=K+U[O]}W=U.join("\n")}return W}else{throw new s("The partial "+H+" could not be compiled when running in runtime-only mode")}};var D={lookup:function(K,I){var H=K.length;for(var J=0;J<H;J++){if(K[J]&&K[J][I]!=null){return K[J][I]}}},lambda:function(I,H){return typeof I==="function"?I.call(H):I},escapeExpression:u.escapeExpression,invokePartial:F,fn:function(H){return C[H]},programs:[],program:function(I,K,N){var H=this.programs[I],J=this.fn(I);if(K||N){H=t(this,I,J,K,N)}else{if(!H){H=this.programs[I]=t(this,I,J)}}return H},data:function(H,I){while(H&&I--){H=H._parent}return H},merge:function(J,I){var H=J||I;if(J&&I&&(J!==I)){H=u.extend({},I,J)}return H},noop:G.VM.noop,compilerInfo:C.compiler};var E=function(I,H){H=H||{};var J=H.data;E._setup(H);if(!H.partial&&C.useData){J=w(I,J)}var K;if(C.useDepths){K=H.depths?[I].concat(H.depths):[I]}return C.main.call(D,I,D.helpers,D.partials,J,K)};E.isTop=true;E._setup=function(H){if(!H.partial){D.helpers=D.merge(H.helpers,G.helpers);if(C.usePartial){D.partials=D.merge(H.partials,G.partials)}}else{D.helpers=H.helpers;D.partials=H.partials}};E._child=function(H,I,J){if(C.useDepths&&!J){throw new s("must pass parent depths")}return t(D,H,C[H],I,J)};return E}y.template=x;function t(C,D,E,F,H){var G=function(J,I){I=I||{};return E.call(C,J,C.helpers,C.partials,I.data||F,H&&[J].concat(H))};G.program=D;G.depth=H?H.length:0;return G}y.program=t;function n(C,E,G,H,F,I,J){var D={partial:true,helpers:H,partials:F,data:I,depths:J};if(C===undefined){throw new s("The partial "+E+" could not be found")}else{if(C instanceof Function){return C(G,D)}}}y.invokePartial=n;function z(){return""}y.noop=z;function w(C,D){if(!D||!("root" in D)){D=D?B(D):{};D.root=C}return D}return y})(l,d,i);var f=(function(x,z,p,t,w){var y;var n=x;var q=z;var s=p;var v=t;var r=w;var u=function(){var A=new n.HandlebarsEnvironment();v.extend(A,n);A.SafeString=q;A.Exception=s;A.Utils=v;A.escapeExpression=v.escapeExpression;A.VM=r;A.template=function(B){return r.template(B,A)};return A};var o=u();o.create=u;o["default"]=o;y=o;return y})(i,a,d,l,g);var j=(function(r){var p;var o=r;function n(s){s=s||{};this.firstLine=s.first_line;this.firstColumn=s.first_column;this.lastColumn=s.last_column;this.lastLine=s.last_line}var q={ProgramNode:function(s,u,t){n.call(this,t);this.type="program";this.statements=s;this.strip=u},MustacheNode:function(x,w,s,u,t){n.call(this,t);this.type="mustache";this.strip=u;if(s!=null&&s.charAt){var v=s.charAt(3)||s.charAt(2);this.escaped=v!=="{"&&v!=="&"}else{this.escaped=!!s}if(x instanceof q.SexprNode){this.sexpr=x}else{this.sexpr=new q.SexprNode(x,w)}this.id=this.sexpr.id;this.params=this.sexpr.params;this.hash=this.sexpr.hash;this.eligibleHelper=this.sexpr.eligibleHelper;this.isHelper=this.sexpr.isHelper},SexprNode:function(w,t,s){n.call(this,s);this.type="sexpr";this.hash=t;var v=this.id=w[0];var u=this.params=w.slice(1);this.isHelper=!!(u.length||t);this.eligibleHelper=this.isHelper||v.isSimple},PartialNode:function(s,u,w,v,t){n.call(this,t);this.type="partial";this.partialName=s;this.context=u;this.hash=w;this.strip=v;this.strip.inlineStandalone=true},BlockNode:function(w,t,s,v,u){n.call(this,u);this.type="block";this.mustache=w;this.program=t;this.inverse=s;this.strip=v;if(s&&!t){this.isInverse=true}},RawBlockNode:function(u,t,v,s){n.call(this,s);if(u.sexpr.id.original!==v){throw new o(u.sexpr.id.original+" doesn't match "+v,this)}t=new q.ContentNode(t,s);this.type="block";this.mustache=u;this.program=new q.ProgramNode([t],{},s)},ContentNode:function(s,t){n.call(this,t);this.type="content";this.original=this.string=s},HashNode:function(t,s){n.call(this,s);this.type="hash";this.pairs=t},IdNode:function(w,z){n.call(this,z);this.type="ID";var u="",A=[],x=0,t="";for(var y=0,v=w.length;y<v;y++){var s=w[y].part;u+=(w[y].separator||"")+s;if(s===".."||s==="."||s==="this"){if(A.length>0){throw new o("Invalid path: "+u,this)}else{if(s===".."){x++;t+="../"}else{this.isScoped=true}}}else{A.push(s)}}this.original=u;this.parts=A;this.string=A.join(".");this.depth=x;this.idName=t+this.string;this.isSimple=w.length===1&&!this.isScoped&&x===0;this.stringModeValue=this.string},PartialNameNode:function(s,t){n.call(this,t);this.type="PARTIAL_NAME";this.name=s.original},DataNode:function(t,s){n.call(this,s);this.type="DATA";this.id=t;this.stringModeValue=t.stringModeValue;this.idName="@"+t.stringModeValue},StringNode:function(s,t){n.call(this,t);this.type="STRING";this.original=this.string=this.stringModeValue=s},NumberNode:function(t,s){n.call(this,s);this.type="NUMBER";this.original=this.number=t;this.stringModeValue=Number(t)},BooleanNode:function(s,t){n.call(this,t);this.type="BOOLEAN";this.bool=s;this.stringModeValue=s==="true"},CommentNode:function(t,s){n.call(this,s);this.type="comment";this.comment=t;this.strip={inlineStandalone:true}}};p=q;return p})(d);var b=(function(){var o;var n=(function(){var v={trace:function r(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,CONTENT:12,COMMENT:13,openRawBlock:14,END_RAW_BLOCK:15,OPEN_RAW_BLOCK:16,sexpr:17,CLOSE_RAW_BLOCK:18,openBlock:19,block_option0:20,closeBlock:21,openInverse:22,block_option1:23,OPEN_BLOCK:24,CLOSE:25,OPEN_INVERSE:26,inverseAndProgram:27,INVERSE:28,OPEN_ENDBLOCK:29,path:30,OPEN:31,OPEN_UNESCAPED:32,CLOSE_UNESCAPED:33,OPEN_PARTIAL:34,partialName:35,param:36,partial_option0:37,partial_option1:38,sexpr_repetition0:39,sexpr_option0:40,dataName:41,STRING:42,NUMBER:43,BOOLEAN:44,OPEN_SEXPR:45,CLOSE_SEXPR:46,hash:47,hash_repetition_plus0:48,hashSegment:49,ID:50,EQUALS:51,DATA:52,pathSegments:53,SEP:54,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",12:"CONTENT",13:"COMMENT",15:"END_RAW_BLOCK",16:"OPEN_RAW_BLOCK",18:"CLOSE_RAW_BLOCK",24:"OPEN_BLOCK",25:"CLOSE",26:"OPEN_INVERSE",28:"INVERSE",29:"OPEN_ENDBLOCK",31:"OPEN",32:"OPEN_UNESCAPED",33:"CLOSE_UNESCAPED",34:"OPEN_PARTIAL",42:"STRING",43:"NUMBER",44:"BOOLEAN",45:"OPEN_SEXPR",46:"CLOSE_SEXPR",50:"ID",51:"EQUALS",52:"DATA",54:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[10,3],[14,3],[9,4],[9,4],[19,3],[22,3],[27,2],[21,3],[8,3],[8,3],[11,5],[11,4],[17,3],[17,1],[36,1],[36,1],[36,1],[36,1],[36,1],[36,3],[47,1],[49,3],[35,1],[35,1],[35,1],[41,2],[30,1],[53,3],[53,1],[6,0],[6,2],[20,0],[20,1],[23,0],[23,1],[37,0],[37,1],[38,0],[38,1],[39,0],[39,2],[40,0],[40,1],[48,1],[48,2]],performAction:function q(w,z,A,D,C,y,B){var x=y.length-1;switch(C){case 1:D.prepareProgram(y[x-1].statements,true);return y[x-1];break;case 2:this.$=new D.ProgramNode(D.prepareProgram(y[x]),{},this._$);break;case 3:this.$=y[x];break;case 4:this.$=y[x];break;case 5:this.$=y[x];break;case 6:this.$=y[x];break;case 7:this.$=new D.ContentNode(y[x],this._$);break;case 8:this.$=new D.CommentNode(y[x],this._$);break;case 9:this.$=new D.RawBlockNode(y[x-2],y[x-1],y[x],this._$);break;case 10:this.$=new D.MustacheNode(y[x-1],null,"","",this._$);break;case 11:this.$=D.prepareBlock(y[x-3],y[x-2],y[x-1],y[x],false,this._$);break;case 12:this.$=D.prepareBlock(y[x-3],y[x-2],y[x-1],y[x],true,this._$);break;case 13:this.$=new D.MustacheNode(y[x-1],null,y[x-2],D.stripFlags(y[x-2],y[x]),this._$);break;case 14:this.$=new D.MustacheNode(y[x-1],null,y[x-2],D.stripFlags(y[x-2],y[x]),this._$);break;case 15:this.$={strip:D.stripFlags(y[x-1],y[x-1]),program:y[x]};break;case 16:this.$={path:y[x-1],strip:D.stripFlags(y[x-2],y[x])};break;case 17:this.$=new D.MustacheNode(y[x-1],null,y[x-2],D.stripFlags(y[x-2],y[x]),this._$);break;case 18:this.$=new D.MustacheNode(y[x-1],null,y[x-2],D.stripFlags(y[x-2],y[x]),this._$);break;case 19:this.$=new D.PartialNode(y[x-3],y[x-2],y[x-1],D.stripFlags(y[x-4],y[x]),this._$);break;case 20:this.$=new D.PartialNode(y[x-2],undefined,y[x-1],D.stripFlags(y[x-3],y[x]),this._$);break;case 21:this.$=new D.SexprNode([y[x-2]].concat(y[x-1]),y[x],this._$);break;case 22:this.$=new D.SexprNode([y[x]],null,this._$);break;case 23:this.$=y[x];break;case 24:this.$=new D.StringNode(y[x],this._$);break;case 25:this.$=new D.NumberNode(y[x],this._$);break;case 26:this.$=new D.BooleanNode(y[x],this._$);break;case 27:this.$=y[x];break;case 28:y[x-1].isHelper=true;this.$=y[x-1];break;case 29:this.$=new D.HashNode(y[x],this._$);break;case 30:this.$=[y[x-2],y[x]];break;case 31:this.$=new D.PartialNameNode(y[x],this._$);break;case 32:this.$=new D.PartialNameNode(new D.StringNode(y[x],this._$),this._$);break;case 33:this.$=new D.PartialNameNode(new D.NumberNode(y[x],this._$));break;case 34:this.$=new D.DataNode(y[x],this._$);break;case 35:this.$=new D.IdNode(y[x],this._$);break;case 36:y[x-2].push({part:y[x],separator:y[x-1]});this.$=y[x-2];break;case 37:this.$=[{part:y[x]}];break;case 38:this.$=[];break;case 39:y[x-1].push(y[x]);break;case 48:this.$=[];break;case 49:y[x-1].push(y[x]);break;case 52:this.$=[y[x]];break;case 53:y[x-1].push(y[x]);break}},table:[{3:1,4:2,5:[2,38],6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],31:[2,38],32:[2,38],34:[2,38]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:[1,10],13:[1,11],14:16,16:[1,20],19:14,22:15,24:[1,18],26:[1,19],28:[2,2],29:[2,2],31:[1,12],32:[1,13],34:[1,17]},{1:[2,1]},{5:[2,39],12:[2,39],13:[2,39],16:[2,39],24:[2,39],26:[2,39],28:[2,39],29:[2,39],31:[2,39],32:[2,39],34:[2,39]},{5:[2,3],12:[2,3],13:[2,3],16:[2,3],24:[2,3],26:[2,3],28:[2,3],29:[2,3],31:[2,3],32:[2,3],34:[2,3]},{5:[2,4],12:[2,4],13:[2,4],16:[2,4],24:[2,4],26:[2,4],28:[2,4],29:[2,4],31:[2,4],32:[2,4],34:[2,4]},{5:[2,5],12:[2,5],13:[2,5],16:[2,5],24:[2,5],26:[2,5],28:[2,5],29:[2,5],31:[2,5],32:[2,5],34:[2,5]},{5:[2,6],12:[2,6],13:[2,6],16:[2,6],24:[2,6],26:[2,6],28:[2,6],29:[2,6],31:[2,6],32:[2,6],34:[2,6]},{5:[2,7],12:[2,7],13:[2,7],16:[2,7],24:[2,7],26:[2,7],28:[2,7],29:[2,7],31:[2,7],32:[2,7],34:[2,7]},{5:[2,8],12:[2,8],13:[2,8],16:[2,8],24:[2,8],26:[2,8],28:[2,8],29:[2,8],31:[2,8],32:[2,8],34:[2,8]},{17:21,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:27,30:22,41:23,50:[1,26],52:[1,25],53:24},{4:28,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{4:29,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{12:[1,30]},{30:32,35:31,42:[1,33],43:[1,34],50:[1,26],53:24},{17:35,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:36,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:37,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[1,38]},{18:[2,48],25:[2,48],33:[2,48],39:39,42:[2,48],43:[2,48],44:[2,48],45:[2,48],46:[2,48],50:[2,48],52:[2,48]},{18:[2,22],25:[2,22],33:[2,22],46:[2,22]},{18:[2,35],25:[2,35],33:[2,35],42:[2,35],43:[2,35],44:[2,35],45:[2,35],46:[2,35],50:[2,35],52:[2,35],54:[1,40]},{30:41,50:[1,26],53:24},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],52:[2,37],54:[2,37]},{33:[1,42]},{20:43,27:44,28:[1,45],29:[2,40]},{23:46,27:47,28:[1,45],29:[2,42]},{15:[1,48]},{25:[2,46],30:51,36:49,38:50,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],47:57,48:58,49:60,50:[1,59],52:[1,25],53:24},{25:[2,31],42:[2,31],43:[2,31],44:[2,31],45:[2,31],50:[2,31],52:[2,31]},{25:[2,32],42:[2,32],43:[2,32],44:[2,32],45:[2,32],50:[2,32],52:[2,32]},{25:[2,33],42:[2,33],43:[2,33],44:[2,33],45:[2,33],50:[2,33],52:[2,33]},{25:[1,61]},{25:[1,62]},{18:[1,63]},{5:[2,17],12:[2,17],13:[2,17],16:[2,17],24:[2,17],26:[2,17],28:[2,17],29:[2,17],31:[2,17],32:[2,17],34:[2,17]},{18:[2,50],25:[2,50],30:51,33:[2,50],36:65,40:64,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],46:[2,50],47:66,48:58,49:60,50:[1,59],52:[1,25],53:24},{50:[1,67]},{18:[2,34],25:[2,34],33:[2,34],42:[2,34],43:[2,34],44:[2,34],45:[2,34],46:[2,34],50:[2,34],52:[2,34]},{5:[2,18],12:[2,18],13:[2,18],16:[2,18],24:[2,18],26:[2,18],28:[2,18],29:[2,18],31:[2,18],32:[2,18],34:[2,18]},{21:68,29:[1,69]},{29:[2,41]},{4:70,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{21:71,29:[1,69]},{29:[2,43]},{5:[2,9],12:[2,9],13:[2,9],16:[2,9],24:[2,9],26:[2,9],28:[2,9],29:[2,9],31:[2,9],32:[2,9],34:[2,9]},{25:[2,44],37:72,47:73,48:58,49:60,50:[1,74]},{25:[1,75]},{18:[2,23],25:[2,23],33:[2,23],42:[2,23],43:[2,23],44:[2,23],45:[2,23],46:[2,23],50:[2,23],52:[2,23]},{18:[2,24],25:[2,24],33:[2,24],42:[2,24],43:[2,24],44:[2,24],45:[2,24],46:[2,24],50:[2,24],52:[2,24]},{18:[2,25],25:[2,25],33:[2,25],42:[2,25],43:[2,25],44:[2,25],45:[2,25],46:[2,25],50:[2,25],52:[2,25]},{18:[2,26],25:[2,26],33:[2,26],42:[2,26],43:[2,26],44:[2,26],45:[2,26],46:[2,26],50:[2,26],52:[2,26]},{18:[2,27],25:[2,27],33:[2,27],42:[2,27],43:[2,27],44:[2,27],45:[2,27],46:[2,27],50:[2,27],52:[2,27]},{17:76,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[2,47]},{18:[2,29],25:[2,29],33:[2,29],46:[2,29],49:77,50:[1,74]},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],51:[1,78],52:[2,37],54:[2,37]},{18:[2,52],25:[2,52],33:[2,52],46:[2,52],50:[2,52]},{12:[2,13],13:[2,13],16:[2,13],24:[2,13],26:[2,13],28:[2,13],29:[2,13],31:[2,13],32:[2,13],34:[2,13]},{12:[2,14],13:[2,14],16:[2,14],24:[2,14],26:[2,14],28:[2,14],29:[2,14],31:[2,14],32:[2,14],34:[2,14]},{12:[2,10]},{18:[2,21],25:[2,21],33:[2,21],46:[2,21]},{18:[2,49],25:[2,49],33:[2,49],42:[2,49],43:[2,49],44:[2,49],45:[2,49],46:[2,49],50:[2,49],52:[2,49]},{18:[2,51],25:[2,51],33:[2,51],46:[2,51]},{18:[2,36],25:[2,36],33:[2,36],42:[2,36],43:[2,36],44:[2,36],45:[2,36],46:[2,36],50:[2,36],52:[2,36],54:[2,36]},{5:[2,11],12:[2,11],13:[2,11],16:[2,11],24:[2,11],26:[2,11],28:[2,11],29:[2,11],31:[2,11],32:[2,11],34:[2,11]},{30:79,50:[1,26],53:24},{29:[2,15]},{5:[2,12],12:[2,12],13:[2,12],16:[2,12],24:[2,12],26:[2,12],28:[2,12],29:[2,12],31:[2,12],32:[2,12],34:[2,12]},{25:[1,80]},{25:[2,45]},{51:[1,78]},{5:[2,20],12:[2,20],13:[2,20],16:[2,20],24:[2,20],26:[2,20],28:[2,20],29:[2,20],31:[2,20],32:[2,20],34:[2,20]},{46:[1,81]},{18:[2,53],25:[2,53],33:[2,53],46:[2,53],50:[2,53]},{30:51,36:82,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],50:[1,26],52:[1,25],53:24},{25:[1,83]},{5:[2,19],12:[2,19],13:[2,19],16:[2,19],24:[2,19],26:[2,19],28:[2,19],29:[2,19],31:[2,19],32:[2,19],34:[2,19]},{18:[2,28],25:[2,28],33:[2,28],42:[2,28],43:[2,28],44:[2,28],45:[2,28],46:[2,28],50:[2,28],52:[2,28]},{18:[2,30],25:[2,30],33:[2,30],46:[2,30],50:[2,30]},{5:[2,16],12:[2,16],13:[2,16],16:[2,16],24:[2,16],26:[2,16],28:[2,16],29:[2,16],31:[2,16],32:[2,16],34:[2,16]}],defaultActions:{4:[2,1],44:[2,41],47:[2,43],57:[2,47],63:[2,10],70:[2,15],73:[2,45]},parseError:function s(x,w){throw new Error(x)},parse:function u(F){var O=this,C=[0],X=[null],H=[],Y=this.table,x="",G=0,V=0,z=0,E=2,J=1;this.lexer.setInput(F);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined"){this.lexer.yylloc={}}var y=this.lexer.yylloc;H.push(y);var A=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function"){this.parseError=this.yy.parseError}function N(aa){C.length=C.length-2*aa;X.length=X.length-aa;H.length=H.length-aa}function K(){var aa;aa=O.lexer.lex()||1;if(typeof aa!=="number"){aa=O.symbols_[aa]||aa}return aa}var U,Q,B,T,Z,I,S={},P,W,w,D;while(true){B=C[C.length-1];if(this.defaultActions[B]){T=this.defaultActions[B]}else{if(U===null||typeof U=="undefined"){U=K()}T=Y[B]&&Y[B][U]}if(typeof T==="undefined"||!T.length||!T[0]){var R="";if(!z){D=[];for(P in Y[B]){if(this.terminals_[P]&&P>2){D.push("'"+this.terminals_[P]+"'")}}if(this.lexer.showPosition){R="Parse error on line "+(G+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+D.join(", ")+", got '"+(this.terminals_[U]||U)+"'"}else{R="Parse error on line "+(G+1)+": Unexpected "+(U==1?"end of input":"'"+(this.terminals_[U]||U)+"'")}this.parseError(R,{text:this.lexer.match,token:this.terminals_[U]||U,line:this.lexer.yylineno,loc:y,expected:D})}}if(T[0] instanceof Array&&T.length>1){throw new Error("Parse Error: multiple actions possible at state: "+B+", token: "+U)}switch(T[0]){case 1:C.push(U);X.push(this.lexer.yytext);H.push(this.lexer.yylloc);C.push(T[1]);U=null;if(!Q){V=this.lexer.yyleng;x=this.lexer.yytext;G=this.lexer.yylineno;y=this.lexer.yylloc;if(z>0){z--}}else{U=Q;Q=null}break;case 2:W=this.productions_[T[1]][1];S.$=X[X.length-W];S._$={first_line:H[H.length-(W||1)].first_line,last_line:H[H.length-1].last_line,first_column:H[H.length-(W||1)].first_column,last_column:H[H.length-1].last_column};if(A){S._$.range=[H[H.length-(W||1)].range[0],H[H.length-1].range[1]]}I=this.performAction.call(S,x,V,G,this.yy,T[1],X,H);if(typeof I!=="undefined"){return I}if(W){C=C.slice(0,-1*W*2);X=X.slice(0,-1*W);H=H.slice(0,-1*W)}C.push(this.productions_[T[1]][0]);X.push(S.$);H.push(S._$);w=Y[C[C.length-2]][C[C.length-1]];C.push(w);break;case 3:return true}}return true}};var p=(function(){var z=({EOF:1,parseError:function B(E,D){if(this.yy.parser){this.yy.parser.parseError(E,D)}else{throw new Error(E)}},setInput:function(D){this._input=D;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var E=this._input[0];this.yytext+=E;this.yyleng++;this.offset++;this.match+=E;this.matched+=E;var D=E.match(/(?:\r\n?|\n).*/g);if(D){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return E},unput:function(F){var D=F.length;var E=F.split(/(?:\r\n?|\n)/g);this._input=F+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-D-1);this.offset-=D;var H=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(E.length-1){this.yylineno-=E.length-1}var G=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:E?(E.length===H.length?this.yylloc.first_column:0)+H[H.length-E.length].length-E[0].length:this.yylloc.first_column-D};if(this.options.ranges){this.yylloc.range=[G[0],G[0]+this.yyleng-D]}return this},more:function(){this._more=true;return this},less:function(D){this.unput(this.match.slice(D))},pastInput:function(){var D=this.matched.substr(0,this.matched.length-this.match.length);return(D.length>20?"...":"")+D.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var D=this.match;if(D.length<20){D+=this._input.substr(0,20-D.length)}return(D.substr(0,20)+(D.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var D=this.pastInput();var E=new Array(D.length+1).join("-");return D+this.upcomingInput()+"\n"+E+"^"},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var J,H,E,G,F,D;if(!this._more){this.yytext="";this.match=""}var K=this._currentRules();for(var I=0;I<K.length;I++){E=this._input.match(this.rules[K[I]]);if(E&&(!H||E[0].length>H[0].length)){H=E;G=I;if(!this.options.flex){break}}}if(H){D=H[0].match(/(?:\r\n?|\n).*/g);if(D){this.yylineno+=D.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:D?D[D.length-1].length-D[D.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+H[0].length};this.yytext+=H[0];this.match+=H[0];this.matches=H;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(H[0].length);this.matched+=H[0];J=this.performAction.call(this,this.yy,this,K[G],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(J){return J}else{return}}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function w(){var D=this.next();if(typeof D!=="undefined"){return D}else{return this.lex()}},begin:function x(D){this.conditionStack.push(D)},popState:function C(){return this.conditionStack.pop()},_currentRules:function A(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function x(D){this.begin(D)}});z.options={};z.performAction=function y(I,E,H,D){function F(K,J){return E.yytext=E.yytext.substr(K,E.yyleng-J)}var G=D;switch(H){case 0:if(E.yytext.slice(-2)==="\\\\"){F(0,1);this.begin("mu")}else{if(E.yytext.slice(-1)==="\\"){F(0,1);this.begin("emu")}else{this.begin("mu")}}if(E.yytext){return 12}break;case 1:return 12;break;case 2:this.popState();return 12;break;case 3:E.yytext=E.yytext.substr(5,E.yyleng-9);this.popState();return 15;break;case 4:return 12;break;case 5:F(0,4);this.popState();return 13;break;case 6:return 45;break;case 7:return 46;break;case 8:return 16;break;case 9:this.popState();this.begin("raw");return 18;break;case 10:return 34;break;case 11:return 24;break;case 12:return 29;break;case 13:this.popState();return 28;break;case 14:this.popState();return 28;break;case 15:return 26;break;case 16:return 26;break;case 17:return 32;break;case 18:return 31;break;case 19:this.popState();this.begin("com");break;case 20:F(3,5);this.popState();return 13;break;case 21:return 31;break;case 22:return 51;break;case 23:return 50;break;case 24:return 50;break;case 25:return 54;break;case 26:break;case 27:this.popState();return 33;break;case 28:this.popState();return 25;break;case 29:E.yytext=F(1,2).replace(/\\"/g,'"');return 42;break;case 30:E.yytext=F(1,2).replace(/\\'/g,"'");return 42;break;case 31:return 52;break;case 32:return 44;break;case 33:return 44;break;case 34:return 43;break;case 35:return 50;break;case 36:E.yytext=F(1,2);return 50;break;case 37:return"INVALID";break;case 38:return 5;break}};z.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/];z.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:false},emu:{rules:[2],inclusive:false},com:{rules:[5],inclusive:false},raw:{rules:[3,4],inclusive:false},INITIAL:{rules:[0,1,38],inclusive:true}};return z})();v.lexer=p;function t(){this.yy={}}t.prototype=v;v.Parser=t;return new t})();o=n;return o})();var e=(function(r){var v={};var o=r;function n(x,y){return{left:x.charAt(2)==="~",right:y.charAt(y.length-3)==="~"}}v.stripFlags=n;function w(E,B,C,F,z,D){if(E.sexpr.id.original!==F.path.original){throw new o(E.sexpr.id.original+" doesn't match "+F.path.original,E)}var A=C&&C.program;var y={left:E.strip.left,right:F.strip.right,openStandalone:t(B.statements),closeStandalone:q((A||B).statements)};if(E.strip.right){s(B.statements,null,true)}if(A){var x=C.strip;if(x.left){u(B.statements,null,true)}if(x.right){s(A.statements,null,true)}if(F.strip.left){u(A.statements,null,true)}if(q(B.statements)&&t(A.statements)){u(B.statements);s(A.statements)}}else{if(F.strip.left){u(B.statements,null,true)}}if(z){return new this.BlockNode(E,A,B,y,D)}else{return new this.BlockNode(E,B,A,y,D)}}v.prepareBlock=w;function p(E,A){for(var D=0,B=E.length;D<B;D++){var F=E[D],x=F.strip;if(!x){continue}var z=q(E,D,A,F.type==="partial"),C=t(E,D,A),y=x.openStandalone&&z,H=x.closeStandalone&&C,G=x.inlineStandalone&&z&&C;if(x.right){s(E,D,true)}if(x.left){u(E,D,true)}if(G){s(E,D);if(u(E,D)){if(F.type==="partial"){F.indent=(/([ \t]+$)/).exec(E[D-1].original)?RegExp.$1:""}}}if(y){s((F.program||F.inverse).statements);u(E,D)}if(H){s(E,D);u((F.inverse||F.program).statements)}}return E}v.prepareProgram=p;function q(y,z,x){if(z===undefined){z=y.length}var B=y[z-1],A=y[z-2];if(!B){return x}if(B.type==="content"){return(A||!x?(/\r?\n\s*?$/):(/(^|\r?\n)\s*?$/)).test(B.original)}}function t(y,z,x){if(z===undefined){z=-1}var B=y[z+1],A=y[z+2];if(!B){return x}if(B.type==="content"){return(A||!x?(/^\s*?\r?\n/):(/^\s*?(\r?\n|$)/)).test(B.original)}}function s(y,A,x){var B=y[A==null?0:A+1];if(!B||B.type!=="content"||(!x&&B.rightStripped)){return}var z=B.string;B.string=B.string.replace(x?(/^\s+/):(/^[ \t]*\r?\n?/),"");B.rightStripped=B.string!==z}function u(y,A,x){var B=y[A==null?y.length-1:A-1];if(!B||B.type!=="content"||(!x&&B.leftStripped)){return}var z=B.string;B.string=B.string.replace(x?(/\s+$/):(/[ \t]+$/),"");B.leftStripped=B.string!==z;return B.leftStripped}return v})(d);var m=(function(u,x,o,q){var w={};var n=u;var r=x;var v=o;var t=q.extend;w.parser=n;var s={};t(s,v,r);function p(y){if(y.constructor===r.ProgramNode){return y}n.yy=s;return n.parse(y)}w.parse=p;return w})(b,j,e,l);var h=(function(r,w){var u={};var o=r;var p=w.isArray;var s=[].slice;function t(){}u.Compiler=t;t.prototype={compiler:t,equals:function(y){var x=this.opcodes.length;if(y.opcodes.length!==x){return false}for(var A=0;A<x;A++){var B=this.opcodes[A],z=y.opcodes[A];if(B.opcode!==z.opcode||!q(B.args,z.args)){return false}}x=this.children.length;for(A=0;A<x;A++){if(!this.children[A].equals(y.children[A])){return false}}return true},guid:0,compile:function(x,z){this.opcodes=[];this.children=[];this.depths={list:[]};this.options=z;this.stringParams=z.stringParams;this.trackIds=z.trackIds;var A=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true,lookup:true};if(A){for(var y in A){this.options.knownHelpers[y]=A[y]}}return this.accept(x)},accept:function(x){return this[x.type](x)},program:function(z){var y=z.statements;for(var A=0,x=y.length;A<x;A++){this.accept(y[A])}this.isSimple=x===1;this.depths.list=this.depths.list.sort(function(C,B){return C-B});return this},compileProgram:function(z){var x=new this.compiler().compile(z,this.options);var A=this.guid++,C;this.usePartial=this.usePartial||x.usePartial;this.children[A]=x;for(var B=0,y=x.depths.list.length;B<y;B++){C=x.depths.list[B];if(C<2){continue}else{this.addDepth(C-1)}}return A},block:function(C){var B=C.mustache,y=C.program,x=C.inverse;if(y){y=this.compileProgram(y)}if(x){x=this.compileProgram(x)}var A=B.sexpr;var z=this.classifySexpr(A);if(z==="helper"){this.helperSexpr(A,y,x)}else{if(z==="simple"){this.simpleSexpr(A);this.opcode("pushProgram",y);this.opcode("pushProgram",x);this.opcode("emptyHash");this.opcode("blockValue",A.id.original)}else{this.ambiguousSexpr(A,y,x);this.opcode("pushProgram",y);this.opcode("pushProgram",x);this.opcode("emptyHash");this.opcode("ambiguousBlockValue")}}this.opcode("append")},hash:function(A){var z=A.pairs,y,x;this.opcode("pushHash");for(y=0,x=z.length;y<x;y++){this.pushParam(z[y][1])}while(y--){this.opcode("assignToHash",z[y][0])}this.opcode("popHash")},partial:function(x){var y=x.partialName;this.usePartial=true;if(x.hash){this.accept(x.hash)}else{this.opcode("push","undefined")}if(x.context){this.accept(x.context)}else{this.opcode("getContext",0);this.opcode("pushContext")}this.opcode("invokePartial",y.name,x.indent||"");this.opcode("append")},content:function(x){if(x.string){this.opcode("appendContent",x.string)}},mustache:function(x){this.sexpr(x.sexpr);if(x.escaped&&!this.options.noEscape){this.opcode("appendEscaped")}else{this.opcode("append")}},ambiguousSexpr:function(B,z,y){var C=B.id,A=C.parts[0],x=z!=null||y!=null;this.opcode("getContext",C.depth);this.opcode("pushProgram",z);this.opcode("pushProgram",y);this.ID(C);this.opcode("invokeAmbiguous",A,x)},simpleSexpr:function(x){var y=x.id;if(y.type==="DATA"){this.DATA(y)}else{if(y.parts.length){this.ID(y)}else{this.addDepth(y.depth);this.opcode("getContext",y.depth);this.opcode("pushContext")}}this.opcode("resolvePossibleLambda")},helperSexpr:function(A,y,x){var B=this.setupFullMustacheParams(A,y,x),C=A.id,z=C.parts[0];if(this.options.knownHelpers[z]){this.opcode("invokeKnownHelper",B.length,z)}else{if(this.options.knownHelpersOnly){throw new o("You specified knownHelpersOnly, but used the unknown helper "+z,A)}else{C.falsy=true;this.ID(C);this.opcode("invokeHelper",B.length,C.original,C.isSimple)}}},sexpr:function(y){var x=this.classifySexpr(y);if(x==="simple"){this.simpleSexpr(y)}else{if(x==="helper"){this.helperSexpr(y)}else{this.ambiguousSexpr(y)}}},ID:function(y){this.addDepth(y.depth);this.opcode("getContext",y.depth);var x=y.parts[0];if(!x){this.opcode("pushContext")}else{this.opcode("lookupOnContext",y.parts,y.falsy,y.isScoped)}},DATA:function(x){this.options.data=true;this.opcode("lookupData",x.id.depth,x.id.parts)},STRING:function(x){this.opcode("pushString",x.string)},NUMBER:function(x){this.opcode("pushLiteral",x.number)},BOOLEAN:function(x){this.opcode("pushLiteral",x.bool)},comment:function(){},opcode:function(x){this.opcodes.push({opcode:x,args:s.call(arguments,1)})},addDepth:function(x){if(x===0){return}if(!this.depths[x]){this.depths[x]=true;this.depths.list.push(x)}},classifySexpr:function(A){var z=A.isHelper;var B=A.eligibleHelper;var y=this.options;if(B&&!z){var x=A.id.parts[0];if(y.knownHelpers[x]){z=true}else{if(y.knownHelpersOnly){B=false}}}if(z){return"helper"}else{if(B){return"ambiguous"}else{return"simple"}}},pushParams:function(z){for(var y=0,x=z.length;y<x;y++){this.pushParam(z[y])}},pushParam:function(x){if(this.stringParams){if(x.depth){this.addDepth(x.depth)}this.opcode("getContext",x.depth||0);this.opcode("pushStringParam",x.stringModeValue,x.type);if(x.type==="sexpr"){this.sexpr(x)}}else{if(this.trackIds){this.opcode("pushId",x.type,x.idName||x.stringModeValue)}this.accept(x)}},setupFullMustacheParams:function(z,y,x){var A=z.params;this.pushParams(A);this.opcode("pushProgram",y);this.opcode("pushProgram",x);if(z.hash){this.hash(z.hash)}else{this.opcode("emptyHash")}return A}};function n(z,A,B){if(z==null||(typeof z!=="string"&&z.constructor!==B.AST.ProgramNode)){throw new o("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+z)}A=A||{};if(!("data" in A)){A.data=true}if(A.compat){A.useDepths=true}var y=B.parse(z);var x=new B.Compiler().compile(y,A);return new B.JavaScriptCompiler().compile(x,A)}u.precompile=n;function v(x,z,A){if(x==null||(typeof x!=="string"&&x.constructor!==A.AST.ProgramNode)){throw new o("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+x)}z=z||{};if(!("data" in z)){z.data=true}if(z.compat){z.useDepths=true}var C;function B(){var F=A.parse(x);var E=new A.Compiler().compile(F,z);var D=new A.JavaScriptCompiler().compile(E,z,undefined,true);return A.template(D)}var y=function(E,D){if(!C){C=B()}return C.call(this,E,D)};y._setup=function(D){if(!C){C=B()}return C._setup(D)};y._child=function(D,E,F){if(!C){C=B()}return C._child(D,E,F)};return y}u.compile=v;function q(y,x){if(y===x){return true}if(p(y)&&p(x)&&y.length===x.length){for(var z=0;z<y.length;z++){if(!q(y[z],x[z])){return false}}return true}}return u})(d,l);var k=(function(u,x){var w;var n=u.COMPILER_REVISION;var r=u.REVISION_CHANGES;var s=x;function p(z){this.value=z}function y(){}y.prototype={nameLookup:function(A,z){if(y.isValidJavaScriptVariableName(z)){return A+"."+z}else{return A+"['"+z+"']"}},depthedLookup:function(z){this.aliases.lookup="this.lookup";return'lookup(depths, "'+z+'")'},compilerInfo:function(){var A=n,z=r[A];return[A,z]},appendToBuffer:function(z){if(this.environment.isSimple){return"return "+z+";"}else{return{appendToBuffer:true,content:z,toString:function(){return"buffer += "+z+";"}}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(C,J,z,F){this.environment=C;this.options=J;this.stringParams=this.options.stringParams;this.trackIds=this.options.trackIds;this.precompile=!F;this.name=this.environment.name;this.isChild=!!z;this.context=z||{programs:[],environments:[]};this.preamble();this.stackSlot=0;this.stackVars=[];this.aliases={};this.registers={list:[]};this.hashes=[];this.compileStack=[];this.inlineStack=[];this.compileChildren(C,J);this.useDepths=this.useDepths||C.depths.list.length||this.options.compat;var H=C.opcodes,D,E,B;for(E=0,B=H.length;E<B;E++){D=H[E];this[D.opcode].apply(this,D.args)}this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length){throw new s("Compile completed with content left on stack")}var I=this.createFunctionContext(F);if(!this.isChild){var G={compiler:this.compilerInfo(),main:I};var A=this.context.programs;for(E=0,B=A.length;E<B;E++){if(A[E]){G[E]=A[E]}}if(this.environment.usePartial){G.usePartial=true}if(this.options.data){G.useData=true}if(this.useDepths){G.useDepths=true}if(this.options.compat){G.compat=true}if(!F){G.compiler=JSON.stringify(G.compiler);G=this.objectLiteral(G)}return G}else{return I}},preamble:function(){this.lastContext=0;this.source=[]},createFunctionContext:function(A){var D="";var C=this.stackVars.concat(this.registers.list);if(C.length>0){D+=", "+C.join(", ")}for(var z in this.aliases){if(this.aliases.hasOwnProperty(z)){D+=", "+z+"="+this.aliases[z]}}var E=["depth0","helpers","partials","data"];if(this.useDepths){E.push("depths")}var B=this.mergeSource(D);if(A){E.push(B);return Function.apply(this,E)}else{return"function("+E.join(",")+") {\n  "+B+"}"}},mergeSource:function(G){var F="",C,D=!this.forceBuffer,A;for(var E=0,z=this.source.length;E<z;E++){var B=this.source[E];if(B.appendToBuffer){if(C){C=C+"\n    + "+B.content}else{C=B.content}}else{if(C){if(!F){A=true;F=C+";\n  "}else{F+="buffer += "+C+";\n  "}C=undefined}F+=B+"\n  ";if(!this.environment.isSimple){D=false}}}if(D){if(C||!F){F+="return "+(C||'""')+";\n"}}else{G+=", buffer = "+(A?"":this.initializeBuffer());if(C){F+="return buffer + "+C+";\n"}else{F+="return buffer;\n"}}if(G){F="var "+G.substring(2)+(A?"":";\n  ")+F}return F},blockValue:function(A){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var B=[this.contextName(0)];this.setupParams(A,0,B);var z=this.popStack();B.splice(1,0,z);this.push("blockHelperMissing.call("+B.join(", ")+")")},ambiguousBlockValue:function(){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var A=[this.contextName(0)];this.setupParams("",0,A,true);this.flushInline();var z=this.topStack();A.splice(1,0,z);this.pushSource("if (!"+this.lastHelper+") { "+z+" = blockHelperMissing.call("+A.join(", ")+"); }")},appendContent:function(z){if(this.pendingContent){z=this.pendingContent+z}this.pendingContent=z},append:function(){this.flushInline();var z=this.popStack();this.pushSource("if ("+z+" != null) { "+this.appendToBuffer(z)+" }");if(this.environment.isSimple){this.pushSource("else { "+this.appendToBuffer("''")+" }")}},appendEscaped:function(){this.aliases.escapeExpression="this.escapeExpression";this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(z){this.lastContext=z},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(C,B,D){var A=0,z=C.length;if(!D&&this.options.compat&&!this.lastContext){this.push(this.depthedLookup(C[A++]))}else{this.pushContext()}for(;A<z;A++){this.replaceStack(function(F){var E=this.nameLookup(F,C[A],"context");if(!B){return" != null ? "+E+" : "+F}else{return" && "+E}})}},lookupData:function(C,B){if(!C){this.pushStackLiteral("data")}else{this.pushStackLiteral("this.data(data, "+C+")")}var z=B.length;for(var A=0;A<z;A++){this.replaceStack(function(D){return" && "+this.nameLookup(D,B[A],"data")})}},resolvePossibleLambda:function(){this.aliases.lambda="this.lambda";this.push("lambda("+this.popStack()+", "+this.contextName(0)+")")},pushStringParam:function(z,A){this.pushContext();this.pushString(A);if(A!=="sexpr"){if(typeof z==="string"){this.pushString(z)}else{this.pushStackLiteral(z)}}},emptyHash:function(){this.pushStackLiteral("{}");if(this.trackIds){this.push("{}")}if(this.stringParams){this.push("{}");this.push("{}")}},pushHash:function(){if(this.hash){this.hashes.push(this.hash)}this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var z=this.hash;this.hash=this.hashes.pop();if(this.trackIds){this.push("{"+z.ids.join(",")+"}")}if(this.stringParams){this.push("{"+z.contexts.join(",")+"}");this.push("{"+z.types.join(",")+"}")}this.push("{\n    "+z.values.join(",\n    ")+"\n  }")},pushString:function(z){this.pushStackLiteral(this.quotedString(z))},push:function(z){this.inlineStack.push(z);return z},pushLiteral:function(z){this.pushStackLiteral(z)},pushProgram:function(z){if(z!=null){this.pushStackLiteral(this.programExpression(z))}else{this.pushStackLiteral(null)}},invokeHelper:function(D,z,B){this.aliases.helperMissing="helpers.helperMissing";var E=this.popStack();var A=this.setupHelper(D,z);var C=(B?A.name+" || ":"")+E+" || helperMissing";this.push("(("+C+").call("+A.callParams+"))")},invokeKnownHelper:function(B,z){var A=this.setupHelper(B,z);this.push(A.name+".call("+A.callParams+")")},invokeAmbiguous:function(z,C){this.aliases.functionType='"function"';this.aliases.helperMissing="helpers.helperMissing";this.useRegister("helper");var D=this.popStack();this.emptyHash();var A=this.setupHelper(0,z,C);var B=this.lastHelper=this.nameLookup("helpers",z,"helper");this.push("((helper = (helper = "+B+" || "+D+") != null ? helper : helperMissing"+(A.paramsInit?"),("+A.paramsInit:"")+"),(typeof helper === functionType ? helper.call("+A.callParams+") : helper))")},invokePartial:function(A,z){var B=[this.nameLookup("partials",A,"partial"),"'"+z+"'","'"+A+"'",this.popStack(),this.popStack(),"helpers","partials"];if(this.options.data){B.push("data")}else{if(this.options.compat){B.push("undefined")}}if(this.options.compat){B.push("depths")}this.push("this.invokePartial("+B.join(", ")+")")},assignToHash:function(A){var C=this.popStack(),z,B,E;if(this.trackIds){E=this.popStack()}if(this.stringParams){B=this.popStack();z=this.popStack()}var D=this.hash;if(z){D.contexts.push("'"+A+"': "+z)}if(B){D.types.push("'"+A+"': "+B)}if(E){D.ids.push("'"+A+"': "+E)}D.values.push("'"+A+"': ("+C+")")},pushId:function(A,z){if(A==="ID"||A==="DATA"){this.pushString(z)}else{if(A==="sexpr"){this.pushStackLiteral("true")}else{this.pushStackLiteral("null")}}},compiler:y,compileChildren:function(z,C){var E=z.children,G,F;for(var D=0,A=E.length;D<A;D++){G=E[D];F=new this.compiler();var B=this.matchExistingProgram(G);if(B==null){this.context.programs.push("");B=this.context.programs.length;G.index=B;G.name="program"+B;this.context.programs[B]=F.compile(G,C,this.context,!this.precompile);this.context.environments[B]=G;this.useDepths=this.useDepths||F.useDepths}else{G.index=B;G.name="program"+B}}},matchExistingProgram:function(C){for(var B=0,A=this.context.environments.length;B<A;B++){var z=this.context.environments[B];if(z&&z.equals(C)){return B}}},programExpression:function(z){var E=this.environment.children[z],D=E.depths.list,A=this.useDepths,C;var B=[E.index,"data"];if(A){B.push("depths")}return"this.program("+B.join(", ")+")"},useRegister:function(z){if(!this.registers[z]){this.registers[z]=true;this.registers.list.push(z)}},pushStackLiteral:function(z){return this.push(new p(z))},pushSource:function(z){if(this.pendingContent){this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent)));this.pendingContent=undefined}if(z){this.source.push(z)}},pushStack:function(A){this.flushInline();var z=this.incrStack();this.pushSource(z+" = "+A+";");this.compileStack.push(z);return z},replaceStack:function(G){var B="",C=this.isInline(),F,A,D;if(!this.isInline()){throw new s("replaceStack on non-inline")}var E=this.popStack(true);if(E instanceof p){B=F=E.value;D=true}else{A=!this.stackSlot;var z=!A?this.topStackName():this.incrStack();B="("+this.push(z)+" = "+E+")";F=this.topStack()}var H=G.call(this,F);if(!D){this.popStack()}if(A){this.stackSlot--}this.push("("+B+H+")")},incrStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var B=this.inlineStack;if(B.length){this.inlineStack=[];for(var A=0,z=B.length;A<z;A++){var C=B[A];if(C instanceof p){this.compileStack.push(C)}else{this.pushStack(C)}}}},isInline:function(){return this.inlineStack.length},popStack:function(z){var B=this.isInline(),A=(B?this.inlineStack:this.compileStack).pop();if(!z&&(A instanceof p)){return A.value}else{if(!B){if(!this.stackSlot){throw new s("Invalid stack pop")}this.stackSlot--}return A}},topStack:function(){var z=(this.isInline()?this.inlineStack:this.compileStack),A=z[z.length-1];if(A instanceof p){return A.value}else{return A}},contextName:function(z){if(this.useDepths&&z){return"depths["+z+"]"}else{return"depth"+z}},quotedString:function(z){return'"'+z.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(B){var A=[];for(var z in B){if(B.hasOwnProperty(z)){A.push(this.quotedString(z)+":"+B[z])}}return"{"+A.join(",")+"}"},setupHelper:function(D,B,A){var C=[],E=this.setupParams(B,D,C,A);var z=this.nameLookup("helpers",B,"helper");return{params:C,paramsInit:E,name:z,callParams:[this.contextName(0)].concat(C).join(", ")}},setupOptions:function(A,E,C){var J={},H=[],I=[],z=[],B,D,G;J.name=this.quotedString(A);J.hash=this.popStack();if(this.trackIds){J.hashIds=this.popStack()}if(this.stringParams){J.hashTypes=this.popStack();J.hashContexts=this.popStack()}D=this.popStack();G=this.popStack();if(G||D){if(!G){G="this.noop"}if(!D){D="this.noop"}J.fn=G;J.inverse=D}var F=E;while(F--){B=this.popStack();C[F]=B;if(this.trackIds){z[F]=this.popStack()}if(this.stringParams){I[F]=this.popStack();H[F]=this.popStack()}}if(this.trackIds){J.ids="["+z.join(",")+"]"}if(this.stringParams){J.types="["+I.join(",")+"]";J.contexts="["+H.join(",")+"]"}if(this.options.data){J.data="data"}return J},setupParams:function(B,D,C,A){var z=this.objectLiteral(this.setupOptions(B,D,C));if(A){this.useRegister("options");C.push("options");return"options="+z}else{C.push(z);return""}}};var o=("break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield").split(" ");var v=y.RESERVED_WORDS={};for(var t=0,q=o.length;t<q;t++){v[o[t]]=true}y.isValidJavaScriptVariableName=function(z){return !y.RESERVED_WORDS[z]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(z)};w=y;return w})(i,d);var c=(function(w,B,o,s,v){var y;var n=w;var u=B;var r=o.parser;var q=o.parse;var x=s.Compiler;var A=s.compile;var p=s.precompile;var C=v;var z=n.create;var t=function(){var D=z();D.compile=function(E,F){return A(E,F,D)};D.precompile=function(E,F){return p(E,F,D)};D.AST=u;D.Compiler=x;D.JavaScriptCompiler=C;D.Parser=r;D.parse=q;return D};n=t();n.create=t;n["default"]=n;y=n;return y})(f,j,m,h,k);return c}));M.define("/js/hotel/module/FestivalDateConfig",function(d,c,e){var a=d("xdate");var b={specific:[{year:2017,month:1,day:27,name:"除夕",shortName:"除夕"},{year:2017,month:1,day:28,name:"春节",shortName:"春节"},{year:2017,month:2,day:11,name:"元宵节",shortName:"元宵"},{year:2017,month:4,day:4,name:"清明",shortName:"清明"},{year:2017,month:5,day:30,name:"端午",shortName:"端午"},{year:2017,month:10,day:4,name:"中秋",shortName:"中秋"}],regular:[{month:1,day:1,name:"元旦",shortName:"元旦"},{month:2,day:14,name:"情人节",shortName:null},{month:5,day:1,name:"劳动节",shortName:"五一"},{month:10,day:1,name:"国庆",shortName:"国庆"},{month:12,day:25,name:"圣诞",shortName:"圣诞"}],getDateList:function(){var n=(new a()).getFullYear(),o=n+1,p=this.specific.slice(),m=[],h=[];for(var l=0;l<this.regular.length;l++){var f=this.regular[l];for(var k=0;k<p.length;k++){var g=p[k];if(g.day===f.day&&g.month===f.month&&(g.year===n||g.year===o)){p.splice(k,1)}}m.push(M.mix({},f,{year:n}));m.push(M.mix({},f,{year:o}))}h=p.concat(m);h.sort(function(j,i){if(j.year!==i.year){return j.year-i.year}if(j.month!==i.month){return j.month-i.month}return j.day-i.day});return h}};e.exports=b});
/*! jQuery UI - v1.11.3 - 2015-02-15
* http://jqueryui.com
* Includes: core.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(window.M&&typeof M.define==="function"){M.define("jqui-core",function(){return a(jQuery)})}else{a(jQuery)}}}(function(e){
/*!
 * jQuery UI Core 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
e.ui=e.ui||{};e.extend(e.ui,{version:"1.11.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});e.fn.extend({scrollParent:function(k){var j=this.css("position"),i=j==="absolute",l=k?/(auto|scroll|hidden)/:/(auto|scroll)/,m=this.parents().filter(function(){var n=e(this);if(i&&n.css("position")==="static"){return false}return l.test(n.css("overflow")+n.css("overflow-y")+n.css("overflow-x"))}).eq(0);return j==="fixed"||!m.length?e(this[0].ownerDocument||document):m},uniqueId:(function(){var i=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++i)}})}})(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){e(this).removeAttr("id")}})}});function g(k,i){var m,l,j,n=k.nodeName.toLowerCase();if("area"===n){m=k.parentNode;l=m.name;if(!k.href||!l||m.nodeName.toLowerCase()!=="map"){return false}j=e("img[usemap='#"+l+"']")[0];return !!j&&f(j)}return(/^(input|select|textarea|button|object)$/.test(n)?!k.disabled:"a"===n?k.href||i:i)&&f(k)}function f(i){return e.expr.filters.visible(i)&&!e(i).parents().addBack().filter(function(){return e.css(this,"visibility")==="hidden"}).length}e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(i){return function(j){return !!e.data(j,i)}}):function(l,k,j){return !!e.data(l,j[3])},focusable:function(i){return g(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(k){var i=e.attr(k,"tabindex"),j=isNaN(i);return(j||i>=0)&&g(k,!j)}});if(!e("<a>").outerWidth(1).jquery){e.each(["Width","Height"],function(l,j){var k=j==="Width"?["Left","Right"]:["Top","Bottom"],m=j.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};function n(q,p,i,r){e.each(k,function(){p-=parseFloat(e.css(q,"padding"+this))||0;if(i){p-=parseFloat(e.css(q,"border"+this+"Width"))||0}if(r){p-=parseFloat(e.css(q,"margin"+this))||0}});return p}e.fn["inner"+j]=function(i){if(i===undefined){return o["inner"+j].call(this)}return this.each(function(){e(this).css(m,n(this,i)+"px")})};e.fn["outer"+j]=function(i,p){if(typeof i!=="number"){return o["outer"+j].call(this,i)}return this.each(function(){e(this).css(m,n(this,i,true,p)+"px")})}})}if(!e.fn.addBack){e.fn.addBack=function(i){return this.add(i==null?this.prevObject:this.prevObject.filter(i))}}if(e("<a>").data("a-b","a").removeData("a-b").data("a-b")){e.fn.removeData=(function(i){return function(j){if(arguments.length){return i.call(this,e.camelCase(j))}else{return i.call(this)}}})(e.fn.removeData)}e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());e.fn.extend({focus:(function(i){return function(j,k){return typeof j==="number"?this.each(function(){var l=this;setTimeout(function(){e(l).focus();if(k){k.call(l)}},j)}):i.apply(this,arguments)}})(e.fn.focus),disableSelection:(function(){var i="onselectstart" in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(i+".ui-disableSelection",function(j){j.preventDefault()})}})(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(l){if(l!==undefined){return this.css("zIndex",l)}if(this.length){var j=e(this[0]),i,k;while(j.length&&j[0]!==document){i=j.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){k=parseInt(j.css("zIndex"),10);if(!isNaN(k)&&k!==0){return k}}j=j.parent()}}return 0}});e.ui.plugin={add:function(k,l,n){var j,m=e.ui[k].prototype;for(j in n){m.plugins[j]=m.plugins[j]||[];m.plugins[j].push([l,n[j]])}},call:function(j,m,l,k){var n,o=j.plugins[m];if(!o){return}if(!k&&(!j.element[0].parentNode||j.element[0].parentNode.nodeType===11)){return}for(n=0;n<o.length;n++){if(j.options[o[n][0]]){o[n][1].apply(j.element,l)}}}};
/*!
 * jQuery UI Widget 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
var h=0,b=Array.prototype.slice;e.cleanData=(function(i){return function(j){var l,m,k;for(k=0;(m=j[k])!=null;k++){try{l=e._data(m,"events");if(l&&l.remove){e(m).triggerHandler("remove")}}catch(n){}}i(j)}})(e.cleanData);e.widget=function(i,j,q){var n,o,l,p,k={},m=i.split(".")[0];i=i.split(".")[1];n=m+"-"+i;if(!q){q=j;j=e.Widget}e.expr[":"][n.toLowerCase()]=function(r){return !!e.data(r,n)};e[m]=e[m]||{};o=e[m][i];l=e[m][i]=function(r,s){if(!this._createWidget){return new l(r,s)}if(arguments.length){this._createWidget(r,s)}};e.extend(l,o,{version:q.version,_proto:e.extend({},q),_childConstructors:[]});p=new j();p.options=e.widget.extend({},p.options);e.each(q,function(s,r){if(!e.isFunction(r)){k[s]=r;return}k[s]=(function(){var t=function(){return j.prototype[s].apply(this,arguments)},u=function(v){return j.prototype[s].apply(this,v)};return function(){var x=this._super,v=this._superApply,w;this._super=t;this._superApply=u;w=r.apply(this,arguments);this._super=x;this._superApply=v;return w}})()});l.prototype=e.widget.extend(p,{widgetEventPrefix:o?(p.widgetEventPrefix||i):i},k,{constructor:l,namespace:m,widgetName:i,widgetFullName:n});if(o){e.each(o._childConstructors,function(s,t){var r=t.prototype;e.widget(r.namespace+"."+r.widgetName,l,t._proto)});delete o._childConstructors}else{j._childConstructors.push(l)}e.widget.bridge(i,l);return l};e.widget.extend=function(n){var j=b.call(arguments,1),m=0,i=j.length,k,l;for(;m<i;m++){for(k in j[m]){l=j[m][k];if(j[m].hasOwnProperty(k)&&l!==undefined){if(e.isPlainObject(l)){n[k]=e.isPlainObject(n[k])?e.widget.extend({},n[k],l):e.widget.extend({},l)}else{n[k]=l}}}}return n};e.widget.bridge=function(j,i){var k=i.prototype.widgetFullName||j;e.fn[j]=function(n){var l=typeof n==="string",m=b.call(arguments,1),o=this;if(l){this.each(function(){var q,p=e.data(this,k);if(n==="instance"){o=p;return false}if(!p){return e.error("cannot call methods on "+j+" prior to initialization; attempted to call method '"+n+"'")}if(!e.isFunction(p[n])||n.charAt(0)==="_"){return e.error("no such method '"+n+"' for "+j+" widget instance")}q=p[n].apply(p,m);if(q!==p&&q!==undefined){o=q&&q.jquery?o.pushStack(q.get()):q;return false}})}else{if(m.length){n=e.widget.extend.apply(null,[n].concat(m))}this.each(function(){var p=e.data(this,k);if(p){p.option(n||{});if(p._init){p._init()}}else{e.data(this,k,new i(n,this))}})}return o}};e.Widget=function(){};e.Widget._childConstructors=[];e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(i,j){j=e(j||this.defaultElement||this)[0];this.element=e(j);this.uuid=h++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=e();this.hoverable=e();this.focusable=e();if(j!==this){e.data(j,this.widgetFullName,this);this._on(true,this.element,{remove:function(k){if(k.target===j){this.destroy()}}});this.document=e(j.style?j.ownerDocument:j.document||j);this.window=e(this.document[0].defaultView||this.document[0].parentWindow)}this.options=e.widget.extend({},this.options,this._getCreateOptions(),i);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(m,n){var j=m,o,l,k;if(arguments.length===0){return e.widget.extend({},this.options)}if(typeof m==="string"){j={};o=m.split(".");m=o.shift();if(o.length){l=j[m]=e.widget.extend({},this.options[m]);for(k=0;k<o.length-1;k++){l[o[k]]=l[o[k]]||{};l=l[o[k]]}m=o.pop();if(arguments.length===1){return l[m]===undefined?null:l[m]}l[m]=n}else{if(arguments.length===1){return this.options[m]===undefined?null:this.options[m]}j[m]=n}}this._setOptions(j);return this},_setOptions:function(i){var j;for(j in i){this._setOption(j,i[j])}return this},_setOption:function(i,j){this.options[i]=j;if(i==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!j);if(j){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},_on:function(l,k,j){var m,i=this;if(typeof l!=="boolean"){j=k;k=l;l=false}if(!j){j=k;k=this.element;m=this.widget()}else{k=m=e(k);this.bindings=this.bindings.add(k)}e.each(j,function(s,r){function p(){if(!l&&(i.options.disabled===true||e(this).hasClass("ui-state-disabled"))){return}return(typeof r==="string"?i[r]:r).apply(i,arguments)}if(typeof r!=="string"){p.guid=r.guid=r.guid||p.guid||e.guid++}var q=s.match(/^([\w:-]*)\s*(.*)$/),o=q[1]+i.eventNamespace,n=q[2];if(n){m.delegate(n,o,p)}else{k.bind(o,p)}})},_off:function(j,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;j.unbind(i).undelegate(i);this.bindings=e(this.bindings.not(j).get());this.focusable=e(this.focusable.not(j).get());this.hoverable=e(this.hoverable.not(j).get())},_delay:function(l,k){function j(){return(typeof l==="string"?i[l]:l).apply(i,arguments)}var i=this;return setTimeout(j,k||0)},_hoverable:function(i){this.hoverable=this.hoverable.add(i);this._on(i,{mouseenter:function(j){e(j.currentTarget).addClass("ui-state-hover")},mouseleave:function(j){e(j.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(i){this.focusable=this.focusable.add(i);this._on(i,{focusin:function(j){e(j.currentTarget).addClass("ui-state-focus")},focusout:function(j){e(j.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(i,j,k){var n,m,l=this.options[i];k=k||{};j=e.Event(j);j.type=(i===this.widgetEventPrefix?i:this.widgetEventPrefix+i).toLowerCase();j.target=this.element[0];m=j.originalEvent;if(m){for(n in m){if(!(n in j)){j[n]=m[n]}}}this.element.trigger(j,k);return !(e.isFunction(l)&&l.apply(this.element[0],[j].concat(k))===false||j.isDefaultPrevented())}};e.each({show:"fadeIn",hide:"fadeOut"},function(j,i){e.Widget.prototype["_"+j]=function(m,l,o){if(typeof l==="string"){l={effect:l}}var n,k=!l?j:l===true||typeof l==="number"?i:l.effect||i;l=l||{};if(typeof l==="number"){l={duration:l}}n=!e.isEmptyObject(l);l.complete=o;if(l.delay){m.delay(l.delay)}if(n&&e.effects&&e.effects.effect[k]){m[j](l)}else{if(k!==j&&m[k]){m[k](l.duration,l.easing,o)}else{m.queue(function(p){e(this)[j]();if(o){o.call(m[0])}p()})}}}});var d=e.widget;
/*!
 * jQuery UI Mouse 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 */
var a=false;e(document).mouseup(function(){a=false});var c=e.widget("ui.mouse",{version:"1.11.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var i=this;this.element.bind("mousedown."+this.widgetName,function(j){return i._mouseDown(j)}).bind("click."+this.widgetName,function(j){if(true===e.data(j.target,i.widgetName+".preventClickEvent")){e.removeData(j.target,i.widgetName+".preventClickEvent");j.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(k){if(a){return}this._mouseMoved=false;(this._mouseStarted&&this._mouseUp(k));this._mouseDownEvent=k;var j=this,l=(k.which===1),i=(typeof this.options.cancel==="string"&&k.target.nodeName?e(k.target).closest(this.options.cancel).length:false);if(!l||i||!this._mouseCapture(k)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){j.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(k)&&this._mouseDelayMet(k)){this._mouseStarted=(this._mouseStart(k)!==false);if(!this._mouseStarted){k.preventDefault();return true}}if(true===e.data(k.target,this.widgetName+".preventClickEvent")){e.removeData(k.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(m){return j._mouseMove(m)};this._mouseUpDelegate=function(m){return j._mouseUp(m)};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);k.preventDefault();a=true;return true},_mouseMove:function(i){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!i.button){return this._mouseUp(i)}else{if(!i.which){return this._mouseUp(i)}}}if(i.which||i.button){this._mouseMoved=true}if(this._mouseStarted){this._mouseDrag(i);return i.preventDefault()}if(this._mouseDistanceMet(i)&&this._mouseDelayMet(i)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,i)!==false);(this._mouseStarted?this._mouseDrag(i):this._mouseUp(i))}return !this._mouseStarted},_mouseUp:function(i){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(i.target===this._mouseDownEvent.target){e.data(i.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(i)}a=false;return false},_mouseDistanceMet:function(i){return(Math.max(Math.abs(this._mouseDownEvent.pageX-i.pageX),Math.abs(this._mouseDownEvent.pageY-i.pageY))>=this.options.distance)},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})}));
/*!
 * jQuery UI Datepicker 1.11.3
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/datepicker/
 */
M.define("jqui-datepicker",function(d){d("jqui-core");$.extend($.ui,{datepicker:{version:"1.11.3"}});var g;function h(j){var i,k;while(j.length&&j[0]!==document){i=j.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){k=parseInt(j.css("zIndex"),10);if(!isNaN(k)&&k!==0){return k}}j=j.parent()}return 0}function c(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",renderDay:null,beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.regional.en=$.extend(true,{},this.regional[""]);this.regional["en-US"]=$.extend(true,{},this.regional.en);this.dpDiv=b($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}$.extend(c.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(i){a(this._defaults,i||{});return this},_attachDatepicker:function(l,i){var m,k,j;m=l.nodeName.toLowerCase();k=(m==="div"||m==="span");if(!l.id){this.uuid+=1;l.id="dp"+this.uuid}j=this._newInst($(l),k);j.settings=$.extend({},i||{});if(m==="input"){this._connectDatepicker(l,j)}else{if(k){this._inlineDatepicker(l,j)}}},_newInst:function(j,i){var k=j[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:k,input:j,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:(!i?this.dpDiv:b($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")))}},_connectDatepicker:function(k,j){var i=$(k);j.append=$([]);j.trigger=$([]);if(i.hasClass(this.markerClassName)){return}this._attachments(i,j);i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);this._autoSize(j);$.data(k,"datepicker",j);if(j.settings.disabled){this._disableDatepicker(k)}},_attachments:function(k,n){var j,m,i,o=this._get(n,"appendText"),l=this._get(n,"isRTL");if(n.append){n.append.remove()}if(o){n.append=$("<span class='"+this._appendClass+"'>"+o+"</span>");k[l?"before":"after"](n.append)}k.unbind("focus",this._showDatepicker);if(n.trigger){n.trigger.remove()}j=this._get(n,"showOn");if(j==="focus"||j==="both"){k.focus(this._showDatepicker)}if(j==="button"||j==="both"){m=this._get(n,"buttonText");i=this._get(n,"buttonImage");n.trigger=$(this._get(n,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:i,alt:m,title:m}):$("<button type='button'></button>").addClass(this._triggerClass).html(!i?m:$("<img/>").attr({src:i,alt:m,title:m})));k[l?"before":"after"](n.trigger);n.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput===k[0]){$.datepicker._hideDatepicker()}else{if($.datepicker._datepickerShowing&&$.datepicker._lastInput!==k[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(k[0])}else{$.datepicker._showDatepicker(k[0])}}return false})}},_autoSize:function(p){if(this._get(p,"autoSize")&&!p.inline){var m,k,l,o,n=new Date(2009,12-1,20),j=this._get(p,"dateFormat");if(j.match(/[DM]/)){m=function(i){k=0;l=0;for(o=0;o<i.length;o++){if(i[o].length>k){k=i[o].length;l=o}}return l};n.setMonth(m(this._get(p,(j.match(/MM/)?"monthNames":"monthNamesShort"))));n.setDate(m(this._get(p,(j.match(/DD/)?"dayNames":"dayNamesShort")))+20-n.getDay())}p.input.attr("size",this._formatDate(p,n).length)}},_inlineDatepicker:function(j,i){var k=$(j);if(k.hasClass(this.markerClassName)){return}k.addClass(this.markerClassName).append(i.dpDiv);$.data(j,"datepicker",i);this._setDate(i,this._getDefaultDate(i),true);this._updateDatepicker(i);this._updateAlternate(i);if(i.settings.disabled){this._disableDatepicker(j)}i.dpDiv.css("display","block")},_dialogDatepicker:function(p,j,n,k,o){var i,s,m,r,q,l=this._dialogInst;if(!l){this.uuid+=1;i="dp"+this.uuid;this._dialogInput=$("<input type='text' id='"+i+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);l=this._dialogInst=this._newInst(this._dialogInput,false);l.settings={};$.data(this._dialogInput[0],"datepicker",l)}a(l.settings,k||{});j=(j&&j.constructor===Date?this._formatDate(l,j):j);this._dialogInput.val(j);this._pos=(o?(o.length?o:[o.pageX,o.pageY]):null);if(!this._pos){s=document.documentElement.clientWidth;m=document.documentElement.clientHeight;r=document.documentElement.scrollLeft||document.body.scrollLeft;q=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(s/2)-100+r,(m/2)-150+q]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");l.settings.onSelect=n;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],"datepicker",l);return this},_destroyDatepicker:function(k){var l,i=$(k),j=$.data(k,"datepicker");if(!i.hasClass(this.markerClassName)){return}l=k.nodeName.toLowerCase();$.removeData(k,"datepicker");if(l==="input"){j.append.remove();j.trigger.remove();i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(l==="div"||l==="span"){i.removeClass(this.markerClassName).empty()}}if(g===j){g=null}},_enableDatepicker:function(l){var m,k,i=$(l),j=$.data(l,"datepicker");if(!i.hasClass(this.markerClassName)){return}m=l.nodeName.toLowerCase();if(m==="input"){l.disabled=false;j.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(m==="div"||m==="span"){k=i.children("."+this._inlineClass);k.children().removeClass("ui-state-disabled");k.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false)}}this._disabledInputs=$.map(this._disabledInputs,function(n){return(n===l?null:n)})},_disableDatepicker:function(l){var m,k,i=$(l),j=$.data(l,"datepicker");if(!i.hasClass(this.markerClassName)){return}m=l.nodeName.toLowerCase();if(m==="input"){l.disabled=true;j.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(m==="div"||m==="span"){k=i.children("."+this._inlineClass);k.children().addClass("ui-state-disabled");k.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true)}}this._disabledInputs=$.map(this._disabledInputs,function(n){return(n===l?null:n)});this._disabledInputs[this._disabledInputs.length]=l},_isDisabledDatepicker:function(k){if(!k){return false}for(var j=0;j<this._disabledInputs.length;j++){if(this._disabledInputs[j]===k){return true}}return false},_getInst:function(j){try{return $.data(j,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(o,j,n){var k,i,m,p,l=this._getInst(o);if(arguments.length===2&&typeof j==="string"){return(j==="defaults"?$.extend({},$.datepicker._defaults):(l?(j==="all"?$.extend({},l.settings):this._get(l,j)):null))}k=j||{};if(typeof j==="string"){k={};k[j]=n}if(l){if(this._curInst===l){this._hideDatepicker()}i=this._getDateDatepicker(o,true);m=this._getMinMaxDate(l,"min");p=this._getMinMaxDate(l,"max");a(l.settings,k);if(m!==null&&k.dateFormat!==undefined&&k.minDate===undefined){l.settings.minDate=this._formatDate(l,m)}if(p!==null&&k.dateFormat!==undefined&&k.maxDate===undefined){l.settings.maxDate=this._formatDate(l,p)}if("disabled" in k){if(k.disabled){this._disableDatepicker(o)}else{this._enableDatepicker(o)}}this._attachments($(o),l);this._autoSize(l);this._setDate(l,i);this._updateAlternate(l);this._updateDatepicker(l)}},_changeDatepicker:function(k,i,j){this._optionDatepicker(k,i,j)},_refreshDatepicker:function(j){var i=this._getInst(j);if(i){this._updateDatepicker(i)}},_setDateDatepicker:function(k,i){var j=this._getInst(k);if(j){this._setDate(j,i);this._updateDatepicker(j);this._updateAlternate(j)}},_getDateDatepicker:function(k,i){var j=this._getInst(k);if(j&&!j.inline){this._setDateFromField(j,i)}return(j?this._getDate(j):null)},_doKeyDown:function(l){var j,i,n,m=$.datepicker._getInst(l.target),o=true,k=m.dpDiv.is(".ui-datepicker-rtl");m._keyEvent=true;if($.datepicker._datepickerShowing){switch(l.keyCode){case 9:$.datepicker._hideDatepicker();o=false;break;case 13:n=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",m.dpDiv);if(n[0]){$.datepicker._selectDay(l.target,m.selectedMonth,m.selectedYear,n[0])}j=$.datepicker._get(m,"onSelect");if(j){i=$.datepicker._formatDate(m);j.apply((m.input?m.input[0]:null),[i,m])}else{$.datepicker._hideDatepicker()}return false;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(l.target,(l.ctrlKey?-$.datepicker._get(m,"stepBigMonths"):-$.datepicker._get(m,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(l.target,(l.ctrlKey?+$.datepicker._get(m,"stepBigMonths"):+$.datepicker._get(m,"stepMonths")),"M");break;case 35:if(l.ctrlKey||l.metaKey){$.datepicker._clearDate(l.target)}o=l.ctrlKey||l.metaKey;break;case 36:if(l.ctrlKey||l.metaKey){$.datepicker._gotoToday(l.target)}o=l.ctrlKey||l.metaKey;break;case 37:if(l.ctrlKey||l.metaKey){$.datepicker._adjustDate(l.target,(k?+1:-1),"D")}o=l.ctrlKey||l.metaKey;if(l.originalEvent.altKey){$.datepicker._adjustDate(l.target,(l.ctrlKey?-$.datepicker._get(m,"stepBigMonths"):-$.datepicker._get(m,"stepMonths")),"M")}break;case 38:if(l.ctrlKey||l.metaKey){$.datepicker._adjustDate(l.target,-7,"D")}o=l.ctrlKey||l.metaKey;break;case 39:if(l.ctrlKey||l.metaKey){$.datepicker._adjustDate(l.target,(k?-1:+1),"D")}o=l.ctrlKey||l.metaKey;if(l.originalEvent.altKey){$.datepicker._adjustDate(l.target,(l.ctrlKey?+$.datepicker._get(m,"stepBigMonths"):+$.datepicker._get(m,"stepMonths")),"M")}break;case 40:if(l.ctrlKey||l.metaKey){$.datepicker._adjustDate(l.target,+7,"D")}o=l.ctrlKey||l.metaKey;break;default:o=false}}else{if(l.keyCode===36&&l.ctrlKey){$.datepicker._showDatepicker(this)}else{o=false}}if(o){l.preventDefault();l.stopPropagation()}},_doKeyPress:function(k){var j,i,l=$.datepicker._getInst(k.target);if($.datepicker._get(l,"constrainInput")){j=$.datepicker._possibleChars($.datepicker._get(l,"dateFormat"));i=String.fromCharCode(k.charCode==null?k.keyCode:k.charCode);return k.ctrlKey||k.metaKey||(i<" "||!j||j.indexOf(i)>-1)}},_doKeyUp:function(k){var i,l=$.datepicker._getInst(k.target);if(l.input.val()!==l.lastVal){try{i=$.datepicker.parseDate($.datepicker._get(l,"dateFormat"),(l.input?l.input.val():null),$.datepicker._getFormatConfig(l));if(i){$.datepicker._setDateFromField(l);$.datepicker._updateAlternate(l);$.datepicker._updateDatepicker(l)}}catch(j){}}return true},_showDatepicker:function(j){j=j.target||j;if(j.nodeName.toLowerCase()!=="input"){j=$("input",j.parentNode)[0]}if($.datepicker._isDisabledDatepicker(j)||$.datepicker._lastInput===j){return}var l,p,k,n,o,i,m;l=$.datepicker._getInst(j);if($.datepicker._curInst&&$.datepicker._curInst!==l){$.datepicker._curInst.dpDiv.stop(true,true);if(l&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0])}}p=$.datepicker._get(l,"beforeShow");k=p?p.apply(j,[j,l]):{};if(k===false){return}a(l.settings,k);l.lastVal=null;$.datepicker._lastInput=j;$.datepicker._setDateFromField(l);if($.datepicker._inDialog){j.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(j);$.datepicker._pos[1]+=j.offsetHeight}n=false;$(j).parents().each(function(){n|=$(this).css("position")==="fixed";return !n});o={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;l.dpDiv.empty();l.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(l);o=$.datepicker._checkOffset(l,o,n);l.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(n?"fixed":"absolute")),display:"none",left:o.left+"px",top:o.top+"px"});if(!l.inline){i=$.datepicker._get(l,"showAnim");m=$.datepicker._get(l,"duration");l.dpDiv.css("z-index",h($(j))+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects.effect[i]){l.dpDiv.show(i,$.datepicker._get(l,"showOptions"),m)}else{l.dpDiv[i||"show"](i?m:null)}if($.datepicker._shouldFocusInput(l)){l.input.focus()}$.datepicker._curInst=l}},_updateDatepicker:function(l){this.maxRows=4;g=l;l.dpDiv.empty().append(this._generateHTML(l));this._attachHandlers(l);var n,i=this._getNumberOfMonths(l),m=i[1],k=17,j=l.dpDiv.find("."+this._dayOverClass+" a");if(j.length>0){f.apply(j.get(0))}l.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(m>1){l.dpDiv.addClass("ui-datepicker-multi-"+m).css("width",(k*m)+"em")}l.dpDiv[(i[0]!==1||i[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");l.dpDiv[(this._get(l,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(l===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(l)){l.input.focus()}if(l.yearshtml){n=l.yearshtml;setTimeout(function(){if(n===l.yearshtml&&l.yearshtml){l.dpDiv.find("select.ui-datepicker-year:first").replaceWith(l.yearshtml)}n=l.yearshtml=null},0)}},_shouldFocusInput:function(i){return i.input&&i.input.is(":visible")&&!i.input.is(":disabled")&&!i.input.is(":focus")},_checkOffset:function(n,l,k){var m=n.dpDiv.outerWidth(),q=n.dpDiv.outerHeight(),p=n.input?n.input.outerWidth():0,i=n.input?n.input.outerHeight():0,o=document.documentElement.clientWidth+(k?0:$(document).scrollLeft()),j=document.documentElement.clientHeight+(k?0:$(document).scrollTop());l.left-=(this._get(n,"isRTL")?(m-p):0);l.left-=(k&&l.left===n.input.offset().left)?$(document).scrollLeft():0;l.top-=(k&&l.top===(n.input.offset().top+i))?$(document).scrollTop():0;l.left-=Math.min(l.left,(l.left+m>o&&o>m)?Math.abs(l.left+m-o):0);l.top-=Math.min(l.top,(l.top+q>j&&j>q)?Math.abs(q+i):0);return l},_findPos:function(l){var i,k=this._getInst(l),j=this._get(k,"isRTL");while(l&&(l.type==="hidden"||l.nodeType!==1||$.expr.filters.hidden(l))){l=l[j?"previousSibling":"nextSibling"]}i=$(l).offset();return[i.left,i.top]},_hideDatepicker:function(k){var j,n,m,i,l=this._curInst;if(!l||(k&&l!==$.data(k,"datepicker"))){return}if(this._datepickerShowing){j=this._get(l,"showAnim");n=this._get(l,"duration");m=function(){$.datepicker._tidyDialog(l)};if($.effects&&($.effects.effect[j]||$.effects[j])){l.dpDiv.hide(j,$.datepicker._get(l,"showOptions"),n,m)}else{l.dpDiv[(j==="slideDown"?"slideUp":(j==="fadeIn"?"fadeOut":"hide"))]((j?n:null),m)}if(!j){m()}this._datepickerShowing=false;i=this._get(l,"onClose");if(i){i.apply((l.input?l.input[0]:null),[(l.input?l.input.val():""),l])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(i){i.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(j){if(!$.datepicker._curInst){return}var i=$(j.target),k=$.datepicker._getInst(i[0]);if(((i[0].id!==$.datepicker._mainDivId&&i.parents("#"+$.datepicker._mainDivId).length===0&&!i.hasClass($.datepicker.markerClassName)&&!i.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||(i.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==k)){$.datepicker._hideDatepicker()}},_adjustDate:function(m,l,k){var j=$(m),i=this._getInst(j[0]);if(this._isDisabledDatepicker(j[0])){return}this._adjustInstDate(i,l+(k==="M"?this._get(i,"showCurrentAtPos"):0),k);this._updateDatepicker(i)},_gotoToday:function(l){var i,k=$(l),j=this._getInst(k[0]);if(this._get(j,"gotoCurrent")&&j.currentDay){j.selectedDay=j.currentDay;j.drawMonth=j.selectedMonth=j.currentMonth;j.drawYear=j.selectedYear=j.currentYear}else{i=new Date();j.selectedDay=i.getDate();j.drawMonth=j.selectedMonth=i.getMonth();j.drawYear=j.selectedYear=i.getFullYear()}this._notifyChange(j);this._adjustDate(k)},_selectMonthYear:function(m,i,l){var k=$(m),j=this._getInst(k[0]);j["selected"+(l==="M"?"Month":"Year")]=j["draw"+(l==="M"?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10);this._notifyChange(j);this._adjustDate(k)},_selectDay:function(n,l,i,m){var j,k=$(n);if($(m).hasClass(this._unselectableClass)||this._isDisabledDatepicker(k[0])){return}j=this._getInst(k[0]);j.selectedDay=j.currentDay=$(m).data("date");j.selectedMonth=j.currentMonth=l;j.selectedYear=j.currentYear=i;this._selectDate(n,this._formatDate(j,j.currentDay,j.currentMonth,j.currentYear))},_clearDate:function(j){var i=$(j);this._selectDate(i,"")},_selectDate:function(m,i){var j,l=$(m),k=this._getInst(l[0]);i=(i!=null?i:this._formatDate(k));if(k.input){k.input.val(i)}this._updateAlternate(k);j=this._get(k,"onSelect");if(j){j.apply((k.input?k.input[0]:null),[i,k])}else{if(k.input){k.input.trigger("change")}}if(k.inline){this._updateDatepicker(k)}else{this._hideDatepicker();this._lastInput=k.input[0];if(typeof(k.input[0])!=="object"){k.input.focus()}this._lastInput=null}},_updateAlternate:function(m){var l,k,i,j=this._get(m,"altField");if(j){l=this._get(m,"altFormat")||this._get(m,"dateFormat");k=this._getDate(m);i=this.formatDate(l,k,this._getFormatConfig(m));$(j).each(function(){$(this).val(i)})}},noWeekends:function(j){var i=j.getDay();return[(i>0&&i<6),""]},iso8601Week:function(i){var j,k=new Date(i.getTime());k.setDate(k.getDate()+4-(k.getDay()||7));j=k.getTime();k.setMonth(0);k.setDate(1);return Math.floor(Math.round((j-k)/86400000)/7)+1},parseDate:function(y,t,A){if(y==null||t==null){throw"Invalid arguments"}t=(typeof t==="object"?t.toString():t+"");if(t===""){return null}var l,v,j,z=0,o=(A?A.shortYearCutoff:null)||this._defaults.shortYearCutoff,k=(typeof o!=="string"?o:new Date().getFullYear()%100+parseInt(o,10)),r=(A?A.dayNamesShort:null)||this._defaults.dayNamesShort,C=(A?A.dayNames:null)||this._defaults.dayNames,i=(A?A.monthNamesShort:null)||this._defaults.monthNamesShort,m=(A?A.monthNames:null)||this._defaults.monthNames,n=-1,D=-1,x=-1,q=-1,w=false,B,s=function(F){var G=(l+1<y.length&&y.charAt(l+1)===F);if(G){l++}return G},E=function(H){var F=s(H),I=(H==="@"?14:(H==="!"?20:(H==="y"&&F?4:(H==="o"?3:2)))),K=(H==="y"?I:1),J=new RegExp("^\\d{"+K+","+I+"}"),G=t.substring(z).match(J);if(!G){throw"Missing number at position "+z}z+=G[0].length;return parseInt(G[0],10)},p=function(G,H,J){var F=-1,I=$.map(s(G)?J:H,function(N,K){return[[K,N]]}).sort(function(N,K){return -(N[1].length-K[1].length)});$.each(I,function(N,O){var K=O[1];if(t.substr(z,K.length).toLowerCase()===K.toLowerCase()){F=O[0];z+=K.length;return false}});if(F!==-1){return F+1}else{throw"Unknown name at position "+z}},u=function(){if(t.charAt(z)!==y.charAt(l)){throw"Unexpected literal at position "+z}z++};for(l=0;l<y.length;l++){if(w){if(y.charAt(l)==="'"&&!s("'")){w=false}else{u()}}else{switch(y.charAt(l)){case"d":x=E("d");break;case"D":p("D",r,C);break;case"o":q=E("o");break;case"m":D=E("m");break;case"M":D=p("M",i,m);break;case"y":n=E("y");break;case"@":B=new Date(E("@"));n=B.getFullYear();D=B.getMonth()+1;x=B.getDate();break;case"!":B=new Date((E("!")-this._ticksTo1970)/10000);n=B.getFullYear();D=B.getMonth()+1;x=B.getDate();break;case"'":if(s("'")){u()}else{w=true}break;default:u()}}}if(z<t.length){j=t.substr(z);if(!/^\s+/.test(j)){throw"Extra/unparsed characters found in date: "+j}}if(n===-1){n=new Date().getFullYear()}else{if(n<100){n+=new Date().getFullYear()-new Date().getFullYear()%100+(n<=k?0:-100)}}if(q>-1){D=1;x=q;do{v=this._getDaysInMonth(n,D-1);if(x<=v){break}D++;x-=v}while(true)}B=this._daylightSavingAdjust(new Date(n,D-1,x));if(B.getFullYear()!==n||B.getMonth()+1!==D||B.getDate()!==x){throw"Invalid date"}return B},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(r,l,m){if(!l){return""}var t,u=(m?m.dayNamesShort:null)||this._defaults.dayNamesShort,j=(m?m.dayNames:null)||this._defaults.dayNames,p=(m?m.monthNamesShort:null)||this._defaults.monthNamesShort,n=(m?m.monthNames:null)||this._defaults.monthNames,s=function(v){var w=(t+1<r.length&&r.charAt(t+1)===v);if(w){t++}return w},i=function(x,y,v){var w=""+y;if(s(x)){while(w.length<v){w="0"+w}}return w},o=function(v,x,w,y){return(s(v)?y[x]:w[x])},k="",q=false;if(l){for(t=0;t<r.length;t++){if(q){if(r.charAt(t)==="'"&&!s("'")){q=false}else{k+=r.charAt(t)}}else{switch(r.charAt(t)){case"d":k+=i("d",l.getDate(),2);break;case"D":k+=o("D",l.getDay(),u,j);break;case"o":k+=i("o",Math.round((new Date(l.getFullYear(),l.getMonth(),l.getDate()).getTime()-new Date(l.getFullYear(),0,0).getTime())/86400000),3);break;case"m":k+=i("m",l.getMonth()+1,2);break;case"M":k+=o("M",l.getMonth(),p,n);break;case"y":k+=(s("y")?l.getFullYear():(l.getYear()%100<10?"0":"")+l.getYear()%100);break;case"@":k+=l.getTime();break;case"!":k+=l.getTime()*10000+this._ticksTo1970;break;case"'":if(s("'")){k+="'"}else{q=true}break;default:k+=r.charAt(t)}}}}return k},_possibleChars:function(m){var l,k="",j=false,i=function(n){var o=(l+1<m.length&&m.charAt(l+1)===n);if(o){l++}return o};for(l=0;l<m.length;l++){if(j){if(m.charAt(l)==="'"&&!i("'")){j=false}else{k+=m.charAt(l)}}else{switch(m.charAt(l)){case"d":case"m":case"y":case"@":k+="0123456789";break;case"D":case"M":return null;case"'":if(i("'")){k+="'"}else{j=true}break;default:k+=m.charAt(l)}}}return k},_get:function(j,i){return j.settings[i]!==undefined?j.settings[i]:this._defaults[i]},_setDateFromField:function(n,k){if(n.input.val()===n.lastVal){return}var i=this._get(n,"dateFormat"),p=n.lastVal=n.input?n.input.val():null,o=this._getDefaultDate(n),j=o,l=this._getFormatConfig(n);try{j=this.parseDate(i,p,l)||o}catch(m){p=(k?"":p)}n.selectedDay=j.getDate();n.drawMonth=n.selectedMonth=j.getMonth();n.drawYear=n.selectedYear=j.getFullYear();n.currentDay=(p?j.getDate():0);n.currentMonth=(p?j.getMonth():0);n.currentYear=(p?j.getFullYear():0);this._adjustInstDate(n)},_getDefaultDate:function(i){return this._restrictMinMax(i,this._determineDate(i,this._get(i,"defaultDate"),new Date()))},_determineDate:function(m,j,n){var l=function(p){var o=new Date();o.setDate(o.getDate()+p);return o},k=function(v){try{return $.datepicker.parseDate($.datepicker._get(m,"dateFormat"),v,$.datepicker._getFormatConfig(m))}catch(u){}var p=(v.toLowerCase().match(/^c/)?$.datepicker._getDate(m):null)||new Date(),q=p.getFullYear(),t=p.getMonth(),o=p.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,r=s.exec(v);while(r){switch(r[2]||"d"){case"d":case"D":o+=parseInt(r[1],10);break;case"w":case"W":o+=parseInt(r[1],10)*7;break;case"m":case"M":t+=parseInt(r[1],10);o=Math.min(o,$.datepicker._getDaysInMonth(q,t));break;case"y":case"Y":q+=parseInt(r[1],10);o=Math.min(o,$.datepicker._getDaysInMonth(q,t));break}r=s.exec(v)}return new Date(q,t,o)},i=(j==null||j===""?n:(typeof j==="string"?k(j):(typeof j==="number"?(isNaN(j)?n:l(j)):new Date(j.getTime()))));i=(i&&i.toString()==="Invalid Date"?n:i);if(i){i.setHours(0);i.setMinutes(0);i.setSeconds(0);i.setMilliseconds(0)}return this._daylightSavingAdjust(i)},_daylightSavingAdjust:function(i){if(!i){return null}i.setHours(i.getHours()>12?i.getHours()+2:0);return i},_setDate:function(o,l,n){var i=!l,k=o.selectedMonth,m=o.selectedYear,j=this._restrictMinMax(o,this._determineDate(o,l,new Date()));o.selectedDay=o.currentDay=j.getDate();o.drawMonth=o.selectedMonth=o.currentMonth=j.getMonth();o.drawYear=o.selectedYear=o.currentYear=j.getFullYear();if((k!==o.selectedMonth||m!==o.selectedYear)&&!n){this._notifyChange(o)}this._adjustInstDate(o);if(o.input){o.input.val(i?"":this._formatDate(o))}},_getDate:function(j){var i=(!j.currentYear||(j.input&&j.input.val()==="")?null:this._daylightSavingAdjust(new Date(j.currentYear,j.currentMonth,j.currentDay)));return i},_attachHandlers:function(j){var i=this._get(j,"stepMonths"),k="#"+j.id.replace(/\\\\/g,"\\");j.dpDiv.find("[data-handler]").map(function(){var l={prev:function(){$.datepicker._adjustDate(k,-i,"M")},next:function(){$.datepicker._adjustDate(k,+i,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(k)},selectDay:function(){$.datepicker._selectDay(k,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){$.datepicker._selectMonthYear(k,this,"M");return false},selectYear:function(){$.datepicker._selectMonthYear(k,this,"Y");return false}};$(this).bind(this.getAttribute("data-event"),l[this.getAttribute("data-handler")])})},_generateHTML:function(aa){var B,A,V,N,m,af,Y,R,ai,J,am,t,v,u,j,ae,ad,r,E,ah,T,an,D,I,s,n,W,P,S,Q,q,G,w,Z,ac,l,ag,ak,O,x,ab=new Date(),C=this._daylightSavingAdjust(new Date(ab.getFullYear(),ab.getMonth(),ab.getDate())),aj=this._get(aa,"isRTL"),al=this._get(aa,"showButtonPanel"),U=this._get(aa,"hideIfNoPrevNext"),H=this._get(aa,"navigationAsDateFormat"),y=this._getNumberOfMonths(aa),p=this._get(aa,"showCurrentAtPos"),K=this._get(aa,"stepMonths"),F=(y[0]!==1||y[1]!==1),k=this._daylightSavingAdjust((!aa.currentDay?new Date(9999,9,9):new Date(aa.currentYear,aa.currentMonth,aa.currentDay))),o=this._getMinMaxDate(aa,"min"),z=this._getMinMaxDate(aa,"max"),i=aa.drawMonth-p,X=aa.drawYear;if(i<0){i+=12;X--}if(z){B=this._daylightSavingAdjust(new Date(z.getFullYear(),z.getMonth()-(y[0]*y[1])+1,z.getDate()));B=(o&&B<o?o:B);while(this._daylightSavingAdjust(new Date(X,i,1))>B){i--;if(i<0){i=11;X--}}}aa.drawMonth=i;aa.drawYear=X;A=this._get(aa,"prevText");A=(!H?A:this.formatDate(A,this._daylightSavingAdjust(new Date(X,i-K,1)),this._getFormatConfig(aa)));V=(this._canAdjustMonth(aa,-1,X,i)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+A+"'><span class='ui-icon ui-icon-circle-triangle-"+(aj?"e":"w")+"'>"+A+"</span></a>":(U?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+A+"'><span class='ui-icon ui-icon-circle-triangle-"+(aj?"e":"w")+"'>"+A+"</span></a>"));N=this._get(aa,"nextText");N=(!H?N:this.formatDate(N,this._daylightSavingAdjust(new Date(X,i+K,1)),this._getFormatConfig(aa)));m=(this._canAdjustMonth(aa,+1,X,i)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+N+"'><span class='ui-icon ui-icon-circle-triangle-"+(aj?"w":"e")+"'>"+N+"</span></a>":(U?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+N+"'><span class='ui-icon ui-icon-circle-triangle-"+(aj?"w":"e")+"'>"+N+"</span></a>"));af=this._get(aa,"currentText");Y=(this._get(aa,"gotoCurrent")&&aa.currentDay?k:C);af=(!H?af:this.formatDate(af,Y,this._getFormatConfig(aa)));R=(!aa.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(aa,"closeText")+"</button>":"");ai=(al)?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(aj?R:"")+(this._isInRange(aa,Y)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+af+"</button>":"")+(aj?"":R)+"</div>":"";J=parseInt(this._get(aa,"firstDay"),10);J=(isNaN(J)?0:J);am=this._get(aa,"showWeek");t=this._get(aa,"dayNames");v=this._get(aa,"dayNamesMin");u=this._get(aa,"monthNames");j=this._get(aa,"monthNamesShort");ae=this._get(aa,"beforeShowDay");ad=this._get(aa,"renderDay");r=this._get(aa,"showOtherMonths");E=this._get(aa,"selectOtherMonths");ah=this._getDefaultDate(aa);T="";an;for(D=0;D<y[0];D++){I="";this.maxRows=4;for(s=0;s<y[1];s++){n=this._daylightSavingAdjust(new Date(X,i,aa.selectedDay));W=" ui-corner-all";P="";if(F){P+="<div class='ui-datepicker-group";if(y[1]>1){switch(s){case 0:P+=" ui-datepicker-group-first";W=" ui-corner-"+(aj?"right":"left");break;case y[1]-1:P+=" ui-datepicker-group-last";W=" ui-corner-"+(aj?"left":"right");break;default:P+=" ui-datepicker-group-middle";W="";break}}P+="'>"}P+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+W+"'>"+(/all|left/.test(W)&&D===0?(aj?m:V):"")+(/all|right/.test(W)&&D===0?(aj?V:m):"")+this._generateMonthYearHeader(aa,i,X,o,z,D>0||s>0,u,j)+"</div><table class='ui-datepicker-calendar'><thead><tr>";S=(am?"<th class='ui-datepicker-week-col'>"+this._get(aa,"weekHeader")+"</th>":"");for(an=0;an<7;an++){Q=(an+J)%7;S+="<th scope='col'"+((an+J+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+t[Q]+"'>"+v[Q]+"</span></th>"}P+=S+"</tr></thead><tbody>";q=this._getDaysInMonth(X,i);if(X===aa.selectedYear&&i===aa.selectedMonth){aa.selectedDay=Math.min(aa.selectedDay,q)}G=(this._getFirstDayOfMonth(X,i)-J+7)%7;w=Math.ceil((G+q)/7);Z=(F?this.maxRows>w?this.maxRows:w:w);this.maxRows=Z;ac=this._daylightSavingAdjust(new Date(X,i,1-G));for(l=0;l<Z;l++){P+="<tr>";ag=(!am?"":"<td class='ui-datepicker-week-col'>"+this._get(aa,"calculateWeek")(ac)+"</td>");for(an=0;an<7;an++){ak=(ae?ae.apply((aa.input?aa.input[0]:null),[ac]):[true,""]);O=(ac.getMonth()!==i);x=(O&&!E)||!ak[0]||(o&&ac<o)||(z&&ac>z);ag+="<td class='"+((an+J+6)%7>=5?" ui-datepicker-week-end":"")+(O?" ui-datepicker-other-month":"")+((ac.getTime()===n.getTime()&&i===aa.selectedMonth&&aa._keyEvent)||(ah.getTime()===ac.getTime()&&ah.getTime()===n.getTime())?" "+this._dayOverClass:"")+(x?" "+this._unselectableClass+" ui-state-disabled":"")+(O&&!r?"":" "+ak[1]+(ac.getTime()===k.getTime()?" "+this._currentClass:"")+(ac.getTime()===C.getTime()?" ui-datepicker-today":""))+"'"+((!O||r)&&ak[2]?" title='"+ak[2].replace(/'/g,"&#39;")+"'":"")+(x?" data-date='"+ac.getDate()+"'":" data-handler='selectDay' data-event='click' data-date='"+ac.getDate()+"' data-month='"+ac.getMonth()+"' data-year='"+ac.getFullYear()+"'")+">"+(O&&!r?"&#xa0;":(x?"<span class='ui-state-default'>"+ac.getDate()+"</span>":"<a class='ui-state-default"+(ac.getTime()===C.getTime()?" ui-state-highlight":"")+(ac.getTime()===k.getTime()?" ui-state-active":"")+(O?" ui-priority-secondary":"")+"' href='#'>"+(ad?ad.apply(aa,[ac.getFullYear(),ac.getMonth()+1,ac.getDate()]):ac.getDate())+"</a>"))+"</td>";ac.setDate(ac.getDate()+1);ac=this._daylightSavingAdjust(ac)}P+=ag+"</tr>"}i++;if(i>11){i=0;X++}P+="</tbody></table>"+(F?"</div>"+((y[0]>0&&s===y[1]-1)?"<div class='ui-datepicker-row-break'></div>":""):"");I+=P}T+=I}T+=ai;aa._keyEvent=false;return T},_generateMonthYearHeader:function(m,k,u,o,s,v,q,i){var z,j,A,x,n,w,t,p,l=this._get(m,"changeMonth"),B=this._get(m,"changeYear"),C=this._get(m,"showMonthAfterYear"),r="<div class='ui-datepicker-title'>",y="";if(v||!l){y+="<span class='ui-datepicker-month'>"+q[k]+"</span>"}else{z=(o&&o.getFullYear()===u);j=(s&&s.getFullYear()===u);y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(A=0;A<12;A++){if((!z||A>=o.getMonth())&&(!j||A<=s.getMonth())){y+="<option value='"+A+"'"+(A===k?" selected='selected'":"")+">"+i[A]+"</option>"}}y+="</select>"}if(!C){r+=y+(v||!(l&&B)?"&#xa0;":"")}if(!m.yearshtml){m.yearshtml="";if(v||!B){r+="<span class='ui-datepicker-year'>"+u+"</span>"}else{x=this._get(m,"yearRange").split(":");n=new Date().getFullYear();w=function(E){var D=(E.match(/c[+\-].*/)?u+parseInt(E.substring(1),10):(E.match(/[+\-].*/)?n+parseInt(E,10):parseInt(E,10)));return(isNaN(D)?n:D)};t=w(x[0]);p=Math.max(t,w(x[1]||""));t=(o?Math.max(t,o.getFullYear()):t);p=(s?Math.min(p,s.getFullYear()):p);m.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;t<=p;t++){m.yearshtml+="<option value='"+t+"'"+(t===u?" selected='selected'":"")+">"+t+"</option>"}m.yearshtml+="</select>";r+=m.yearshtml;m.yearshtml=null}}r+=this._get(m,"yearSuffix");if(C){r+=(v||!(l&&B)?"&#xa0;":"")+y}r+="</div>";return r},_adjustInstDate:function(l,o,n){var k=l.drawYear+(n==="Y"?o:0),m=l.drawMonth+(n==="M"?o:0),i=Math.min(l.selectedDay,this._getDaysInMonth(k,m))+(n==="D"?o:0),j=this._restrictMinMax(l,this._daylightSavingAdjust(new Date(k,m,i)));l.selectedDay=j.getDate();l.drawMonth=l.selectedMonth=j.getMonth();l.drawYear=l.selectedYear=j.getFullYear();if(n==="M"||n==="Y"){this._notifyChange(l)}},_restrictMinMax:function(l,j){var k=this._getMinMaxDate(l,"min"),m=this._getMinMaxDate(l,"max"),i=(k&&j<k?k:j);return(m&&i>m?m:i)},_notifyChange:function(j){var i=this._get(j,"onChangeMonthYear");if(i){i.apply((j.input?j.input[0]:null),[j.selectedYear,j.selectedMonth+1,j])}},_getNumberOfMonths:function(j){var i=this._get(j,"numberOfMonths");return(i==null?[1,1]:(typeof i==="number"?[1,i]:i))},_getMinMaxDate:function(j,i){return this._determineDate(j,this._get(j,i+"Date"),null)},_getDaysInMonth:function(i,j){return 32-this._daylightSavingAdjust(new Date(i,j,32)).getDate()},_getFirstDayOfMonth:function(i,j){return new Date(i,j,1).getDay()},_canAdjustMonth:function(l,n,k,m){var i=this._getNumberOfMonths(l),j=this._daylightSavingAdjust(new Date(k,m+(n<0?n:i[0]*i[1]),1));if(n<0){j.setDate(this._getDaysInMonth(j.getFullYear(),j.getMonth()))}return this._isInRange(l,j)},_isInRange:function(m,k){var j,p,l=this._getMinMaxDate(m,"min"),i=this._getMinMaxDate(m,"max"),q=null,n=null,o=this._get(m,"yearRange");if(o){j=o.split(":");p=new Date().getFullYear();q=parseInt(j[0],10);n=parseInt(j[1],10);if(j[0].match(/[+\-].*/)){q+=p}if(j[1].match(/[+\-].*/)){n+=p}}return((!l||k.getTime()>=l.getTime())&&(!i||k.getTime()<=i.getTime())&&(!q||k.getFullYear()>=q)&&(!n||k.getFullYear()<=n))},_getFormatConfig:function(i){var j=this._get(i,"shortYearCutoff");j=(typeof j!=="string"?j:new Date().getFullYear()%100+parseInt(j,10));return{shortYearCutoff:j,dayNamesShort:this._get(i,"dayNamesShort"),dayNames:this._get(i,"dayNames"),monthNamesShort:this._get(i,"monthNamesShort"),monthNames:this._get(i,"monthNames")}},_formatDate:function(l,i,m,k){if(!i){l.currentDay=l.selectedDay;l.currentMonth=l.selectedMonth;l.currentYear=l.selectedYear}var j=(i?(typeof i==="object"?i:this._daylightSavingAdjust(new Date(k,m,i))):this._daylightSavingAdjust(new Date(l.currentYear,l.currentMonth,l.currentDay)));return this.formatDate(this._get(l,"dateFormat"),j,this._getFormatConfig(l))}});function b(j){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return j.delegate(i,"mouseout",function(){$(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).removeClass("ui-datepicker-next-hover")}}).delegate(i,"mouseover",f)}function f(){if(!$.datepicker._isDisabledDatepicker(g.inline?g.dpDiv.parent()[0]:g.input[0])){$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");$(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).addClass("ui-datepicker-next-hover")}}}function a(k,j){$.extend(k,j);for(var i in j){if(j[i]==null){k[i]=j[i]}}return k}$.fn.datepicker=function(j){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick);$.datepicker.initialized=true}if($("#"+$.datepicker._mainDivId).length===0){$("body").append($.datepicker.dpDiv)}var i=Array.prototype.slice.call(arguments,1);if(typeof j==="string"&&(j==="isDisabled"||j==="getDate"||j==="widget")){return $.datepicker["_"+j+"Datepicker"].apply($.datepicker,[this[0]].concat(i))}if(j==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return $.datepicker["_"+j+"Datepicker"].apply($.datepicker,[this[0]].concat(i))}return this.each(function(){typeof j==="string"?$.datepicker["_"+j+"Datepicker"].apply($.datepicker,[this].concat(i)):$.datepicker._attachDatepicker(this,j)})};$.datepicker=new c();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.11.3";var e=$.datepicker;return e});M.define("/js/hotel/module/DateRangePicker",function(f,e,g){var b=f("xdate"),d=f("/js/hotel/module/FestivalDateConfig");f("jqui-datepicker");var a={duration:50,numberOfMonths:2,firstDay:1,altFormat:"yy-mm-dd",dateFormat:"yy-mm-dd",dayNamesMin:["日","一","二","三","四","五","六"],dayNamesShort:["日","一","二","三","四","五","六"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]};var c=function(h){this.dateFormat="yyyy-MM-dd";this.timer=null;this.customCss="hotel_datepicker";this.fesDateList=d.getDateList();this.priceDateList=[];this.startInput=null;this.endInput=null;this.startDate=null;this.endDate=null;this.minDate=null;this.maxDate=null;this.rangeMinDays=1;this.rangeMaxDays=null;this.datePickerOptions={};this.startDayClass="start_day";this.startDayClassUnset="start_day_unset";this.endDayClass="end_day";this.endDayClassUnset="end_day_unset";this.isCached=false;this.isDoublePick=false;this.isAllowSameDate=false;M.mix(this,h);M.mix(this.datePickerOptions,a,false);if(this.isAllowSameDate){this.rangeMinDays=0}this.startInput=$(this.startInput);this.endInput=$(this.endInput);this.dateRangeSetted=true;this.showIns=null;this.preCheck();this.init()};c.prototype={init:function(){this.initDatePicker()},preCheck:function(){if(!this.startInput.length||!this.endInput.length){M.error("date range picker need an start input and an end input")}if(this.maxDate&&this.minDate&&b.parse(this.maxDate)<=b.parse(this.minDate)){M.error("max date must big than min date")}this.rangeMinDays=+this.rangeMinDays;if(isNaN(this.rangeMinDays)||this.rangeMinDays<0){M.error("date range days must be positive")}if(this.rangeMaxDays){this.rangeMaxDays=+this.rangeMaxDays;if(isNaN(this.rangeMaxDays)||this.rangeMaxDays<0){M.error("date range days must be positive")}}if(this.rangeMinDays&&this.rangeMaxDays&&this.rangeMinDays>this.rangeMaxDays){M.error("date range max days must equal or more than min days")}if(this.maxDate&&this.minDate&&this.rangeMinDays>0){var i=new b(this.minDate);var k=new b(this.maxDate);if(i.diffDays(k)<this.rangeMinDays){M.error("date range days must equal or more than range min days")}}if(!this.startDate){this.startDate=(new b()).toString(this.dateFormat)}if(this.minDate&&b.parse(this.startDate)<b.parse(this.minDate)){this.startDate=this.minDate}if(this.endDate){var h=new b(this.startDate),j=new b(this.endDate);if(h.diffDays(j)<this.rangeMinDays){j=h.addDays(this.rangeMinDays)}if(this.maxDate&&b.parse(this.maxDate)<j){j=this.maxDate}this.endDate=j.toString(this.dateFormat)}else{this.endDate=(new b(this.startDate)).addDays(1).toString(this.dateFormat)}},initDatePicker:function(){var i={onSelect:M.bind(this.selectDate,this),onClose:M.bind(this.closeDate,this),beforeShow:M.bind(this.beforeShow,this),beforeShowDay:M.bind(this.beforeShowDay,this),renderDay:M.bind(this.renderDay,this),gotoCurrent:true},j=M.mix({},i,a),h=M.mix({},i,a);if(this.minDate){j.minDate=(new b(this.minDate)).toString(this.dateFormat);h.minDate=(new b(this.minDate)).addDays(this.rangeMinDays).toString(this.dateFormat)}if(this.maxDate){j.maxDate=(new b(this.maxDate)).addDays(-this.rangeMinDays).toString(this.dateFormat);h.maxDate=(new b(this.startDate)).addDays(this.rangeMaxDays).toString(this.dateFormat)}this.startInput.datepicker(j);this.endInput.datepicker(h);this.startInput.datepicker("setDate",this.startDate);this.endInput.datepicker("setDate",this.endDate);if(this.isDoublePick){this.startInput.datepicker("widget").on("mouseenter","td:not(.ui-state-disabled)",$.proxy(this.mouseenterEffect,this));this.startInput.datepicker("widget").on("mouseleave","td:not(.ui-state-disabled)",$.proxy(this.mouseleaveEffect,this));this.endInput.datepicker("widget").on("mouseenter","td:not(.ui-state-disabled)",$.proxy(this.mouseenterEffect,this));this.endInput.datepicker("widget").on("mouseleave","td:not(.ui-state-disabled)",$.proxy(this.mouseleaveEffect,this))}},mouseenterEffect:function(j){var m=$(j.delegateTarget),l=$(j.target).closest("td"),i=new b(l.data("year"),l.data("month"),$("a",l).html());if(!this.showIns||!this.showIns.input){return true}if(this.showIns.input.is(this.startInput)){var k=new b(this.endDate);l.addClass("unset")}else{var h=new b(this.startDate);l.addClass("unset")}},mouseleaveEffect:function(j){var m=$(j.delegateTarget),l=$(j.target).closest("td"),i=new b(l.data("year"),(l.data("month")+1),$("a",l).html());if(!this.showIns||!this.showIns.input){return true}if(this.showIns.input.is(this.startInput)){var k=new b(this.endDate);l.removeClass("unset")}else{var h=new b(this.startDate);l.removeClass("unset")}}};M.mix(c.prototype,{selectDate:function(i,o){var j="",p={startDate:this.startDate,endDate:this.endDate},l=false,k=false;if(o.input.is(this.startInput)){p.startDate=i;j=this.endInput}else{p.endDate=i;j=this.startInput}if(o.input.is(this.startInput)){j.datepicker("option","maxDate",(new b(i)).addDays(this.rangeMaxDays).toString(this.dateFormat));if(this.rangeMaxDays&&b.parse(p.endDate)-b.parse(i)>this.rangeMaxDays*24*60*60*1000){p.endDate=(new b(i)).addDays(this.rangeMinDays).toString(this.dateFormat);j.datepicker("setDate",p.endDate);k=true;setTimeout(M.bind(function(){this.dateRangeSetted=false;j.datepicker("show")},this),1)}}if(b.parse(p.startDate)>=b.parse(p.endDate)){if(this.isAllowSameDate&&b.parse(p.startDate)==b.parse(p.endDate)){this.dateRangeSetted=true}else{var m="";if(o.input.is(this.startInput)){m=(new b(p.startDate)).addDays(this.rangeMinDays).toString(this.dateFormat);p.endDate=m}else{m=(new b(p.endDate)).addDays(-this.rangeMinDays).toString(this.dateFormat);p.startDate=m}j.datepicker("setDate",m);if(this.dateRangeSetted){if(o.input.is(this.startInput)){k=true}else{l=true}setTimeout(M.bind(function(){this.dateRangeSetted=false;j.datepicker("show")},this),1)}else{this.dateRangeSetted=true}}}else{this.dateRangeSetted=true}if(this.isDoublePick&&o.input.is(this.startInput)&&!this.isCached&&!k){k=true;setTimeout(M.bind(function(){this.dateRangeSetted=false;j.datepicker("show")},this),1)}if(!(p.startDate==this.startDate&&p.endDate==this.endDate)){this.startDate=p.startDate;this.endDate=p.endDate;M.Event(this).fire("date range picker changed",p)}if(this.isDoublePick){var h=new b(this.startDate),n=new b(this.endDate);if(!h.valid()){this.startDate=(new b()).addDays(40).toString(this.dateFormat)}if(!n.valid()){this.endDate=(new b(this.startDate)).addDays(1).toString(this.dateFormat)}if(o.input.is(this.startInput)&&b.parse(p.startDate)<b.parse(p.endDate)&&this.isCached&&!k){this.isCached=true;M.Event(this).fire("date range picker doublepicked",{startDate:this.startDate,endDate:this.endDate})}if(o.input.is(this.startInput)&&this.isAllowSameDate&&b.parse(p.startDate)<=b.parse(p.endDate)&&this.isCached&&!k){this.isCached=true;M.Event(this).fire("date range picker doublepicked",{startDate:this.startDate,endDate:this.endDate})}if(o.input.is(this.endInput)&&!l){this.isCached=true;M.Event(this).fire("date range picker doublepicked",{startDate:this.startDate,endDate:this.endDate})}}},setDate:function(h){this.startDate=h.startDate;this.endDate=h.endDate;this.preCheck();this.startInput.datepicker("setDate",h.startDate);this.endInput.datepicker("setDate",h.endDate)},closeDate:function(i,j){var h=this;this.timer=setTimeout(function(){$("#ui-datepicker-div").removeClass(h.customCss)},1000);$("#ui-datepicker-div").data("removeClassTimer",this.timer);if(!this.dateRangeSetted){this.dateRangeSetted=true}if(M.isFunction(this._onClose)){this._onClose(i,j)}},beforeShow:function(h,i){this.timer=$("#ui-datepicker-div").data("removeClassTimer")||this.timer;clearTimeout(this.timer);$("#ui-datepicker-div").addClass(this.customCss);this.showIns=i;if(M.isFunction(this._beforeShow)){this._beforeShow(h,i)}},beforeShowDay:function(j){var k=b.parse(this.startDate),i=b.parse(this.endDate),h=b.parse(j);var l=h==k?this.startDayClass:(h>k&&h<i?"range_day":(h==i?this.endDayClass:""));if(!this.dateRangeSetted){if(this.showIns.input.is(this.startInput)){if(this.isAllowSameDate&&k===i){l=l==this.startDayClass?this.endDayClassUnset:""}else{l=l==this.endDayClass?this.endDayClassUnset:""}}else{l=l==this.startDayClass?this.startDayClassUnset:""}}return[true,l]},renderDay:function(m,n,h){var k=h;for(var j=0;j<this.fesDateList.length;j++){var o=this.fesDateList[j];if(o.year===m&&o.month===n&&o.day===h){if(o.shortName){k='<p class="fes">'+o.shortName+"</p>"}}}for(var j=0;j<this.priceDateList.length;j++){var l=this.priceDateList[j];if(l.year===m&&l.month===n&&l.day===h){k+='<p class="price">'+l.name+"</p>"}}return k}});g.exports=c});M.define("/js/hotel/module/NumberGuestsPicker",function(f,g,c){var l=f("/js/hotel/module/BookingGuests"),j=M.cssSupport("transition"),h=M.cssSupport("transform");var i='<div class="ngp-dropdown _j_ngp_dropdown" style="display:none;"><div class="item _j_ngp_room_item"><div class="row-guests clearfix _j_ngp_row_guests"><span class="label">每间</span></div><div class="row-children clearfix _j_ngp_row_children" style="display:none;"><span class="label">儿童年龄</span></div></div><div class="item item-action clearfix _j_ngp_action_item"><span class="tips"></span><a class="btn-action" href="javascript:;">确 认</a></div></div>';var m='<div class="ngp-select"><div class="select-trigger _j_ngp_select_trigger"><span></span><div class="caret"><i></i></div></div><ul style="display:none;"></ul></div>';var d=[{value:1,text:1},{value:2,text:2},{value:3,text:3},{value:4,text:4},{value:5,text:5},{value:6,text:6},{value:7,text:7}];var k=[{value:0,text:0},{value:1,text:1},{value:2,text:2},{value:3,text:3},{value:4,text:4}];var e=[{value:0,text:"<1"},{value:1,text:1},{value:2,text:2},{value:3,text:3},{value:4,text:4},{value:5,text:5},{value:6,text:6},{value:7,text:7},{value:8,text:8},{value:9,text:9},{value:10,text:10},{value:11,text:11},{value:12,text:12},{value:13,text:13},{value:14,text:14},{value:15,text:15},{value:16,text:16},{value:17,text:17}];var b=function(n){var o=l.defaultGuests;if(l.isValid(n.numberAdults,n.numberChildren,n.childrenAge)){this.numberAdults=n.numberAdults;this.numberChildren=n.numberChildren;this.childrenAge=n.childrenAge}else{this.numberAdults=o.numberAdults;this.numberChildren=o.numberChildren;this.childrenAge=o.childrenAge}this.isCached=n.isCached;this.isDisabled=n.isDisabled||false;this.isAlignRight=n.isAlignRight||false;this.snap={numberAdults:this.numberAdults,numberChildren:this.numberChildren,childrenAge:this.childrenAge};this.isShow=false;this.$ele=$(n.element);this.$ele.addClass("number-guests-picker");this.$dropdown=null;this.numberAdultsSelect=null;this.numberChildrenSelect=null;this.childrenAgeSelects=[];this.createDropdown();this.renderSelect();this.renderDisabled();this.bindEvents()};b.prototype.createDropdown=function(){this.$dropdown=$(i).appendTo(this.$ele);if(this.isAlignRight){this.$dropdown.addClass("align-right")}};b.prototype.renderSelect=function(){var n=this.$dropdown.find("._j_ngp_row_guests");if(!this.numberAdultsSelect){this.numberAdultsSelect=new a({container:n[0],value:this.numberAdults,options:d,textSuffix:"成人"})}else{this.numberAdultsSelect.setValue(this.numberAdults)}if(!this.numberChildrenSelect){this.numberChildrenSelect=new a({container:n[0],value:this.numberChildren,options:k,textSuffix:"儿童"})}else{this.numberChildrenSelect.setValue(this.numberChildren)}this.renderChildrenAgeSelects()};b.prototype.renderChildrenAgeSelects=function(){var p=this.$dropdown.find("._j_ngp_row_children");for(var o=0;o<this.snap.childrenAge.length;o++){var q=this.snap.childrenAge[o],n=this.childrenAgeSelects[o];if(!n){n=new a({container:p[0],value:q,options:e,textSuffix:"岁",attrs:{index:o}});M.Event(n).on("value changed",M.bind(function(s,r){this.snap.childrenAge[r.index]=s},this));this.childrenAgeSelects[o]=n}else{if(n.getValue()!==q){n.setValue(q)}}}for(var o=this.childrenAgeSelects.length-1;o>=0;o--){if(M.isUndefined(this.snap.childrenAge[o])){this.childrenAgeSelects[o].destroy();this.childrenAgeSelects.splice(o,1)}}if(this.snap.childrenAge.length>0){p.show()}else{p.hide()}};b.prototype.renderDisabled=function(){var o=this.$dropdown.find("._j_ngp_action_item .tips"),n=this.$dropdown.find("._j_ngp_action_item .btn-action");if(this.isDisabled){o.html("请优先选择日期，以便查询实时价格。");n.addClass("disabled")}else{o.html("");n.removeClass("disabled")}};b.prototype.bindEvents=function(){this.$ele.on("click",M.bind(function(n){if(!$(n.target).closest(this.$dropdown)[0]){if(this.isShow){this.hide()}else{this.show()}}},this));this.$dropdown.on("click",".btn-action",M.bind(function(n){if(!this.isDisabled){this.syncData();this.hide()}},this));$(document).on("click",M.bind(function(n){if(this.isShow&&!$(n.target).closest(this.$ele)[0]){this.hide()}},this));M.Event(this.numberAdultsSelect).on("value changed",M.bind(function(n){this.snap.numberAdults=n},this));M.Event(this.numberChildrenSelect).on("value changed",M.bind(function(o){this.snap.numberChildren=o;var p=[];for(var n=0;n<this.snap.numberChildren;n++){p.push(0)}for(var n=0;n<this.snap.childrenAge.length;n++){if(this.snap.numberChildren>n){p[n]=this.snap.childrenAge[n]}}this.snap.childrenAge=p;this.renderChildrenAgeSelects()},this))};b.prototype.syncData=function(){var o=false;if(this.numberAdults!==this.snap.numberAdults){o=true}if(this.numberChildren!==this.snap.numberChildren){o=true}if(this.childrenAge.length!==this.snap.childrenAge.length){o=true}else{for(var n=0;n<this.childrenAge.length;n++){if(this.childrenAge[n]!==this.snap.childrenAge[n]){o=true}}}if(!this.isCached){o=true}this.numberAdults=this.snap.numberAdults;this.numberChildren=this.snap.numberChildren;this.childrenAge=this.snap.childrenAge;this.isCached=true;if(o){M.Event(this).fire("number guests picker changed",{numberAdults:this.numberAdults,numberChildren:this.numberChildren,childrenAge:this.childrenAge})}};b.prototype.syncSnap=function(){this.snap={numberAdults:this.numberAdults,numberChildren:this.numberChildren,childrenAge:this.childrenAge}};b.prototype.setIsDisabled=function(n){this.isDisabled=n;this.renderDisabled()};b.prototype.show=function(){this.syncSnap();this.renderSelect();if(j){this.$dropdown.css({opacity:0,marginTop:-16});setTimeout(M.bind(function(){this.$dropdown.css({opacity:1,marginTop:0})},this),1)}this.$dropdown.show();this.$ele.addClass("focus");this.isShow=true};b.prototype.hide=function(){this.$dropdown.css({opacity:1,marginTop:0});setTimeout(M.bind(function(){this.$dropdown.css({opacity:0,marginTop:-16})},this),1);this.$dropdown.hide();this.$ele.removeClass("focus");this.isShow=false};var a=function(n){this.textPrefix=n.textPrefix||"";this.textSuffix=n.textSuffix||"";this.value=n.value;this.options=n.options;this.attrs=n.attrs||{};this.isShowDropdown=false;this.globalClickHandler=M.bind(function(o){if(this.isShowDropdown&&!$(o.target).closest(this.$ele)[0]){this.hideDropdown()}},this);this.$container=$(n.container);this.$ele=null;this.$dropdown=null;this.createElement();this.setOptions();this.setValue(this.value);this.bindEvents()};a.prototype.createElement=function(){this.$ele=$(m).appendTo(this.$container);if(this.options.length>7){this.$ele.addClass("scroll-select")}this.$dropdown=this.$ele.find("ul")};a.prototype.bindEvents=function(){this.$ele.on("click","._j_ngp_select_trigger",M.bind(function(n){if(this.isShowDropdown){this.hideDropdown()}else{this.showDropdown()}},this)).on("click","li",M.bind(function(n){this.setValue($(n.currentTarget).data("value"));this.hideDropdown()},this));$(document).on("click",this.globalClickHandler)};a.prototype.unbindEvents=function(){this.$ele.off();$(document).off("click",this.globalClickHandler)};a.prototype.setOptions=function(){var n=this.$ele.find("ul");n.empty();for(var o=0;o<this.options.length;o++){var p=this.options[o];n.append('<li data-value="'+p.value+'">'+p.text+"</li>")}};a.prototype.setValue=function(p){this.value=p;var q;for(var n=0;n<this.options.length;n++){var o=this.options[n];if(this.value==o.value){q=o.text;break}}if(this.$ele.find("span")[0]){this.$ele.find("span").html((this.textPrefix?this.textPrefix+" ":"")+q+(this.textSuffix?" "+this.textSuffix:""))}else{if(this.$ele.find('input[type="text"]')[0]){this.$ele.find('input[type="text"]').value((this.textPrefix?this.textPrefix+" ":"")+q+(this.textSuffix?" "+this.textSuffix:""))}}M.Event(this).fire("value changed",this.value,this.attrs)};a.prototype.getValue=function(){return this.value};a.prototype.showDropdown=function(){if(j){this.$dropdown.css({opacity:0,marginTop:-16});setTimeout(M.bind(function(){this.$dropdown.css({opacity:1,marginTop:0})},this),1)}this.$dropdown.show();this.isShowDropdown=true};a.prototype.hideDropdown=function(){if(j){this.$dropdown.css({opacity:1,marginTop:0});setTimeout(M.bind(function(){this.$dropdown.css({opacity:0,marginTop:-16})},this),1)}this.$dropdown.hide();this.isShowDropdown=false};a.prototype.destroy=function(){this.unbindEvents();this.$ele.remove()};c.exports=b});M.define("/js/hotel/list_mvc_filter_view",function(h,D,b){var g=h("/js/corelib/handlebars-2.0.0"),j=h("xdate"),l=h("/js/hotel/module/DateRangePicker"),d=h("/js/hotel/module/BookingDate"),p=h("/js/hotel/module/BookingGuests"),a=p.defaultGuests,v=h("/js/hotel/module/NumberGuestsPicker"),s=h("/js/hotel/module/Log"),y=M.cssSupport("transition"),q=M.cssSupport("transform"),B=M.cssSupport("animation"),c=window.Env||{};var f={};var m=f.DatepickerView=Backbone.View.extend({initialize:function(){this.$checkInDateInput=this.$("#_j_check_in_date input");this.$checkOutDateInput=this.$("#_j_check_out_date input");this.$checkIn=this.$("#_j_check_in_date span");this.$checkOut=this.$("#_j_check_out_date span");this.datepicker=null;this.render();this.renderDate()},delegateEvents:function(){M.Event(this.datepicker).on("date range picker doublepicked",_.bind(function(E){var G=this.model.get("isFixedDate"),F=this.model.get("isFixedGuests");this.model.set("foreDate",{checkIn:E.startDate,checkOut:E.endDate});s.listFilterLog({type:"date",value:[E.startDate,E.endDate],mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this));this.$el.on("click.delegateEvents","#_j_check_in_date",_.bind(function(E){this.$checkInDateInput.trigger("focus")},this)).on("click.delegateEvents","#_j_check_out_date",_.bind(function(E){this.$checkOutDateInput.trigger("focus")},this));this.listenTo(this.model,"change:foreDate",this.renderDate);m.__super__.delegateEvents.call(this)},undelegateEvents:function(){m.__super__.undelegateEvents.call(this)},render:function(){this.datepicker=new l({startInput:this.$checkInDateInput,endInput:this.$checkOutDateInput,startDate:this.model.get("date").checkIn,endDate:this.model.get("date").checkOut,minDate:(new j()).toString("yyyy-MM-dd"),maxDate:(new j()).addYears(1).toString("yyyy-MM-dd"),rangeMaxDays:30,isDoublePick:true,isCached:this.model.get("isFixedDate"),_beforeShow:function(E,F){$(F.input).closest(".hs-item-date").addClass("focus")},_onClose:function(E,F){$(F.input).closest(".hs-item-date").removeClass("focus")}});if(!this.model.get("isFixedDate")&&!d.hasRemind()){this.$checkInDateInput.trigger("focus");d.setRemind()}},renderDate:function(){var E=this.model.get("foreDate");if(E.checkIn&&E.checkOut){this.$checkIn.html(E.checkIn);this.$checkOut.html(E.checkOut)}else{this.$checkIn.html("入住日");this.$checkOut.html("离店日")}}});var x=f.NumberGuestsPickerView=Backbone.View.extend({initialize:function(){this.numberGuestsPicker=null;this.isRemind=p.hasRemind();this.render();this.renderGuests()},delegateEvents:function(){M.Event(this.numberGuestsPicker).on("number guests picker changed",_.bind(function(E){this.model.set("foreGuests",{numberAdults:E.numberAdults,numberChildren:E.numberChildren,childrenAge:E.childrenAge});s.listFilterLog({type:"guests",value:[E.numberAdults,E.numberChildren,E.childrenAge],mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this));this.listenTo(this.model,"change:foreGuests",this.renderGuests);this.listenTo(this.model,"change:foreDate",this.showPicker)},render:function(){var E=this.model.get("guests");this.numberGuestsPicker=new v({element:this.$el[0],numberAdults:E.numberAdults,numberChildren:E.numberChildren,childrenAge:E.childrenAge,isCached:E.isCached,isDisabled:!this.model.get("isFixedDate")})},renderGuests:function(){var E=this.model.get("foreGuests");if(!_.isEmpty(E)){this.$el.find("> span").html(E.numberAdults+"成人 "+E.numberChildren+"儿童")}else{this.$el.find("> span").html("人数未定")}},showPicker:function(){this.numberGuestsPicker.setIsDisabled(false);if(!this.isRemind){this.isRemind=true;this.numberGuestsPicker.show();p.setRemind()}}});var z=f.PriceBtnView=Backbone.View.extend({delegateEvents:function(){this.$("a").on("click.delegateEvents",_.bind(function(J){var F=$.trim($("#_j_search_input").val()),I=this.model.get("positionName")?this.model.get("positionName"):c.mdd_info.name;if(F&&F!==I){var E=this.model.get("foreDate");if(E.checkIn&&E.checkOut){d.setDate(E.checkIn,E.checkOut,"list")}s.listFilterLog({type:"查看价格button",value:F,mddid:this.model.get("mddid"),entrance_type:c.entrance_type});M.Event.fire("price btn click");return true}var G={},E=this.model.get("foreDate"),H=this.model.get("foreGuests");if(E.checkIn&&E.checkOut){G.date=E;G.isFixedDate=true}if(!_.isEmpty(H)){G.guests=H;G.isFixedGuests=true}if(!_.isEmpty(G)){this.model.set(G);setTimeout(function(){var K=$("#_j_feature_tab");if(K[0]){$(window).scrollTo(K.offset().top,400)}else{$(window).scrollTo($("#_j_price_slider").offset().top,400)}},1)}s.listFilterLog({type:"查看价格button",value:1,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this));z.__super__.delegateEvents.call(this)},undelegateEvents:function(){z.__super__.undelegateEvents.call(this)},renderRipple:function(){this.$("a").html("更新价格");if(q&&B){if(!this.$("a").hasClass("anim-press")){this.$("a").addClass("anim-press")}}},renderStand:function(){this.$("a").html("查看价格").removeClass("anim-press")}});var A=f.PriceSliderView=Backbone.View.extend({initialize:function(){this.render();this.renderSelected()},delegateEvents:function(){this.listenTo(this.model,"change:price",this.renderSelected);A.__super__.delegateEvents.call(this)},undelegateEvents:function(){A.__super__.undelegateEvents.call(this)},render:function(){var E=function(F){if(F>750){return 750*2+(F-750)*10}return F*2};this.$(".range-bar").slider({range:true,min:0,max:1000,step:5,slide:_.bind(function(H,I){var G=E(I.values[0]),F=E(I.values[1]);this.$(".htb-title span").html("¥"+G+" - "+F)},this),change:_.bind(function(H,I){var G=E(I.values[0]),F=E(I.values[1]);this.$(".htb-title span").html("¥"+G+" - "+F)},this),stop:_.bind(function(H,I){var G=E(I.values[0]),F=E(I.values[1]);if(F===4000){F=Infinity}this.model.set("price",[G,F]);s.listFilterLog({type:"价格",value:[G,F],mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this)})},renderSelected:function(){var H=this.model.get("price"),G=H[0]?H[0]:0,F=H[1]?(H[1]===Infinity?4000:H[1]):4000,E=function(I){if(I>1500){return 1500/2+Math.round((I-1500)/10)}return I/2};this.$(".range-bar").slider("values",[E(G),E(F)])}});var o=f.AreaView=Backbone.View.extend({initialize:function(){this.$areaList=this.$("._j_area_list");this.$areaDescList=this.$("._j_area_desc_list");this.$areaPriceList=this.$("._j_area_price_list");this.render();this.renderRestrict();this.renderSelected();this.renderDesc();this.renderPrice()},delegateEvents:function(){this.$el.on("click.delegateEvents",".item-area ._j_area_name",_.bind(function(F){var G=Number($(F.currentTarget).data("id"));this.model.set("areaId",G);var E=_.find(c.area_list,function(H){return H.id===G});if(E){s.listFilterLog({type:"area",value:G===-1?"全部":E.name,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}},this)).on("click.delegateEvents",".toggle",_.bind(function(G){var E=$(G.currentTarget),F=Number(E.data("count"));if(F){F--}if(F>0){E.toggleClass("extend");if(E.hasClass("extend")){E.html("<i></i>收起共"+F+"个区域")}else{E.html("<i></i>展开共"+F+"个区域")}this.$areaList.find("ul").toggleClass("restrictheight")}},this)).on("mouseenter.delegateEvents","._j_area_desc_list",_.bind(function(F){var E=this.$areaDescList.find("dd:visible");if(E.find("p").length&&E.find("p").length>3){E.css("height","auto");this.$areaDescList.css("height",E.height())}},this)).on("mouseleave.delegateEvents","._j_area_desc_list",_.bind(function(F){var E=this.$areaDescList.find("dd:visible");E.css("height",105);this.$areaDescList.css("height",105)},this));this.listenTo(this.model,"change:areaId",this.renderSelected);this.listenTo(this.model,"change:areaId",this.renderDesc);this.listenTo(this.model,"change:areaId",this.renderPrice);this.listenTo(this.model,"change:areaId",this.renderMap);M.Event.on("list map init",_.bind(this.renderMap,this));o.__super__.delegateEvents.call(this)},undelegateEvents:function(){o.__super__.undelegateEvents.call(this)},render:function(){if(c.area_list.length>1){this.$el.show()}else{this.$el.hide()}},renderRestrict:function(){if(this.$areaList[0]){var E=this.$areaList.find(".toggle"),F=Number(E.data("count"));if(F){F--}if(F>0&&this.$areaList.find("ul:eq(0)").height()>=48){E.show();this.$areaList.find("ul:eq(0)").css("height",this.$areaList.find("ul").height());if(this.model.get("areaId")!=-1){E.addClass("extend")}else{this.$areaList.find("ul:eq(0)").addClass("restrictheight")}if(E.hasClass("extend")){E.html("<i></i>收起共"+F+"个区域")}else{E.html("<i></i>展开共"+F+"个区域")}}}},renderSelected:function(){var F=this.model.get("areaId");if(this.$areaList[0]){var E;if(F===null){E=this.$areaList.find('._j_area_name[data-id="-1"]')}else{E=this.$areaList.find('._j_area_name[data-id="'+F+'"]')}if(E[0]){this.$areaList.find("._j_area_name").removeClass("on");E.addClass("on")}}},renderDesc:function(){var G=this.model.get("areaId");if(this.$areaDescList[0]){var E=this.$areaDescList.find("dt"),H,F=this.$areaDescList.find("dd:visible");if(G===null){H=this.$areaDescList.find('dd[data-id="-1"]')}else{H=this.$areaDescList.find('dd[data-id="'+G+'"]')}F.hide();if(E[0]&&H[0]&&G!==0){this.$areaDescList.removeClass("item-empty");E.show();H.show()}else{E.hide();this.$areaDescList.addClass("item-empty")}}},renderPrice:function(){var G=this.model.get("areaId");if(this.$areaPriceList[0]){var E=this.$areaPriceList.find("dt"),H,F=this.$areaPriceList.find("dd:visible");if(G===null){H=this.$areaPriceList.find('dd[data-id="-1"]')}else{H=this.$areaPriceList.find('dd[data-id="'+G+'"]')}F.hide();if(E[0]&&H[0]){this.$areaPriceList.removeClass("item-empty");E.show();H.show()}else{E.hide();this.$areaPriceList.addClass("item-empty")}if(E[0]&&H[0]){this.$areaPriceList.removeClass("item-empty");if(y&&q){setTimeout(function(){E.addClass("anim-show");H.addClass("anim-show")},1)}E.show();H.show()}else{if(y&&q){E.removeClass("anim-show");setTimeout(function(){E.hide()},200)}else{E.hide()}this.$areaPriceList.addClass("item-empty")}}},renderMap:function(){var E=this.model.get("areaId");M.Event.fire("areaId changed",{areaId:E})}});var n=f.RegionView=Backbone.View.extend({initialize:function(){this.$regionList=this.$("._j_region_list");this.$regionDescList=this.$("._j_region_desc_list");this.render();this.renderRestrict();this.renderSelected();this.renderDesc()},delegateEvents:function(){this.$el.on("click.delegateEvents",".item-area ._j_region_name",_.bind(function(E){var G=Number($(E.currentTarget).data("id"));this.model.set("regionId",G);var F=_.find(c.region_list,function(H){return H.id===G});if(F){s.listFilterLog({type:"region",value:G===-1?"全部":F.name,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}},this)).on("click.delegateEvents",".toggle",_.bind(function(G){var E=$(G.currentTarget),F=Number(E.data("count"));if(F){F--}if(F>0){E.toggleClass("extend");if(E.hasClass("extend")){E.html("<i></i>收起共"+F+"个区域")}else{E.html("<i></i>展开共"+F+"个区域")}this.$regionList.find("ul").toggleClass("restrictheight")}},this)).on("mouseenter.delegateEvents","._j_region_desc_list",_.bind(function(F){var E=this.$regionDescList.find("dd:visible");if(E.find("p").length&&E.find("p").length>3){E.css("height","auto");this.$regionDescList.css("height",E.height())}},this)).on("mouseleave.delegateEvents","._j_region_desc_list",_.bind(function(F){var E=this.$regionDescList.find("dd:visible");E.css("height",105);this.$regionDescList.css("height",105)},this));this.listenTo(this.model,"change:regionId",this.renderSelected);n.__super__.delegateEvents.call(this)},undelegateEvents:function(){n.__super__.undelegateEvents.call(this)},render:function(){if(c.area_list.length<=1&&c.region_list.length>1){this.$el.show()}else{this.$el.hide()}},renderRestrict:function(){if(this.$regionList[0]){var E=this.$regionList.find(".toggle"),F=Number(E.data("count"));if(F){F--}if(F>0&&this.$regionList.find("ul:eq(0)").height()>=48){E.show();this.$regionList.find("ul:eq(0)").css("height",this.$regionList.find("ul").height());if(this.model.get("regionId")!=-1){E.addClass("extend")}else{this.$regionList.find("ul:eq(0)").addClass("restrictheight")}if(E.hasClass("extend")){E.html("<i></i>收起共"+F+"个区域")}else{E.html("<i></i>展开共"+F+"个区域")}}}},renderSelected:function(){var F=this.model.get("regionId");if(this.$regionList[0]){var E;if(F===null){E=this.$regionList.find('._j_region_name[data-id="-1"]')}else{E=this.$regionList.find('._j_region_name[data-id="'+F+'"]')}if(E[0]){this.$regionList.find("._j_region_name").removeClass("on");E.addClass("on")}}},renderDesc:function(){var H=this.model.get("regionId");if(this.$regionDescList[0]){var E=this.$regionDescList.find("dt"),G,F=this.$regionDescList.find("dd:visible");this.$regionDescList.removeClass("item-empty");E.show();this.$regionDescList.find('dd[data-id="-1"]').show()}}});var u=f.FeatureTabView=Backbone.View.extend({initialize:function(){this.renderSelected()},delegateEvents:function(){this.$(".ul-tab").on("click","a",_.bind(function(G){var E=$(G.currentTarget),H=Number(E.data("id"));this.model.set("feature",H);var F=_.find(c.feature_tags,function(I){return I.id===H});if(F){s.listFilterLog({type:"feature",value:F.name,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}},this));this.listenTo(this.model,"change:feature",this.renderSelected);u.__super__.delegateEvents.call(this)},undelegateEvents:function(){u.__super__.undelegateEvents.call(this)},renderSelected:function(){this.$(".ul-tab a").each(_.bind(function(E,H){var F=$(H),G=Number(F.data("id"));if(this.model.get("feature")===G){F.addClass("on")}else{F.removeClass("on")}},this))}});var k=f.DropdownFilterView=Backbone.View.extend({initialize:function(E){this.filterType=E.filterType;this.filterOptions=E.filterOptions;this.filterName=E.filterName;this.isCustomEvents=E.isCustomEvents;this.$dropdownTrigger=this.$("._j_dropdown_filter_trigger");this.$dropdownContent=this.$("._j_dropdown_filter_content");this.render();this.renderOptions();this.renderSelected()},delegateEvents:function(){this.$dropdownTrigger.on("click.delegateEvents",_.bind(function(E){if(y){this.$dropdownContent.css({opacity:0,marginTop:-4});setTimeout(_.bind(function(){this.$dropdownContent.css({opacity:1,marginTop:16})},this),1)}this.$dropdownContent.show();this.$dropdownContent.closest(".htb-select").addClass("open")},this));$("body").on("click.delegateEvents",_.bind(function(E){if(!$(E.target).closest(this.$dropdownContent)[0]&&!$(E.target).closest(this.$dropdownTrigger)[0]){this.$dropdownContent.hide();this.$dropdownContent.closest(".htb-select").removeClass("open")}},this));if(!this.isCustomEvents){this.$dropdownContent.on("click.delegateEvents","li",_.bind(function(F){var J=$(F.currentTarget),I=Number(J.data("id")),E=_.clone(this.model.get(this.filterType));if(_.contains(E,I)){E=_.without(E,I)}else{if(!J.hasClass("disabled")){E.push(I)}}this.model.set(this.filterType,E);var H=this.model.get(this.filterOptions),G=[];_.each(E,function(P,K,N){var O=_.find(H,function(Q){return Q.id===P});if(O){G.push(O.name)}});s.listFilterLog({type:this.filterType,value:G,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this)).on("click.delegateEvents",".empty .btn",_.bind(function(E){this.model.set(this.filterType,[]);s.listFilterLog({type:this.filterType,value:"clear",mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this))}this.listenTo(this.model,"change:mode",this.render);this.listenTo(this.model,"change:"+this.filterOptions,this.renderOptions);this.listenTo(this.model,"change:"+this.filterOptions,this.renderSelected);this.listenTo(this.model,"change:"+this.filterType,this.renderSelected);k.__super__.delegateEvents.call(this)},undelegateEvents:function(){k.__super__.undelegateEvents.call(this)},render:function(){var E=this.model.get("mode");if(E==="hotel"){if(_.contains(["type","star","facility","brand"],this.filterType)){this.$el.show()}else{this.$el.hide();this.renderSelected()}}if(E==="airbnb"){if(_.contains(["airbnbRoom","airbnbBedroom","airbnbFacility","airbnbPropertyType"],this.filterType)){this.$el.show()}else{this.$el.hide();this.renderSelected()}}},renderOptions:function(){var G=this.model.get(this.filterOptions),E=this.$dropdownContent.find("ul"),F=0;E.empty();_.each(G,_.bind(function(I,H,J){E.append('<li class="'+(I.count==0?"disabled":"")+'" data-id="'+I.id+'" data-count="'+I.count+'"><i class="icon-checkbox"></i><span class="num">'+I.count+'</span><span class="'+(this.filterType==="brand"?"brand-name":"")+'">'+I.name+"</span></li>");if(Number(I.count)>F){F=Number(I.count)}},this));E.find(".num").each(function(H,I){$(I).css("width",String(F).length*8)});if(G&&G.length>5){this.$dropdownContent.addClass("scroll-list")}else{this.$dropdownContent.removeClass("scroll-list")}if(this.filterType==="brand"){this.$dropdownContent.css("width",260)}},renderSelected:function(){var F=this.model.get(this.filterType);this.$dropdownContent.find("li").each(function(G,I){var K=$(I),J=K.data("id"),H=K.data("count");if(_.contains(F,J)){if(K.hasClass("disabled")){K.removeClass("disabled")}K.addClass("on")}else{if(H==0){K.addClass("disabled")}K.removeClass("on")}});var E=this.$dropdownTrigger.find("span");if(F.length===0){E.removeClass("active").html("不限")}if(F.length===1){_.each(this.model.get(this.filterOptions),_.bind(function(I,G,H){if(F[0]==I.id){E.addClass("active").html(I.name);if(this.filterType==="brand"&&I.name.length>6){E.html(I.name.slice(0,5)+"...")}return false}},this))}if(F.length>1){E.addClass("active").html("已选"+F.length+"项")}}});var w=f.StarFilterView=k.extend({renderOptions:function(){var G=this.model.get("starOptions"),E=this.$dropdownContent.find("ul"),F=0;E.empty();_.each(G,_.bind(function(J,H,I){console.log(J);E.append('<li class="'+(J.count==0?"disabled":"")+'" data-id="'+J.id+'" data-count="'+J.count+'"><i class="icon-checkbox"></i><span class="num">'+J.count+'</span><span class="hotel-rate rate'+this.convertStar(J.id)+'"></span></li>');if(Number(J.count)>F){F=Number(J.count)}},this));E.find(".num").each(function(H,I){$(I).css("width",String(F).length*8)})},renderSelected:function(){var F=this.model.get("star");this.$dropdownContent.find("li").each(function(G,I){var K=$(I),J=K.data("id"),H=K.data("count");if(_.contains(F,J)){if(K.hasClass("disabled")){K.removeClass("disabled")}K.addClass("on")}else{if(H==0){K.addClass("disabled")}K.removeClass("on")}});var E=this.$dropdownTrigger.find("span");E.removeAttr("class").empty();if(F.length===0){E.html("不限")}if(F.length===1){E.addClass("hotel-rate rate"+this.convertStar(F[0]))}if(F.length>1){E.html("已选"+F.length+"项")}},convertStar:function(E){switch(Number(E)){case 9927:return 5;case 9926:return 4;case 9925:return 3;case 9924:return 2;default:return 1}}});var i=f.PoiFilterView=k.extend({initialize:function(E){E.isCustomEvents=true;i.__super__.initialize.call(this,E)},delegateEvents:function(){this.$dropdownTrigger.on("click.delegateEvents",_.bind(function(E){if(y){this.$dropdownContent.css({opacity:0,marginTop:-4});setTimeout(_.bind(function(){this.$dropdownContent.css({opacity:1,marginTop:16})},this),1)}this.$dropdownContent.show();this.$dropdownContent.closest(".htb-select").addClass("open")},this));$("body").on("click.delegateEvents",_.bind(function(E){if(!$(E.target).closest(this.$dropdownContent)[0]&&!$(E.target).closest(this.$dropdownTrigger)[0]){this.$dropdownContent.hide();this.$dropdownContent.closest(".htb-select").removeClass("open")}},this));this.$dropdownContent.on("click.delegateEvents","li",_.bind(function(F){var I=$(F.currentTarget),H=Number(I.data("id")),G=this.model.get("poiId");if(H===G){this.model.set("poiId",null);s.listFilterLog({type:"poi",value:null,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}else{this.model.set("poiId",H);var E=_.find(this.model.get("poiOptions"),function(J){return J.id===H});if(E){s.listFilterLog({type:"poi",value:E.name,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}}},this)).on("click.delegateEvents",".empty .btn",_.bind(function(E){this.model.set("poiId",null);s.listFilterLog({type:"poi",value:"clear",mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this));this.listenTo(this.model,"change:distance",this.renderSelected);i.__super__.delegateEvents.call(this)},render:function(){var F=function(G){return G*1000},E=function(G){return G/1000};this.$(".range-bar").slider({range:"min",min:1,max:10,step:1,slide:_.bind(function(G,H){this.$(".dist-range-title").html("<span>"+H.value+"公里内</span>距离")},this),change:_.bind(function(G,H){this.$(".dist-range-title").html("<span>"+H.value+"公里内</span>距离")},this),stop:_.bind(function(G,H){this.model.set("distance",F(H.value));s.listFilterLog({type:"distance",value:F(H.value),mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this)});this.$(".range-bar").slider("value",E(this.model.get("distance")))},renderOptions:function(){var G=this.model.get("poiOptions"),E=this.$dropdownContent.find("ul"),F=0;E.empty();_.each(G,_.bind(function(J,H,I){E.append('<li class="'+(J.count==0?"disabled":"")+'" data-id="'+J.id+'" data-count="'+J.count+'"><i class="icon-checkbox"></i><span class="num">'+J.count+'</span><span class="name">'+J.name+"</span></li>");if(Number(J.count)>F){F=Number(J.count)}},this));E.find(".num").each(function(H,I){$(I).css("width",String(F).length*8)});if(G&&G.length>5){this.$dropdownContent.addClass("scroll-list")}else{this.$dropdownContent.removeClass("scroll-list")}},renderSelected:function(){var I=this.model.get("poiId"),H=this.model.get("positionName"),J=this.model.get("poiOptions");this.$dropdownContent.find("li").each(function(K,O){var Q=$(O),P=Q.data("id"),N=Q.data("count");if(P===I){if(Q.hasClass("disabled")){Q.removeClass("disabled")}Q.addClass("on")}else{if(N==0){Q.addClass("disabled")}Q.removeClass("on")}});var F=H?this.$(".htb-title span"):this.$dropdownTrigger.find("span:eq(1)"),E=this.$dropdownTrigger.find(".dist-num");if(H){F.html(Math.round(this.model.get("distance")/1000)+"公里以内")}else{E.html(Math.round(this.model.get("distance")/1000)+"公里")}if(I){var G=_.find(this.model.get("poiOptions"),function(K){return K.id==I});if(G){F.addClass("active").html(G.name);E.addClass("active");if(G.name.length>10){F.html(G.name.slice(0,8)+"...")}}}else{if(!H){F.removeClass("active").html("选择地点");E.removeClass("active")}}}});var C=f.AvailableSwitchView=Backbone.View.extend({initialize:function(){this.render();this.renderSelected()},delegateEvents:function(){this.$el.on("click.delegateEvents",".mui-switch",_.bind(function(E){this.model.set("hasBookingRooms",!this.model.get("hasBookingRooms"));s.listFilterLog({type:"hasBookingRooms",value:!this.model.get("hasBookingRooms")?"有房":"全部",mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this));this.listenTo(this.model,"change:isFixedDate change:guests change:isFixedGuests",this.render);this.listenTo(this.model,"change:hasBookingRooms",this.renderSelected);C.__super__.delegateEvents.call(this)},undelegateEvents:function(){C.__super__.undelegateEvents.call(this)},render:function(){var E=this.model.get("guests");if(this.model.get("isFixedDate")&&this.model.get("isFixedGuests")&&E.numberAdults===a.numberAdults&&E.numberChildren===a.numberChildren){this.$el.show()}else{this.$el.hide()}},renderSelected:function(){if(this.model.get("hasBookingRooms")){this.$(".mui-switch").removeClass("right")}else{this.$(".mui-switch").addClass("right")}}});var t=f.CheckboxListView=Backbone.View.extend({initialize:function(){this.renderOptions();this.renderSelected()},delegateEvents:function(){this.$el.on("click.delegateEvents","a",_.bind(function(G){var E=$(G.currentTarget),I=E.data("id");if(I==="hasFaved"){this.model.set("hasFaved",!this.model.get("hasFaved"));s.listFilterLog({type:"hasFaved",value:!this.model.get("hasFaved"),mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}else{var I=Number(I),H=_.clone(this.model.get("addedTags"));if(_.contains(H,I)){H=_.without(H,I)}else{H.push(I)}this.model.set("addedTags",H);var F=[];_.each(H,_.bind(function(K,J,O){var N=_.find(this.model.get("addedTagOptions"),function(P){return P.id===K});if(N){F.push(N.name)}},this));if(I===19455){s.listFilterLog({type:"subway",value:_.contains(H,I)?0:1,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}else{s.listFilterLog({type:"addedTags",value:F,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}}},this));this.listenTo(this.model,"change:hasFaved",this.renderSelected);this.listenTo(this.model,"change:addedTags",this.renderSelected);t.__super__.delegateEvents.call(this)},undelegateEvents:function(){t.__super__.undelegateEvents.call(this)},renderOptions:function(){_.each(this.model.get("addedTagOptions"),_.bind(function(F,E,G){this.$el.append('<a class="mui-checkbox" href="javascript:;" data-id="'+F.id+'"><i class="icon-checkbox"></i>'+(F.html?F.html:F.name)+"</a>")},this));this.$el.append('<a class="mui-checkbox" href="javascript:;" data-id="hasFaved"><i class="icon-checkbox"></i>收藏</a>')},renderSelected:function(){var E=this.model.get("addedTags");this.$("a").each(_.bind(function(F,H){var G=$(H),I=G.data("id");if(I==="hasFaved"){if(this.model.get("hasFaved")){G.addClass("on")}else{G.removeClass("on")}}else{if(_.contains(E,I)){G.addClass("on")}else{G.removeClass("on")}}},this))}});var r=f.KeywordFilterView=Backbone.View.extend({initialize:function(){this.renderInput()},delegateEvents:function(){this.$el.on("click.delegateEvents",".htb-icon-search",_.bind(function(F){var E=$.trim(this.$("input").val());this.model.set("keyword",E);s.listFilterLog({type:"keyword",value:E,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this)).on("keyup.delegateEvents","input",_.bind(function(F){var E=$.trim(this.$("input").val());if(F.keyCode===13){this.model.set("keyword",E);s.listFilterLog({type:"keyword",value:E,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}if(this.model.get("keyword")&&E!==this.model.get("keyword")){this.model.set("keyword","",{isUnReset:true});s.listFilterLog({type:"keyword",value:"clear",mddid:this.model.get("mddid"),entrance_type:c.entrance_type})}if(E){this.$(".icon-search-clear").show()}else{this.$(".icon-search-clear").hide()}},this)).on("click.delegateEvents",".icon-search-clear",_.bind(function(E){this.model.set("keyword","");s.listFilterLog({type:"keyword",value:"clear",mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this));this.listenTo(this.model,"change:keyword",this.renderInput);r.__super__.delegateEvents.call(this)},undelegateEvents:function(){r.__super__.undelegateEvents.call(this)},renderInput:function(G,E,F){var H=this.model.get("keyword");if(H){if(!this.$("input").val()){this.$("input").val(H);this.$(".icon-search-clear").show()}this.$(".htb-searchbar").addClass("active")}else{if(F&&!F.isUnReset){this.$("input").val("");this.$(".icon-search-clear").hide()}this.$(".htb-searchbar").removeClass("active")}}});var e=f.SorterView=Backbone.View.extend({initialize:function(){this.render();this.renderSelected()},delegateEvents:function(){this.$el.on("click.delegateEvents","a",_.bind(function(G){var F=$(G.currentTarget).data("type"),E=_.clone(this.model.get("sort"));if(F=="price"){if(E[0]=="price"){if(E[1]=="DESC"){E[1]="ASC"}else{E[1]="DESC"}}else{E[1]="ASC"}}E[0]=F;if(F!="price"){E[1]=F=="distance"?"ASC":"DESC"}this.model.set("sort",E);s.listFilterLog({type:"sort",value:E,mddid:this.model.get("mddid"),entrance_type:c.entrance_type})},this));this.listenTo(this.model,"change:sort",this.renderSelected);this.listenTo(this.model,"change:poiId",this.render);this.listenTo(this.model,"change:poiId",this.renderSelected);r.__super__.delegateEvents.call(this)},undelegateEvents:function(){r.__super__.undelegateEvents.call(this)},render:function(){this.$el.empty().append('<a href="javascript:;" data-type="comment">人气</a>').append('<a href="javascript:;" data-type="hot">销量</a>').append('<a class="price-sort" href="javascript:;" data-type="price"><i></i>价格</a>');if(this.model.get("poiId")){this.$el.append('<a href="javascript:;" data-type="distance">距离</a>')}},renderSelected:function(){var F=this.model.get("sort"),J=F[0],G=F[1],I=this.$('[data-type="comment"]'),K=this.$('[data-type="hot"]'),E=this.$('[data-type="price"]'),H=this.$('[data-type="distance"]');if(J==="comment"){I.html("综合排序").addClass("on")}else{I.html("综合排序").removeClass("on")}if(J==="hot"){K.html("销量从高到低").addClass("on")}else{K.html("销量").removeClass("on")}if(J==="price"){E.addClass("on");if(G==="DESC"){E.removeClass("price-up").addClass("price-down")}else{E.removeClass("price-down").addClass("price-up")}}else{E.removeClass("on price-up price-down")}if(H[0]){if(J==="distance"){H.html("距离最近").addClass("on")}else{H.html("距离").removeClass("on")}}}});b.exports=f});(function(c){var b=c.scrollTo=function(e,d,f){c(window).scrollTo(e,d,f)};b.defaults={axis:"xy",duration:parseFloat(c.fn.jquery)>=1.3?0:1,limit:true};b.window=function(d){return c(window)._scrollable()};c.fn._scrollable=function(){return this.map(function(){var e=this,f=!e.nodeName||c.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!f){return e}var d=(e.contentWindow||e).document||e.ownerDocument||e;return/webkit/i.test(navigator.userAgent)||d.compatMode=="BackCompat"?d.body:d.documentElement})};c.fn.scrollTo=function(i,h,d){if(typeof h=="object"){d=h;h=0}if(typeof d=="function"){d={onAfter:d}}if(i=="max"){i=9000000000}d=c.extend({},b.defaults,d);h=h||d.duration;d.queue=d.queue&&d.axis.length>1;if(d.queue){h/=2}d.offset=a(d.offset);d.over=a(d.over);return this._scrollable().each(function(){if(!i){return}var m=this,j=c(m),k=i,g,e={},l=j.is("html,body");switch(typeof k){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(k)){k=a(k);break}k=c(k,this);if(!k.length){return}case"object":if(k.is||k.style){g=(k=c(k)).offset()}}c.each(d.axis.split(""),function(s,q){var o=q=="x"?"Left":"Top",u=o.toLowerCase(),r="scroll"+o,p=m[r],n=b.max(m,q);if(g){e[r]=g[u]+(l?0:p-j.offset()[u]);if(d.margin){e[r]-=parseInt(k.css("margin"+o))||0;e[r]-=parseInt(k.css("border"+o+"Width"))||0}e[r]+=d.offset[u]||0;if(d.over[u]){e[r]+=k[q=="x"?"width":"height"]()*d.over[u]}}else{var t=k[u];e[r]=t.slice&&t.slice(-1)=="%"?parseFloat(t)/100*n:t}if(d.limit&&/^\d+$/.test(e[r])){e[r]=e[r]<=0?0:Math.min(e[r],n)}if(!s&&d.queue){if(p!=e[r]){f(d.onAfterFirst)}delete e[r]}});f(d.onAfter);function f(n){j.animate(e,h,d.easing,n&&function(){n.call(this,i,d)})}}).end()};b.max=function(h,g){var k=g=="x"?"Width":"Height",f="scroll"+k;if(!c(h).is("html,body")){return h[f]-c(h)[k.toLowerCase()]()}var j="client"+k,i=h.ownerDocument.documentElement,e=h.ownerDocument.body;return Math.max(i[f],e[f])-Math.min(i[j],e[j])};function a(d){return typeof d=="object"?d:{top:d,left:d}}})(jQuery);if(window.M&&typeof window.M.define=="function"){window.M.define("/js/jquery.scrollTo.js",function(){return jQuery})}M.define("dialog/Layer",function(a){var g=0,f=550,d=(function(){return $.browser&&$.browser.msie&&parseInt($.browser.version,10)==7}()),c=(function(){return $.browser&&$.browser.msie&&parseInt($.browser.version,10)<7}());function b(){return g++}function e(h){this.opacity=0.8;this.background="#fff";this.impl="Dialog";this.fixed=true;M.mix(this,h);this.id="_j_layer_"+b();this.stacks=[];this.activeStackId=null;this.overflow=false;this.changeFixed=false;e.instances[this.id]=this;if(!e[this.impl]){e[this.impl]=[]}e[this.impl].push(this.id);this.init()}e.prototype={init:function(){this._createPanel()},_createPanel:function(){f++;var h={position:(!c&&this.fixed)?"fixed":"absolute",width:"100%",height:"100%",top:0,left:0},j=M.mix({},h,{"z-index":f,display:"none"}),k=M.mix({},h,{position:!c?"fixed":"absolute",background:this.background,opacity:this.opacity,"z-index":-1}),i=M.mix({},h,{"z-index":0},(!c&&this.fixed)?{"overflow-x":"hidden","overflow-y":"hidden"}:{overflow:"visible"});this._panel=$('<div id="'+this.id+'" class="layer _j_layer">                                <div class="layer_mask _j_mask"></div>                                <div class="layer_content _j_content"></div>                            </div>').css(j).appendTo("body");this._mask=this._panel.children("._j_mask").css(k);this._content=this._panel.children("._j_content").css(i)},setZIndex:function(h){f=h;this._panel.css("z-index",f)},getZIndex:function(){return +this._panel.css("z-index")},toFront:function(){this.setZIndex(f+1)},setFixed:function(h){h=!!h;if(this.fixed!=h){this.changeFixed=true;this.fixed=h;if(!c&&this.fixed){this._panel.css("position","fixed");this._content.css({position:"fixed","overflow-x":"hidden","overflow-y":"hidden"})}else{this._panel.css("position","absolute");this._content.css({position:"absolute","overflow-x":"","overflow-y":"",overflow:"visible"})}}else{this.changeFixed=false}},newStack:function(i){var h=$(i).appendTo(this._content);this.stacks.push(h);return this.stacks.length-1},getStack:function(h){return this.stacks[h]},getActiveStack:function(){return this.stacks[this.activeStackId]},setActiveStack:function(h){this.activeStackId=h},getPanel:function(){return this._panel},getMask:function(){return this._mask},getContent:function(){return this._content},show:function(j){var i=this;if(this.visible){typeof j==="function"&&j();return}e.activeId=this.id;this.visible=true;if(c){var h=document.documentElement&&document.documentElement.scrollHeight||document.body.scrollHeight;this._panel.css("height",h);this._mask.css("height",h)}this._panel.fadeIn(200,function(){typeof j==="function"&&j()})},hide:function(i){var h=this;if(!this.visible){typeof i==="function"&&i();return}this.visible=false;if(c){this._panel.css("height","");this._mask.css("height","")}this._panel.fadeOut(200,function(){typeof i==="function"&&i();h._recoverTopScroller()})},setOverFlow:function(h){this.overflow=h;if(h){if(!c&&this.fixed){this._hideTopScroller();this._content.css("overflow-y","auto")}}else{if(!c&&this.fixed){this._content.css("overflow-y","hidden")}}},_hideTopScroller:function(){if(d){$("html").css("overflow","hidden")}else{if(!c){$("body").css("overflow","hidden")}else{$("body").css("overflow-x","hidden");this._panel.height($(document).height()+20)}}},_recoverTopScroller:function(){if(d){$("html").css("overflow","")}else{if(!c){$("body").css("overflow","")}else{$("body").css("overflow-x","")}}},destroy:function(){this.hide($.proxy(function(){this._panel&&this._panel.remove();this._panel=null;if(M.indexOf(e[this.impl],this.id)!=-1){e[this.impl].splice(M.indexOf(e[this.impl],this.id),1)}delete e.instances[this.id]},this))},clear:function(){this._content.empty();this.stacks=[];this.activeStackId=null}};e.instances={};e.activeId=null;e.getInstance=function(h){return e.instances[h]};e.getActive=function(h){var i=e.getInstance(e.activeId);if(h&&i){i=i.impl===h?i:null}return i};e.getImplInstance=function(i){var h=e.getActive(i);if(!h&&M.is(e[i],"Array")&&e[i].length){h=e.getInstance(e[i][e[i].length-1])}return h};e.closeActive=function(){var h=e.getActive();if(h&&h.getActiveStack()){h.getActiveStack().trigger("close")}};$(document).keyup(function(h){if(h.keyCode==27){e.closeActive()}});$(document).unload(function(){M.forEach(e.instances,function(){e.destroy()})});return e});M.define("dialog/DialogBase",function(b){var e=b("dialog/Layer"),a=M.Event,d=(function(){return $.browser&&$.browser.msie&&parseInt($.browser.version,10)<7}());function c(f){this.newLayer=false;this.width="";this.height="";this.background="#000";this.panelBackground="#fff";this.bgOpacity=0.7;this.stackable=true;this.fixed=true;this.reposition=false;this.autoPosition=true;this.minTopOffset=20;this.layerZIndex=-1;this.impl="Dialog";M.mix(this,f);this.visible=false;this.destroyed=false;this.positioned=false;this.resizeTimer=0;this.init()}c.prototype={tpl:"<div />",init:function(){this._createDialog();this._bindEvents()},_createDialog:function(){this._panel=$(this.tpl).css({position:"absolute",opacity:0,display:"none",background:this.panelBackground,"z-index":0});this.setRect({width:this.width,height:this.height});this._layer=!this.newLayer&&e.getImplInstance(this.impl)||new e({impl:this.impl});if(this.layerZIndex>=0){this._layer.setZIndex(this.layerZIndex)}this._layer.setFixed(this.fixed);this._layer.getMask().css({background:this.background,opacity:this.bgOpacity});this._stackId=this._layer.newStack(this._panel);this.setPanelContent()},_bindEvents:function(){var f=this;$(window).resize($.proxy(this.resizePosition,this));M.Event(this).on("resize",$.proxy(this.resizePosition,this));this._panel.delegate("._j_close, a[data-dialog-button]","click",function(g){var h=$(g.currentTarget).attr("data-dialog-button");if(h=="hide"){f.hide()}else{f.close()}g.preventDefault()});this._panel.bind("close",function(g,h){f.close(h)})},resizePosition:function(){var f=this;clearTimeout(this.resizeTimer);if(f.visible&&f.autoPosition){this.resizeTimer=setTimeout(function(){f.setPosition()},100)}},addClass:function(f){this._panel.addClass(f)},removeClass:function(f){this._panel.removeClass(f)},setRect:function(f){if(f.width){this._panel.css("width",f.width);this.width=f.width}if(f.height){this._panel.css("height",f.height);this.height=f.height}},getPanel:function(){return this._panel},getLayer:function(){return this._layer},getMask:function(){return this._layer&&this._layer.getMask()},setPanelContent:function(){},_getPanelRect:function(){var f=this.getPanel(),g=f.outerHeight(),h=f.outerWidth();if(!f.is(":visible")){f.css({visibility:"hidden",display:"block"});var g=f.outerHeight(),h=f.outerWidth();f.css({visibility:"",display:""})}return{height:g,width:h}},_getNumric:function(f){f=parseInt(f,10);return isNaN(f)?0:f},setPosition:function(f){var g=this._getPanelRect(),h={width:$(window).width(),height:$(window).height()};var k=(h.width-(this._getNumric(this.width)>0?this._getNumric(this.width):g.width))/2,j=(h.height-(this._getNumric(this.height)>0?this._getNumric(this.height):g.height))*4/9;j=j<this.minTopOffset?this.minTopOffset:j;if(d||!this.fixed){var i=$(window).scrollTop();if(i>0){j+=i}}f={left:(f&&f.left)||k,top:(f&&f.top)||j};if(!d&&this.fixed){if(h.height-g.height<=f.top){this.getPanel().addClass("dialog_overflow");this._layer.setOverFlow(true)}else{this.getPanel().removeClass("dialog_overflow");this._layer.setOverFlow(false)}}var l=this.positioned?"animate":"css";$.fn[l].call(this.getPanel(),f,200);this.positioned=true;this.position=f},setFixed:function(f){this.fixed=!!f;this._layer.setFixed(this.fixed)},getPosition:function(){return this.position},show:function(f){if(this.visible){return}var h=this;a(this).fire("beforeshow");var g;if(this._layer.getActiveStack()){g=this._layer.getActiveStack();if(!this.reposition&&!f&&!this._layer.changeFixed){f=this._layer.getActiveStack().position()}}this._layer.show();this.getPanel().css({display:"","z-index":1});this.setPosition(f);g&&g.trigger("close",[true]);this.visible=true;this._layer.setActiveStack(this._stackId);this.getPanel().animate({opacity:1},{queue:false,duration:200,complete:function(){a(h).fire("aftershow")}})},close:function(){var f=this.stackable?"hide":"destroy";this[f].apply(this,Array.prototype.slice.call(arguments))},hide:function(g,f){if(typeof g=="function"){f=g;g=undefined}if(!this.visible){typeof f=="function"&&f();return}a(this).fire("beforeclose");a(this).fire("beforehide");this._layer.setActiveStack(null);this.visible=false;if(!g){this._layer.hide()}this.getPanel().animate({opacity:0},{queue:false,duration:200,complete:$.proxy(function(){this.getPanel().css({display:"none","z-index":0});a(this).fire("afterhide");a(this).fire("afterclose");typeof f=="function"&&f()},this)})},destroy:function(g,f){if(typeof g=="function"){f=g;g=undefined}if(this.destroyed){M.error("Dialog already destroyed!");typeof f=="function"&&f();return}a(this).fire("beforeclose");a(this).fire("beforedestroy");this.destroyed=true;this.hide(g,$.proxy(function(){if(this._panel.length){this._panel.undelegate();this._panel.unbind();this._panel.remove();this._panel=null}this._layer=null;a(this).fire("afterdestroy");a(this).fire("afterclose");typeof f=="function"&&f()},this))}};return c});M.define("dialog/Dialog",function(c){var d=c("dialog/DialogBase"),a='<div class="popup-box layer_dialog _j_dialog pop_no_margin">                    <div class="dialog_title" style="display:none"><div class="_j_title title"></div></div>                    <div class="dialog_body _j_content"></div>                    <a id="popup_close" class="close-btn _j_close"><i></i></a>                </div>';var b=M.extend(function(e){this.content="";this.title="";this.PANEL_CLASS="";this.MASK_CLASS="";b.$parent.call(this,e)},d);M.mix(b.prototype,{tpl:a,setPanelContent:function(){this._dialogTitle=this._panel.find("._j_title");this._dialogContent=this._panel.find("._j_content");this.setTitle(this.title);this.setContent(this.content);this.addClass(this.PANEL_CLASS);this.getMask().addClass(this.MASK_CLASS)},setTitle:function(e){if(e){this._dialogTitle.html(e).parent().css("display","")}else{this._dialogTitle.parent().css("display","none")}this.title=e},getTitle:function(){return this.title},setContent:function(e){this._dialogContent.empty().append(e)}});return b});M.define("dialog/alert",function(e,d){var b=e("dialog/Dialog"),a='<div id="popup_container" class="popup-box new-popbox"><a class="close-btn _j_close"><i></i></a><div class="pop-ico" id="_j_alertpopicon"><i class="i1"></i></div><div class="pop-ctn"><p class="hd _j_content"></p><p class="bd _j_detail"></p></div><div class="pop-btns"><a role="button" tabindex="0" class="popbtn popbtn-submit _j_close">&nbsp;确定&nbsp;</a></div></div>',f=M.extend(function(j){var i={width:420,content:"请输入内容",background:"#000",bgOpacity:0.7,PANEL_CLASS:"pop_no_margin",reposition:true,impl:"Alert",layerZIndex:10000};j=M.mix(i,j);f.$parent.call(this,j);this.bindEvents()},b),g=null,h=$.noop;M.mix(f.prototype,{tpl:a,setAlertTitle:function(i){this.setContent(i)},setAlertContent:function(i){this.getPanel().find("._j_detail").text(i)},setAssureWords:function(i){this.getPanel().find(".popbtn-submit").text(i)},setCloserHide:function(i){if(i){this.getPanel().find(".close-btn").hide()}else{this.getPanel().find(".close-btn").show()}},bindEvents:function(){var i=this.getPanel();i.on("keydown",".pop-btns ._j_close",function(j){if(j.keyCode==13){$(this).trigger("click")}}).on("click",".pop-btns ._j_close",function(j){i.data("btn_trigger",true)})}});var c=function(i,k,j){if(!g){g=new f();M.Event(g).on("afterhide",function(){var l=g.getPanel();if(typeof h=="function"){h.call(g,l)}l.data("btn_trigger",false)});M.Event(g).on("aftershow",function(){g.getPanel().find(".pop-btns ._j_close").focus()})}g.getLayer().toFront();if(M.isObject(i)){g.setAlertTitle(i.title);g.setAlertContent(i.content)}else{g.setAlertTitle(i);g.setAlertContent("")}if(M.isObject(i)){if(i.assureWords){g.setAssureWords(i.assureWords)}else{g.setAssureWords("确定")}if(i.hideCloser){g.setCloserHide(true)}else{g.setCloserHide(false)}}else{g.setAssureWords("确定");g.setCloserHide(false)}if(typeof k=="function"){h=k}else{h=$.noop}if(j){$("#_j_alertpopicon").children("i").attr("class","i"+j)}else{$("#_j_alertpopicon").children("i").attr("class","i"+1)}g.show();return g};d.pop=c;d.warning=function(i,j){c(i,j,1)};d.tip=function(i,j){c(i,j,3)}});M.define("/js/hotel/module/FavDialog",function(e,c){var b=e("dialog/Dialog"),f=e("dialog/alert"),a=e("/js/hotel/module/Log"),d='<div class="popup-box hotel-fav-dialog"><div class="popup-title"><h2>将酒店收藏到</h2><a href="javascript:;" class="close-btn _j_close"><i></i></a></div><div class="packet-list"><ul></ul></div><div class="popup-packet"><div class="cre-group"><a href="javascript:;"><i></i>创建个性分组</a><button type="button" style="display:none;">完成</button></div><div class="int-name" style="display:none;"><input type="text" placeholder="分组名称"><a href="javascript:;">确定</a></div></div></div>',h=M.extend(function(j){var i={width:350,content:"",background:"#000",bgOpacity:0.7,PANEL_CLASS:"pop_no_margin",reposition:true,impl:"hotelFavDialog",layerZIndex:10000};j=M.mix(i,j);h.$parent.call(this,j);this.bindEvents()},b),g;M.mix(h.prototype,{tpl:d,poiId:null,pageType:"unknown",bindEvents:function(){this.getPanel().on("click",".packet-list ul li a",M.bind(function(i){var k=$(i.currentTarget).closest("li"),j=k.data("hotelFavTagRelId");if(k.hasClass("on")&&j){k.removeClass("on").removeData("hotelFavTagRelId")}else{k.addClass("on").data("hotelFavTagRelId",this.poiId);this.getPanel().find(".cre-group button").show()}},this)).on("click",".cre-group a",M.bind(function(i){this.getPanel().find(".cre-group").hide().end().find(".int-name").show().end().find("input").trigger("focus")},this)).on("click",".int-name a",M.bind(function(j){var i=$.trim(this.getPanel().find('.int-name input[type="text"]').val());if(i.length===0){f.pop("分组名称不能为空");return true}if(i.replace(/[^\x00-\xff]/gi,"--").length>26){f.pop("分组名称过长");return true}$.post("/hajax/collect/addFolder",{name:i},"json").done(M.bind(function(l){if(1==l.status){var n=l.data.id,k=l.data,m=$('<li data-hotel-fav-tag-id="'+k.id+'"><a href="javascript:;" class="clearfix"><div class="cover"></div><span style="width:240px;overflow: hidden;text-overflow:ellipsis;white-space: nowrap;">'+k.folder_name+"</span><i></i></a></li>").appendTo(this.getPanel().find(".packet-list ul"))}else{f.pop(l.msg)}this.getPanel().find('.int-name input[type="text"]').val("").end().find(".int-name").hide().end().find(".cre-group").show()},this))},this)).on("click",".cre-group button",M.bind(function(i){var j=new Array();$(".packet-list ul li.on").each(function(){j.push($(this).attr("data-hotel-fav-tag-id"))});if(j.length>0){$.post("/hajax/collect/addCollection",{sFolderId:j.join(","),iHotelId:this.poiId},"json").done(M.bind(function(k){if(1==k.status){f.pop("添加成功");this.hide()}else{f.pop("添加失败")}},this))}else{this.hide()}},this));this.getLayer().getPanel().on("click",M.bind(function(i){if($(i.target).is(this.getLayer().getContent())){this.hide()}},this));return this},reset:function(){this.getPanel().find('.int-name input[type="text"]').val("").end().find(".int-name").hide().end().find(".cre-group button").hide().end().find(".cre-group").show();this.renderFavTagList();return this},renderFavTagList:function(){var i=this.getPanel().find(".packet-list ul");i.empty();$.get("/hajax/collect/folderList",{},"json").done(M.bind(function(m){if(1==m.status){var n=m.data.folderList,l=false;for(var k=0;k<n.length;k++){var j=n[k];if(j.id!=0){l=true;i.append('<li data-hotel-fav-tag-id="'+j.id+'"><a href="javascript:;" class="clearfix"><span style="width:240px;overflow: hidden;text-overflow:ellipsis;white-space: nowrap;">'+j.folder_name+"</span><i></i></a></li>")}}}else{i.append("<li>获取分组列表失败</li>")}},this)).fail(M.bind(function(){i.append("<li>获取分组列表失败</li>")},this));return this}});c.pop=function(j,i){if(!g){g=new h()}g.poiId=j;g.pageType=i;g.show();g.reset()}});M.define("/js/hotel/list_mvc_data_view",function(d,e,c){d("/js/jquery.scrollTo.js");var i=d("/js/hotel/module/FavDialog"),j=M.cssSupport("transitiosn"),g=M.cssSupport("transform"),f=d("/js/hotel/module/Log"),h=window.Env||{};var a={};var b=a.TotalTextView=Backbone.View.extend({delegateEvents:function(){this.listenTo(this.model,"sync:data",this.render);b.__super__.delegateEvents.call(this)},undelegateEvents:function(){b.__super__.undelegateEvents.call(this)},render:function(m){var n=m&&m.msg;if(!m||m.ret!==1||!n){return false}this.$el.html("<span>"+n.count+"</span> 家酒店");var l=n.count>0?1:0;f.listDataLog({type:"hotel_count",value:l});if(h.hotel_activity_type===1){$(".hotel-sale-banner").css("background-image",'url("http://images.mafengwo.net/images/hotel/hotel_index/20180417-banner.png")')}else{if(h.hotel_activity_type===2){$(".hotel-sale-banner").css("background-image",'url("http://images.mafengwo.net/images/hotel/hotel_index/20180418-banner.png")')}else{$(".hotel-sale-banner").remove()}}}});var k=a.ListDataView=Backbone.View.extend({initialize:function(){this.$loading=$("#_j_hotel_list_loading")},delegateEvents:function(){this.$el.on("click.delegateEvents","._j_pageitem",_.bind(function(l){l.preventDefault();var m=Number($(l.currentTarget).data("value"));m&&this.model.set("page",m);setTimeout(function(){var n=$("#_j_feature_tab");if(n[0]){$(window).scrollTo(n.offset().top,400)}else{$(window).scrollTo($("#_j_price_slider").offset().top,400)}},1)},this)).on("click.delegateEvents",".not-found a",_.bind(function(o){var l=$(o.currentTarget),n=l.data("type"),p=l.data("value");if(n==="areaId"){this.model.set("areaId",-1)}if(n==="feature"){this.model.set("feature",0)}if(n==="price"){this.model.set("price",[0,Infinity])}if(_.contains(["star","type","facility","brand","airbnbRoom","airbnbBedroom","airbnbFacility","airbnbPropertyType"],n)){var m=_.clone(this.model.get(n));if(_.contains(m,Number(p))){m=_.without(m,Number(p))}this.model.set(n,m)}if(n==="poiId"){this.model.set("poiId",null)}if(n==="addedTags"){var q=_.clone(this.model.get("addedTags"));if(_.contains(q,Number(p))){q=_.without(q,Number(p))}this.model.set("addedTags",q);Number(p)===19455&&(n="subway")}if(n==="hasFaved"){this.model.set("hasFaved",false)}if(n==="keyword"){this.model.set("keyword","")}f.listFilterLog({type:"nonResult",value:n,mddid:this.model.get("mddid"),entrance_type:h.entrance_type})},this)).on("click.delegateEvents",'a[data-type="area"]',_.bind(function(l){l.preventDefault();var m=Number($(l.currentTarget).data("id"));if(m||m===0){this.model.set("areaId",m)}setTimeout(function(){$(window).scrollTo($("#_j_area_wrapper").offset().top,400)},1)},this)).on("click.delegateEvents","._j_booking_btn",_.bind(function(u){u.preventDefault();var v=$(u.currentTarget),t=v.data("ota"),m=v.data("url"),s=v.find("._j_booking_price").is(":visible")?v.find("._j_booking_price").find("strong").eq(1).html():1000000,n=this.model.get("date"),o=v.closest(".hotel-btns").find("._j_booking_btn"),p=o.index(v)+1;if(t==="youyu_pkg"||t==="youyu"){var x=/([\S\s]*j=)([\S\s]*)/;var r=x.exec(m)||[];var w=r[2]?decodeURIComponent(r[2]):"";m=r[1]?r[1]:m;w=w.replace(/[\S\s]*(?=\?)/,"https://www.mafengwo.cn/hotel_zx/hotel/index.php");m+=encodeURIComponent(w);m+=encodeURIComponent("&")+"ref=list"+encodeURIComponent("&")+"price="+s+encodeURIComponent("&")+"ota="+t}if((t==="youyu_pkg"||t==="youyu")&&(typeof v.data("ota-id")!=="undefined")){m+=encodeURIComponent("&")+"iOtaId="+v.data("ota-id")}m+="&checkin_date="+n.checkIn+"&checkout_date="+n.checkOut+"&button_index="+p;if(t==="airbnb"){var y=this.model.get("feature"),q=this.model.getParams("data"),l="none";if(q.iPriceMin||q.iPriceMax||q.sTags||q.iPoiId||q.sKeyWord){l="common"}if(y===19646){l="airbnb"}!!mfwPageEvent&&mfwPageEvent("hotel","airbnb_click",{filter_type:l,page_type:"list"})}window.open(m,"_blank")},this)).on("click.delegateEvents","._j_hotel_info_link",_.bind(function(v){v.preventDefault();var s=$(v.currentTarget),t=s.closest("._j_hotel_item"),n=s.attr("href"),r="",m=this.model.get("isFixedDate"),o=this.model.get("date"),x=this.model.get("isFixedGuests"),u=this.model.get("guests");if(t.data("isAirbnb")&&!s.closest("._j_booking_btn")[0]){var w=t.find("._j_booking_btn:eq(0)");if(w[0]){n=w.data("url");n+="&checkin_date="+o.checkIn+"&checkout_date="+o.checkOut+"&button_index=1"}var y=this.model.get("feature"),p=this.model.getParams("data"),l="none";if(p.iPriceMin||p.iPriceMax||p.sTags||p.iPoiId||p.sKeyWord){l="common"}if(y===19646){l="airbnb"}!!mfwPageEvent&&mfwPageEvent("hotel","airbnb_click",{filter_type:l,page_type:"list"});window.open(n,"_blank");return true}if(m){r+="checkin="+o.checkIn+"&checkout="+o.checkOut}if(x){var q=u.childrenAge.join(",");r+=(r?"&":"")+"guests="+u.numberAdults+"-"+u.numberChildren+(q?"-"+q:"")}if(r){n+=(n.indexOf("#")===-1?"#":"&")+r}window.open(n,"_blank")},this)).on("click.delegateEvents","_j_onyx_tips",function(l){window.open("http://cn.amari.com/bestrate_guarantee.aspx","_blank");return false}).on("click.delegateEvents","._j_add_fav",_.bind(function(n){var l=$(n.currentTarget),m=l.data("id");$.post("/hajax/collect/addFav",{iHotelId:m,iSubType:2},function(o){if(o.status==-1){show_login();return false}else{if(o.status==1){l.hide().siblings("._j_del_fav").show();i.pop(m,"list");f.favLog({opt_type:"addFav",page_type:"list",poi_id:m})}else{Alert.pop("添加收藏失败")}}},"json")},this)).on("click.delegateEvents","._j_del_fav",_.bind(function(n){var l=$(n.currentTarget),m=l.data("id");$.post("/hajax/collect/delFav",{sHotelIds:m},function(o){if(o.status==-1){show_login();return false}else{if(o.status==1){l.hide().siblings("._j_add_fav").show()}else{Alert.pop("删除失败")}}},"json")},this));this.listenTo(this.model,"request:data",this.renderLoading);this.listenTo(this.model,"sync:data",this.renderList);this.listenTo(this.model,"sync:data",this.renderMap);M.Event.on("list map init",_.bind(this.renderMap,this));k.__super__.delegateEvents.call(this)},undelegateEvents:function(){k.__super__.undelegateEvents.call(this)},renderLoading:function(){this.$(".not-found").remove();this.$loading.show()},renderList:function(q){var r=q&&q.msg,m=q&&q.html;if(!q||q.ret!==1||!r||!m){return this}this.$loading.hide();if(j&&g){var o=$("<div>").html(m);o.find("._j_hotel_item, #list_paginator").addClass("anim-climb");this.$el.html(m);this.$("._j_hotel_item, #list_paginator").each(function(s,t){setTimeout(function(){$(t).removeClass("anim-climb")},1)})}else{this.$el.html(m)}this.updatePrice();this.updateRoomTemplate();if(!r.count||r.count<=0){var n=this.model.dataVid,p=this.model.tagOptionsXhr,l=this.model.poiOptionsXhr;if(p&&l){$.when(p,l).then(_.bind(function(){if(n!=this.model.dataVid){return false}this.renderSelected()},this))}}},renderMap:function(l){if(!l||l.ret==1){var m=[];this.$("._j_hotel_item").each(function(n,r){var q=$(r),t=q.data("id"),p=q.data("name"),s=q.data("lat"),o=q.data("lng");if(t&&p&&s&&o){m.push({id:t,name:p,lat:s,lng:o})}});M.Event.fire("hotelList changed",{hotelList:m})}},renderSelected:function(){var l=$('<div class="tags"></div>').appendTo(this.$(".not-found"));var v=this.model.get("areaId");if(v!==-1&&h.area_list){var m=_.find(h.area_list,function(A){return A.id===v});if(m){l.append('<a class="tag" href="javascript:;" data-type="areaId" data-value="'+v+'"><span>区域: '+m.name+"</span><i>×</i></a>")}}var z=this.model.get("feature");if(z!==0&&h.feature_tags){var t=_.find(h.feature_tags,function(A){return A.id===z});if(t){l.append('<a class="tag" href="javascript:;" data-type="feature" data-value="'+z+'"><span>特色类型: '+t.name+"</span><i>×</i></a>")}}var q=this.model.get("price");if(q[0]>0||q[1]<4000){var x="";if(q[0]>0){x="大于¥"+q[0]}if(q[1]<4000){x="小于¥"+q[1]}if(q[0]>0&&q[1]<4000){x="¥"+q[0]+" - ¥"+q[1]}l.append('<a class="tag" href="javascript:;" data-type="price" data-value="'+JSON.stringify(q)+'"><span>价格: '+x+"</span><i>×</i></a>")}var w=[];if(this.model.get("mode")==="hotel"){w=[{filter:"star",filterOptions:"starOptions",filterName:"星级"},{filter:"type",filterOptions:"typeOptions",filterName:"住宿类型"},{filter:"facility",filterOptions:"facilityOptions",filterName:"设施"},{filter:"brand",filterOptions:"brandOptions",filterName:"品牌"}]}if(this.model.get("mode")==="airbnb"){w=[{filter:"airbnbRoom",filterOptions:"airbnbRoomOptions",filterName:"整套/合住"},{filter:"airbnbBedroom",filterOptions:"airbnbBedroomOptions",filterName:"卧室数量"},{filter:"airbnbFacility",filterOptions:"airbnbFacilityOptions",filterName:"设施"},{filter:"airbnbPropertyType",filterOptions:"airbnbPropertyTypeOptions",filterName:"住宿类型"}]}_.each(w,_.bind(function(F,B,G){var E=this.model.get(F.filter);if(E.length){for(var C=0;C<E.length;C++){var A=E[C],D=_.find(this.model.get(F.filterOptions),function(H){return A===H.id});if(D){l.append('<a class="tag" href="javascript:;" data-type="'+F.filter+'" data-value="'+A+'"><span>'+F.filterName+": "+D.name+"</span><i>×</i></a>")}}}},this));var o=this.model.get("poiId");if(o){var n=_.find(this.model.get("poiOptions"),function(A){return o===A.id});if(n){l.append('<a class="tag" href="javascript:;" data-type="poiId" data-value="'+o+'"><span>景点: '+n.name+"</span><i>×</i></a>")}}var y=this.model.get("addedTags");if(y.length){for(var p=0;p<y.length;p++){var s=y[p],u=_.find(this.model.get("addedTagOptions"),function(A){return s===A.id});if(u){l.append('<a class="tag" href="javascript:;" data-type="addedTags" data-value="'+s+'"><span>'+u.name+"</span><i>×</i></a>")}}}if(this.model.get("hasFaved")){l.append('<a class="tag" href="javascript:;" data-type="hasFaved" data-value="1"><span>收藏</span><i>×</i></a>')}var r=this.model.get("keyword");if(r){l.append('<a class="tag" href="javascript:;" data-type="keyword" data-value="'+r+'"><span>关键字: '+r+"</span><i>×</i></a>")}},updatePrice:function(){var r=this.model.dataVid,w={},s={},n={},u={},m=["dujiake","zizaike","fishtrip","ezding"],l={},t=this.model;this.$("._j_hotel_item").each(function(H,I){var G=$(I),y=G.data("id"),B=[],F=$.Deferred(),A={},z=true,x={},E={};w[y]={otas:B,otaPriceDeferred:F};F.done(function(){if(r!==t.dataVid){return false}var U=0,R=null,N=null,O=false,P=false,T=null,J=false,K=false,S=null,Q=false;_.each(B,function(X,V,W){if(X.ota==="youyu_pkg"){N=X}if(X.ota==="youyu"){T=X}if(X.ota==="hotelzd"){S=X}});_.each(B,function(X,V,W){if(V>3){return true}})});setTimeout(function(){F.state()==="pending"&&F.resolve()},20000);s[y]=G;G.find("._j_booking_btn").each(function(K,N){var J=$(N),R=J.data("ota"),Q=Number(J.data("price")),P=!!Number(J.data("isCachePrice")),T=!!Number(J.data("isSoldOut")),U=Number(J.data("payType"));if(R==="airbnb"){var O=Number(J.data("minNights")),S="房东要求：最少预定"+O+"晚";if(O>1){J.find(".tips").html('<span class="dis-txt" data-content="'+S+'">'+S+"</span>").show()}}if(R&&P&&!T&&!_.contains(m.concat(["airbnb","onyx"]),R)){z=false}if(R){if(_.contains(m,R)){x[R]=J}else{if(!_.contains(["airbnb","onyx"],R)){E[R]=-1}}}if(R){B.push({ota:R,price:P?(T?0:Q):-1,payType:P?U:-1})}if(!R||(P&&!T)||_.contains([],R)){return true}A[R]=J;u[R]||(u[R]=[]);u[R].push(y)});var C=true;_.each(B,function(N,J,K){if(N.price===-1){C=false}});C&&F.resolve();n[y]=A;if(z&&_.size(E)>0){var D=$.Deferred();D.done(function(J){_.each(l[y].inquiresOtas,function(K,O,N){if(J.isSoldOut){K.addClass("btn-soldout").find("._j_booking_price").hide().end().find("._j_booking_sold_out").show()}else{K.removeClass("btn-soldout").find("._j_booking_sold_out").hide().end().find("._j_booking_price").show()}})});l[y]={inquiresDeferred:D,inquiresOtas:x,realtimeOtas:E}}});var p=this.model.get("mddid"),o=this.model.get("date"),v=this.model.get("guests");if(u.ctrip){var q=u.ctrip;if(q.length>10){u.ctrip=q.slice(0,10);u.ctrip2=q.slice(10,q.length)}}_.each(u,function(x,z){if("ctrip2"===z){z="ctrip"}var y={poi_ids:x.join(","),mddid:p,ota:z,check_in:o.checkIn,check_out:o.checkOut,adults_num:v.numberAdults,children_num:v.numberChildren,children_age:v.childrenAge.join(","),platform:"www"};$.ajax({url:"/hotel/ajax_remote/price",data:y}).done(function(B){var A=B&&B.data;if(r!==t.dataVid||!B||B.error||!A){return}_.each(A,function(C,E){_.each(C.list_promote,function(G,H){if(H===z){G=G.replace(/\s+/g,"");var F=G.length>12?G.substring(0,12)+"...":G;s[E].find('[data-ota="'+z+'"] .tips').html('<span class="dis-txt" data-content="'+G+'">'+F+"</span>").show()}});if($.inArray(z,["youyu","youyu_pkg"])!==-1){var D=n[E][z];if(!!h.hotel_activity_type&&h.is_cnmain===false&&(C.youyu_ota_id===1||C.youyu_ota_id===5||C.youyu_ota_id===9)){if(D.find(".icon-alipay, .icon-wxpay")[0]){D.find(".icon-alipay, .icon-wxpay").hide()}if(h.hotel_activity_type==3){D.find(".name").append('<i class="icon-sale0420" style=""></i>')}else{D.find(".name").append('<i class="icon-sale0417" style=""></i>')}}else{if(D.find(".icon-alipay, .icon-wxpay")[0]){if(C.pay_type===0){D.find(".icon-alipay, .icon-wxpay").show()}else{D.find(".icon-alipay, .icon-wxpay").hide()}}}}_.each(C.list,function(J,Q){if(!w[E]){return true}var O=w[E],I=n[E][z],F=I.closest("._j_hotel_item").find("._j_booking_btn"),G=I.find("._j_booking_price"),R=I.find("._j_booking_sold_out");if(Q==="youyu_pkg"||Q==="youyu"){if(C.youyu_ota_id){I.attr("data-ota-id",C.youyu_ota_id)}}if(Q==z){_.each(O.otas,function(U,S,T){if(U.ota==z){U.price=J>0?J:0;U.payType=Number(C.pay_type)}});var K=true;_.each(O.otas,function(U,S,T){if(U.price===-1){K=false}});K&&O.otaPriceDeferred.resolve();if(J>0){I.removeClass("btn-soldout");R.hide();G.show().find("strong:eq(1)").text(J)}else{if(t.get("isFixedDate")){if(I.data("ota")!=="airbnb"){R.find("span").html("已售罄");I.addClass("btn-soldout");G.hide();R.show()}}else{I.removeClass("btn-soldout");R.hide();G.show()}}if(!_.contains(m,z)){var H=l[E];if(H){H.realtimeOtas[z]=J>0?J:0;var N=true,P=true;_.each(H.realtimeOtas,function(S,U,T){if(-1===S){N=false}if(0<S){P=false}});if(N){H.inquiresDeferred.resolve({isSoldOut:P})}}}}})})})});return this},updateRoomTemplate:function(){var r=function(t){var v={},u,s=t.length,w=[];for(u=0;u<s;u++){var x=t[u];if(x.flow_type==1){if(!v[x.container_type]){v[x.container_type]=x.container_type;w.push(x)}}else{w.push(x)}}return w};var p=this.model.get("mddid"),m=this.model.get("date"),q=this.model.get("guests"),o=null,n=[];$("._j_hotel_item").each(function(w,x){var t=$(x),v=t.data("is-merge_room"),z=t.data("id"),s=$(this).find(".hotel-btns");if(v){var y=[];if(q.numberAdults){y.push(q.numberAdults);if(q.childrenAge.length){y.push(q.childrenAge.join(","))}}else{y.push(2)}var u="/hotel_zx/hotel/index.php?poiid="+z+"&sCheckIn="+m.checkIn+"&sCheckOut="+m.checkOut+"&sRoom="+y.join(",")+"&is_merge_room=1";t.find("._j_hotel_info_link").attr("href",u);s.append('<ul class="room_loading_wrapper"><li></li><li></li><li></li><li></li><li></li></ul>');n.push(z)}});if(n.length>0){var l={mdd_id:p,hotel_ids:n.join(","),check_in:m.checkIn,check_out:m.checkOut,adults_num:q.numberAdults,children_num:q.numberChildren,children_age:q.childrenAge.join(","),};$.ajax({url:"/hajax/get_list_price.php",data:l,}).done(function(v){if(v.code===0){for(var z in v.data){var A=v.data[z],t=A.hotel_id;var u=$(".hotel-item[data-id="+t+"]").find(".hotel-btns");var x=[];if(A.ota_price_ret){var s=r(A.ota_price_ret);for(var w=0;w<s.length;w++){var y=s[w];if(y.price){x.push('<a class="btn-booking _j_booking_btn" href="javascript:" rel="nofollow" data-url="'+y.url+'"><div class="ota"><div class="name">')}else{x.push('<a class="btn-booking _j_booking_btn btn-soldout" href="javascript:" rel="nofollow" data-url="'+y.url+'"><div class="ota"><div class="name">')}if(y.logo&&w<2){x.push('<strong><img src="'+y.logo+'" height="20" width="100">')}else{x.push("<strong>"+y.name)}if(y.flow_type==1){if(y.ota_id==1||y.ota_id==5||y.ota_id==9||y.ota_id==14||y.ota_id==19){x.push('<i class="icon-alipay"></i><i class="icon-wxpay"></i>')}}x.push("</strong></div></div>");if(y.price){x.push('<div class="price _j_booking_price"><strong>￥</strong><strong>');x.push(y.price);x.push('</strong><i class="arrow"></i></div>')}else{x.push('<div class="price _j_booking_sold_out" style=""><span>已售罄</span></div>')}x.push("</a>")}if(x.length){u.html(x.join(""))}else{u.find(".room_loading_wrapper").hide()}}else{u.find(".room_loading_wrapper").hide()}}}else{$(".room_loading_wrapper").hide()}}).fail(function(s){$(".room_loading_wrapper").hide()})}},});c.exports=a});M.closure(function(b){b("jq-jgrowl");var n=b("/js/Dropdown"),p=b("/js/hotel/mfwmap/mfwmap"),o=b("/js/hotel/mfwmap/mfwmap-overlays"),g=b("/js/hotel/module/ListTips"),q=b("Storage"),c=b("/js/hotel/module/Search"),e=b("/js/hotel/module/Captcha"),l=b("/js/hotel/module/Dialog"),i=b("/js/hotel/list_mvc_model"),h=b("/js/hotel/list_mvc_filter_view"),k=b("/js/hotel/list_mvc_data_view"),j=window.Env||{};if(!j.UID&&!j.referrer){var m=new l();var f=m.getContentElem();var a=new e(f);m.show();M.Event(m).on("confirmBtnClick",function(){var r=a.checkedCaptcha(m);if(r){r.done(function(s){console.log(s);if(s.data){m.tipsHide();m.hide();d();return}a.autoFocus();m.setTips("验证码填写错误!")})}})}else{d()}function d(){$(".top-info .crumb").find(".item").each(function(ag,ai){var ah=$(ai);if(!ah.hasClass("cur")){new n({nav:ah.find(".drop"),panel:ah.find(".bd"),delay:400})}});$(".diversion-sales .icon-close").on("click",_.bind(function(ag){$(".diversion-sales").remove()},this));var F=$("#_j_map"),P,r=j.mdd_info.lat,ab=j.mdd_info.lng,J=j.mdd_info.zoom,U=j.area_list,H={},af,ad={},s;if(j.position_info.lat&&j.position_info.lng&&j.position_info.zoom){r=j.position_info.lat;ab=j.position_info.lng;J=j.position_info.zoom}p.createMap({element:F.find(".map-container")[0],lat:r,lng:ab,zoom:J,runtimes:j.is_cnmain?["amap","google","leaflet"]:["google","leaflet"],leafletTileType:_.contains([10183],j.country_mddid)?"arcgis":"mfw",control:{mapType:{visible:false},zoom:{position:p.controlPosition.TOP_RIGHT,amapRuler:false,amapOffset:[0,40]}},channelType:"hotel",pageType:"list"}).then(function(ag){P=ag;if(j.is_cnmain&&p.isWGS84(P.mapType)){if(U&&U.length){U=_.map(U,function(ai,ah,aj){ai.paths=_.map(ai.paths,function(an,al,am){return p.util.gcj2wgs(an.lat,an.lng)});var ak=p.util.gcj2wgs(ai.lat,ai.lng);ai.lat=ak.lat;ai.lng=ak.lng;return ai})}}if(U&&U.length){_.each(U,function(aj,ah,ak){if(!aj.paths||!aj.paths.length){return true}var ai=new p.Polygon({map:P,paths:aj.paths,strokeWeight:2,strokeColor:"#0a89e4",strokeOpacity:0.7});H[aj.id]=ai;ai.addListener("mouseover",function(al,am){S();Q(aj.id)});ai.addListener("mouseout",function(){S()})})}M.Event.on("areaId changed",function(ai){var aj=ai.areaId;if(aj){if(aj==-1){P.setZoom(J);P.panTo(r,ab);S()}else{var ah=_.find(U,function(ak){return ak.id==aj});P.setZoom(J);P.panTo(ah.lat,ah.lng);S();Q(ah.id)}}});M.Event.on("hotelList changed",function(ah){var ai=ah.hotelList;if(ai){_.each(ad,function(aj,al,ak){if(!_.find(ai,function(am){return am.id==al})){aj.remove();delete ad[al]}});_.each(ai,function(am,aj,al){if(!ad[am.id]){var ak=new o.HotelMarker({map:P,lat:am.lat,lng:am.lng,id:am.id,isMiddle:false});ad[am.id]=ak;ak.addListener("click",function(){window.open("/hotel/list_map.php?mddid="+j.mdd_info.mddid+"#ht="+am.id,"_blank")});ak.addListener("mouseover",function(){s&&s.remove();s=new o.HotelMiniInfoWindow({map:P,lat:am.lat,lng:am.lng,id:am.id,name:am.name})});ak.addListener("mouseout",function(){s&&s.remove()})}})}});M.Event.fire("list map init")},function(ag){});function Q(ai){var ah=_.find(U,function(aj){return aj.id==ai}),ag=H[ai];if(ag){ag.setOptions({strokeWeight:4,strokeColor:"#a979cd",zIndex:10});if(af){af.remove()}af=new o.AreaInfoWindow({map:P,lat:ah.lat,lng:ah.lng,name:ah.name})}}function S(){_.each(H,function(ag,ai,ah){ag.setOptions({strokeWeight:2,strokeColor:"#0a89e4",zIndex:0})});if(af){af.remove()}}var N={mddid:j.mdd_info.mddid,areaId:j.area_id,regionId:j.region_id,poiId:j.poi_id||null,positionName:j.position_info.name,lat:j.position_info.lat,lng:j.position_info.lng,addedPoiId:j.poi_id||null,brand:j.brand_id?[j.brand_id]:[]},R=[];if(j.position_info.distance>0){N.distance=j.position_info.distance}if(j.has_subway){R.push({id:19455,name:"临地铁"})}N.addedTagOptions=R;var G=new i.FilterModel(N),K=new h.DatepickerView({model:G,el:"#_j_booking_date"}),u=new h.NumberGuestsPickerView({model:G,el:"#_j_booking_number_guests"}),Z=new h.PriceBtnView({model:G,el:"#_j_price_btn"}),I=new h.AreaView({model:G,el:"#_j_area_wrapper"}),x=new h.RegionView({model:G,el:"#_j_region_wrapper"}),D=new h.PriceSliderView({model:G,el:"#_j_price_slider"}),w=new h.StarFilterView({model:G,el:"#_j_star_filter",filterType:"star",filterOptions:"starOptions",filterName:"星级"}),T=new h.DropdownFilterView({model:G,el:"#_j_type_filter",filterType:"type",filterOptions:"typeOptions",filterName:"住宿类型"}),v=new h.DropdownFilterView({model:G,el:"#_j_facility_filter",filterType:"facility",filterOptions:"facilityOptions",filterName:"设施"}),Y=new h.DropdownFilterView({model:G,el:"#_j_brand_filter",filterType:"brand",filterOptions:"brandOptions",filterName:"品牌"}),O=new h.DropdownFilterView({model:G,el:"#_j_airbnb_room_filter",filterType:"airbnbRoom",filterOptions:"airbnbRoomOptions",filterName:"整套/合住"}),C=new h.DropdownFilterView({model:G,el:"#_j_airbnb_bedroom_filter",filterType:"airbnbBedroom",filterOptions:"airbnbBedroomOptions",filterName:"卧室数量"}),aa=new h.DropdownFilterView({model:G,el:"#_j_airbnb_facility_filter",filterType:"airbnbFacility",filterOptions:"airbnbFacilityOptions",filterName:"设施"}),E=new h.DropdownFilterView({model:G,el:"#_j_airbnb_property_type_filter",filterType:"airbnbPropertyType",filterOptions:"airbnbPropertyTypeOptions",filterName:"住宿类型"}),t=new h.PoiFilterView({model:G,el:"#_j_poi_filter",filterType:"poiId",filterOptions:"poiOptions",filterName:"地点"}),V=new h.AvailableSwitchView({model:G,el:"#_j_available_switch"}),z=new h.CheckboxListView({model:G,el:"#_j_checkbox_list"}),ae=new h.KeywordFilterView({model:G,el:"#_j_keyword_filter"}),A=new h.SorterView({model:G,el:"#_j_sorter"}),X=new k.TotalTextView({model:G,el:"#_j_total_text"}),y=new k.ListDataView({model:G,el:"#_j_hotel_list"});if($("#_j_feature_tab")[0]){var B=new h.FeatureTabView({model:G,el:"#_j_feature_tab"})}var ac=new c({input:"_j_search_input",listContainer:"_j_search_suggest",type:"common",defaultSearch:function(ah,ag){var ai="/hotel/s.php?keyword="+ah;if(!!ag){ai+="&disautomatch=1"}window.location.href=ai}});$("#_j_search_btn").on("click",_.bind(function(ag){ac.defaultSearch()},this));M.Event.on("price btn click",function(){ac.defaultSearch()});function W(){new MouseTip({selector:".icon-bird",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute"><b>畅销酒店：</b>上月销量在该地区前列。</p>').appendTo("body")}});new MouseTip({selector:".icon-birdRed",createTip:function(ag){return $('<p class="rec-tips" style="display:none; position:absolute"><b>人气酒店：</b>人气不错建议提早预订。</p>').appendTo("body")}});new MouseTip({selector:".icon-innAlliance",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute">马蜂窝酒店自助联盟成员认证，点击加入~</p>').appendTo("body")}});new MouseTip({selector:".icon-inntop",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute">掌柜通过马蜂窝酒店自助联盟使用了“顶”，每次6小时，点击加入~</p>').appendTo("body")}});new MouseTip({selector:".hotel-item .icon-subway",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute; width:auto;">出门有地铁</p>').appendTo("body")}});new MouseTip({selector:".icon-alipay",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute; width:auto;">可用支付宝</p>').appendTo("body")}});new MouseTip({selector:".icon-wxpay",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute; width:auto;">可用微信支付</p>').appendTo("body")}});new MouseTip({selector:".icon-activity",createTip:function(ag){return $('<p class="rec-tips-nowrap">12月21日-12月30日 可用优惠券</p>').appendTo("body")}});new MouseTip({selector:".icon-discount7",createTip:function(ag){return $('<p class="rec-tips-nowrap">12月21日-12月30日 可用优惠券</p>').appendTo("body")}});new MouseTip({selector:".icon-flash",createTip:function(ah){var ag=ah.data("value");return $('<p class="rec-tips-nowrap" style="display:none; position:absolute; width:auto;">即时预定</p>').appendTo("body")}});new MouseTip({selector:".medal",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute; width:auto;">优质房东</p>').appendTo("body")}});new MouseTip({selector:".icon-coupon",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute">可用优惠券</p>').appendTo("body")}});new MouseTip({selector:".dis-txt",createTip:function(ag){return $('<p class="rec-tips-nowrap">'+$(ag).data("content")+"</p>").appendTo("body")}});new MouseTip({selector:".hotel-rate",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute">等级评定是针对房价，设施和服务等各方面水平的综合评估。</p>').appendTo("body")}});new MouseTip({selector:".icon-rank",createTip:function(ai){var ag=$(ai),ah="过去12个月";if(!/red-/gi.test(ag.attr("class"))){ah+="此区域"}if(/first/gi.test(ag.attr("class"))){ah+="订单第一名。"}if(/second/gi.test(ag.attr("class"))){ah+="订单第二名。"}if(/third/gi.test(ag.attr("class"))){ah+="订单第三名。"}return $('<p class="rec-tips-nowrap">'+ah+"</p>").appendTo("body")}})}W();new MouseTip({selector:".icon-signpost",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute">点击查看详细攻略</p>').appendTo("body")}});new MouseTip({selector:".icon-photos",createTip:function(ag){return $('<p class="rec-tips-nowrap" style="display:none; position:absolute">查看区域街景</p>').appendTo("body")}});setTimeout(function(){g.addListVisitor(j.mdd_info.mddid)},8000)}});$(function(){$.ajax({url:"/hotel/ajax_remote/appGuide",dataType:"json"}).done(function(a){if(!a){return}var b="";if(a.data===1){b="qrcode_new_user_coupon.png"}else{if(a.data===2){b="qrcode_app.png"}}if(b){$("body").append('<div id="_j_pc_app_guide" style="position: fixed;right: 50%;bottom: 20px;margin-right: -718px;z-index: 10;"><i id="_j_pc_app_guide_close_btn" style="width: 20px;height: 20px;border-radius: 20px;color:#fff;background: rgba(0,0,0,0.4);position: absolute;top:10px;right: 10px;font-size: 20px;font-style: normal;text-align: center;line-height: 20px;cursor: pointer;">×</i><img src="'+location.protocol+"//"+Env.IMG_HOST+"/images/hotel/pc_app_guide/"+b+'" style="width: 150px;height: 175px;"></div>');$("#_j_pc_app_guide_close_btn").on("click",function(c){$("#_j_pc_app_guide").hide()})}})});M.define("PageAdmin",function(b){var e={},c=d();e.uuid=window.Env&&window.Env.uPageId||a();function a(){var f=c();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){var g=(f+Math.random()*16)%16|0;f=Math.floor(f/16);return(h==="x"?g:(g&3|8)).toString(16)})}function d(){var f=window.performance||{},g=f.now||f.mozNow||f.msNow||f.oNow||f.webkitNow||Date.now||function(){return new Date().getTime()};return g}return e});M.define("Cookie",function(f,h,e){var g=/\+/g;var i=navigator.cookieEnabled;if(!i){document.cookie="__detectCookieEnabled=1;";i=document.cookie.indexOf("__detectCookieEnabled")!=-1?true:false;if(i){document.cookie="__detectCookieEnabled=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}}if(!i){return{isSupport:false}}var d={isSupport:true,set:function(m,n,k){k=(typeof k=="object"&&k!==null)?k:{};if(typeof k.expires==="number"){var o=k.expires,l=k.expires=new Date();l.setTime(+l+o*1000)}return(document.cookie=[j(m),"=",j(String(n)),k.expires?"; expires="+k.expires.toUTCString():"",k.path?"; path="+k.path:"",k.domain?"; domain="+k.domain:"",k.secure?"; secure":""].join(""))},get:function(q){var k=q?undefined:{};var r=document.cookie?document.cookie.split("; "):[];for(var p=0,m=r.length;p<m;p++){var s=r[p].split("=");var n=a(s.shift());var o=s.join("=");if(q&&q===n){k=b(o);break}if(!q&&(o=b(o))!==undefined){k[n]=o}}return k},remove:function(l,k){if(this.get(l)===undefined){return false}k=(typeof k=="object"&&k!==null)?k:{};k.expires=-1;this.set(l,"",k)}};function j(k){return encodeURIComponent(k)}function a(k){return decodeURIComponent(k)}function c(k){if(k.indexOf('"')===0){k=k.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{k=decodeURIComponent(k.replace(g," "));return k}catch(l){}}function b(k){var l=c(k);return l}e.exports=d});M.define("ResourceKeeper",function(d){var m=b();if(!m){return{isSupport:false}}var c=[];if(window.addEventListener){window.addEventListener("onbeforeunload",l,false)}else{if(window.attachEvent){window.attachEvent("onbeforeunload",l)}}function l(){M.forEach(c,function(n){n.release()})}var e=d("PageAdmin").uuid,j="default_resource",h="__resource_keeper",f=1000,k=2000;function a(n){n=""+n;n=n||j;this.keeping=false;this.resourceKeeperStorageKey=h+"_"+n;this.keepingRefreshInterval=0;this._initStorageListener();c.push(this)}M.mix(a.prototype,{keep:function(){this._requestKeep();return this.keeping},forceKeep:function(n){this._startKeep(n)},release:function(){if(this.keeping){var n=+new Date(),o=g(this.resourceKeeperStorageKey);if(o.currentKeeperPageUUID==e&&o.expire>n){m.remove(this.resourceKeeperStorageKey);this._setKeeping(false)}}},_initStorageListener:function(){M.Event(m).on("resource_keeper_change",M.bind(function(n){if(this.keeping&&n.key==this.resourceKeeperStorageKey&&n.pageUUID&&n.pageUUID!=e){this._setKeeping(false)}},this))},_requestKeep:function(){var n=+new Date(),o=g(this.resourceKeeperStorageKey);if(!o.currentKeeperPageUUID||o.currentKeeperPageUUID==e||o.expire<=n){this._startKeep(n)}else{this._setKeeping(false)}},_startKeep:function(n){n=n||+new Date();var o=n+k;m.set(this.resourceKeeperStorageKey,e+":"+o);this._setKeeping(true)},_setKeeping:function(n){this.keeping=n;if(this.keeping){this._startKeepingRefreshRequest()}else{this._stopKeepingRefreshRequest()}},_startKeepingRefreshRequest:function(){clearInterval(this.keepingRefreshInterval);this.keepingRefreshInterval=setInterval(M.bind(this._requestKeep,this),f)},_stopKeepingRefreshRequest:function(){clearInterval(this.keepingRefreshInterval)}});function b(){var o=null,p=d("Storage");if(p&&p.isSupport){o={set:M.bind(p.setItem,p),get:M.bind(p.getItem,p),remove:M.bind(p.removeItem,p)};if(window.addEventListener){window.addEventListener("storage",function(r){var q=r.key;if(q.indexOf(h)===0){var t="";if(r.newValue){var s=r.newValue.split(":");if(s.length==2){t=s[0]}}M.Event(o).fire("resource_keeper_change",{key:q,pageUUID:t})}},false)}}else{var n=d("Cookie");if(n&&n.isSupport){o={set:function(q,r){return n.set(q,r,k)},get:M.bind(n.get,n),remove:M.bind(n.remove,n)}}}return o}function g(p){var o={currentKeeperPageUUID:"",expire:0},n=m.get(p);if(n){n=n.split(":");o.currentKeeperPageUUID=n[0];o.expire=+n[1]}return o}function i(o){var n=new a(o);return{keep:M.bind(n.keep,n),forceKeep:M.bind(n.forceKeep,n),release:M.bind(n.release,n)}}i.isSupport=true;return i});M.closure(function(e){var j=e("ResourceKeeper"),t=j.isSupport?new j("new_msg_loop"):null,s=e("Storage"),b=1000,r=10000,u=40000,d=120000;var v=(function(){if(j.isSupport){return $.proxy(t.keep,t)}else{return function(){return M.windowFocused}}}());var k=function(){if(j.isSupport){t.forceKeep()}};if("addEventListener" in window){window.addEventListener("focus",k,false)}else{if("attachEvent" in document){document.attachEvent("onfocusin",k)}}$(function(){if(window.Env&&window.Env.UID>0||window.__mfw_uid>0){setTimeout(n,b)}else{setTimeout(l,r)}$("body").delegate(".jGrowl-closer","click",function(x){$.getJSON("/ajax/ajax_msg.php",{a:"closetip"});s.setItem("jgrowl_close_time",+new Date())});M.Event.on("update msg",function(){setTimeout(function(){w();s.setItem("update_msg",+new Date())},1)});s.on("update_msg",function(x){w()});function w(){if(window.Env&&window.Env.UID>0||window.__mfw_uid>0){p("msgdisplay")}else{p("nologinfeed")}}});function n(){setInterval(function(){v()&&p("msgdisplay")},u)}function l(){var x,w=1;v()&&p("nologinfeed");x=setInterval(function(){v()&&p("nologinfeed");w++;if(w==3){clearInterval(x)}},d)}function p(w){$.get("/ajax/ajax_msg.php?a="+w,function(x){if(x){o(x)}},"json")}function o(w){g();M.Event.fire("get new msg",w);if(w.msg){m()}if(w.tips&&!i()){a(w)}}e("jq-jgrowl");function a(w){var x=w.tips.split(w.split_char);M.forEach(x,function(z,y){if(z){setTimeout(function(){$.jGrowl(z,{header:"新鲜事：",closer:false,life:20000})},2000*y+10)}})}function i(){var x=s.getItem("jgrowl_close_time"),w=+new Date();if(x&&w-x<24*60*60*1000){return true}return false}var c,f=0,h=1000,q=document.title;function m(){g();c=setInterval(function(){if(v()){f++;document.title=f%2===0?"【　　　】 - "+q:"【新消息】 - "+q}else{document.title=q}},h)}function g(){clearInterval(c);document.title=q}});M.define("FrequencyVerifyControl",function(c,b,d){function a(e){this.container=e.container;this.app=e.app;this.successHandler=$.noop;M.mix(this,e);this.init()}a.prototype={init:function(){this.initData();this.refreshImg();this.verifyCon.delegate("img,._j_change_img","click",$.proxy(function(e){this.refreshImg()},this));this.verifyCon.delegate("._j_fre_confirm","click",$.proxy(function(h){var g=this.verifyText.val();var f=g.length;if(f==0){this.showErro("您还没有输入验证码!");return false}else{if(f!==6){this.showErro("请输入正确的验证码!");return false}}var e=$(h.currentTarget);if(e.hasClass("waiting")){return false}e.addClass("waiting");$.post("/user/captcha/verify",{sCode:g,iApp:this.app},$.proxy(function(i){if(i){if(i.ret===1){this.successHandler(this.target);this.verifyCon.hide();this.hideErro()}else{if(i.ret===0){this.verifyText.val("");this.verifyText.focus();this.refreshImg();this.showErro("输入的验证码不正确!")}else{if(i.ret===-1){this.showErro("错误次数过多，请稍候尝试")}}}}e.removeClass("waiting")},this),"json")},this));this.verifyCon.delegate("._j_fre_text","keyup",$.proxy(function(e){if(e.keyCode==13){this.verifyCon.find("._j_fre_confirm").trigger("click")}},this))},showErro:function(e){this.errorCon.html(e);this.errorCon.show()},hideErro:function(){this.errorCon.hide()},initData:function(){this.verifyCon=this.container;this.verifyPo=this.verifyCon.find(".protectedYZM");this.verifyImg=this.verifyCon.find("img");this.verifyText=this.verifyCon.find("._j_fre_text");this.errorCon=this.verifyPo.find(".n-error")},refreshImg:function(){var e="/user/captcha/code?iApp="+this.app+"&s="+new Date().getTime();this.verifyImg.attr("src",e)}};d.exports=a});M.define("FrequencySystemVerify",function(f,e,g){var b=f("dialog/Dialog"),h=f("dialog/Layer"),d=f("FrequencyVerifyControl");var a='<div class="popYzm" style="z-index:inherit;position: relative;width:350px;height: 250px"><div class="protectedYZM" style="border: none;box-shadow: none;padding:25px 15px;"><p>亲爱的蜂蜂，你操作的速度有点像机器人<br>来证明下自己吧~</p><div class="YZMInput"><input class="_j_fre_text" type="text" placeHolder="验证码"></div><div class="YZMInput"><img src="http://images.mafengwo.net/images/home_new2015/verify.gif" width="150px" height="40px"><label><a href="javascript:void(0);" class="_j_change_img">看不清，换一张</a></label></div><div class="YZMSubmit"><a href="javascript:void(0);" class="_j_fre_confirm" title="确定">确定</a><span class="n-error">错误次数过多，请稍候尝试</span></div></div></div>';function c(i){this.app=i.app;this.init()}c.prototype={init:function(){var i=new b({content:a});if(h.getActive()){i.getLayer().setZIndex(h.getActive().getZIndex()+1)}i.show();var j=i.getPanel().find(".popYzm");new d({container:j,app:this.app,successHandler:$.proxy(function(){M.Event.fire("frequency:system:verify:success");i.close()},this)})}};g.exports=c});M.closure(function(d){var b=d("dialog/Dialog"),f=d("dialog/alert"),c=d("FrequencySystemVerify");window.show_login=a;$.ajaxSetup({dataFilter:function(i,h){try{var k=$.parseJSON(i);if(k&&k.unsafe==1){window.location.href="http://www.mafengwo.cn";return"{}"}if(k&&k.error&&k.error.msg=="login:required"){M.Event.fire("login:required");return"{}"}if(k&&k.error&&k.error.msg=="mobilebind:required"){f.pop({title:"依《网络安全法》要求，你需要在发布内容之前绑定手机号~",assureWords:"去绑定",hideCloser:true},function(m){location.href=window.Env.P_HTTP+"/setting/security/mobile/"});return{}}if(k&&k.resource&&k.resource.onload&&k.resource.onload.length){if(k.resource.onload[0]=='K.fire("login:required");'){M.Event.fire("login:required");return"{}"}}if(k&&k.error){var g=0;var l=0;if(typeof(k.error.errno)!=="undefined"){g=k.error.errno;l=k.error.error}else{if(typeof(k.error.code)!=="undefined"){g=k.error.code;l=k.error.msg}}if(g===10000){M.Event.fire("frequency:verify",l);return"{}"}}}catch(j){}return i},error:function(g){if(g.status==401){if(g.responseJSON&&g.responseJSON.data&&g.responseJSON.data.auth_type=="login"){M.Event.fire("login:required")}}}});var e=null;function a(){if($.browser.msie&&parseInt($.browser.version,10)<9){document.location.href=(window.Env&&window.Env.P_HTTP)||"https://passport.mafengwo.cn";return}if(!e){e=new b({PANEL_CLASS:"login_pop",content:'<iframe frameborder="no" border="0" scrolling="no" width="580" height="292" allowtransparency="true"></iframe>',background:"#aaa",bgOpacity:0.6,reposition:true,impl:"logindialog"})}e.show();if(!e.getPanel().find("iframe").attr("src")){M.Event(e).once("aftershow",function(){var g=window.Env.P_HTTP||"https://passport.mafengwo.cn";e.getPanel().find("iframe").attr("src",g+"/login-popup.html")})}}M.Event.on("login:required",a);M.Event.on("frequency:verify",function(g){new c({app:g})});if(M.Event.isFired("login:required")){a()}});M.define("ScrollObserver",function(e,g,c){var h=0,f={},a=false,b,d=true;g.addObserver=function(k){var j="ScrollObserver_"+h;h++;f[j]=k;d=false;return j};g.removeObserver=function(j){delete f[j];if(M.isEmpty(f)){d=true}};function i(){for(var j in f){if(f.hasOwnProperty(j)){f[j]()}}}$(window).scroll(function(){if(d){return}if(!a){b=setInterval(function(){if(a){a=false;clearTimeout(b);i()}},50)}a=true});return g});M.define("QRCode",function(b,a,c){c.exports={gen:function(e,d){var d={text:e,size:d.size||200,eclevel:d.evlevel||"H",logo:d.logo||"",__stk__:window.Env.CSTK};return"http://"+window.Env.WWW_HOST+"/qrcode.php?"+$.param(d)}}});M.closure(function(b){var l=b("ScrollObserver"),m=b("Storage"),d=window.Env||{},f=$("#_j_mfwtoolbar"),h=f.height(),a=$(window).height(),k=$(document).height(),g=$("#footer"),e=g.outerHeight();$("body").css("position","relative");$(window).resize(function(){a=$(window).height();k=$(document).height()});setInterval(function(){var n=$(document).height();if(n!=k){k=n;$(window).trigger("scroll")}},2000);if(!d.hideToolbar){if(!d.showToolbarDownArrow){f.children(".toolbar-item-down").remove()}else{f.children(".toolbar-item-down").show()}f.show();c();l.addObserver(c);f.on("click","._j_gotop",i);f.on("click","._j_gobottom",j);f.children(".toolbar-item-code").mouseenter(function(){$(this).addClass("hover")});f.children(".toolbar-item-code").mouseleave(function(){$(this).removeClass("hover")})}function c(){var n=$(window).scrollTop();if(n>500){f.children(".toolbar-item-top").show()}else{f.children(".toolbar-item-top").hide()}if(g.length){if(n+a>g.offset().top){f.css({position:"absolute",bottom:e+20})}else{f.css({position:"",bottom:""})}}}function i(){$("html, body").animate({scrollTop:0},500,function(){M.Event.fire("scroll to top")})}function j(){$("html, body").animate({scrollTop:k-a},500,function(){M.Event.fire("scroll to bottom")})}});(function(){var a=document.createElement("script"),b=window.Env&&window.Env.CNZZID||30065558;a.type="text/javascript";a.async=true;a.charset="utf-8";a.src=document.location.protocol+"//w.cnzz.com/c.php?id="+b+"&async=1";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,c)})();M.closure(function(a){M.log("只要你有梦想，就加入我们\n你即将见证互联网最新趋势的快速成长\n马蜂窝的一切资源都会成为你成长路上的最大助力\n你可以和马蜂窝一起书写互联网的风云奇迹\n在这里有一群和你一样，疯狂地热爱互联网和旅行的人们\n马蜂窝能为你实现梦想提供最广阔的平台");M.log("请将简历发送至 %csuperhr@mafengwo.com%c（ 邮件标题请以“_console”结尾）","color:#4ae;","color:inherit;");M.log("职位介绍：http://www.mafengwo.cn/s/hr.html")});M.closure(function(a){$.get("/ajax/ajax_page_onload.php",{href:document.location.href,_t:+new Date()},function(b){if(b.payload&&b.payload.apps){var c=b.payload.apps;if(!M.isEmpty(c)){var d={css_list:c.css||[]};M.loadCssJsListSeq(d,function(){if(c.html){$("body").append(c.html)}if(c.js&&c.js.length){M.loadResource(c.js)}})}}},"json")});