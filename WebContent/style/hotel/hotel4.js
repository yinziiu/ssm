(function(){var v=this;var j=v._;var D={};var C=Array.prototype,f=Object.prototype,q=Function.prototype;var m=C.slice,z=C.unshift,c=f.toString,h=f.hasOwnProperty;var L=C.forEach,o=C.map,E=C.reduce,b=C.reduceRight,a=C.filter,A=C.every,n=C.some,l=C.indexOf,k=C.lastIndexOf,s=Array.isArray,e=Object.keys,F=q.bind;var M=function(p){return new t(p)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=M}exports._=M}else{v._=M}M.VERSION="1.3.3";var I=M.each=M.forEach=function(R,Q,P){if(R==null){return}if(L&&R.forEach===L){R.forEach(Q,P)}else{if(R.length===+R.length){for(var O=0,p=R.length;O<p;O++){if(O in R&&Q.call(P,R[O],O,R)===D){return}}}else{for(var N in R){if(M.has(R,N)){if(Q.call(P,R[N],N,R)===D){return}}}}}};M.map=M.collect=function(P,O,N){var p=[];if(P==null){return p}if(o&&P.map===o){return P.map(O,N)}I(P,function(S,Q,R){p[p.length]=O.call(N,S,Q,R)});if(P.length===+P.length){p.length=P.length}return p};M.reduce=M.foldl=M.inject=function(Q,P,p,O){var N=arguments.length>2;if(Q==null){Q=[]}if(E&&Q.reduce===E){if(O){P=M.bind(P,O)}return N?Q.reduce(P,p):Q.reduce(P)}I(Q,function(T,R,S){if(!N){p=T;N=true}else{p=P.call(O,p,T,R,S)}});if(!N){throw new TypeError("Reduce of empty array with no initial value")}return p};M.reduceRight=M.foldr=function(Q,P,p,O){var N=arguments.length>2;if(Q==null){Q=[]}if(b&&Q.reduceRight===b){if(O){P=M.bind(P,O)}return N?Q.reduceRight(P,p):Q.reduceRight(P)}var R=M.toArray(Q).reverse();if(O&&!N){P=M.bind(P,O)}return N?M.reduce(R,P,p,O):M.reduce(R,P)};M.find=M.detect=function(P,O,N){var p;y(P,function(S,Q,R){if(O.call(N,S,Q,R)){p=S;return true}});return p};M.filter=M.select=function(P,O,N){var p=[];if(P==null){return p}if(a&&P.filter===a){return P.filter(O,N)}I(P,function(S,Q,R){if(O.call(N,S,Q,R)){p[p.length]=S}});return p};M.reject=function(P,O,N){var p=[];if(P==null){return p}I(P,function(S,Q,R){if(!O.call(N,S,Q,R)){p[p.length]=S}});return p};M.every=M.all=function(P,O,N){var p=true;if(P==null){return p}if(A&&P.every===A){return P.every(O,N)}I(P,function(S,Q,R){if(!(p=p&&O.call(N,S,Q,R))){return D}});return !!p};var y=M.some=M.any=function(P,O,N){O||(O=M.identity);var p=false;if(P==null){return p}if(n&&P.some===n){return P.some(O,N)}I(P,function(S,Q,R){if(p||(p=O.call(N,S,Q,R))){return D}});return !!p};M.include=M.contains=function(O,N){var p=false;if(O==null){return p}if(l&&O.indexOf===l){return O.indexOf(N)!=-1}p=y(O,function(P){return P===N});return p};M.invoke=function(N,O){var p=m.call(arguments,2);return M.map(N,function(P){return(M.isFunction(O)?O||P:P[O]).apply(P,p)})};M.pluck=function(N,p){return M.map(N,function(O){return O[p]})};M.max=function(P,O,N){if(!O&&M.isArray(P)&&P[0]===+P[0]){return Math.max.apply(Math,P)}if(!O&&M.isEmpty(P)){return -Infinity}var p={computed:-Infinity};I(P,function(T,Q,S){var R=O?O.call(N,T,Q,S):T;R>=p.computed&&(p={value:T,computed:R})});return p.value};M.min=function(P,O,N){if(!O&&M.isArray(P)&&P[0]===+P[0]){return Math.min.apply(Math,P)}if(!O&&M.isEmpty(P)){return Infinity}var p={computed:Infinity};I(P,function(T,Q,S){var R=O?O.call(N,T,Q,S):T;R<p.computed&&(p={value:T,computed:R})});return p.value};M.shuffle=function(O){var p=[],N;I(O,function(R,P,Q){N=Math.floor(Math.random()*(P+1));p[P]=p[N];p[N]=R});return p};M.sortBy=function(O,P,p){var N=M.isFunction(P)?P:function(Q){return Q[P]};return M.pluck(M.map(O,function(S,Q,R){return{value:S,criteria:N.call(p,S,Q,R)}}).sort(function(T,S){var R=T.criteria,Q=S.criteria;if(R===void 0){return 1}if(Q===void 0){return -1}return R<Q?-1:R>Q?1:0}),"value")};M.groupBy=function(O,P){var p={};var N=M.isFunction(P)?P:function(Q){return Q[P]};I(O,function(S,Q){var R=N(S,Q);(p[R]||(p[R]=[])).push(S)});return p};M.sortedIndex=function(R,Q,O){O||(O=M.identity);var p=0,P=R.length;while(p<P){var N=(p+P)>>1;O(R[N])<O(Q)?p=N+1:P=N}return p};M.toArray=function(p){if(!p){return[]}if(M.isArray(p)){return m.call(p)}if(M.isArguments(p)){return m.call(p)}if(p.toArray&&M.isFunction(p.toArray)){return p.toArray()}return M.values(p)};M.size=function(p){return M.isArray(p)?p.length:M.keys(p).length};M.first=M.head=M.take=function(O,N,p){return(N!=null)&&!p?m.call(O,0,N):O[0]};M.initial=function(O,N,p){return m.call(O,0,O.length-((N==null)||p?1:N))};M.last=function(O,N,p){if((N!=null)&&!p){return m.call(O,Math.max(O.length-N,0))}else{return O[O.length-1]}};M.rest=M.tail=function(O,p,N){return m.call(O,(p==null)||N?1:p)};M.compact=function(p){return M.filter(p,function(N){return !!N})};M.flatten=function(N,p){return M.reduce(N,function(O,P){if(M.isArray(P)){return O.concat(p?P:M.flatten(P))}O[O.length]=P;return O},[])};M.without=function(p){return M.difference(p,m.call(arguments,1))};M.uniq=M.unique=function(Q,P,O){var p=O?M.map(Q,O):Q;var N=[];if(Q.length<3){P=true}M.reduce(p,function(R,T,S){if(P?M.last(R)!==T||!R.length:!M.include(R,T)){R.push(T);N.push(Q[S])}return R},[]);return N};M.union=function(){return M.uniq(M.flatten(arguments,true))};M.intersection=M.intersect=function(N){var p=m.call(arguments,1);return M.filter(M.uniq(N),function(O){return M.every(p,function(P){return M.indexOf(P,O)>=0})})};M.difference=function(N){var p=M.flatten(m.call(arguments,1),true);return M.filter(N,function(O){return !M.include(p,O)})};M.zip=function(){var p=m.call(arguments);var P=M.max(M.pluck(p,"length"));var O=new Array(P);for(var N=0;N<P;N++){O[N]=M.pluck(p,""+N)}return O};M.indexOf=function(Q,O,P){if(Q==null){return -1}var N,p;if(P){N=M.sortedIndex(Q,O);return Q[N]===O?N:-1}if(l&&Q.indexOf===l){return Q.indexOf(O)}for(N=0,p=Q.length;N<p;N++){if(N in Q&&Q[N]===O){return N}}return -1};M.lastIndexOf=function(O,N){if(O==null){return -1}if(k&&O.lastIndexOf===k){return O.lastIndexOf(N)}var p=O.length;while(p--){if(p in O&&O[p]===N){return p}}return -1};M.range=function(R,P,Q){if(arguments.length<=1){P=R||0;R=0}Q=arguments[2]||1;var N=Math.max(Math.ceil((P-R)/Q),0);var p=0;var O=new Array(N);while(p<N){O[p++]=R;R+=Q}return O};var G=function(){};M.bind=function d(P,N){var O,p;if(P.bind===F&&F){return F.apply(P,m.call(arguments,1))}if(!M.isFunction(P)){throw new TypeError}p=m.call(arguments,2);return O=function(){if(!(this instanceof O)){return P.apply(N,p.concat(m.call(arguments)))}G.prototype=P.prototype;var R=new G;var Q=P.apply(R,p.concat(m.call(arguments)));if(Object(Q)===Q){return Q}return R}};M.bindAll=function(N){var p=m.call(arguments,1);if(p.length==0){p=M.functions(N)}I(p,function(O){N[O]=M.bind(N[O],N)});return N};M.memoize=function(O,N){var p={};N||(N=M.identity);return function(){var P=N.apply(this,arguments);return M.has(p,P)?p[P]:(p[P]=O.apply(this,arguments))}};M.delay=function(N,O){var p=m.call(arguments,2);return setTimeout(function(){return N.apply(null,p)},O)};M.defer=function(p){return M.delay.apply(M,[p,1].concat(m.call(arguments,1)))};M.throttle=function(O,P){var N,R,S,T,Q,U;var p=M.debounce(function(){Q=T=false},P);return function(){N=this;R=arguments;var V=function(){S=null;if(Q){O.apply(N,R)}p()};if(!S){S=setTimeout(V,P)}if(T){Q=true}else{U=O.apply(N,R)}p();T=true;return U}};M.debounce=function(N,P,p){var O;return function(){var S=this,R=arguments;var Q=function(){O=null;if(!p){N.apply(S,R)}};if(p&&!O){N.apply(S,R)}clearTimeout(O);O=setTimeout(Q,P)}};M.once=function(O){var p=false,N;return function(){if(p){return N}p=true;return N=O.apply(this,arguments)}};M.wrap=function(p,N){return function(){var O=[p].concat(m.call(arguments,0));return N.apply(this,O)}};M.compose=function(){var p=arguments;return function(){var N=arguments;for(var O=p.length-1;O>=0;O--){N=[p[O].apply(this,N)]}return N[0]}};M.after=function(N,p){if(N<=0){return p()}return function(){if(--N<1){return p.apply(this,arguments)}}};M.keys=e||function(O){if(O!==Object(O)){throw new TypeError("Invalid object")}var N=[];for(var p in O){if(M.has(O,p)){N[N.length]=p}}return N};M.values=function(p){return M.map(p,M.identity)};M.functions=M.methods=function(O){var N=[];for(var p in O){if(M.isFunction(O[p])){N.push(p)}}return N.sort()};M.extend=function(p){I(m.call(arguments,1),function(N){for(var O in N){p[O]=N[O]}});return p};M.pick=function(N){var p={};I(M.flatten(m.call(arguments,1)),function(O){if(O in N){p[O]=N[O]}});return p};M.defaults=function(p){I(m.call(arguments,1),function(N){for(var O in N){if(p[O]==null){p[O]=N[O]}}});return p};M.clone=function(p){if(!M.isObject(p)){return p}return M.isArray(p)?p.slice():M.extend({},p)};M.tap=function(N,p){p(N);return N};function J(P,O,N){if(P===O){return P!==0||1/P==1/O}if(P==null||O==null){return P===O}if(P._chain){P=P._wrapped}if(O._chain){O=O._wrapped}if(P.isEqual&&M.isFunction(P.isEqual)){return P.isEqual(O)}if(O.isEqual&&M.isFunction(O.isEqual)){return O.isEqual(P)}var S=c.call(P);if(S!=c.call(O)){return false}switch(S){case"[object String]":return P==String(O);case"[object Number]":return P!=+P?O!=+O:(P==0?1/P==1/O:P==+O);case"[object Date]":case"[object Boolean]":return +P==+O;case"[object RegExp]":return P.source==O.source&&P.global==O.global&&P.multiline==O.multiline&&P.ignoreCase==O.ignoreCase}if(typeof P!="object"||typeof O!="object"){return false}var T=N.length;while(T--){if(N[T]==P){return true}}N.push(P);var R=0,p=true;if(S=="[object Array]"){R=P.length;p=R==O.length;if(p){while(R--){if(!(p=R in P==R in O&&J(P[R],O[R],N))){break}}}}else{if("constructor" in P!="constructor" in O||P.constructor!=O.constructor){return false}for(var Q in P){if(M.has(P,Q)){R++;if(!(p=M.has(O,Q)&&J(P[Q],O[Q],N))){break}}}if(p){for(Q in O){if(M.has(O,Q)&&!(R--)){break}}p=!R}}N.pop();return p}M.isEqual=function(N,p){return J(N,p,[])};M.isEmpty=function(N){if(N==null){return true}if(M.isArray(N)||M.isString(N)){return N.length===0}for(var p in N){if(M.has(N,p)){return false}}return true};M.isElement=function(p){return !!(p&&p.nodeType==1)};M.isArray=s||function(p){return c.call(p)=="[object Array]"};M.isObject=function(p){return p===Object(p)};M.isArguments=function(p){return c.call(p)=="[object Arguments]"};if(!M.isArguments(arguments)){M.isArguments=function(p){return !!(p&&M.has(p,"callee"))}}M.isFunction=function(p){return c.call(p)=="[object Function]"};M.isString=function(p){return c.call(p)=="[object String]"};M.isNumber=function(p){return c.call(p)=="[object Number]"};M.isFinite=function(p){return M.isNumber(p)&&isFinite(p)};M.isNaN=function(p){return p!==p};M.isBoolean=function(p){return p===true||p===false||c.call(p)=="[object Boolean]"};M.isDate=function(p){return c.call(p)=="[object Date]"};M.isRegExp=function(p){return c.call(p)=="[object RegExp]"};M.isNull=function(p){return p===null};M.isUndefined=function(p){return p===void 0};M.has=function(N,p){return h.call(N,p)};M.noConflict=function(){v._=j;return this};M.identity=function(p){return p};M.times=function(P,O,N){for(var p=0;p<P;p++){O.call(N,p)}};M.escape=function(p){return(""+p).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};M.result=function(p,O){if(p==null){return null}var N=p[O];return M.isFunction(N)?N.call(p):N};M.mixin=function(p){I(M.functions(p),function(N){w(N,M[N]=p[N])})};var x=0;M.uniqueId=function(p){var N=x++;return p?p+N:N};M.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var u=/.^/;var g={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var H in g){g[g[H]]=H}var i=/\\|'|\r|\n|\t|\u2028|\u2029/g;var B=/\\(\\|'|r|n|t|u2028|u2029)/g;var K=function(p){return p.replace(B,function(N,O){return g[O]})};M.template=function(R,Q,O){O=M.defaults(O||{},M.templateSettings);var P="__p+='"+R.replace(i,function(S){return"\\"+g[S]}).replace(O.escape||u,function(S,T){return"'+\n_.escape("+K(T)+")+\n'"}).replace(O.interpolate||u,function(S,T){return"'+\n("+K(T)+")+\n'"}).replace(O.evaluate||u,function(S,T){return"';\n"+K(T)+"\n;__p+='"})+"';\n";if(!O.variable){P="with(obj||{}){\n"+P+"}\n"}P="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+P+"return __p;\n";var N=new Function(O.variable||"obj","_",P);if(Q){return N(Q,M)}var p=function(S){return N.call(this,S,M)};p.source="function("+(O.variable||"obj")+"){\n"+P+"}";return p};M.chain=function(p){return M(p).chain()};var t=function(p){this._wrapped=p};M.prototype=t.prototype;var r=function(N,p){return p?M(N).chain():N};var w=function(p,N){t.prototype[p]=function(){var O=m.call(arguments);z.call(O,this._wrapped);return r(N.apply(M,O),this._chain)}};M.mixin(M);I(["pop","push","reverse","shift","sort","splice","unshift"],function(p){var N=C[p];t.prototype[p]=function(){var O=this._wrapped;N.apply(O,arguments);var P=O.length;if((p=="shift"||p=="splice")&&P===0){delete O[0]}return r(O,this._chain)}});I(["concat","join","slice"],function(p){var N=C[p];t.prototype[p]=function(){return r(N.apply(this._wrapped,arguments),this._chain)}});t.prototype.chain=function(){this._chain=true;return this};t.prototype.value=function(){return this._wrapped}}).call(this);(function(a,b){if(typeof define==="function"&&define.amd){define(["underscore","jquery","exports"],function(e,f,d){a.Backbone=b(a,d,e,f)})}else{if(typeof exports!=="undefined"){var c=require("underscore");b(a,exports,c)}else{a.Backbone=b(a,{},a._,(a.jQuery||a.Zepto||a.ender||a.$))}}}(this,function(v,B,N,z){var D=v.Backbone;var g=[];var F=g.push;var o=g.slice;var u=g.splice;B.VERSION="1.1.2";B.$=z;B.noConflict=function(){v.Backbone=D;return this};B.emulateHTTP=false;B.emulateJSON=false;var L=B.Events={on:function(O,R,Q){if(!y(this,"on",O,[R,Q])||!R){return this}this._events||(this._events={});var P=this._events[O]||(this._events[O]=[]);P.push({callback:R,context:Q,ctx:Q||this});return this},once:function(P,S,Q){if(!y(this,"once",P,[S,Q])||!S){return this}var O=this;var R=N.once(function(){O.off(P,R);S.apply(this,arguments)});R._callback=S;return this.on(P,R,Q)},off:function(O,X,P){var V,W,Y,U,T,Q,S,R;if(!this._events||!y(this,"off",O,[X,P])){return this}if(!O&&!X&&!P){this._events=void 0;return this}U=O?[O]:N.keys(this._events);for(T=0,Q=U.length;T<Q;T++){O=U[T];if(Y=this._events[O]){this._events[O]=V=[];if(X||P){for(S=0,R=Y.length;S<R;S++){W=Y[S];if((X&&X!==W.callback&&X!==W.callback._callback)||(P&&P!==W.context)){V.push(W)}}}if(!V.length){delete this._events[O]}}}return this},trigger:function(Q){if(!this._events){return this}var P=o.call(arguments,1);if(!y(this,"trigger",Q,P)){return this}var R=this._events[Q];var O=this._events.all;if(R){b(R,P)}if(O){b(O,arguments)}return this},stopListening:function(R,P,T){var Q=this._listeningTo;if(!Q){return this}var O=!P&&!T;if(!T&&typeof P==="object"){T=this}if(R){(Q={})[R._listenId]=R}for(var S in Q){R=Q[S];R.off(P,T,this);if(O||N.isEmpty(R._events)){delete this._listeningTo[S]}}return this}};var x=/\s+/;var y=function(V,T,P,S){if(!P){return true}if(typeof P==="object"){for(var R in P){V[T].apply(V,[R,P[R]].concat(S))}return false}if(x.test(P)){var U=P.split(x);for(var Q=0,O=U.length;Q<O;Q++){V[T].apply(V,[U[Q]].concat(S))}return false}return true};var b=function(T,R){var U,S=-1,Q=T.length,P=R[0],O=R[1],V=R[2];switch(R.length){case 0:while(++S<Q){(U=T[S]).callback.call(U.ctx)}return;case 1:while(++S<Q){(U=T[S]).callback.call(U.ctx,P)}return;case 2:while(++S<Q){(U=T[S]).callback.call(U.ctx,P,O)}return;case 3:while(++S<Q){(U=T[S]).callback.call(U.ctx,P,O,V)}return;default:while(++S<Q){(U=T[S]).callback.apply(U.ctx,R)}return}};var E={listenTo:"on",listenToOnce:"once"};N.each(E,function(O,P){L[P]=function(S,Q,U){var R=this._listeningTo||(this._listeningTo={});var T=S._listenId||(S._listenId=N.uniqueId("l"));R[T]=S;if(!U&&typeof Q==="object"){U=this}S[O](Q,U,this);return this}});L.bind=L.on;L.unbind=L.off;N.extend(B,L);var G=B.Model=function(O,Q){var P=O||{};Q||(Q={});this.cid=N.uniqueId("c");this.attributes={};if(Q.collection){this.collection=Q.collection}if(Q.parse){P=this.parse(P,Q)||{}}P=N.defaults({},P,N.result(this,"defaults"));this.set(P,Q);this.changed={};this.initialize.apply(this,arguments)};N.extend(G.prototype,L,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(O){return N.clone(this.attributes)},sync:function(){return B.sync.apply(this,arguments)},get:function(O){return this.attributes[O]},escape:function(O){return N.escape(this.get(O))},has:function(O){return this.get(O)!=null},set:function(W,O,aa){var U,X,Y,V,T,Z,Q,S;if(W==null){return this}if(typeof W==="object"){X=W;aa=O}else{(X={})[W]=O}aa||(aa={});if(!this._validate(X,aa)){return false}Y=aa.unset;T=aa.silent;V=[];Z=this._changing;this._changing=true;if(!Z){this._previousAttributes=N.clone(this.attributes);this.changed={}}S=this.attributes,Q=this._previousAttributes;if(this.idAttribute in X){this.id=X[this.idAttribute]}for(U in X){O=X[U];if(!N.isEqual(S[U],O)){V.push(U)}if(!N.isEqual(Q[U],O)){this.changed[U]=O}else{delete this.changed[U]}Y?delete S[U]:S[U]=O}if(!T){if(V.length){this._pending=aa}for(var R=0,P=V.length;R<P;R++){this.trigger("change:"+V[R],this,S[V[R]],aa)}}if(Z){return this}if(!T){while(this._pending){aa=this._pending;this._pending=false;this.trigger("change",this,aa)}}this._pending=false;this._changing=false;return this},unset:function(O,P){return this.set(O,void 0,N.extend({},P,{unset:true}))},clear:function(P){var O={};for(var Q in this.attributes){O[Q]=void 0}return this.set(O,N.extend({},P,{unset:true}))},hasChanged:function(O){if(O==null){return !N.isEmpty(this.changed)}return N.has(this.changed,O)},changedAttributes:function(Q){if(!Q){return this.hasChanged()?N.clone(this.changed):false}var S,R=false;var P=this._changing?this._previousAttributes:this.attributes;for(var O in Q){if(N.isEqual(P[O],(S=Q[O]))){continue}(R||(R={}))[O]=S}return R},previous:function(O){if(O==null||!this._previousAttributes){return null}return this._previousAttributes[O]},previousAttributes:function(){return N.clone(this._previousAttributes)},fetch:function(P){P=P?N.clone(P):{};if(P.parse===void 0){P.parse=true}var O=this;var Q=P.success;P.success=function(R){if(!O.set(O.parse(R,P),P)){return false}if(Q){Q(O,R,P)}O.trigger("sync",O,R,P)};J(this,P);return this.sync("read",this,P)},save:function(S,P,W){var T,O,V,Q=this.attributes;if(S==null||typeof S==="object"){T=S;W=P}else{(T={})[S]=P}W=N.extend({validate:true},W);if(T&&!W.wait){if(!this.set(T,W)){return false}}else{if(!this._validate(T,W)){return false}}if(T&&W.wait){this.attributes=N.extend({},Q,T)}if(W.parse===void 0){W.parse=true}var R=this;var U=W.success;W.success=function(Y){R.attributes=Q;var X=R.parse(Y,W);if(W.wait){X=N.extend(T||{},X)}if(N.isObject(X)&&!R.set(X,W)){return false}if(U){U(R,Y,W)}R.trigger("sync",R,Y,W)};J(this,W);O=this.isNew()?"create":(W.patch?"patch":"update");if(O==="patch"){W.attrs=T}V=this.sync(O,this,W);if(T&&W.wait){this.attributes=Q}return V},destroy:function(P){P=P?N.clone(P):{};var O=this;var S=P.success;var Q=function(){O.trigger("destroy",O,O.collection,P)};P.success=function(T){if(P.wait||O.isNew()){Q()}if(S){S(O,T,P)}if(!O.isNew()){O.trigger("sync",O,T,P)}};if(this.isNew()){P.success();return false}J(this,P);var R=this.sync("delete",this,P);if(!P.wait){Q()}return R},url:function(){var O=N.result(this,"urlRoot")||N.result(this.collection,"url")||s();if(this.isNew()){return O}return O.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(P,O){return P},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return !this.has(this.idAttribute)},isValid:function(O){return this._validate({},N.extend(O||{},{validate:true}))},_validate:function(Q,P){if(!P.validate||!this.validate){return true}Q=N.extend({},this.attributes,Q);var O=this.validationError=this.validate(Q,P)||null;if(!O){return true}this.trigger("invalid",this,O,N.extend(P,{validationError:O}));return false}});var a=["keys","values","pairs","invert","pick","omit"];N.each(a,function(O){G.prototype[O]=function(){var P=o.call(arguments);P.unshift(this.attributes);return N[O].apply(N,P)}});var c=B.Collection=function(P,O){O||(O={});if(O.model){this.model=O.model}if(O.comparator!==void 0){this.comparator=O.comparator}this._reset();this.initialize.apply(this,arguments);if(P){this.reset(P,N.extend({silent:true},O))}};var p={add:true,remove:true,merge:true};var M={add:true,remove:false};N.extend(c.prototype,L,{model:G,initialize:function(){},toJSON:function(O){return this.map(function(P){return P.toJSON(O)})},sync:function(){return B.sync.apply(this,arguments)},add:function(P,O){return this.set(P,N.extend({merge:false},O,M))},remove:function(U,R){var T=!N.isArray(U);U=T?[U]:N.clone(U);R||(R={});var S,O,Q,P;for(S=0,O=U.length;S<O;S++){P=U[S]=this.get(U[S]);if(!P){continue}delete this._byId[P.id];delete this._byId[P.cid];Q=this.indexOf(P);this.models.splice(Q,1);this.length--;if(!R.silent){R.index=Q;P.trigger("remove",P,this,R)}this._removeReference(P,R)}return T?U[0]:U},set:function(ah,P){P=N.defaults({},P,p);if(P.parse){ah=this.parse(ah,P)}var S=!N.isArray(ah);ah=S?(ah?[ah]:[]):N.clone(ah);var ad,ab,X,Q,Z,W,ag;var U=P.at;var af=this.model;var O=this.comparator&&(U==null)&&P.sort!==false;var ae=N.isString(this.comparator)?this.comparator:null;var aj=[],aa=[],Y={};var V=P.add,R=P.merge,ai=P.remove;var ac=!O&&V&&ai?[]:false;for(ad=0,ab=ah.length;ad<ab;ad++){Z=ah[ad]||{};if(Z instanceof G){X=Q=Z}else{X=Z[af.prototype.idAttribute||"id"]}if(W=this.get(X)){if(ai){Y[W.cid]=true}if(R){Z=Z===Q?Q.attributes:Z;if(P.parse){Z=W.parse(Z,P)}W.set(Z,P);if(O&&!ag&&W.hasChanged(ae)){ag=true}}ah[ad]=W}else{if(V){Q=ah[ad]=this._prepareModel(Z,P);if(!Q){continue}aj.push(Q);this._addReference(Q,P)}}Q=W||Q;if(ac&&(Q.isNew()||!Y[Q.id])){ac.push(Q)}Y[Q.id]=true}if(ai){for(ad=0,ab=this.length;ad<ab;++ad){if(!Y[(Q=this.models[ad]).cid]){aa.push(Q)}}if(aa.length){this.remove(aa,P)}}if(aj.length||(ac&&ac.length)){if(O){ag=true}this.length+=aj.length;if(U!=null){for(ad=0,ab=aj.length;ad<ab;ad++){this.models.splice(U+ad,0,aj[ad])}}else{if(ac){this.models.length=0}var T=ac||aj;for(ad=0,ab=T.length;ad<ab;ad++){this.models.push(T[ad])}}}if(ag){this.sort({silent:true})}if(!P.silent){for(ad=0,ab=aj.length;ad<ab;ad++){(Q=aj[ad]).trigger("add",Q,this,P)}if(ag||(ac&&ac.length)){this.trigger("sort",this,P)}}return S?ah[0]:ah},reset:function(R,P){P||(P={});for(var Q=0,O=this.models.length;Q<O;Q++){this._removeReference(this.models[Q],P)}P.previousModels=this.models;this._reset();R=this.add(R,N.extend({silent:true},P));if(!P.silent){this.trigger("reset",this,P)}return R},push:function(P,O){return this.add(P,N.extend({at:this.length},O))},pop:function(P){var O=this.at(this.length-1);this.remove(O,P);return O},unshift:function(P,O){return this.add(P,N.extend({at:0},O))},shift:function(P){var O=this.at(0);this.remove(O,P);return O},slice:function(){return o.apply(this.models,arguments)},get:function(O){if(O==null){return void 0}return this._byId[O]||this._byId[O.id]||this._byId[O.cid]},at:function(O){return this.models[O]},where:function(O,P){if(N.isEmpty(O)){return P?void 0:[]}return this[P?"find":"filter"](function(Q){for(var R in O){if(O[R]!==Q.get(R)){return false}}return true})},findWhere:function(O){return this.where(O,true)},sort:function(O){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}O||(O={});if(N.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(N.bind(this.comparator,this))}if(!O.silent){this.trigger("sort",this,O)}return this},pluck:function(O){return N.invoke(this.models,"get",O)},fetch:function(O){O=O?N.clone(O):{};if(O.parse===void 0){O.parse=true}var Q=O.success;var P=this;O.success=function(R){var S=O.reset?"reset":"set";P[S](R,O);if(Q){Q(P,R,O)}P.trigger("sync",P,R,O)};J(this,O);return this.sync("read",this,O)},create:function(P,O){O=O?N.clone(O):{};if(!(P=this._prepareModel(P,O))){return false}if(!O.wait){this.add(P,O)}var R=this;var Q=O.success;O.success=function(S,T){if(O.wait){R.add(S,O)}if(Q){Q(S,T,O)}};P.save(null,O);return P},parse:function(P,O){return P},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(Q,P){if(Q instanceof G){return Q}P=P?N.clone(P):{};P.collection=this;var O=new this.model(Q,P);if(!O.validationError){return O}this.trigger("invalid",this,O.validationError,P);return false},_addReference:function(P,O){this._byId[P.cid]=P;if(P.id!=null){this._byId[P.id]=P}if(!P.collection){P.collection=this}P.on("all",this._onModelEvent,this)},_removeReference:function(P,O){if(this===P.collection){delete P.collection}P.off("all",this._onModelEvent,this)},_onModelEvent:function(Q,P,R,O){if((Q==="add"||Q==="remove")&&R!==this){return}if(Q==="destroy"){this.remove(P,O)}if(P&&Q==="change:"+P.idAttribute){delete this._byId[P.previous(P.idAttribute)];if(P.id!=null){this._byId[P.id]=P}}this.trigger.apply(this,arguments)}});var A=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];N.each(A,function(O){c.prototype[O]=function(){var P=o.call(arguments);P.unshift(this.models);return N[O].apply(N,P)}});var l=["groupBy","countBy","sortBy","indexBy"];N.each(l,function(O){c.prototype[O]=function(R,P){var Q=N.isFunction(R)?R:function(S){return S.get(R)};return N[O](this.models,Q,P)}});var I=B.View=function(O){this.cid=N.uniqueId("view");O||(O={});N.extend(this,N.pick(O,e));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var w=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];N.extend(I.prototype,L,{tagName:"div",$:function(O){return this.$el.find(O)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(O,P){if(this.$el){this.undelegateEvents()}this.$el=O instanceof B.$?O:B.$(O);this.el=this.$el[0];if(P!==false){this.delegateEvents()}return this},delegateEvents:function(S){if(!(S||(S=N.result(this,"events")))){return this}this.undelegateEvents();for(var R in S){var T=S[R];if(!N.isFunction(T)){T=this[S[R]]}if(!T){continue}var Q=R.match(w);var P=Q[1],O=Q[2];T=N.bind(T,this);P+=".delegateEvents"+this.cid;if(O===""){this.$el.on(P,T)}else{this.$el.on(P,O,T)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_ensureElement:function(){if(!this.el){var O=N.extend({},N.result(this,"attributes"));if(this.id){O.id=N.result(this,"id")}if(this.className){O["class"]=N.result(this,"className")}var P=B.$("<"+N.result(this,"tagName")+">").attr(O);this.setElement(P,false)}else{this.setElement(N.result(this,"el"),false)}}});B.sync=function(U,P,O){var R=k[U];N.defaults(O||(O={}),{emulateHTTP:B.emulateHTTP,emulateJSON:B.emulateJSON});var T={type:R,dataType:"json"};if(!O.url){T.url=N.result(P,"url")||s()}if(O.data==null&&P&&(U==="create"||U==="update"||U==="patch")){T.contentType="application/json";T.data=JSON.stringify(O.attrs||P.toJSON(O))}if(O.emulateJSON){T.contentType="application/x-www-form-urlencoded";T.data=T.data?{model:T.data}:{}}if(O.emulateHTTP&&(R==="PUT"||R==="DELETE"||R==="PATCH")){T.type="POST";if(O.emulateJSON){T.data._method=R}var Q=O.beforeSend;O.beforeSend=function(V){V.setRequestHeader("X-HTTP-Method-Override",R);if(Q){return Q.apply(this,arguments)}}}if(T.type!=="GET"&&!O.emulateJSON){T.processData=false}if(T.type==="PATCH"&&j){T.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var S=O.xhr=B.ajax(N.extend(T,O));P.trigger("request",P,S,O);return S};var j=typeof window!=="undefined"&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);var k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};B.ajax=function(){return B.$.ajax.apply(B.$,arguments)};var q=B.Router=function(O){O||(O={});if(O.routes){this.routes=O.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var r=/\((.*?)\)/g;var t=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;N.extend(q.prototype,L,{initialize:function(){},route:function(P,Q,R){if(!N.isRegExp(P)){P=this._routeToRegExp(P)}if(N.isFunction(Q)){R=Q;Q=""}if(!R){R=this[Q]}var O=this;B.history.route(P,function(T){var S=O._extractParameters(P,T);O.execute(R,S);O.trigger.apply(O,["route:"+Q].concat(S));O.trigger("route",Q,S);B.history.trigger("route",O,Q,S)});return this},execute:function(P,O){if(P){P.apply(this,O)}},navigate:function(P,O){B.history.navigate(P,O);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=N.result(this,"routes");var P,O=N.keys(this.routes);while((P=O.pop())!=null){this.route(P,this.routes[P])}},_routeToRegExp:function(O){O=O.replace(h,"\\$&").replace(r,"(?:$1)?").replace(t,function(Q,P){return P?Q:"([^/?]+)"}).replace(d,"([^?]*?)");return new RegExp("^"+O+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(O,P){var Q=O.exec(P).slice(1);return N.map(Q,function(S,R){if(R===Q.length-1){return S||null}return S?decodeURIComponent(S):null})}});var i=B.History=function(){this.handlers=[];N.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var C=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var K=/msie [\w.]+/;var n=/\/$/;var H=/#.*$/;i.started=false;N.extend(i.prototype,L,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(P){var O=(P||this).location.href.match(/#(.*)$/);return O?O[1]:""},getFragment:function(Q,P){if(Q==null){if(this._hasPushState||!this._wantsHashChange||P){Q=decodeURI(this.location.pathname+this.location.search);var O=this.root.replace(n,"");if(!Q.indexOf(O)){Q=Q.slice(O.length)}}else{Q=this.getHash()}}return Q.replace(C,"")},start:function(Q){if(i.started){throw new Error("Backbone.history has already been started")}i.started=true;this.options=N.extend({root:"/"},this.options,Q);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var P=this.getFragment();var O=document.documentMode;var R=(K.exec(navigator.userAgent.toLowerCase())&&(!O||O<=7));this.root=("/"+this.root+"/").replace(f,"/");if(R&&this._wantsHashChange){var T=B.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=T.hide().appendTo("body")[0].contentWindow;this.navigate(P)}if(this._hasPushState){B.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!R){B.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=P;var S=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){this.fragment=this.getFragment(null,true);this.location.replace(this.root+"#"+this.fragment);return true}else{if(this._hasPushState&&this.atRoot()&&S.hash){this.fragment=this.getHash().replace(C,"");this.history.replaceState({},document.title,this.root+this.fragment)}}}if(!this.options.silent){return this.loadUrl()}},stop:function(){B.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);if(this._checkUrlInterval){clearInterval(this._checkUrlInterval)}i.started=false},route:function(O,P){this.handlers.unshift({route:O,callback:P})},checkUrl:function(P){var O=this.getFragment();if(O===this.fragment&&this.iframe){O=this.getFragment(this.getHash(this.iframe))}if(O===this.fragment){return false}if(this.iframe){this.navigate(O)}this.loadUrl()},loadUrl:function(O){O=this.fragment=this.getFragment(O);return N.any(this.handlers,function(P){if(P.route.test(O)){P.callback(O);return true}})},navigate:function(Q,P){if(!i.started){return false}if(!P||P===true){P={trigger:!!P}}var O=this.root+(Q=this.getFragment(Q||""));Q=Q.replace(H,"");if(this.fragment===Q){return}this.fragment=Q;if(Q===""&&O!=="/"){O=O.slice(0,-1)}if(this._hasPushState){this.history[P.replace?"replaceState":"pushState"]({},document.title,O)}else{if(this._wantsHashChange){this._updateHash(this.location,Q,P.replace);if(this.iframe&&(Q!==this.getFragment(this.getHash(this.iframe)))){if(!P.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,Q,P.replace)}}else{return this.location.assign(O)}}if(P.trigger){return this.loadUrl(Q)}},_updateHash:function(O,Q,R){if(R){var P=O.href.replace(/(javascript:|#).*$/,"");O.replace(P+"#"+Q)}else{O.hash="#"+Q}}});B.history=new i;var m=function(O,Q){var P=this;var S;if(O&&N.has(O,"constructor")){S=O.constructor}else{S=function(){return P.apply(this,arguments)}}N.extend(S,P,Q);var R=function(){this.constructor=S};R.prototype=P.prototype;S.prototype=new R;if(O){N.extend(S.prototype,O)}S.__super__=P.prototype;return S};G.extend=c.extend=q.extend=I.extend=i.extend=m;var s=function(){throw new Error('A "url" property or function must be specified')};var J=function(Q,P){var O=P.error;P.error=function(R){if(O){O(Q,R,P)}Q.trigger("error",Q,R,P)}};return B}));